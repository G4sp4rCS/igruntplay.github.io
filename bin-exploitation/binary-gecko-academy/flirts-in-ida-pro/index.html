
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Grunt's Blog">
      
      
      
        <link rel="canonical" href="https://igruntplay.github.io/bin-exploitation/binary-gecko-academy/flirts-in-ida-pro/">
      
      
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Reversing Avanzado con IDA Pro: FLIRT, Bindiff y Desofuscación - Grunt's Personal Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CFira+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Fira Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="lime" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reversing-avanzado-con-ida-pro-flirt-bindiff-y-desofuscacion" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../../.." title="Grunt&#39;s Personal Wiki" class="md-header__button md-logo" aria-label="Grunt's Personal Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Grunt's Personal Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reversing Avanzado con IDA Pro: FLIRT, Bindiff y Desofuscación
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="lime" data-md-color-accent="teal"  aria-label="Cambiar a modo claro"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo claro" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Cambiar a modo oscuro"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/G4sp4rCS/igruntplay.github.io" title="Ir al repositorio" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    G4sp4rCS/igruntplay.github.io
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Grunt&#39;s Personal Wiki" class="md-nav__button md-logo" aria-label="Grunt's Personal Wiki" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Grunt's Personal Wiki
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/G4sp4rCS/igruntplay.github.io" title="Ir al repositorio" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    G4sp4rCS/igruntplay.github.io
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Inicio
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Ofensiva
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Ofensiva
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bin-exploitation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fundamentos de explotación
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../OSCP/OSCP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OSCP Preparation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../WindowsHacking/windowsHackingIndex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Windows Hacking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../privilege-escalation-linux-assistance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PrivEsc Cheatsheet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../HavocC2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Havoc C2 101
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../scripts/scripts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scripts & Exploits
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../dnsSpoofing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNS Spoofing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../subdomain-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Subdomain Enumeration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Cloud & AppSec
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cloud & AppSec
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CloudHacking/cloudHacking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cloud Hacking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CloudHacking/AWS-enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS Enumeration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../CloudHacking/AWS-Attacking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AWS Attacking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../AppSecKPI/AppSecKPI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AppSec KPI & Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../bug-bounty-resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bug Bounty Resources
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../corsPOC/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CORS PoC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Certificaciones
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Certificaciones
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BSCP/BSCP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BSCP Preparation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BSCP/practicioner-labs-notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BSCP Practitioner Labs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BSCP/OAuth-account-hijacking-via-redirect_uri/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OAuth Hijacking Notes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ejpt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    eJPT Notes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Programación & AI
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Programación & AI
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Rust/rust/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rust Programming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Rust/closures-rust/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rust: Closures
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Rust/smart-pointers-rust/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rust: Smart Pointers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../AI/AI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI for Red Teaming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../AI/fundamentals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../AI/DecisionTrees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Decision Trees
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../AI/NaiveBayes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Naive Bayes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../university/university/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Apuntes universitarios
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Miscelánea
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Miscelánea
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../android-pentesting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Android Pentesting Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BurpSuite-regex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BurpSuite Regex Cheatsheet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../jobs/jobs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Jobs Interview Tips
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gaming/gaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gaming Settings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../xss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    XSS Payloads
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/G4sp4rCS/igruntplay.github.io/edit/master/docs/bin-exploitation/binary-gecko-academy/flirts-in-ida-pro.md" title="Editar esta página" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="reversing-avanzado-con-ida-pro-flirt-bindiff-y-desofuscacion">Reversing Avanzado con IDA Pro: FLIRT, Bindiff y Desofuscación<a class="headerlink" href="#reversing-avanzado-con-ida-pro-flirt-bindiff-y-desofuscacion" title="Permanent link">&para;</a></h1>
<h2 id="introduccion">Introducción<a class="headerlink" href="#introduccion" title="Permanent link">&para;</a></h2>
<p>Este documento compila técnicas avanzadas de reversing aplicadas a binarios Windows, específicamente enfocado en:</p>
<ul>
<li><strong>Desofuscación estática</strong> mediante scripts IDAPython</li>
<li><strong>Creación de firmas FLIRT personalizadas</strong> para librerías embebidas</li>
<li><strong>Reconstrucción de símbolos C++</strong> usando Bindiff</li>
<li><strong>Importación de estructuras STL</strong> (std::string, std::vector, etc.)</li>
<li><strong>Análisis de calling conventions y stack alignment</strong> en x64</li>
</ul>
<p>Estas técnicas fueron aplicadas en el análisis del challenge "Binary Echo" del curso de Binary Exploitation de Gecko Academy, compilado con Intel C++ Compiler y con múltiples capas de ofuscación.</p>
<hr />
<h2 id="parte-1-desofuscacion-estatica">Parte 1: Desofuscación Estática<a class="headerlink" href="#parte-1-desofuscacion-estatica" title="Permanent link">&para;</a></h2>
<h3 id="introduccion-al-problema">Introducción al Problema<a class="headerlink" href="#introduccion-al-problema" title="Permanent link">&para;</a></h3>
<p>El binario presenta ofuscación mediante saltos manipulados que rompen el desensamblado automático de IDA Pro. El patrón típico es:</p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">test</span><span class="w"> </span><span class="no">ebp</span><span class="p">,</span><span class="w"> </span><span class="no">ebp</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nf">jnz</span><span class="w"> </span><span class="no">short</span><span class="w"> </span><span class="no">loc_102C</span><span class="err">+</span><span class="mi">1</span><span class="w">    </span><span class="c1">; Salta a 102D (dentro de una instrucción)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="nf">retn</span><span class="w"> </span><span class="mi">0</span><span class="w">                  </span><span class="c1">; 0xC2 - byte que se saltea</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nf">nop</span><span class="w">                     </span><span class="c1">; 0x90 - destino real</span>
</span></code></pre></div>
<p><strong>Problema:</strong> IDA ve el <code>retn 0</code> (C2 00) como una instrucción válida y no desensambla desde el byte siguiente (90), dejando código "roto".</p>
<h3 id="metodos-de-correccion">Métodos de Corrección<a class="headerlink" href="#metodos-de-correccion" title="Permanent link">&para;</a></h3>
<h4 id="metodo-1-correccion-dinamica-debugging">Método 1: Corrección Dinámica (Debugging)<a class="headerlink" href="#metodo-1-correccion-dinamica-debugging" title="Permanent link">&para;</a></h4>
<ol>
<li>Ejecutar el binario en x64dbg o IDA Debugger</li>
<li>Trasear (F7) hasta la zona ofuscada</li>
<li>Observar cómo el código "se arregla" automáticamente al ejecutarse</li>
<li>El problema: <strong>trabajo de mono</strong> si hay miles de instancias</li>
</ol>
<p><strong>Ventaja:</strong> Funciona siempre<br />
<strong>Desventaja:</strong> Extremadamente lento para binarios grandes</p>
<h4 id="metodo-2-correccion-manual">Método 2: Corrección Manual<a class="headerlink" href="#metodo-2-correccion-manual" title="Permanent link">&para;</a></h4>
<p>Para cada instancia ofuscada:</p>
<ol>
<li>Cambiar a vista de texto (barra espaciadora en IDA)</li>
<li>Activar visualización de bytes: <code>Options &gt; General &gt; Number of opcode bytes</code></li>
<li>Identificar el salto: <code>jnz short loc_102C+1</code></li>
<li>Ubicar el byte destino (102D)</li>
<li>Presionar <code>U</code> en la dirección 102C para "undefinir" el <code>retn</code></li>
<li>Ahora la dirección 102D existe</li>
<li>Presionar <code>C</code> en 102D para crear código</li>
</ol>
<p><strong>Ejemplo visual:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>Antes:
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>102C: jnz short loc_102C+1    ; Salta a 102D (no existe)
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>102C: retn 0                  ; C2 00
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>102E: nop                     ; 90
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>Después:
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>102C: jnz short loc_102D      ; Ahora salta a dirección válida
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>102C: db 0xC2                 ; Byte indefinido
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>102D: nop                     ; Código válido
</span></code></pre></div>
<h4 id="metodo-3-script-idapython-recomendado">Método 3: Script IDAPython (Recomendado)<a class="headerlink" href="#metodo-3-script-idapython-recomendado" title="Permanent link">&para;</a></h4>
<p><strong>Paso 1:</strong> Identificar el patrón de bytes</p>
<p>Buscar la secuencia repetida:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>85 ED 75 01 C2    ; test ebp, ebp; jnz +1; retn
</span></code></pre></div>
<p>En IDA: <code>Search &gt; Sequence of bytes &gt; 85 ED 75 01 C2</code></p>
<p><strong>Paso 2:</strong> Extraer direcciones</p>
<p>Copiar resultados al Notepad, extraer direcciones con Alt+selección de columna.</p>
<p><strong>Paso 3:</strong> Aplicar script</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">ida_bytes</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">ida_auto</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">idaapi</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="c1"># Direcciones donde está el patrón</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="n">addrs</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="mh">0x00401028</span><span class="p">,</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    <span class="mh">0x0040108C</span><span class="p">,</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>    <span class="mh">0x00401095</span><span class="p">,</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    <span class="mh">0x00401142</span><span class="p">,</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>    <span class="mh">0x004011F3</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="p">]</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">addrs</span><span class="p">:</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>    <span class="c1"># Paso 1: Undefinir el byte C2 (offset +4 desde el inicio del patrón)</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>    <span class="n">ida_bytes</span><span class="o">.</span><span class="n">del_items</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">ida_bytes</span><span class="o">.</span><span class="n">DELIT_SIMPLE</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>    <span class="c1"># Paso 2: Crear código desde el byte siguiente (offset +5)</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>    <span class="k">for</span> <span class="n">ea</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">ida_inf_get_max_ea</span><span class="p">()):</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>        <span class="n">ida_ua</span><span class="o">.</span><span class="n">create_insn</span><span class="p">(</span><span class="n">ea</span><span class="p">)</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>        <span class="k">break</span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>    <span class="c1"># Paso 3: Re-analizar (opcional, puede comentarse)</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>    <span class="n">ida_auto</span><span class="o">.</span><span class="n">auto_wait</span><span class="p">()</span>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Desofuscación completada&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>Ejecución:</strong> <code>File &gt; Script command &gt; Python &gt; Pegar script &gt; Run</code></p>
<h3 id="patrones-de-ofuscacion-encontrados">Patrones de Ofuscación Encontrados<a class="headerlink" href="#patrones-de-ofuscacion-encontrados" title="Permanent link">&para;</a></h3>
<p>En el challenge había <strong>5 instancias</strong> del patrón principal:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>85 ED 75 01 C2    ; Común (5 veces)
</span></code></pre></div>
<p>Y <strong>variantes</strong> que requieren corrección manual:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>85 ED 75 01 C3    ; Usa retn en vez de retn 0
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>85 ED 75 03 C3    ; Salta +3 bytes en vez de +1
</span></code></pre></div>
<h3 id="bytes-residuales-0x48">Bytes Residuales (0x48)<a class="headerlink" href="#bytes-residuales-0x48" title="Permanent link">&para;</a></h3>
<p>Después de aplicar el script, suelen quedar bytes <code>0x48</code> sin desensamblar. Solución:</p>
<ul>
<li>Presionar <code>C</code> sobre el byte 0x48</li>
<li>IDA lo reconocerá como parte de una instrucción válida</li>
</ul>
<h3 id="notas-importantes">Notas Importantes<a class="headerlink" href="#notas-importantes" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Analizar todo al final puede romper correcciones:</strong> Comentar <code>ida_auto.auto_wait()</code> si causa problemas</li>
<li><strong>Backups:</strong> Hacer snapshots de IDA (<code>Take database snapshot</code>) antes de aplicar scripts masivos</li>
<li><strong>Patrones únicos:</strong> Si cada ofuscación es diferente, buscar sub-patrones comunes</li>
<li><strong>Automatización vs. Manual:</strong> Si son &lt;10 instancias, manual es viable; si son &gt;100, script obligatorio</li>
</ul>
<hr />
<h2 id="parte-2-creacion-de-firmas-flirt-personalizadas">Parte 2: Creación de Firmas FLIRT Personalizadas<a class="headerlink" href="#parte-2-creacion-de-firmas-flirt-personalizadas" title="Permanent link">&para;</a></h2>
<h3 id="contexto-por-que-necesitamos-flirt-personalizado">Contexto: ¿Por Qué Necesitamos FLIRT Personalizado?<a class="headerlink" href="#contexto-por-que-necesitamos-flirt-personalizado" title="Permanent link">&para;</a></h3>
<p><strong>FLIRT (Fast Library Identification and Recognition Technology):</strong> Sistema de IDA para reconocer funciones de librerías mediante patrones de bytes.</p>
<p><strong>Problema en el challenge:</strong></p>
<ul>
<li>Binario compilado con <strong>static linking</strong> (DLLs embebidas)</li>
<li>Funciones como <code>printf</code>, <code>scanf</code>, operadores de C++ (<code>operator&lt;&lt;</code>) no aparecen en la IAT</li>
<li>FLIRT por defecto de IDA <strong>no reconoce</strong> estas funciones embebidas</li>
<li>Compilador: <strong>Intel C++</strong> (no Visual Studio estándar)</li>
</ul>
<p><strong>Resultado:</strong> IDA muestra <code>sub_401234</code> en vez de <code>std::basic_string::operator&lt;&lt;</code>, haciendo el análisis incomprensible.</p>
<h3 id="prerequisitos">Prerequisitos<a class="headerlink" href="#prerequisitos" title="Permanent link">&para;</a></h3>
<p><strong>Herramientas necesarias:</strong></p>
<ul>
<li>IDA Pro o IDA Classroom (con soporte IDAPython)</li>
<li>IDA Free <strong>NO soporta</strong> IDAPython (limitación)</li>
<li>Compilador Intel C++ integrado en Visual Studio 2022</li>
<li>Scripts:</li>
<li><code>idb2pat.py</code> (convierte IDB a archivo .pat)</li>
<li><code>sigmake.exe</code> (viene con IDA, en carpeta <code>flair/</code>)</li>
</ul>
<h3 id="proceso-completo-paso-a-paso">Proceso Completo: Paso a Paso<a class="headerlink" href="#proceso-completo-paso-a-paso" title="Permanent link">&para;</a></h3>
<h4 id="paso-1-generar-codigo-de-prueba-con-simbolos">Paso 1: Generar Código de Prueba con Símbolos<a class="headerlink" href="#paso-1-generar-codigo-de-prueba-con-simbolos" title="Permanent link">&para;</a></h4>
<p><strong>Objetivo:</strong> Crear un ejecutable que use todas las funciones que queremos detectar, con símbolos claros para IDA Pro.</p>
<p><strong>Método recomendado:</strong> Pedirle a ChatGPT/Claude:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>Prompt: &quot;Genera un programa en C++ que use:
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>- printf, scanf, fgets, strcmp
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>- std::string, std::vector
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>- Operadores &lt;&lt; y &gt;&gt; de iostream
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>- Constructores y destructores de STL
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>Usa la mayor cantidad posible de funciones estándar.&quot;
</span></code></pre></div>
<p><strong>Ejemplo de código generado:</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string&gt;</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstdio&gt;</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstring&gt;</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Hello&quot;</span><span class="p">;</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">vec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">};</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">    </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="p">);</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;You entered: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="p">);</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="paso-2-compilar-con-configuraciones-especificas">Paso 2: Compilar con Configuraciones Específicas<a class="headerlink" href="#paso-2-compilar-con-configuraciones-especificas" title="Permanent link">&para;</a></h4>
<p><strong>Configuración crítica en Visual Studio:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>Properties &gt; C/C++ &gt; Code Generation &gt; Runtime Library
</span></code></pre></div>
<p><strong>Configuración correcta:</strong></p>
<ul>
<li><code>Multi-threaded DLL (/MD)</code> → <strong>Use this</strong> para que IDA Pro pueda ver símbolos correctamente</li>
</ul>
<p><strong>Nota importante:</strong> A diferencia de otros escenarios, para que FLIRT funcione bien y IDA detecte nombres de funciones y variables, es necesario usar <code>/MD</code> (DLL linking) en vez de <code>/MT</code> (static linking).</p>
<p><strong>Optimizaciones:</strong></p>
<ul>
<li><strong>Desactivar TODAS las optimizaciones</strong> (<code>/Od</code> - Disabled)</li>
<li><strong>No usar Release con optimizaciones</strong> (<code>/O2</code>)</li>
<li>Razón: Sin optimizaciones, IDA Pro puede ver claramente los nombres de funciones, variables y estructuras de STL</li>
</ul>
<p><strong>Compiladores a probar:</strong></p>
<ol>
<li><strong>Intel C++ Compiler</strong> (para el challenge)</li>
<li><strong>Visual Studio Compiler</strong> (para Bindiff posterior)</li>
</ol>
<h4 id="paso-3-convertir-idb-a-archivo-pat">Paso 3: Convertir IDB a Archivo .pat<a class="headerlink" href="#paso-3-convertir-idb-a-archivo-pat" title="Permanent link">&para;</a></h4>
<p><strong>En IDA Pro/Classroom:</strong></p>
<ol>
<li>Abrir el ejecutable compilado <strong>con símbolos</strong> (archivo .pdb)</li>
<li>Verificar que los nombres estén correctos: <code>Options &gt; Demangle names</code></li>
<li>Ejecutar: <code>File &gt; Script file &gt; idb2pat.py</code></li>
<li>Guardar como: <code>console_app.pat</code></li>
</ol>
<p><strong>¿Qué hace idb2pat.py?</strong></p>
<ul>
<li>Lee el IDB (base de datos de IDA)</li>
<li>Extrae patrones de bytes de cada función</li>
<li>Asocia cada patrón con su nombre simbólico</li>
<li>Genera archivo <code>.pat</code> (intermedio)</li>
</ul>
<h4 id="paso-4-generar-archivo-sig-con-sigmake">Paso 4: Generar Archivo .sig con sigmake<a class="headerlink" href="#paso-4-generar-archivo-sig-con-sigmake" title="Permanent link">&para;</a></h4>
<p><strong>Abrir terminal (PowerShell/CMD):</strong></p>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nb">cd </span><span class="s2">&quot;C:\Program Files\IDA Pro 9.0\flair\bin\win&quot;</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="p">.\</span><span class="n">sigmake</span><span class="p">.</span><span class="n">exe</span> <span class="n">-n</span> <span class="s2">&quot;MyLibrary&quot;</span> <span class="s2">&quot;C:\path\to\console_app.pat&quot;</span> <span class="s2">&quot;C:\path\to\console_app.sig&quot;</span>
</span></code></pre></div>
<p><strong>Sintaxis:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>sigmake.exe [-n nombre] &lt;archivo.pat&gt; &lt;archivo.sig&gt;
</span></code></pre></div>
<p><strong>Problema común: Colisiones</strong></p>
<p>Si <code>sigmake</code> dice:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>console_app.exc: 5 collision(s)
</span></code></pre></div>
<p><strong>Solución:</strong></p>
<ol>
<li>Se generó un archivo <code>.exc</code> con las colisiones</li>
<li>Abrir <code>console_app.exc</code> con Notepad++</li>
<li>Comentar las líneas con <code>;</code> al principio:</li>
</ol>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>;00401234 05 memcpy....
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>;00401240 06 strlen....
</span></code></pre></div>
<ol>
<li>Guardar y volver a ejecutar <code>sigmake</code></li>
</ol>
<p><strong>Ahora sí genera:</strong> <code>console_app.sig</code></p>
<h4 id="paso-5-aplicar-la-firma-al-binario-target">Paso 5: Aplicar la Firma al Binario Target<a class="headerlink" href="#paso-5-aplicar-la-firma-al-binario-target" title="Permanent link">&para;</a></h4>
<p><strong>En IDA (con el challenge abierto):</strong></p>
<ol>
<li><code>File &gt; Load file &gt; FLIRT signature file</code></li>
<li>Seleccionar <code>console_app.sig</code></li>
<li>IDA aplica las firmas automáticamente</li>
</ol>
<p><strong>Antes:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>sub_401234
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>sub_401250
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>sub_401ABC
</span></code></pre></div>
<p><strong>Después:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>std::basic_string::operator&lt;&lt;
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>printf
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>std::allocator::allocate
</span></code></pre></div>
<h3 id="limitaciones-y-casos-especiales">Limitaciones y Casos Especiales<a class="headerlink" href="#limitaciones-y-casos-especiales" title="Permanent link">&para;</a></h3>
<h4 id="problema-compilador-intel-y-name-mangling">Problema: Compilador Intel y Name Mangling<a class="headerlink" href="#problema-compilador-intel-y-name-mangling" title="Permanent link">&para;</a></h4>
<p><strong>Síntoma:</strong> Los nombres en Release con Intel C++ salen así:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>??$operator@_W@std@@blah___
</span></code></pre></div>
<p>En vez de:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>std::operator&lt;&lt;(std::string&amp;, char)
</span></code></pre></div>
<p><strong>Causa:</strong> El compilador Intel no incluye los símbolos completos en Release mode.</p>
<p><strong>Solución:</strong> Usar <strong>Bindiff</strong> (ver Parte 3).</p>
<h4 id="multiples-versiones-de-flirt">Múltiples Versiones de FLIRT<a class="headerlink" href="#multiples-versiones-de-flirt" title="Permanent link">&para;</a></h4>
<p>Recomendación: Mantener una colección de <code>.sig</code>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>flirt_signatures/
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>├── msvc_2019_x64_mt.sig
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>├── msvc_2022_x64_mt.sig
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>├── intel_cpp_2023_x64.sig
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>├── mingw_gcc_x64.sig
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>└── clang_x64.sig
</span></code></pre></div>
<p><strong>Probar varias:</strong> Si una no detecta nada, probar otra. No hay riesgo de "romper" el IDB.</p>
<h4 id="detectar-el-compilador-detect-it-easy">Detectar el Compilador: Detect It Easy<a class="headerlink" href="#detectar-el-compilador-detect-it-easy" title="Permanent link">&para;</a></h4>
<p><strong>Tool:</strong> <a href="https://github.com/horsicq/Detect-It-Easy">Detect It Easy (DIE)</a></p>
<p><strong>Uso:</strong></p>
<ol>
<li>Abrir el ejecutable en DIE</li>
<li>Ver "Compiler" y "Linker"</li>
</ol>
<p><strong>Ejemplo:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>Compiler: Microsoft Visual C++ 2022 (19.34)
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>Linker: Microsoft Linker 14.34
</span></code></pre></div>
<p><strong>Con Intel C++:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>Compiler: Intel C++ (info incomplete)
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>Linker: Microsoft Linker (no version)
</span></code></pre></div>
<p><strong>Nota:</strong> Intel C++ es difícil de detectar porque usa el linker de MSVC.</p>
<hr />
<h2 id="parte-3-reconstruccion-de-simbolos-con-bindiff">Parte 3: Reconstrucción de Símbolos con Bindiff<a class="headerlink" href="#parte-3-reconstruccion-de-simbolos-con-bindiff" title="Permanent link">&para;</a></h2>
<h3 id="contexto-el-problema-del-intel-c-compiler">Contexto: El Problema del Intel C++ Compiler<a class="headerlink" href="#contexto-el-problema-del-intel-c-compiler" title="Permanent link">&para;</a></h3>
<p><strong>Escenario:</strong></p>
<ul>
<li>Compilaste con Intel C++ en Release</li>
<li>Los símbolos en IDA salen ofuscados:</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>??$operator@___W@std@@blah___
</span></code></pre></div>
<ul>
<li>El FLIRT generado <strong>no funciona</strong> en el challenge porque los bytes no coinciden exactamente</li>
</ul>
<p><strong>Solución:</strong> Compilar <strong>dos versiones</strong> del mismo código:</p>
<ol>
<li><strong>Con Intel C++</strong> (sin símbolos legibles)</li>
<li><strong>Con Visual Studio</strong> (con símbolos correctos)</li>
</ol>
<p>Luego usar <strong>Bindiff</strong> para:</p>
<ul>
<li>Comparar ambos ejecutables</li>
<li>Machear funciones similares</li>
<li><strong>Importar los nombres</strong> del ejecutable de VS al de Intel</li>
</ul>
<h3 id="instalacion-de-bindiff-para-ida-9">Instalación de Bindiff para IDA 9<a class="headerlink" href="#instalacion-de-bindiff-para-ida-9" title="Permanent link">&para;</a></h3>
<h4 id="problema-incompatibilidad-oficial">Problema: Incompatibilidad Oficial<a class="headerlink" href="#problema-incompatibilidad-oficial" title="Permanent link">&para;</a></h4>
<p><strong>Estado actual (2025):</strong></p>
<ul>
<li>Bindiff oficial <strong>NO soporta IDA 9</strong></li>
<li>Issue abierto en GitHub sin solución oficial</li>
<li>Solución: <strong>Librerías parcheadas por la comunidad</strong></li>
</ul>
<h4 id="instalacion-paso-a-paso">Instalación Paso a Paso<a class="headerlink" href="#instalacion-paso-a-paso" title="Permanent link">&para;</a></h4>
<p><strong>1. Descargar Bindiff:</strong></p>
<ul>
<li><a href="https://www.zynamics.com/bindiff.html">Página oficial</a></li>
<li>Descargar el instalador <code>.msi</code> para Windows</li>
</ul>
<p><strong>2. Instalar normalmente:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>C:\Program Files\BinDiff\
</span></code></pre></div>
<p><strong>3. Descargar librerías parcheadas:</strong></p>
<p><strong>Opción A (GitHub - cfox):</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>https://github.com/google/bindiff/issues/XX
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>(Buscar: &quot;IDA 9 support&quot;)
</span></code></pre></div>
<p>Bajar los archivos:</p>
<ul>
<li><code>zynamics_binexport_12_ida64.dll</code></li>
<li><code>zynamics_bindiff_10_ida64.dll</code></li>
</ul>
<p><strong>Opción B (Moodle del curso):</strong></p>
<p>Archivo <code>bindiff_ida9_dlls.zip</code> con las DLLs ya parcheadas.</p>
<p><strong>4. Reemplazar DLLs:</strong></p>
<p><strong>Ubicación 1 (plugins de IDA):</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>C:\Users\[Usuario]\AppData\Roaming\Hex-Rays\IDA Pro\plugins\
</span></code></pre></div>
<p>Archivos a reemplazar:</p>
<ul>
<li><code>zynamics_binexport_12_ida64.dll</code></li>
<li><code>zynamics_bindiff_10_ida64.dll</code></li>
</ul>
<p><strong>Ubicación 2 (instalación de Bindiff):</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>C:\Program Files\BinDiff\plugins\
</span></code></pre></div>
<p><strong>¡Importante!</strong> Hay que reemplazar en <strong>ambos</strong> lugares, porque Bindiff restaura las DLLs originales al arrancar.</p>
<p><strong>Solución definitiva:</strong> Borrar las DLLs de la instalación de Bindiff para evitar que restaure las viejas.</p>
<p><strong>5. Verificar instalación:</strong></p>
<p>Abrir IDA Pro:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>Edit &gt; Plugins &gt; Bindiff ✓
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>Edit &gt; Plugins &gt; Binexport ✓
</span></code></pre></div>
<p>Si aparecen, la instalación fue exitosa.</p>
<h4 id="bindiff-en-ida-free-workaround">Bindiff en IDA Free: Workaround<a class="headerlink" href="#bindiff-en-ida-free-workaround" title="Permanent link">&para;</a></h4>
<p><strong>Problema:</strong> Bindiff en IDA Free dice "database is open in another instance" aunque no lo esté.</p>
<p><strong>Solución:</strong></p>
<p><strong>1. Exportar ambos ejecutables con Binexport:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>IDA Free &gt; Edit &gt; Plugins &gt; Binexport
</span></code></pre></div>
<p>Genera: <code>executable.BinExport</code></p>
<p><strong>2. Usar Bindiff desde línea de comandos:</strong></p>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nb">cd </span><span class="s2">&quot;C:\Program Files\BinDiff\bin&quot;</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="p">.\</span><span class="n">bindiff</span><span class="p">.</span><span class="n">exe</span> <span class="p">`</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>  <span class="p">-</span><span class="n">-primary</span> <span class="s2">&quot;C:\path\to\intel.BinExport&quot;</span> <span class="p">`</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>  <span class="p">-</span><span class="n">-secondary</span> <span class="s2">&quot;C:\path\to\vs.BinExport&quot;</span> <span class="p">`</span>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>  <span class="p">-</span><span class="n">-output</span> <span class="s2">&quot;.&quot;</span>
</span></code></pre></div>
<p><strong>3. Cargar resultados en IDA Free:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>Edit &gt; Plugins &gt; Bindiff &gt; Add existing diff results
</span></code></pre></div>
<p>Seleccionar el archivo <code>.bindiff</code> generado.</p>
<h3 id="proceso-matcheo-de-simbolos">Proceso: Matcheo de Símbolos<a class="headerlink" href="#proceso-matcheo-de-simbolos" title="Permanent link">&para;</a></h3>
<h4 id="paso-1-compilar-dos-versiones">Paso 1: Compilar Dos Versiones<a class="headerlink" href="#paso-1-compilar-dos-versiones" title="Permanent link">&para;</a></h4>
<p><strong>Versión 1: Intel C++ Compiler</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>Properties &gt; General &gt; Platform Toolset: Intel C++ Compiler
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>Properties &gt; C/C++ &gt; Code Generation &gt; Runtime Library: Multi-threaded DLL (/MD)
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>Properties &gt; C/C++ &gt; Optimization: Disabled (/Od)
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>Output: console_app_intel.exe + console_app_intel.pdb
</span></code></pre></div>
<p><strong>Versión 2: Visual Studio</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>Properties &gt; General &gt; Platform Toolset: Visual Studio 2022 (v143)
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>Properties &gt; C/C++ &gt; Code Generation &gt; Runtime Library: Multi-threaded DLL (/MD)
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>Properties &gt; C/C++ &gt; Optimization: Disabled (/Od)
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>Output: console_app_vs.exe + console_app_vs.pdb
</span></code></pre></div>
<p><strong>Importante:</strong> Ambos deben:</p>
<ul>
<li>Usar <strong>mismo código fuente</strong></li>
<li>Compilar en <strong>Release</strong></li>
<li>Usar <strong>dynamic linking</strong> (/MD) para que IDA vea los símbolos</li>
<li><strong>Desactivar todas las optimizaciones</strong> (<code>/Od</code>)</li>
<li>Tener <strong>símbolos</strong> (.pdb disponibles)</li>
</ul>
<h4 id="paso-2-abrir-ejecutables-en-ida">Paso 2: Abrir Ejecutables en IDA<a class="headerlink" href="#paso-2-abrir-ejecutables-en-ida" title="Permanent link">&para;</a></h4>
<p><strong>En IDA Pro:</strong></p>
<ol>
<li>Abrir <code>console_app_vs.exe</code> (con símbolos correctos gracias a <code>/MD</code> y optimizaciones desactivadas)</li>
<li><code>Options &gt; Demangle names</code> → Verificar que los nombres sean claramente visibles</li>
<li>
<p>Cerrar</p>
</li>
<li>
<p>Abrir <code>console_app_intel.exe</code> (compilado con Intel C++)</p>
</li>
<li><code>Options &gt; Demangle names</code> → Ver que los nombres pueden no estar tan claros</li>
<li><strong>No cerrar este</strong></li>
</ol>
<h4 id="paso-3-ejecutar-bindiff">Paso 3: Ejecutar Bindiff<a class="headerlink" href="#paso-3-ejecutar-bindiff" title="Permanent link">&para;</a></h4>
<p><strong>Con <code>console_app_intel.exe</code> abierto:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>Edit &gt; Plugins &gt; Bindiff &gt; Diff database...
</span></code></pre></div>
<p>Seleccionar: <code>console_app_vs.i64</code> (el IDB del ejecutable de VS)</p>
<p><strong>Importante:</strong> El <code>.i64</code> de VS debe estar <strong>cerrado</strong> (no abierto en otra instancia de IDA).</p>
<p><strong>Bindiff comienza a analizar:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>Analyzing functions...
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>Matching algorithms:
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>- Address matching
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>- String references
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>- Call graph matching
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>- Manual matches
</span></code></pre></div>
<p><strong>Resultado:</strong> Ventana de Bindiff con matches.</p>
<h4 id="paso-4-interpretar-resultados">Paso 4: Interpretar Resultados<a class="headerlink" href="#paso-4-interpretar-resultados" title="Permanent link">&para;</a></h4>
<p><strong>Pestañas en Bindiff:</strong></p>
<table>
<thead>
<tr>
<th>Pestaña</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Matched Functions</strong></td>
<td>Funciones que Bindiff considera iguales (high confidence)</td>
</tr>
<tr>
<td><strong>Unmatched Primary</strong></td>
<td>Funciones solo en Intel (no machean)</td>
</tr>
<tr>
<td><strong>Unmatched Secondary</strong></td>
<td>Funciones solo en VS (no machean)</td>
</tr>
<tr>
<td><strong>Statistics</strong></td>
<td>Métricas de similitud</td>
</tr>
</tbody>
</table>
<p><strong>Columnas importantes:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>Primary Name: operator@@___W@std (nombre roto de Intel)
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>Secondary Name: std::operator&lt;&lt;(std::string&amp;) (nombre correcto de VS)
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>Similarity: 0.95 (95% de código similar)
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>Confidence: High
</span></code></pre></div>
<p><strong>Ejemplo visual:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>Matched Functions:
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>Primary (Intel)              Secondary (VS)                   Similarity
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>??$operator@_W@std@@___     std::basic_string::operator&lt;&lt;    0.98
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>sub_401234                   printf                           1.00
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>??allocator@std@@___        std::allocator::allocate         0.95
</span></code></pre></div>
<h4 id="paso-5-importar-simbolos">Paso 5: Importar Símbolos<a class="headerlink" href="#paso-5-importar-simbolos" title="Permanent link">&para;</a></h4>
<p><strong>Seleccionar funciones a importar:</strong></p>
<ol>
<li>En la pestaña <strong>Matched Functions</strong></li>
<li><code>Ctrl+A</code> (seleccionar todas)</li>
<li>Clic derecho → <strong>Import Symbol &amp; Comments</strong></li>
</ol>
<p><strong>Alternativamente (selectivo):</strong></p>
<ul>
<li>Filtrar por similitud &gt; 0.90</li>
<li>Importar solo las de alta confianza</li>
</ul>
<p><strong>IDA aplica los cambios:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>Primary antes:     ??$operator@_W@std@@___
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>Primary después:   std::basic_string::operator&lt;&lt;
</span></code></pre></div>
<p><strong>Cerrar Bindiff:</strong> <code>File &gt; Close</code></p>
<h4 id="paso-6-verificar-en-ida">Paso 6: Verificar en IDA<a class="headerlink" href="#paso-6-verificar-en-ida" title="Permanent link">&para;</a></h4>
<p><strong>En la ventana de IDA (Intel C++):</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>View &gt; Open subviews &gt; Functions
</span></code></pre></div>
<p><strong>Antes:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>??$operator@_W@std@@___
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>??allocator@std@@___
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>sub_401234
</span></code></pre></div>
<p><strong>Después:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>std::basic_string::operator&lt;&lt;
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>std::allocator::allocate
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>printf
</span></code></pre></div>
<p><strong>Ahora sí:</strong> Los nombres están legibles y se puede generar el FLIRT correctamente.</p>
<h3 id="casos-de-uso-adicionales-de-bindiff">Casos de Uso Adicionales de Bindiff<a class="headerlink" href="#casos-de-uso-adicionales-de-bindiff" title="Permanent link">&para;</a></h3>
<p><strong>1. Diffing de versiones de malware:</strong></p>
<ul>
<li>Comparar v1.0 vs v1.1 de un malware</li>
<li>Identificar qué funciones cambiaron</li>
</ul>
<p><strong>2. Patch analysis:</strong></p>
<ul>
<li>Comparar ejecutable antes/después de un parche de seguridad</li>
<li>Ver exactamente qué se modificó</li>
</ul>
<p><strong>3. Funciones parcialmente similares:</strong></p>
<ul>
<li>Bindiff muestra gráficos de flujo lado a lado</li>
<li>Ver bloques básicos que difieren</li>
</ul>
<p><strong>Visualización gráfica:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>Clic derecho en función &gt; Matched Function &gt; View
</span></code></pre></div>
<p>Muestra dos grafos lado a lado con colores:</p>
<ul>
<li><strong>Verde:</strong> Bloques idénticos</li>
<li><strong>Amarillo:</strong> Bloques similares</li>
<li><strong>Rojo:</strong> Bloques diferentes</li>
</ul>
<hr />
<h2 id="parte-4-importacion-de-estructuras-stl-y-analisis-del-challenge">Parte 4: Importación de Estructuras STL y Análisis del Challenge<a class="headerlink" href="#parte-4-importacion-de-estructuras-stl-y-analisis-del-challenge" title="Permanent link">&para;</a></h2>
<h3 id="contexto-el-binario-ya-tiene-simbolos-pero">Contexto: El Binario Ya Tiene Símbolos, Pero...<a class="headerlink" href="#contexto-el-binario-ya-tiene-simbolos-pero" title="Permanent link">&para;</a></h3>
<p>Después de aplicar FLIRT + Bindiff:</p>
<p><strong>Tenemos:</strong> Nombres de funciones correctos<br />
<strong>No tenemos:</strong> Definiciones de estructuras STL</p>
<p><strong>Problema visible en IDA:</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="c1">// Sin estructuras:</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="kt">char</span><span class="w"> </span><span class="n">username</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span><span class="w">  </span><span class="c1">// IDA muestra &quot;db 20h dup(?)&quot;</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="kt">char</span><span class="w"> </span><span class="n">password</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="c1">// Con estructuras:</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">username</span><span class="p">;</span><span class="w">  </span><span class="c1">// IDA muestra &quot;std::string&quot;</span>
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">password</span><span class="p">;</span>
</span></code></pre></div>
<p><strong>Local Types muestra:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>Structures: 65 (solo las básicas de Windows)
</span></code></pre></div>
<p><strong>Necesitamos:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>Structures: 706 (incluyendo toda la STL)
</span></code></pre></div>
<h3 id="importacion-de-estructuras-desde-otro-idb">Importación de Estructuras desde Otro IDB<a class="headerlink" href="#importacion-de-estructuras-desde-otro-idb" title="Permanent link">&para;</a></h3>
<h4 id="paso-1-exportar-estructuras-del-ejecutable-con-simbolos">Paso 1: Exportar Estructuras del Ejecutable con Símbolos<a class="headerlink" href="#paso-1-exportar-estructuras-del-ejecutable-con-simbolos" title="Permanent link">&para;</a></h4>
<p><strong>En el IDB de Visual Studio (con símbolos completos):</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>File &gt; Produce file &gt; Dump typeinfo to IDC file...
</span></code></pre></div>
<p><strong>Guardar como:</strong> <code>structures.idc</code></p>
<p><strong>¿Qué contiene este archivo?</strong></p>
<ul>
<li>Definiciones de todas las estructuras en formato IDC</li>
<li>Incluye: <code>std::string</code>, <code>std::vector</code>, <code>std::allocator</code>, etc.</li>
</ul>
<h4 id="paso-2-importar-en-el-challenge">Paso 2: Importar en el Challenge<a class="headerlink" href="#paso-2-importar-en-el-challenge" title="Permanent link">&para;</a></h4>
<p><strong>En el IDB del challenge:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>File &gt; Script file... &gt; Seleccionar structures.idc
</span></code></pre></div>
<p><strong>IDA ejecuta el script silenciosamente.</strong></p>
<p><strong>Verificar:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>View &gt; Open subviews &gt; Local Types (Shift+F1)
</span></code></pre></div>
<p><strong>Antes:</strong> 65 estructuras<br />
<strong>Después:</strong> 706 estructuras</p>
<p><strong>Buscar <code>std::</code>:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>std::string
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>std::allocator&lt;char&gt;
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>std::char_traits&lt;char&gt;
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>std::vector&lt;int&gt;
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a>...
</span></code></pre></div>
<h3 id="aplicacion-de-estructuras-en-el-codigo">Aplicación de Estructuras en el Código<a class="headerlink" href="#aplicacion-de-estructuras-en-el-codigo" title="Permanent link">&para;</a></h3>
<h4 id="identificar-stdstring-en-el-stack">Identificar std::string en el Stack<a class="headerlink" href="#identificar-stdstring-en-el-stack" title="Permanent link">&para;</a></h4>
<p><strong>Código desensamblado:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="nf">lea</span><span class="w">     </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rsp</span><span class="err">+</span><span class="mi">68</span><span class="no">h</span><span class="err">+</span><span class="no">username</span><span class="p">]</span><span class="w">   </span><span class="c1">; RCX = puntero al stack</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="nf">call</span><span class="w">    </span><span class="no">std</span><span class="p">::</span><span class="no">string</span><span class="p">::</span><span class="no">basic_string</span><span class="w"> </span><span class="c1">; Constructor</span>
</span></code></pre></div>
<p><strong>Pseudocódigo (antes de aplicar estructura):</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="kt">char</span><span class="w"> </span><span class="n">username</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span><span class="w">  </span><span class="c1">// IDA asume array de bytes</span>
</span></code></pre></div>
<p><strong>¿Cómo saber que es std::string?</strong></p>
<ol>
<li>Se llama al <strong>constructor</strong> <code>std::string::basic_string</code></li>
<li>El tamaño en el stack es <strong>0x20 bytes (32 decimal)</strong></li>
<li>En <code>Local Types</code>, <code>std::string</code> tiene tamaño <strong>0x20</strong></li>
</ol>
<p><strong>Verificar tamaño de std::string:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>Local Types &gt; std::string &gt; Clic derecho &gt; Edit
</span></code></pre></div>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="k">struct</span><span class="w"> </span><span class="nc">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="w">    </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">_Ptr</span><span class="p">;</span><span class="w">      </span><span class="c1">// 8 bytes (puntero a buffer)</span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">_Size</span><span class="p">;</span><span class="w">    </span><span class="c1">// 8 bytes (longitud actual)</span>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">_Res</span><span class="p">;</span><span class="w">     </span><span class="c1">// 8 bytes (capacidad reservada)</span>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="w">    </span><span class="c1">// Total: 24 bytes (0x18)</span>
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a><span class="w">    </span><span class="c1">// + alignment = 32 bytes (0x20)</span>
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a><span class="p">};</span>
</span></code></pre></div>
<h4 id="aplicar-estructura-en-el-stack-frame">Aplicar Estructura en el Stack Frame<a class="headerlink" href="#aplicar-estructura-en-el-stack-frame" title="Permanent link">&para;</a></h4>
<p><strong>En la vista de desensamblado:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>username = byte ptr -48h
</span></code></pre></div>
<p><strong>Pasos:</strong></p>
<ol>
<li>Posicionarse en <code>username</code></li>
<li>Presionar <code>Y</code> (cambiar tipo)</li>
<li>Escribir: <code>std::string</code></li>
<li>Enter</li>
</ol>
<p><strong>Ahora muestra:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>username = std::string ptr -48h
</span></code></pre></div>
<p><strong>Pseudocódigo (después):</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">username</span><span class="p">;</span>
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">password</span><span class="p">;</span>
</span></code></pre></div>
<p><strong>Repetir para <code>password</code>:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>password = byte ptr -28h
</span></code></pre></div>
<p>Aplicar tipo: <code>std::string</code></p>
<h3 id="analisis-del-challenge-flujo-principal">Análisis del Challenge: Flujo Principal<a class="headerlink" href="#analisis-del-challenge-flujo-principal" title="Permanent link">&para;</a></h3>
<h4 id="parte-1-inicializacion">Parte 1: Inicialización<a class="headerlink" href="#parte-1-inicializacion" title="Permanent link">&para;</a></h4>
<p><strong>Código desensamblado:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="nf">sub_401000</span><span class="w"> </span><span class="no">proc</span><span class="w"> </span><span class="no">near</span>
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="w">    </span><span class="c1">; Prólogo</span>
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="w">    </span><span class="nf">push</span><span class="w">    </span><span class="no">rbp</span>
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a><span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">rbp</span><span class="p">,</span><span class="w"> </span><span class="no">rsp</span>
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a><span class="w">    </span><span class="nf">sub</span><span class="w">     </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">60</span><span class="no">h</span><span class="w">          </span><span class="c1">; Reservar stack (96 bytes)</span>
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a>
</span><span id="__span-55-7"><a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a><span class="w">    </span><span class="c1">; Crear std::string username (vacío)</span>
</span><span id="__span-55-8"><a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a><span class="w">    </span><span class="nf">lea</span><span class="w">     </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-48h</span><span class="p">]</span><span class="w">    </span><span class="c1">; RCX = &amp;username</span>
</span><span id="__span-55-9"><a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a><span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">std</span><span class="p">::</span><span class="no">string</span><span class="p">::</span><span class="no">basic_string</span>
</span><span id="__span-55-10"><a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a>
</span><span id="__span-55-11"><a id="__codelineno-55-11" name="__codelineno-55-11" href="#__codelineno-55-11"></a><span class="w">    </span><span class="c1">; Crear std::string password (vacío)</span>
</span><span id="__span-55-12"><a id="__codelineno-55-12" name="__codelineno-55-12" href="#__codelineno-55-12"></a><span class="w">    </span><span class="nf">lea</span><span class="w">     </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-28h</span><span class="p">]</span><span class="w">    </span><span class="c1">; RCX = &amp;password</span>
</span><span id="__span-55-13"><a id="__codelineno-55-13" name="__codelineno-55-13" href="#__codelineno-55-13"></a><span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">std</span><span class="p">::</span><span class="no">string</span><span class="p">::</span><span class="no">basic_string</span>
</span></code></pre></div>
<p><strong>Pseudocódigo:</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">username</span><span class="p">;</span><span class="w">  </span><span class="c1">// Constructor en rbp-48h</span>
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">password</span><span class="p">;</span><span class="w">  </span><span class="c1">// Constructor en rbp-28h</span>
</span></code></pre></div>
<h4 id="parte-2-input-del-usuario">Parte 2: Input del Usuario<a class="headerlink" href="#parte-2-input-del-usuario" title="Permanent link">&para;</a></h4>
<p><strong>Código desensamblado:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="w">    </span><span class="c1">; Imprimir &quot;Enter username: &quot;</span>
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a><span class="w">    </span><span class="nf">lea</span><span class="w">     </span><span class="no">rdx</span><span class="p">,</span><span class="w"> </span><span class="no">aEnterUsername</span><span class="w">  </span><span class="c1">; RDX = &quot;Enter username: &quot;</span>
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a><span class="w">    </span><span class="nf">lea</span><span class="w">     </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="no">std</span><span class="p">::</span><span class="no">cout</span><span class="w">       </span><span class="c1">; RCX = &amp;cout (this)</span>
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a><span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">std</span><span class="p">::</span><span class="no">operator</span><span class="err">&lt;&lt;</span><span class="w">      </span><span class="c1">; cout &lt;&lt; &quot;Enter username: &quot;</span>
</span><span id="__span-57-5"><a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a>
</span><span id="__span-57-6"><a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a><span class="w">    </span><span class="c1">; Leer username</span>
</span><span id="__span-57-7"><a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a><span class="w">    </span><span class="nf">lea</span><span class="w">     </span><span class="no">rdx</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-48h</span><span class="p">]</span><span class="w">       </span><span class="c1">; RDX = &amp;username</span>
</span><span id="__span-57-8"><a id="__codelineno-57-8" name="__codelineno-57-8" href="#__codelineno-57-8"></a><span class="w">    </span><span class="nf">lea</span><span class="w">     </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="no">std</span><span class="p">::</span><span class="no">cin</span><span class="w">        </span><span class="c1">; RCX = &amp;cin (this)</span>
</span><span id="__span-57-9"><a id="__codelineno-57-9" name="__codelineno-57-9" href="#__codelineno-57-9"></a><span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">std</span><span class="p">::</span><span class="no">getline</span><span class="w">         </span><span class="c1">; getline(cin, username)</span>
</span><span id="__span-57-10"><a id="__codelineno-57-10" name="__codelineno-57-10" href="#__codelineno-57-10"></a>
</span><span id="__span-57-11"><a id="__codelineno-57-11" name="__codelineno-57-11" href="#__codelineno-57-11"></a><span class="w">    </span><span class="c1">; Imprimir &quot;Enter password: &quot;</span>
</span><span id="__span-57-12"><a id="__codelineno-57-12" name="__codelineno-57-12" href="#__codelineno-57-12"></a><span class="w">    </span><span class="nf">lea</span><span class="w">     </span><span class="no">rdx</span><span class="p">,</span><span class="w"> </span><span class="no">aEnterPassword</span>
</span><span id="__span-57-13"><a id="__codelineno-57-13" name="__codelineno-57-13" href="#__codelineno-57-13"></a><span class="w">    </span><span class="nf">lea</span><span class="w">     </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="no">std</span><span class="p">::</span><span class="no">cout</span>
</span><span id="__span-57-14"><a id="__codelineno-57-14" name="__codelineno-57-14" href="#__codelineno-57-14"></a><span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">std</span><span class="p">::</span><span class="no">operator</span><span class="err">&lt;&lt;</span>
</span><span id="__span-57-15"><a id="__codelineno-57-15" name="__codelineno-57-15" href="#__codelineno-57-15"></a>
</span><span id="__span-57-16"><a id="__codelineno-57-16" name="__codelineno-57-16" href="#__codelineno-57-16"></a><span class="w">    </span><span class="c1">; Leer password</span>
</span><span id="__span-57-17"><a id="__codelineno-57-17" name="__codelineno-57-17" href="#__codelineno-57-17"></a><span class="w">    </span><span class="nf">lea</span><span class="w">     </span><span class="no">rdx</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-28h</span><span class="p">]</span><span class="w">       </span><span class="c1">; RDX = &amp;password</span>
</span><span id="__span-57-18"><a id="__codelineno-57-18" name="__codelineno-57-18" href="#__codelineno-57-18"></a><span class="w">    </span><span class="nf">lea</span><span class="w">     </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="no">std</span><span class="p">::</span><span class="no">cin</span>
</span><span id="__span-57-19"><a id="__codelineno-57-19" name="__codelineno-57-19" href="#__codelineno-57-19"></a><span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">std</span><span class="p">::</span><span class="no">getline</span>
</span></code></pre></div>
<p><strong>Calling convention (Windows x64 - FastCall):</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>RCX = this (primer parámetro, objeto implícito)
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>RDX = segundo parámetro
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>R8  = tercer parámetro
</span><span id="__span-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a>R9  = cuarto parámetro
</span></code></pre></div>
<p><strong>Pseudocódigo:</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Enter username: &quot;</span><span class="p">;</span>
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">getline</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="p">,</span><span class="w"> </span><span class="n">username</span><span class="p">);</span>
</span><span id="__span-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a>
</span><span id="__span-59-4"><a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Enter password: &quot;</span><span class="p">;</span>
</span><span id="__span-59-5"><a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">getline</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">);</span>
</span></code></pre></div>
<h4 id="parte-3-extraccion-de-c-string">Parte 3: Extracción de C-String<a class="headerlink" href="#parte-3-extraccion-de-c-string" title="Permanent link">&para;</a></h4>
<p><strong>Código desensamblado:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="w">    </span><span class="c1">; Obtener puntero a la C-string interna de username</span>
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a><span class="w">    </span><span class="nf">lea</span><span class="w">     </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-48h</span><span class="p">]</span><span class="w">       </span><span class="c1">; RCX = &amp;username</span>
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a><span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">std</span><span class="p">::</span><span class="no">string</span><span class="p">::</span><span class="no">c_str</span><span class="w">   </span><span class="c1">; RAX = puntero a &quot;char*&quot;</span>
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a>
</span><span id="__span-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a><span class="w">    </span><span class="c1">; Leer primer carácter</span>
</span><span id="__span-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a><span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">al</span><span class="p">,</span><span class="w"> </span><span class="no">byte</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rax</span><span class="p">]</span><span class="w">   </span><span class="c1">; AL = username[0]</span>
</span><span id="__span-60-7"><a id="__codelineno-60-7" name="__codelineno-60-7" href="#__codelineno-60-7"></a><span class="w">    </span><span class="nf">movzx</span><span class="w">   </span><span class="no">eax</span><span class="p">,</span><span class="w"> </span><span class="no">al</span><span class="w">              </span><span class="c1">; EAX = (int)username[0]</span>
</span></code></pre></div>
<p><strong>¿Qué hace <code>c_str()</code>?</strong></p>
<ul>
<li>Devuelve puntero al buffer interno de <code>std::string</code></li>
<li>Equivalente a: <code>const char* ptr = username.c_str();</code></li>
</ul>
<p><strong>Pseudocódigo:</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">user_cstr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">username</span><span class="p">.</span><span class="n">c_str</span><span class="p">();</span>
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">first_char</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">user_cstr</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span></code></pre></div>
<h4 id="parte-4-calculo-de-direccion-de-salto">Parte 4: Cálculo de Dirección de Salto<a class="headerlink" href="#parte-4-calculo-de-direccion-de-salto" title="Permanent link">&para;</a></h4>
<p><strong>Código desensamblado:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="w">    </span><span class="c1">; Cargar dirección base (main)</span>
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a><span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="no">offset</span><span class="w"> </span><span class="no">main</span><span class="w">     </span><span class="c1">; RDI = dirección de main</span>
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a>
</span><span id="__span-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a><span class="w">    </span><span class="c1">; Sumar offset fijo (0xBB)</span>
</span><span id="__span-62-5"><a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a><span class="w">    </span><span class="nf">add</span><span class="w">     </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="no">BBh</span><span class="w">            </span><span class="c1">; RDI = main + 0xBB</span>
</span><span id="__span-62-6"><a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a>
</span><span id="__span-62-7"><a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a><span class="w">    </span><span class="c1">; Sumar primer carácter del username</span>
</span><span id="__span-62-8"><a id="__codelineno-62-8" name="__codelineno-62-8" href="#__codelineno-62-8"></a><span class="w">    </span><span class="nf">add</span><span class="w">     </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="no">rax</span><span class="w">             </span><span class="c1">; RDI = main + 0xBB + username[0]</span>
</span><span id="__span-62-9"><a id="__codelineno-62-9" name="__codelineno-62-9" href="#__codelineno-62-9"></a>
</span><span id="__span-62-10"><a id="__codelineno-62-10" name="__codelineno-62-10" href="#__codelineno-62-10"></a><span class="w">    </span><span class="c1">; Guardar dirección calculada</span>
</span><span id="__span-62-11"><a id="__codelineno-62-11" name="__codelineno-62-11" href="#__codelineno-62-11"></a><span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="p">[</span><span class="no">rbp-8</span><span class="p">],</span><span class="w"> </span><span class="no">rdi</span><span class="w">         </span><span class="c1">; Guardar en variable local</span>
</span><span id="__span-62-12"><a id="__codelineno-62-12" name="__codelineno-62-12" href="#__codelineno-62-12"></a>
</span><span id="__span-62-13"><a id="__codelineno-62-13" name="__codelineno-62-13" href="#__codelineno-62-13"></a><span class="w">    </span><span class="c1">; Cargar en RBX y saltar</span>
</span><span id="__span-62-14"><a id="__codelineno-62-14" name="__codelineno-62-14" href="#__codelineno-62-14"></a><span class="w">    </span><span class="nf">mov</span><span class="w">     </span><span class="no">rbx</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-8</span><span class="p">]</span>
</span><span id="__span-62-15"><a id="__codelineno-62-15" name="__codelineno-62-15" href="#__codelineno-62-15"></a><span class="w">    </span><span class="nf">call</span><span class="w">    </span><span class="no">rbx</span><span class="w">                  </span><span class="c1">; Saltar a la dirección calculada</span>
</span></code></pre></div>
<p><strong>Fórmula del salto:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>Dirección destino = main + 0xBB + (int)username[0]
</span></code></pre></div>
<p><strong>Ejemplo:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>Si main = 0x401000
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a>Si username[0] = &#39;j&#39; (ASCII 0x6A = 106)
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a>
</span><span id="__span-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a>Destino = 0x401000 + 0xBB + 0x6A
</span><span id="__span-64-5"><a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a>        = 0x401000 + 0x125
</span><span id="__span-64-6"><a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a>        = 0x401125
</span></code></pre></div>
<p><strong>Pseudocódigo:</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="w">    </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">jump_addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)((</span><span class="kt">size_t</span><span class="p">)</span><span class="n">main</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0xBB</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="p">)</span><span class="n">first_char</span><span class="p">);</span>
</span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a><span class="w">    </span><span class="p">((</span><span class="kt">void</span><span class="p">(</span><span class="o">*</span><span class="p">)())</span><span class="n">jump_addr</span><span class="p">)();</span><span class="w">  </span><span class="c1">// Call function pointer</span>
</span></code></pre></div>
<h4 id="parte-5-destinos-validos">Parte 5: Destinos Válidos<a class="headerlink" href="#parte-5-destinos-validos" title="Permanent link">&para;</a></h4>
<p><strong>Análisis del código:</strong></p>
<p>Si queremos saltar al <strong>inicio de la validación</strong> (donde debería ir normalmente):</p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="err">00401123:</span><span class="w"> </span><span class="nf">nop</span><span class="w">                    </span><span class="c1">; Alineamiento</span>
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a><span class="err">00401124:</span><span class="w"> </span><span class="nf">nop</span>
</span><span id="__span-66-3"><a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a><span class="err">00401125:</span><span class="w"> </span><span class="nf">mov</span><span class="w">     </span><span class="no">dword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span><span class="w"> </span><span class="mi">101</span><span class="no">h</span><span class="w">  </span><span class="c1">; Código de validación</span>
</span></code></pre></div>
<p><strong>Dirección objetivo:</strong> <code>0x401125</code></p>
<p><strong>Cálculo inverso:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a>0x401125 = main + 0xBB + username[0]
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a>0x401125 = 0x401000 + 0xBB + username[0]
</span><span id="__span-67-3"><a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a>username[0] = 0x401125 - 0x401000 - 0xBB
</span><span id="__span-67-4"><a id="__codelineno-67-4" name="__codelineno-67-4" href="#__codelineno-67-4"></a>username[0] = 0x125 - 0xBB
</span><span id="__span-67-5"><a id="__codelineno-67-5" name="__codelineno-67-5" href="#__codelineno-67-5"></a>username[0] = 0x6A
</span></code></pre></div>
<p><strong>Caracteres ASCII:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a>0x68 = &#39;h&#39;
</span><span id="__span-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>0x69 = &#39;i&#39;
</span><span id="__span-68-3"><a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a>0x6A = &#39;j&#39;  ← Valid
</span><span id="__span-68-4"><a id="__codelineno-68-4" name="__codelineno-68-4" href="#__codelineno-68-4"></a>0x6B = &#39;k&#39;  ← Valid
</span></code></pre></div>
<p><strong>Pero hay un problema...</strong></p>
<h3 id="stack-alignment-y-crashes">Stack Alignment y Crashes<a class="headerlink" href="#stack-alignment-y-crashes" title="Permanent link">&para;</a></h3>
<h4 id="problema-call-sin-return">Problema: Call sin Return<a class="headerlink" href="#problema-call-sin-return" title="Permanent link">&para;</a></h4>
<p><strong>El código hace:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="nf">call</span><span class="w">    </span><span class="no">rbx</span><span class="w">    </span><span class="c1">; Salta a dirección calculada</span>
</span></code></pre></div>
<p><strong>Pero NO hay:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="nf">ret</span><span class="w">            </span><span class="c1">; Para volver</span>
</span></code></pre></div>
<p><strong>Consecuencia:</strong></p>
<ol>
<li>El <code>call</code> pushea la dirección de retorno al stack</li>
<li>RSP se decrementa en 8 bytes</li>
<li><strong>El stack se desalinea</strong></li>
</ol>
<p><strong>Stack antes del call:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a>RSP = 0x...F0  (termina en 0, alineado a 16 bytes)
</span></code></pre></div>
<p><strong>Stack después del call:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a>RSP = 0x...E8  (termina en 8, desalineado)
</span></code></pre></div>
<h4 id="por-que-importa-el-alignment">Por Qué Importa el Alignment<a class="headerlink" href="#por-que-importa-el-alignment" title="Permanent link">&para;</a></h4>
<p><strong>Windows x64 ABI requiere:</strong></p>
<ul>
<li>Stack alineado a <strong>16 bytes</strong> al entrar a una función</li>
<li>Las APIs de Windows <strong>asumen</strong> este alineamiento</li>
<li>Instrucciones SSE/AVX requieren alineamiento</li>
</ul>
<p><strong>¿Qué pasa si no está alineado?</strong></p>
<ul>
<li><strong>Windows 10:</strong> Funciona (por suerte)</li>
<li><strong>Windows 11:</strong> Crash en llamadas a APIs (<code>printf</code>, <code>ExitProcess</code>, etc.)</li>
<li><strong>Algunas funciones STL:</strong> Crash inmediato</li>
</ul>
<h4 id="solucion-1-ajustar-el-salto-para-evitar-el-call">Solución 1: Ajustar el Salto para Evitar el Call<a class="headerlink" href="#solucion-1-ajustar-el-salto-para-evitar-el-call" title="Permanent link">&para;</a></h4>
<p>En vez de saltar a <code>0x401125</code>, saltar <strong>después</strong> del prólogo de la función destino (donde el stack ya está alineado).</p>
<p><strong>No viable:</strong> Rompe el flujo esperado del programa.</p>
<h4 id="solucion-2-caracteres-alternativos-trampa-del-challenge">Solución 2: Caracteres Alternativos (Trampa del Challenge)<a class="headerlink" href="#solucion-2-caracteres-alternativos-trampa-del-challenge" title="Permanent link">&para;</a></h4>
<p><strong>Descubrimiento:</strong> Algunos caracteres saltan a lugares donde <strong>sí funciona</strong>.</p>
<p><strong>Ejemplos encontrados:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a>username[0] = &#39;{&#39;  (0x7B)  → Salta a código válido
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>username[0] = &#39;}&#39;  (0x7D)  → Salta a código válido
</span><span id="__span-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a>username[0] = &#39;~&#39;  (0x7E)  → Funciona parcialmente
</span></code></pre></div>
<p><strong>Calculando:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a>Destino = 0x401000 + 0xBB + 0x7B = 0x401136
</span></code></pre></div>
<p><strong>En <code>0x401136</code>:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="err">00401136:</span><span class="w"> </span><span class="nf">sub</span><span class="w">    </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="no">h</span><span class="w">    </span><span class="c1">; Ajusta el stack</span>
</span><span id="__span-75-2"><a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a><span class="err">00401138:</span><span class="w"> </span><span class="nf">nop</span>
</span><span id="__span-75-3"><a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a><span class="err">00401139:</span><span class="w"> </span><span class="nf">nop</span>
</span><span id="__span-75-4"><a id="__codelineno-75-4" name="__codelineno-75-4" href="#__codelineno-75-4"></a><span class="err">0040113</span><span class="nl">A:</span><span class="w"> </span><span class="nf">mov</span><span class="w">    </span><span class="no">dword</span><span class="w"> </span><span class="no">ptr</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-4</span><span class="p">],</span><span class="w"> </span><span class="mi">101</span><span class="no">h</span><span class="w">  </span><span class="c1">; Código de validación</span>
</span></code></pre></div>
<p><strong>¡Funciona!</strong> Porque el <code>sub rsp, 28h</code> realinea el stack.</p>
<h4 id="solucion-3-parchear-el-binario-no-recomendado">Solución 3: Parchear el Binario (No Recomendado)<a class="headerlink" href="#solucion-3-parchear-el-binario-no-recomendado" title="Permanent link">&para;</a></h4>
<p>Agregar instrucción de alineamiento:</p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a><span class="nf">and</span><span class="w">    </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="no">FFFFFFFFFFFFFFF0h</span><span class="w">  </span><span class="c1">; Alinear a 16 bytes</span>
</span></code></pre></div>
<p><strong>Razón para no hacerlo:</strong> El challenge pide keygen, no parche.</p>
<h3 id="variables-locales-del-challenge">Variables Locales del Challenge<a class="headerlink" href="#variables-locales-del-challenge" title="Permanent link">&para;</a></h3>
<p><strong>Stack frame completo:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a>rbp-68h:  username (std::string, 32 bytes)
</span><span id="__span-77-2"><a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a>rbp-48h:  password (std::string, 32 bytes)
</span><span id="__span-77-3"><a id="__codelineno-77-3" name="__codelineno-77-3" href="#__codelineno-77-3"></a>rbp-28h:  n (int, valor calculado = 0x100 o 0x101)
</span><span id="__span-77-4"><a id="__codelineno-77-4" name="__codelineno-77-4" href="#__codelineno-77-4"></a>rbp-8h:   jump_address (void*, dirección calculada)
</span></code></pre></div>
<p><strong>Renombrar variables:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a>Posicionarse en cada offset → Presionar N → Escribir nombre
</span></code></pre></div>
<p><strong>Resultado:</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">username</span><span class="p">;</span><span class="w">    </span><span class="c1">// rbp-68h</span>
</span><span id="__span-79-2"><a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">password</span><span class="p">;</span><span class="w">    </span><span class="c1">// rbp-48h</span>
</span><span id="__span-79-3"><a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x100</span><span class="p">;</span><span class="w">           </span><span class="c1">// rbp-28h, cambia según input</span>
</span><span id="__span-79-4"><a id="__codelineno-79-4" name="__codelineno-79-4" href="#__codelineno-79-4"></a><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">jump_addr</span><span class="p">;</span><span class="w">         </span><span class="c1">// rbp-8h</span>
</span></code></pre></div>
<hr />
<h2 id="parte-5-limpieza-del-decompiler-y-correccion-del-stack-pointer">Parte 5: Limpieza del Decompiler y Corrección del Stack Pointer<a class="headerlink" href="#parte-5-limpieza-del-decompiler-y-correccion-del-stack-pointer" title="Permanent link">&para;</a></h2>
<h3 id="contexto-argumentos-fantasma-por-ofuscacion">Contexto: Argumentos Fantasma por Ofuscación<a class="headerlink" href="#contexto-argumentos-fantasma-por-ofuscacion" title="Permanent link">&para;</a></h3>
<p>Después de aplicar todas las técnicas anteriores, el decompiler de IDA muestra <strong>argumentos incorrectos</strong> en las funciones debido a la ofuscación.</p>
<p><strong>Problema visible:</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a><span class="c1">// Función con argumentos fantasma:</span>
</span><span id="__span-80-2"><a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a><span class="kt">void</span><span class="w"> </span><span class="nf">nivel_7</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">case_num</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">arg2</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">arg3</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">arg4</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">arg5</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>
</span><span id="__span-80-3"><a id="__codelineno-80-3" name="__codelineno-80-3" href="#__codelineno-80-3"></a>
</span><span id="__span-80-4"><a id="__codelineno-80-4" name="__codelineno-80-4" href="#__codelineno-80-4"></a><span class="c1">// Debería ser:</span>
</span><span id="__span-80-5"><a id="__codelineno-80-5" name="__codelineno-80-5" href="#__codelineno-80-5"></a><span class="kt">void</span><span class="w"> </span><span class="nf">nivel_7</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">case_num</span><span class="p">);</span>
</span></code></pre></div>
<p><strong>Causa:</strong> La ofuscación rompió el análisis de la calling convention, y IDA asume que hay más argumentos de los que realmente existen.</p>
<h3 id="correccion-de-prototipos-de-funciones">Corrección de Prototipos de Funciones<a class="headerlink" href="#correccion-de-prototipos-de-funciones" title="Permanent link">&para;</a></h3>
<h4 id="paso-1-identificar-argumentos-reales">Paso 1: Identificar Argumentos Reales<a class="headerlink" href="#paso-1-identificar-argumentos-reales" title="Permanent link">&para;</a></h4>
<p><strong>Comparar con otros cases del switch:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a><span class="c1">; Case 1, 2, 3, etc.:</span>
</span><span id="__span-81-2"><a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a><span class="nf">mov</span><span class="w">     </span><span class="no">ecx</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w">          </span><span class="c1">; Solo un argumento</span>
</span><span id="__span-81-3"><a id="__codelineno-81-3" name="__codelineno-81-3" href="#__codelineno-81-3"></a><span class="nf">call</span><span class="w">    </span><span class="no">nivel_1</span>
</span><span id="__span-81-4"><a id="__codelineno-81-4" name="__codelineno-81-4" href="#__codelineno-81-4"></a>
</span><span id="__span-81-5"><a id="__codelineno-81-5" name="__codelineno-81-5" href="#__codelineno-81-5"></a><span class="c1">; Case 7 (ofuscado):</span>
</span><span id="__span-81-6"><a id="__codelineno-81-6" name="__codelineno-81-6" href="#__codelineno-81-6"></a><span class="nf">mov</span><span class="w">     </span><span class="no">ecx</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span>
</span><span id="__span-81-7"><a id="__codelineno-81-7" name="__codelineno-81-7" href="#__codelineno-81-7"></a><span class="c1">; ... código ofuscado ...</span>
</span><span id="__span-81-8"><a id="__codelineno-81-8" name="__codelineno-81-8" href="#__codelineno-81-8"></a><span class="nf">call</span><span class="w">    </span><span class="no">nivel_7</span><span class="w">         </span><span class="c1">; Debería tener solo un argumento</span>
</span></code></pre></div>
<p><strong>Todos los cases</strong> del switch tienen <strong>un solo argumento</strong> (el número de case en <code>rcx</code>).</p>
<h4 id="paso-2-editar-el-prototipo">Paso 2: Editar el Prototipo<a class="headerlink" href="#paso-2-editar-el-prototipo" title="Permanent link">&para;</a></h4>
<p><strong>En la función <code>nivel_7</code>:</strong></p>
<ol>
<li>Presionar <code>Y</code> en el nombre de la función</li>
<li>Aparece el editor de tipo:</li>
</ol>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">nivel_7</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">case_num</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">arg2</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">arg3</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">arg4</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">arg5</span><span class="p">);</span>
</span></code></pre></div>
<ol>
<li>Eliminar argumentos extras:</li>
</ol>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">nivel_7</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">case_num</span><span class="p">);</span>
</span></code></pre></div>
<ol>
<li>Enter para aplicar</li>
</ol>
<p><strong>Resultado en el decompiler:</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a><span class="c1">// Antes:</span>
</span><span id="__span-84-2"><a id="__codelineno-84-2" name="__codelineno-84-2" href="#__codelineno-84-2"></a><span class="n">nivel_7</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="n">v5</span><span class="p">,</span><span class="w"> </span><span class="n">v6</span><span class="p">,</span><span class="w"> </span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">);</span>
</span><span id="__span-84-3"><a id="__codelineno-84-3" name="__codelineno-84-3" href="#__codelineno-84-3"></a>
</span><span id="__span-84-4"><a id="__codelineno-84-4" name="__codelineno-84-4" href="#__codelineno-84-4"></a><span class="c1">// Después:</span>
</span><span id="__span-84-5"><a id="__codelineno-84-5" name="__codelineno-84-5" href="#__codelineno-84-5"></a><span class="n">nivel_7</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span>
</span></code></pre></div>
<h4 id="paso-3-corregir-funcion-de-validacion">Paso 3: Corregir Función de Validación<a class="headerlink" href="#paso-3-corregir-funcion-de-validacion" title="Permanent link">&para;</a></h4>
<p><strong>Problema similar en <code>validate_credentials</code>:</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a><span class="c1">// Incorrecto:</span>
</span><span id="__span-85-2"><a id="__codelineno-85-2" name="__codelineno-85-2" href="#__codelineno-85-2"></a><span class="kt">bool</span><span class="w"> </span><span class="nf">validate_credentials</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pass</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-85-3"><a id="__codelineno-85-3" name="__codelineno-85-3" href="#__codelineno-85-3"></a><span class="w">                          </span><span class="kt">int</span><span class="w"> </span><span class="n">arg3</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">arg4</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">arg5</span><span class="p">);</span>
</span><span id="__span-85-4"><a id="__codelineno-85-4" name="__codelineno-85-4" href="#__codelineno-85-4"></a>
</span><span id="__span-85-5"><a id="__codelineno-85-5" name="__codelineno-85-5" href="#__codelineno-85-5"></a><span class="c1">// Correcto:</span>
</span><span id="__span-85-6"><a id="__codelineno-85-6" name="__codelineno-85-6" href="#__codelineno-85-6"></a><span class="kt">bool</span><span class="w"> </span><span class="nf">validate_credentials</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">pass</span><span class="p">);</span>
</span></code></pre></div>
<p><strong>Aplicar el mismo proceso:</strong> <code>Y</code> → Editar → Eliminar argumentos extras</p>
<h3 id="correccion-manual-del-stack-pointer">Corrección Manual del Stack Pointer<a class="headerlink" href="#correccion-manual-del-stack-pointer" title="Permanent link">&para;</a></h3>
<h4 id="problema-rsp-tracking-incorrecto">Problema: RSP Tracking Incorrecto<a class="headerlink" href="#problema-rsp-tracking-incorrecto" title="Permanent link">&para;</a></h4>
<p><strong>Síntoma en IDA:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a>[SP+98h] warning: SP value is incorrect
</span></code></pre></div>
<p><strong>Causa:</strong> El <code>call rbx</code> (salto calculado) confunde al análisis de stack de IDA.</p>
<h4 id="activar-vista-de-stack-pointer">Activar Vista de Stack Pointer<a class="headerlink" href="#activar-vista-de-stack-pointer" title="Permanent link">&para;</a></h4>
<p><strong>Opción de IDA:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a>Options &gt; General &gt; Stack pointer
</span></code></pre></div>
<p>Marcar: <strong>"Show stack pointer"</strong></p>
<p><strong>Vista en desensamblador:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a><span class="err">00401000:</span><span class="w"> </span><span class="nf">push</span><span class="w">    </span><span class="no">rbp</span><span class="w">           </span><span class="c1">; [sp+0]</span>
</span><span id="__span-88-2"><a id="__codelineno-88-2" name="__codelineno-88-2" href="#__codelineno-88-2"></a><span class="err">00401001:</span><span class="w"> </span><span class="nf">mov</span><span class="w">     </span><span class="no">rbp</span><span class="p">,</span><span class="w"> </span><span class="no">rsp</span><span class="w">      </span><span class="c1">; [sp+8]</span>
</span><span id="__span-88-3"><a id="__codelineno-88-3" name="__codelineno-88-3" href="#__codelineno-88-3"></a><span class="err">00401004:</span><span class="w"> </span><span class="nf">sub</span><span class="w">     </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">98</span><span class="no">h</span><span class="w">      </span><span class="c1">; [sp+98h] ← Aquí debe quedarse</span>
</span><span id="__span-88-4"><a id="__codelineno-88-4" name="__codelineno-88-4" href="#__codelineno-88-4"></a><span class="na">...</span>
</span><span id="__span-88-5"><a id="__codelineno-88-5" name="__codelineno-88-5" href="#__codelineno-88-5"></a><span class="err">00401050:</span><span class="w"> </span><span class="nf">call</span><span class="w">    </span><span class="no">some_func</span><span class="w">     </span><span class="c1">; [sp+98h] ← Correcto</span>
</span><span id="__span-88-6"><a id="__codelineno-88-6" name="__codelineno-88-6" href="#__codelineno-88-6"></a><span class="err">00401055:</span><span class="w"> </span><span class="nf">call</span><span class="w">    </span><span class="no">rbx</span><span class="w">           </span><span class="c1">; [sp+A0h] ← ¡INCORRECTO!</span>
</span></code></pre></div>
<p><strong>IDA asume que el <code>call rbx</code> cambia RSP</strong>, pero en nuestro caso sabemos que es un salto controlado.</p>
<h4 id="forzar-el-valor-correcto">Forzar el Valor Correcto<a class="headerlink" href="#forzar-el-valor-correcto" title="Permanent link">&para;</a></h4>
<p><strong>En la instrucción problemática:</strong></p>
<ol>
<li>Posicionarse en <code>call rbx</code></li>
<li>Clic derecho → <strong>Change stack pointer</strong></li>
<li>Ingresar: <strong>0</strong> (delta = 0, no cambia RSP)</li>
</ol>
<p><strong>Antes:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-89-1"><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a><span class="err">00401055:</span><span class="w"> </span><span class="nf">call</span><span class="w">    </span><span class="no">rbx</span><span class="w">           </span><span class="c1">; [sp+A0h]</span>
</span><span id="__span-89-2"><a id="__codelineno-89-2" name="__codelineno-89-2" href="#__codelineno-89-2"></a><span class="err">0040105</span><span class="nl">A:</span><span class="w"> </span><span class="nf">add</span><span class="w">     </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="no">h</span><span class="w">      </span><span class="c1">; [sp+B0h]</span>
</span></code></pre></div>
<p><strong>Después:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-90-1"><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a><span class="err">00401055:</span><span class="w"> </span><span class="nf">call</span><span class="w">    </span><span class="no">rbx</span><span class="w">           </span><span class="c1">; [sp+98h]  ← Forzado a 98h</span>
</span><span id="__span-90-2"><a id="__codelineno-90-2" name="__codelineno-90-2" href="#__codelineno-90-2"></a><span class="err">0040105</span><span class="nl">A:</span><span class="w"> </span><span class="nf">add</span><span class="w">     </span><span class="no">rsp</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="no">h</span><span class="w">      </span><span class="c1">; [sp+A8h]  ← Ahora es consistente</span>
</span></code></pre></div>
<p><strong>Repetir para todos los <code>call</code> ofuscados</strong> donde IDA se confunde.</p>
<h3 id="limpieza-de-jump-outs-y-codigo-muerto">Limpieza de Jump-Outs y Código Muerto<a class="headerlink" href="#limpieza-de-jump-outs-y-codigo-muerto" title="Permanent link">&para;</a></h3>
<h4 id="identificar-codigo-inalcanzable">Identificar Código Inalcanzable<a class="headerlink" href="#identificar-codigo-inalcanzable" title="Permanent link">&para;</a></h4>
<p><strong>Patrón típico:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-91-1"><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a><span class="err">00401100:</span><span class="w"> </span><span class="nf">jnz</span><span class="w">     </span><span class="no">short</span><span class="w"> </span><span class="no">loc_102D</span>
</span><span id="__span-91-2"><a id="__codelineno-91-2" name="__codelineno-91-2" href="#__codelineno-91-2"></a><span class="err">00401102:</span><span class="w"> </span><span class="nf">retn</span><span class="w"> </span><span class="mi">0</span><span class="w">                </span><span class="c1">; C2 00 - Nunca se ejecuta</span>
</span><span id="__span-91-3"><a id="__codelineno-91-3" name="__codelineno-91-3" href="#__codelineno-91-3"></a><span class="err">00401104:</span><span class="w"> </span><span class="nf">nop</span><span class="w">                   </span><span class="c1">; Código real</span>
</span></code></pre></div>
<p>El <code>retn 0</code> (byte <code>C2 00</code>) es <strong>código muerto</strong> que solo confunde a IDA.</p>
<h4 id="parchear-temporalmente-para-analisis-estatico">Parchear Temporalmente para Análisis Estático<a class="headerlink" href="#parchear-temporalmente-para-analisis-estatico" title="Permanent link">&para;</a></h4>
<p><strong>¡IMPORTANTE!</strong> Estos parches son <strong>solo para análisis estático</strong>, no para ejecución.</p>
<p><strong>Proceso:</strong></p>
<ol>
<li>Posicionarse en el byte problemático (ej: <code>C2</code> en offset 102)</li>
<li>Presionar <strong>Edit &gt; Patch program &gt; Change byte</strong></li>
<li>Cambiar <code>C2</code> por <code>90</code> (NOP)</li>
<li>Presionar <code>C</code> para recrear código</li>
</ol>
<p><strong>Ejemplo:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-92-1"><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a><span class="c1">; Antes:</span>
</span><span id="__span-92-2"><a id="__codelineno-92-2" name="__codelineno-92-2" href="#__codelineno-92-2"></a><span class="err">00401102:</span><span class="w"> </span><span class="nf">db</span><span class="w"> </span><span class="mi">0</span><span class="no">C2h</span><span class="w">       </span><span class="c1">; Basura</span>
</span><span id="__span-92-3"><a id="__codelineno-92-3" name="__codelineno-92-3" href="#__codelineno-92-3"></a><span class="err">00401103:</span><span class="w"> </span><span class="nf">db</span><span class="w"> </span><span class="mi">00</span><span class="no">h</span>
</span><span id="__span-92-4"><a id="__codelineno-92-4" name="__codelineno-92-4" href="#__codelineno-92-4"></a><span class="err">00401104:</span><span class="w"> </span><span class="nf">nop</span>
</span><span id="__span-92-5"><a id="__codelineno-92-5" name="__codelineno-92-5" href="#__codelineno-92-5"></a>
</span><span id="__span-92-6"><a id="__codelineno-92-6" name="__codelineno-92-6" href="#__codelineno-92-6"></a><span class="c1">; Después (parcheado):</span>
</span><span id="__span-92-7"><a id="__codelineno-92-7" name="__codelineno-92-7" href="#__codelineno-92-7"></a><span class="err">00401102:</span><span class="w"> </span><span class="nf">nop</span><span class="w">           </span><span class="c1">; 90</span>
</span><span id="__span-92-8"><a id="__codelineno-92-8" name="__codelineno-92-8" href="#__codelineno-92-8"></a><span class="err">00401103:</span><span class="w"> </span><span class="nf">nop</span><span class="w">           </span><span class="c1">; 90</span>
</span><span id="__span-92-9"><a id="__codelineno-92-9" name="__codelineno-92-9" href="#__codelineno-92-9"></a><span class="err">00401104:</span><span class="w"> </span><span class="nf">nop</span>
</span></code></pre></div>
<p><strong>Resultado:</strong> Los "jump-outs" (flechas rojas en el grafo) desaparecen.</p>
<h4 id="script-para-parchear-multiples-bytes">Script para Parchear Múltiples Bytes<a class="headerlink" href="#script-para-parchear-multiples-bytes" title="Permanent link">&para;</a></h4>
<p>Si hay muchos bytes <code>C2</code> o <code>48</code> sueltos:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-93-1"><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">ida_bytes</span>
</span><span id="__span-93-2"><a id="__codelineno-93-2" name="__codelineno-93-2" href="#__codelineno-93-2"></a>
</span><span id="__span-93-3"><a id="__codelineno-93-3" name="__codelineno-93-3" href="#__codelineno-93-3"></a><span class="c1"># Direcciones con bytes basura</span>
</span><span id="__span-93-4"><a id="__codelineno-93-4" name="__codelineno-93-4" href="#__codelineno-93-4"></a><span class="n">basura</span> <span class="o">=</span> <span class="p">[</span><span class="mh">0x401102</span><span class="p">,</span> <span class="mh">0x401156</span><span class="p">,</span> <span class="mh">0x401234</span><span class="p">,</span> <span class="mh">0x401ABC</span><span class="p">]</span>
</span><span id="__span-93-5"><a id="__codelineno-93-5" name="__codelineno-93-5" href="#__codelineno-93-5"></a>
</span><span id="__span-93-6"><a id="__codelineno-93-6" name="__codelineno-93-6" href="#__codelineno-93-6"></a><span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="n">basura</span><span class="p">:</span>
</span><span id="__span-93-7"><a id="__codelineno-93-7" name="__codelineno-93-7" href="#__codelineno-93-7"></a>    <span class="n">ida_bytes</span><span class="o">.</span><span class="n">patch_byte</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">)</span>  <span class="c1"># Cambiar a NOP</span>
</span><span id="__span-93-8"><a id="__codelineno-93-8" name="__codelineno-93-8" href="#__codelineno-93-8"></a>    <span class="n">ida_ua</span><span class="o">.</span><span class="n">create_insn</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>           <span class="c1"># Recrear código</span>
</span><span id="__span-93-9"><a id="__codelineno-93-9" name="__codelineno-93-9" href="#__codelineno-93-9"></a>
</span><span id="__span-93-10"><a id="__codelineno-93-10" name="__codelineno-93-10" href="#__codelineno-93-10"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Limpieza completada&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p><strong>Ejecución:</strong> <code>File &gt; Script command &gt; Python</code></p>
<h3 id="renombrado-final-y-documentacion">Renombrado Final y Documentación<a class="headerlink" href="#renombrado-final-y-documentacion" title="Permanent link">&para;</a></h3>
<h4 id="variables-y-funciones-clave">Variables y Funciones Clave<a class="headerlink" href="#variables-y-funciones-clave" title="Permanent link">&para;</a></h4>
<p><strong>Renombrar con <code>N</code>:</strong></p>
<table>
<thead>
<tr>
<th>Nombre Original</th>
<th>Nombre Descriptivo</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sub_401000</code></td>
<td><code>nivel_7</code></td>
</tr>
<tr>
<td><code>sub_401500</code></td>
<td><code>validate_credentials</code></td>
</tr>
<tr>
<td><code>off_403000</code></td>
<td><code>ptr_nivel_7</code></td>
</tr>
<tr>
<td><code>var_48</code></td>
<td><code>username</code></td>
</tr>
<tr>
<td><code>var_28</code></td>
<td><code>password</code></td>
</tr>
<tr>
<td><code>var_8</code></td>
<td><code>jump_address</code></td>
</tr>
</tbody>
</table>
<p><strong>Agregar comentarios con <code>;</code>:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-94-1"><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a><span class="c1">; Calcular dirección de salto basada en username[0]</span>
</span><span id="__span-94-2"><a id="__codelineno-94-2" name="__codelineno-94-2" href="#__codelineno-94-2"></a><span class="nf">mov</span><span class="w">     </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="no">offset</span><span class="w"> </span><span class="no">nivel_7</span>
</span><span id="__span-94-3"><a id="__codelineno-94-3" name="__codelineno-94-3" href="#__codelineno-94-3"></a><span class="nf">add</span><span class="w">     </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="no">BBh</span>
</span><span id="__span-94-4"><a id="__codelineno-94-4" name="__codelineno-94-4" href="#__codelineno-94-4"></a><span class="nf">add</span><span class="w">     </span><span class="no">rdi</span><span class="p">,</span><span class="w"> </span><span class="no">rax</span><span class="w">        </span><span class="c1">; rax = username[0]</span>
</span></code></pre></div>
<h4 id="estado-final-del-pseudocodigo">Estado Final del Pseudocódigo<a class="headerlink" href="#estado-final-del-pseudocodigo" title="Permanent link">&para;</a></h4>
<p><strong>Antes de limpieza:</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-95-1"><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a><span class="kt">void</span><span class="w"> </span><span class="kr">__fastcall</span><span class="w"> </span><span class="n">sub_401000</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">a2</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">a3</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">a4</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-95-2"><a id="__codelineno-95-2" name="__codelineno-95-2" href="#__codelineno-95-2"></a><span class="w">                            </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">a5</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">a6</span><span class="p">,</span><span class="w"> </span><span class="kr">__int64</span><span class="w"> </span><span class="n">a7</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-95-3"><a id="__codelineno-95-3" name="__codelineno-95-3" href="#__codelineno-95-3"></a><span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">v8</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>
</span><span id="__span-95-4"><a id="__codelineno-95-4" name="__codelineno-95-4" href="#__codelineno-95-4"></a><span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">v9</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>
</span><span id="__span-95-5"><a id="__codelineno-95-5" name="__codelineno-95-5" href="#__codelineno-95-5"></a><span class="w">  </span><span class="c1">// ... código confuso ...</span>
</span><span id="__span-95-6"><a id="__codelineno-95-6" name="__codelineno-95-6" href="#__codelineno-95-6"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>Después de limpieza:</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-96-1"><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a><span class="kt">void</span><span class="w"> </span><span class="kr">__fastcall</span><span class="w"> </span><span class="n">nivel_7</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">case_num</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-96-2"><a id="__codelineno-96-2" name="__codelineno-96-2" href="#__codelineno-96-2"></a><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">username</span><span class="p">;</span>
</span><span id="__span-96-3"><a id="__codelineno-96-3" name="__codelineno-96-3" href="#__codelineno-96-3"></a><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">password</span><span class="p">;</span>
</span><span id="__span-96-4"><a id="__codelineno-96-4" name="__codelineno-96-4" href="#__codelineno-96-4"></a><span class="w">  </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">jump_addr</span><span class="p">;</span>
</span><span id="__span-96-5"><a id="__codelineno-96-5" name="__codelineno-96-5" href="#__codelineno-96-5"></a>
</span><span id="__span-96-6"><a id="__codelineno-96-6" name="__codelineno-96-6" href="#__codelineno-96-6"></a><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;User Authentication System</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-96-7"><a id="__codelineno-96-7" name="__codelineno-96-7" href="#__codelineno-96-7"></a><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Enter username: &quot;</span><span class="p">;</span>
</span><span id="__span-96-8"><a id="__codelineno-96-8" name="__codelineno-96-8" href="#__codelineno-96-8"></a><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">getline</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="p">,</span><span class="w"> </span><span class="n">username</span><span class="p">);</span>
</span><span id="__span-96-9"><a id="__codelineno-96-9" name="__codelineno-96-9" href="#__codelineno-96-9"></a>
</span><span id="__span-96-10"><a id="__codelineno-96-10" name="__codelineno-96-10" href="#__codelineno-96-10"></a><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Enter password: &quot;</span><span class="p">;</span>
</span><span id="__span-96-11"><a id="__codelineno-96-11" name="__codelineno-96-11" href="#__codelineno-96-11"></a><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">getline</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cin</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">);</span>
</span><span id="__span-96-12"><a id="__codelineno-96-12" name="__codelineno-96-12" href="#__codelineno-96-12"></a>
</span><span id="__span-96-13"><a id="__codelineno-96-13" name="__codelineno-96-13" href="#__codelineno-96-13"></a><span class="w">  </span><span class="c1">// Calcular salto basado en primer carácter</span>
</span><span id="__span-96-14"><a id="__codelineno-96-14" name="__codelineno-96-14" href="#__codelineno-96-14"></a><span class="w">  </span><span class="n">jump_addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)((</span><span class="kt">size_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">nivel_7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0xBB</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">username</span><span class="p">.</span><span class="n">c_str</span><span class="p">()[</span><span class="mi">0</span><span class="p">]);</span>
</span><span id="__span-96-15"><a id="__codelineno-96-15" name="__codelineno-96-15" href="#__codelineno-96-15"></a>
</span><span id="__span-96-16"><a id="__codelineno-96-16" name="__codelineno-96-16" href="#__codelineno-96-16"></a><span class="w">  </span><span class="c1">// Saltar (desalineado, pero ya lo corregimos)</span>
</span><span id="__span-96-17"><a id="__codelineno-96-17" name="__codelineno-96-17" href="#__codelineno-96-17"></a><span class="w">  </span><span class="p">((</span><span class="kt">void</span><span class="p">(</span><span class="o">*</span><span class="p">)())</span><span class="n">jump_addr</span><span class="p">)();</span>
</span><span id="__span-96-18"><a id="__codelineno-96-18" name="__codelineno-96-18" href="#__codelineno-96-18"></a>
</span><span id="__span-96-19"><a id="__codelineno-96-19" name="__codelineno-96-19" href="#__codelineno-96-19"></a><span class="w">  </span><span class="c1">// Validación</span>
</span><span id="__span-96-20"><a id="__codelineno-96-20" name="__codelineno-96-20" href="#__codelineno-96-20"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">validate_credentials</span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-96-21"><a id="__codelineno-96-21" name="__codelineno-96-21" href="#__codelineno-96-21"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Access granted!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-96-22"><a id="__codelineno-96-22" name="__codelineno-96-22" href="#__codelineno-96-22"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-96-23"><a id="__codelineno-96-23" name="__codelineno-96-23" href="#__codelineno-96-23"></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Authentication failed!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-96-24"><a id="__codelineno-96-24" name="__codelineno-96-24" href="#__codelineno-96-24"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-96-25"><a id="__codelineno-96-25" name="__codelineno-96-25" href="#__codelineno-96-25"></a><span class="p">}</span>
</span></code></pre></div>
<p><strong>Mucho más legible</strong> que el código ofuscado original.</p>
<h3 id="snapshot-para-preservar-el-trabajo">Snapshot para Preservar el Trabajo<a class="headerlink" href="#snapshot-para-preservar-el-trabajo" title="Permanent link">&para;</a></h3>
<p><strong>¡Crítico!</strong> Antes de continuar con más análisis:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-97-1"><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a>File &gt; Take database snapshot...
</span><span id="__span-97-2"><a id="__codelineno-97-2" name="__codelineno-97-2" href="#__codelineno-97-2"></a>Nombre: &quot;limpio_para_estatico&quot;
</span></code></pre></div>
<p><strong>¿Por qué?</strong></p>
<ul>
<li>Los parches (<code>90</code> en vez de <code>C2</code>) <strong>no son para ejecución</strong></li>
<li>Si guardamos y ejecutamos el binario, crasheará</li>
<li>El snapshot preserva el estado "limpio para análisis estático"</li>
</ul>
<p><strong>Flujo de trabajo:</strong></p>
<ol>
<li><strong>Snapshot "limpio_para_estatico"</strong>: Para análisis estático en decompiler</li>
<li><strong>IDB original sin parches</strong>: Para debugging dinámico con x64dbg/WinDbg</li>
</ol>
<h3 id="casos-especiales-encontrados">Casos Especiales Encontrados<a class="headerlink" href="#casos-especiales-encontrados" title="Permanent link">&para;</a></h3>
<h4 id="funcion-con-puntero-tamano">Función con Puntero + Tamaño<a class="headerlink" href="#funcion-con-puntero-tamano" title="Permanent link">&para;</a></h4>
<p><strong>Prototipo incorrecto:</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-98-1"><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">mystery_func</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">arg2</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">arg3</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">arg4</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>
</span></code></pre></div>
<p><strong>Análisis del desensamblado:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-99-1"><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a><span class="nf">lea</span><span class="w">     </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rbp-48h</span><span class="p">]</span><span class="w">  </span><span class="c1">; Primer argumento</span>
</span><span id="__span-99-2"><a id="__codelineno-99-2" name="__codelineno-99-2" href="#__codelineno-99-2"></a><span class="nf">mov</span><span class="w">     </span><span class="no">edx</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="no">h</span><span class="w">      </span><span class="c1">; 4096 decimal</span>
</span><span id="__span-99-3"><a id="__codelineno-99-3" name="__codelineno-99-3" href="#__codelineno-99-3"></a><span class="nf">call</span><span class="w">    </span><span class="no">mystery_func</span>
</span></code></pre></div>
<p><strong>Prototipo correcto:</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-100-1"><a id="__codelineno-100-1" name="__codelineno-100-1" href="#__codelineno-100-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">mystery_func</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>
</span></code></pre></div>
<p><strong>Aplicar con <code>Y</code>:</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-101-1"><a id="__codelineno-101-1" name="__codelineno-101-1" href="#__codelineno-101-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">mystery_func</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>
</span></code></pre></div>
<h4 id="security-cookie-check">Security Cookie Check<a class="headerlink" href="#security-cookie-check" title="Permanent link">&para;</a></h4>
<p><strong>Código al final de funciones:</strong></p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-102-1"><a id="__codelineno-102-1" name="__codelineno-102-1" href="#__codelineno-102-1"></a><span class="nf">mov</span><span class="w">     </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="no">rbp</span><span class="err">+</span><span class="mi">8</span><span class="p">]</span>
</span><span id="__span-102-2"><a id="__codelineno-102-2" name="__codelineno-102-2" href="#__codelineno-102-2"></a><span class="nf">xor</span><span class="w">     </span><span class="no">rcx</span><span class="p">,</span><span class="w"> </span><span class="no">rbp</span>
</span><span id="__span-102-3"><a id="__codelineno-102-3" name="__codelineno-102-3" href="#__codelineno-102-3"></a><span class="nf">call</span><span class="w">    </span><span class="no">__security_check_cookie</span>
</span></code></pre></div>
<p><strong>Si falla:</strong> Salta a <code>__report_gsfailure</code> y llama a <code>ExitProcess</code>.</p>
<p><strong>Nota:</strong> No es parte de la lógica del challenge, es protección del compilador. <strong>Ignorar en el análisis.</strong></p>
<h3 id="desofuscar-expresiones-automaticamente">Desofuscar Expresiones Automáticamente<a class="headerlink" href="#desofuscar-expresiones-automaticamente" title="Permanent link">&para;</a></h3>
<p><strong>IDA tiene una función útil:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-103-1"><a id="__codelineno-103-1" name="__codelineno-103-1" href="#__codelineno-103-1"></a>Clic derecho en expresión confusa &gt; Deobfuscate &gt; Simplify arithmetic
</span></code></pre></div>
<p><strong>Ejemplo:</strong></p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-104-1"><a id="__codelineno-104-1" name="__codelineno-104-1" href="#__codelineno-104-1"></a><span class="c1">// Antes:</span>
</span><span id="__span-104-2"><a id="__codelineno-104-2" name="__codelineno-104-2" href="#__codelineno-104-2"></a><span class="n">v5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="kt">unsigned</span><span class="w"> </span><span class="kr">__int64</span><span class="p">)(</span><span class="n">v3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x1234</span><span class="p">)</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="mh">0x5678</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mh">0x9ABC</span><span class="p">;</span>
</span><span id="__span-104-3"><a id="__codelineno-104-3" name="__codelineno-104-3" href="#__codelineno-104-3"></a>
</span><span id="__span-104-4"><a id="__codelineno-104-4" name="__codelineno-104-4" href="#__codelineno-104-4"></a><span class="c1">// Después:</span>
</span><span id="__span-104-5"><a id="__codelineno-104-5" name="__codelineno-104-5" href="#__codelineno-104-5"></a><span class="n">v5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0xABCD</span><span class="p">;</span><span class="w">  </span><span class="c1">// Simplificado</span>
</span></code></pre></div>
<p><strong>No siempre funciona</strong>, pero vale la pena intentar.</p>
<hr />
<h2 id="parte-6-notas-finales-y-workflow-recomendado">Parte 6: Notas Finales y Workflow Recomendado<a class="headerlink" href="#parte-6-notas-finales-y-workflow-recomendado" title="Permanent link">&para;</a></h2>
<h3 id="orden-de-aplicacion-de-tecnicas">Orden de Aplicación de Técnicas<a class="headerlink" href="#orden-de-aplicacion-de-tecnicas" title="Permanent link">&para;</a></h3>
<p><strong>Workflow completo para un binario ofuscado con C++:</strong></p>
<ol>
<li><strong>Detección del compilador:</strong></li>
<li>Usar Detect It Easy</li>
<li>
<p>Identificar: MSVC, Intel C++, MinGW, Clang, etc.</p>
</li>
<li>
<p><strong>Desofuscación (si aplica):</strong></p>
</li>
<li>Identificar patrones de ofuscación</li>
<li>Crear script IDAPython</li>
<li>
<p>Aplicar y hacer snapshot del IDB</p>
</li>
<li>
<p><strong>FLIRT básico:</strong></p>
</li>
<li>Intentar cargar firmas estándar de IDA</li>
<li>
<p>Ver cuántas funciones se detectan</p>
</li>
<li>
<p><strong>FLIRT personalizado (si falla el estándar):</strong></p>
</li>
<li>Generar código de prueba con ChatGPT</li>
<li>Compilar con mismo compilador: <strong><code>/MD</code> + sin optimizaciones (<code>/Od</code>)</strong></li>
<li>idb2pat → sigmake → .sig</li>
<li>
<p>Aplicar al challenge</p>
</li>
<li>
<p><strong>Bindiff (si los nombres siguen rotos):</strong></p>
</li>
<li>Compilar versión con Visual Studio</li>
<li>Ejecutar Bindiff entre Intel y VS</li>
<li>
<p>Importar símbolos</p>
</li>
<li>
<p><strong>Importación de estructuras:</strong></p>
</li>
<li>Exportar typeinfo del IDB con símbolos</li>
<li>Importar en el challenge</li>
<li>
<p>Aplicar estructuras al stack frame</p>
</li>
<li>
<p><strong>Análisis manual:</strong></p>
</li>
<li>Renombrar variables</li>
<li>Entender lógica</li>
<li>Escribir keygen</li>
</ol>
<h3 id="comandos-y-atajos-esenciales">Comandos y Atajos Esenciales<a class="headerlink" href="#comandos-y-atajos-esenciales" title="Permanent link">&para;</a></h3>
<p><strong>IDA Pro:</strong></p>
<table>
<thead>
<tr>
<th>Atajo</th>
<th>Función</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Space</code></td>
<td>Toggle vista Graph/Text</td>
</tr>
<tr>
<td><code>Shift+F12</code></td>
<td>Ver strings</td>
</tr>
<tr>
<td><code>Alt+M</code></td>
<td>Crear bookmark</td>
</tr>
<tr>
<td><code>N</code></td>
<td>Renombrar variable/función</td>
</tr>
<tr>
<td><code>Y</code></td>
<td>Cambiar tipo de variable</td>
</tr>
<tr>
<td><code>U</code></td>
<td>Undefinir (convertir a bytes)</td>
</tr>
<tr>
<td><code>C</code></td>
<td>Crear código desde bytes</td>
</tr>
<tr>
<td><code>H</code></td>
<td>Toggle hex/decimal</td>
</tr>
<tr>
<td><code>;</code></td>
<td>Agregar comentario</td>
</tr>
<tr>
<td><code>X</code></td>
<td>Ver referencias cruzadas (xrefs)</td>
</tr>
<tr>
<td><code>G</code></td>
<td>Saltar a dirección</td>
</tr>
<tr>
<td><code>Shift+F1</code></td>
<td>Abrir Local Types</td>
</tr>
</tbody>
</table>
<p><strong>IDAPython (consola o script):</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-105-1"><a id="__codelineno-105-1" name="__codelineno-105-1" href="#__codelineno-105-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">ida_bytes</span>
</span><span id="__span-105-2"><a id="__codelineno-105-2" name="__codelineno-105-2" href="#__codelineno-105-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">ida_ua</span>
</span><span id="__span-105-3"><a id="__codelineno-105-3" name="__codelineno-105-3" href="#__codelineno-105-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">ida_auto</span>
</span><span id="__span-105-4"><a id="__codelineno-105-4" name="__codelineno-105-4" href="#__codelineno-105-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">idaapi</span>
</span><span id="__span-105-5"><a id="__codelineno-105-5" name="__codelineno-105-5" href="#__codelineno-105-5"></a>
</span><span id="__span-105-6"><a id="__codelineno-105-6" name="__codelineno-105-6" href="#__codelineno-105-6"></a><span class="c1"># Undefinir byte</span>
</span><span id="__span-105-7"><a id="__codelineno-105-7" name="__codelineno-105-7" href="#__codelineno-105-7"></a><span class="n">ida_bytes</span><span class="o">.</span><span class="n">del_items</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">ida_bytes</span><span class="o">.</span><span class="n">DELIT_SIMPLE</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
</span><span id="__span-105-8"><a id="__codelineno-105-8" name="__codelineno-105-8" href="#__codelineno-105-8"></a>
</span><span id="__span-105-9"><a id="__codelineno-105-9" name="__codelineno-105-9" href="#__codelineno-105-9"></a><span class="c1"># Crear instrucción</span>
</span><span id="__span-105-10"><a id="__codelineno-105-10" name="__codelineno-105-10" href="#__codelineno-105-10"></a><span class="n">ida_ua</span><span class="o">.</span><span class="n">create_insn</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
</span><span id="__span-105-11"><a id="__codelineno-105-11" name="__codelineno-105-11" href="#__codelineno-105-11"></a>
</span><span id="__span-105-12"><a id="__codelineno-105-12" name="__codelineno-105-12" href="#__codelineno-105-12"></a><span class="c1"># Analizar desde inicio hasta fin</span>
</span><span id="__span-105-13"><a id="__codelineno-105-13" name="__codelineno-105-13" href="#__codelineno-105-13"></a><span class="n">ida_auto</span><span class="o">.</span><span class="n">auto_wait</span><span class="p">()</span>
</span><span id="__span-105-14"><a id="__codelineno-105-14" name="__codelineno-105-14" href="#__codelineno-105-14"></a>
</span><span id="__span-105-15"><a id="__codelineno-105-15" name="__codelineno-105-15" href="#__codelineno-105-15"></a><span class="c1"># Get min/max address</span>
</span><span id="__span-105-16"><a id="__codelineno-105-16" name="__codelineno-105-16" href="#__codelineno-105-16"></a><span class="n">min_ea</span> <span class="o">=</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">ida_inf_get_min_ea</span><span class="p">()</span>
</span><span id="__span-105-17"><a id="__codelineno-105-17" name="__codelineno-105-17" href="#__codelineno-105-17"></a><span class="n">max_ea</span> <span class="o">=</span> <span class="n">idaapi</span><span class="o">.</span><span class="n">ida_inf_get_max_ea</span><span class="p">()</span>
</span></code></pre></div>
<h3 id="errores-comunes-y-soluciones">Errores Comunes y Soluciones<a class="headerlink" href="#errores-comunes-y-soluciones" title="Permanent link">&para;</a></h3>
<p><strong>1. "Bindiff dice que el IDB está abierto"</strong></p>
<ul>
<li>Cerrar todas las instancias de IDA</li>
<li>Si persiste: Copiar el <code>.i64</code> a otra carpeta y probar de nuevo</li>
<li>En IDA Free: Usar workaround con Binexport + línea de comandos</li>
</ul>
<p><strong>2. "FLIRT no detecta nada o ve pocos símbolos"</strong></p>
<ul>
<li>Verificar que el compilador coincida</li>
<li><strong>Verificar que las optimizaciones están desactivadas (<code>/Od</code>)</strong></li>
<li><strong>Verificar que usas <code>/MD</code> (dynamic linking)</strong></li>
<li>Verificar que el binario tiene símbolos (.pdb)</li>
</ul>
<p><strong>3. "Símbolos importados con Bindiff están incompletos"</strong></p>
<ul>
<li>Filtrar por similitud &gt; 0.90</li>
<li>Verificar que ambos ejecutables usen el mismo código fuente</li>
</ul>
<p><strong>4. "Script IDAPython da error al ejecutar"</strong></p>
<ul>
<li>Verificar sintaxis de Python 3</li>
<li>Usar <code>print()</code> para debugging</li>
<li>IDA Free no soporta IDAPython</li>
</ul>
<p><strong>5. "Estructuras importadas no aparecen"</strong></p>
<ul>
<li>Verificar que el script <code>.idc</code> se ejecutó sin errores</li>
<li>Recargar IDA si es necesario</li>
<li>Asegurarse de que el IDB origen tenga las estructuras</li>
</ul>
<h3 id="recursos-adicionales">Recursos Adicionales<a class="headerlink" href="#recursos-adicionales" title="Permanent link">&para;</a></h3>
<p><strong>Herramientas:</strong></p>
<ul>
<li><a href="https://www.zynamics.com/bindiff.html">Bindiff</a></li>
<li><a href="https://github.com/horsicq/Detect-It-Easy">Detect It Easy</a></li>
<li><a href="https://github.com/google/binexport">idb2pat.py</a></li>
</ul>
<hr />
<h2 id="resumen-final">Resumen Final<a class="headerlink" href="#resumen-final" title="Permanent link">&para;</a></h2>
<p>✅ <strong>Desofuscación estática</strong> con scripts IDAPython automatizados<br />
✅ <strong>Creación de FLIRT personalizado</strong> para detectar funciones embebidas de C++<br />
✅ <strong>Uso de Bindiff</strong> para reconstruir símbolos desde ejecutables con compiladores diferentes<br />
✅ <strong>Importación de estructuras STL</strong> para mejorar la legibilidad del pseudocódigo<br />
✅ <strong>Análisis de stack alignment</strong> y problemas de calling convention en x64  </p>
<p><strong>Lección clave:</strong> El reversing profesional requiere <strong>automatización</strong> y <strong>herramientas personalizadas</strong>. Un script de 10 líneas puede ahorrar horas de trabajo manual.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/G4sp4rCS" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.sections", "navigation.top", "navigation.tracking", "navigation.indexes", "toc.integrate", "content.code.copy", "content.action.edit", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>