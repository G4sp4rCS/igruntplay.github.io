## ZEXOR v0.1 (svidnet)

Challenge page: https://crackmes.one/crackme/6953d0c0d88d50bd6a9e7b63

## 1) Brief context (what was analyzed)

Windows x64 GUI binary analyzed with IDA. The entry flow leads to `WinMain`, and the license check is centralized in a helper function called from the button handler.

## 2) Key findings (3â€“6 points)

* The GUI is just a wrapper: the real flow goes from the button handler to `CheckLicense(char const*)`.
* The validation is a plain `strcmp` against a hardcoded string in `.data`.
* The `strcmp` result is converted to a boolean with `test` + `setz` and branched directly to success/failure.
* The entrypoint looks like standard MSVC/CRT startup (probable, based on pattern).
* The license string is stored as a pointer in `__data_start__` (`dq offset`).
* The handler explicitly checks `WM_COMMAND (0x111)` before running the check.

## 3) Visual evidence

### 3.1) Detected OS / binary info

![DIE](<zexor-imgs/Pasted image 20260204035832.png>)

### 3.2) Entry flow to `WinMain`

![Entry to WinMain](<zexor-imgs/Pasted image 20260204040522.png>)

### 3.3) Main handler: input read and check call

![Check license path](<zexor-imgs/Pasted image 20260204040606.png>)

### 3.4) GUI success dialog

![Success dialog](<zexor-imgs/Pasted image 20260204040741.png>)

### 3.5) `Chequear_licencia_llave` in assembly

![strcmp in check](<zexor-imgs/Pasted image 20260204041003.png>)

### 3.6) Hardcoded string in `.data`

![License pointer](<zexor-imgs/Pasted image 20260204041037.png>)

![License string](<zexor-imgs/Pasted image 20260204041058.png>)

## 4) Logic flow (decomp + reasoning)

In the button handler, the edit control text is read via `GetWindowTextA` and passed to `CheckLicense(char const*)`. On MSVC x64, the first argument goes in `RCX`. The return (`AL`) is tested with `test al, al` and branches to success/failure.

From the IDA dump you provided, the main handler is inside `Funcion_principal`, and it compares `Msg` with `0x111` before executing the check. The check is performed by `Chequear_licencia_llave` and uses `strcmp` against `__data_start__` (pointer to the license string in `.rdata`).

## 5) Assembly explained (MSVC x64)

### 5.1) Button handler (relevant fragment)

```asm
; Funcion_principal (based on the provided IDA dump)
cmp     [rbp+Msg], 111h        ; WM_COMMAND
jnz     short loc_continue

mov     rax, cs:hEdit
lea     rdx, [rbp+String]      ; lpString
mov     r8d, 100h              ; nMaxCount
mov     rcx, rax               ; hWnd
call    cs:__imp_GetWindowTextA

lea     rcx, [rbp+String]      ; RCX = input buffer
call    Chequear_licencia_llave
test    al, al
jz      short loc_fail
; success path
```

**Why it matters:** `test al, al` evaluates the boolean returned by `strcmp == 0`. If `al == 0`, the code jumps to the error path; if `al != 0`, it goes to success.

### 5.2) License check

```asm
; Chequear_licencia_llave (based on the provided IDA dump)
mov     [rbp+Str1], rcx        ; Str1 = input
mov     rdx, cs:__data_start__ ; Str2 = hardcoded license
mov     rcx, [rbp+Str1]        ; Str1
call    strcmp
test    eax, eax
setz    al                     ; AL=1 if strcmp == 0
```

**Why it matters:** `strcmp` returns 0 when strings match, and `setz al` converts that into a boolean.

## 6) License key (flag)

```
AEXORRBSHA36325S33
```

## 7) Pseudocode (IDA-style, at the end)

```cpp
bool __fastcall Chequear_licencia_llave(const char *Str1)
{
  // "AEXORRBSHA36325S33"
  return strcmp(Str1, __data_start__) == 0;
}
```

## 8) Clean reconstructed C++

```cpp
#include <windows.h>
#include <cstring>

static const char *kLicense = "AEXORRBSHA36325S33";

bool __fastcall CheckLicense(const char *input) {
    return std::strcmp(input, kLicense) == 0;
}

// Button handler (summary)
void OnCheckClicked(HWND hEdit, HWND hStatus, HWND hWnd) {
    char buf[0x100] = {0};
    GetWindowTextA(hEdit, buf, sizeof(buf));

    if (CheckLicense(buf)) {
        SetWindowTextA(hStatus, "Success");
        MessageBoxA(hWnd, "Congratulations! You've cracked it!", "Success", 0x40);
    } else {
        SetWindowTextA(hStatus, "Error");
        MessageBoxA(hWnd, "Invalid license key. Try again!", "Error", 0x10);
    }
}
```
